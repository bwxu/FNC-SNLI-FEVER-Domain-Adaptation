Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
Loading CNN vectors...
SIZE_TRAIN = 303791
SIZE_VAL = 55606
SIZE_TEST = 28477
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 76989.53156280518
    Train  Domain Loss = 72936.07703018188
    Train  Regularization Loss = 4998.548408031464
    Train  Total Loss = 154924.15700101852
    Train  Composite Score 62044.25
    Train  Label Accuracy [0.6815207581227437, 0.5189079422382672, 0.0, 0.0]
    Train  Label F1 [0.6307754957137338, 0.5653044921034843, 0, 0]
    Train  Domain Accuracy [0.0, 0.632062274368231, 0.45888989169675093]

    Val  Label Loss = 31987.367067337036
    Val  Domain Loss = 37626.65449714661
    Val  Regularization Loss = 1975.072335243225
    Val  Total Loss = 71589.09389972687
    Val  Composite Score 43493.5
    Val  Label Accuracy [0.7483520970658578, 0.6471857410881802, 0.0, 0.0]
    Val  Label F1 [0.760620164230872, 0.6308233895670461, 0, 0]
    Val  Domain Accuracy [0.0, 0.9653634499874114, 0.13275545804409597]

    New Best Val Loss

    Test  Label Loss = 17229.7928314209
    Test  Domain Loss = 19371.937408447266
    Test  Regularization Loss = 1010.5845880508423
    Test  Total Loss = 37612.314827919006
    Test  Composite Score 21556.0
    Test  Label Accuracy [0.7108717603500505, 0.5813802083333334, 0.0, 0.0]
    Test  Label F1 [0.7621404268481287, 0.49179425046811326, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.1318256838852407]

  EPOCH 1
    Train  Label Loss = 75593.94859695435
    Train  Domain Loss = 88353.18040084839
    Train  Regularization Loss = 2928.9257974624634
    Train  Total Loss = 166876.0547952652
    Train  Composite Score 63193.75
    Train  Label Accuracy [0.6918546931407942, 0.5428023465703972, 0.0, 0.0]
    Train  Label F1 [0.6441536069913029, 0.5866559367912796, 0, 0]
    Train  Domain Accuracy [0.0, 0.5751805054151624, 0.3526624548736462]

    Val  Label Loss = 32779.73878669739
    Val  Domain Loss = 38218.51232767105
    Val  Regularization Loss = 1609.580924987793
    Val  Total Loss = 72607.83203935623
    Val  Composite Score 42362.5
    Val  Label Accuracy [0.6580236831359738, 0.7217166979362102, 0.0, 0.0]
    Val  Label F1 [0.718732080280344, 0.6354063429137761, 0, 0]
    Val  Domain Accuracy [0.0, 0.9358342624896594, 0.13397834766032443]

    Test  Label Loss = 18277.239910125732
    Test  Domain Loss = 20924.320793151855
    Test  Regularization Loss = 823.5737228393555
    Test  Total Loss = 40025.13442611694
    Test  Composite Score 20366.5
    Test  Label Accuracy [0.5904697792950906, 0.7009114583333333, 0.0, 0.0]
    Test  Label F1 [0.6942952450952676, 0.498887859128823, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.13523194156687854]

  EPOCH 2
    Train  Label Loss = 74629.29470825195
    Train  Domain Loss = 74814.95571136475
    Train  Regularization Loss = 2435.419852256775
    Train  Total Loss = 151879.67027187347
    Train  Composite Score 63281.75
    Train  Label Accuracy [0.6998420577617328, 0.5376805054151624, 0.0, 0.0]
    Train  Label F1 [0.647915274064171, 0.5855396523127956, 0, 0]
    Train  Domain Accuracy [0.0, 0.5056859205776173, 0.44650270758122745]

    Val  Label Loss = 31299.989329576492
    Val  Domain Loss = 38573.14845466614
    Val  Regularization Loss = 1389.5668652057648
    Val  Total Loss = 71262.7046494484
    Val  Composite Score 43798.75
    Val  Label Accuracy [0.7393105057457855, 0.6808161350844277, 0.0, 0.0]
    Val  Label F1 [0.7630458014118214, 0.6483818372679964, 0, 0]
    Val  Domain Accuracy [0.0, 0.7869654353846707, 0.19156206164802358]

    New Best Val Loss

    Test  Label Loss = 17025.629459381104
    Test  Domain Loss = 19966.08905029297
    Test  Regularization Loss = 710.9992039203644
    Test  Total Loss = 37702.71771359444
    Test  Composite Score 21445.75
    Test  Label Accuracy [0.6973601961821416, 0.598828125, 0.0, 0.0]
    Test  Label F1 [0.7557385164534535, 0.4952350185753514, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.19282227762755907]

  EPOCH 3
    Train  Label Loss = 73306.86953735352
    Train  Domain Loss = 74108.22917556763
    Train  Regularization Loss = 2028.447830438614
    Train  Total Loss = 149443.54654335976
    Train  Composite Score 63399.0
    Train  Label Accuracy [0.7020306859205776, 0.5386507220216606, 0.0, 0.0]
    Train  Label F1 [0.6490737650200267, 0.5865962282695497, 0, 0]
    Train  Domain Accuracy [0.0, 0.5435694945848375, 0.40002256317689533]

    Val  Label Loss = 31587.11748600006
    Val  Domain Loss = 38658.327687740326
    Val  Regularization Loss = 1128.3043274879456
    Val  Total Loss = 71373.74950122833
    Val  Composite Score 43529.5
    Val  Label Accuracy [0.7111940733827218, 0.7091932457786116, 0.0, 0.0]
    Val  Label F1 [0.7517804840450131, 0.6525398126969056, 0, 0]
    Val  Domain Accuracy [0.0, 0.9992446858252707, 0.010286659712980614]

    Test  Label Loss = 17378.69630432129
    Test  Domain Loss = 21673.58402633667
    Test  Regularization Loss = 577.3190903663635
    Test  Total Loss = 39629.59942102432
    Test  Composite Score 21221.5
    Test  Label Accuracy [0.6685098812328701, 0.6380208333333334, 0.0, 0.0]
    Test  Label F1 [0.7418890074706509, 0.503235082674335, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.010991326333532324]

  EPOCH 4
    Train  Label Loss = 72598.79335021973
    Train  Domain Loss = 73948.63143157959
    Train  Regularization Loss = 1724.4325312376022
    Train  Total Loss = 148271.85731303692
    Train  Composite Score 63499.75
    Train  Label Accuracy [0.7046931407942238, 0.5389891696750903, 0.0, 0.0]
    Train  Label F1 [0.6507954699367583, 0.5876868196076019, 0, 0]
    Train  Domain Accuracy [0.0, 0.5123420577617328, 0.42815884476534294]

    Val  Label Loss = 31280.719290733337
    Val  Domain Loss = 38633.28715610504
    Val  Regularization Loss = 1077.2158974409103
    Val  Total Loss = 70991.22234427929
    Val  Composite Score 43838.5
    Val  Label Accuracy [0.7282855976200199, 0.7010318949343339, 0.0, 0.0]
    Val  Label F1 [0.7609325003809233, 0.6557851783598789, 0, 0]
    Val  Domain Accuracy [0.0, 0.990900262561594, 0.00010790202496133511]

    New Best Val Loss

    Test  Label Loss = 17040.905479431152
    Test  Domain Loss = 19963.27764892578
    Test  Regularization Loss = 551.1786907911301
    Test  Total Loss = 37555.361819148064
    Test  Composite Score 21559.75
    Test  Label Accuracy [0.699091215079098, 0.6139322916666666, 0.0, 0.0]
    Test  Label F1 [0.7591968878097178, 0.5055487053020962, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0001053481757207571]

  EPOCH 5
    Train  Label Loss = 72311.39859008789
    Train  Domain Loss = 73746.43574905396
    Train  Regularization Loss = 1638.2378162145615
    Train  Total Loss = 147696.0721553564
    Train  Composite Score 63610.75
    Train  Label Accuracy [0.70514440433213, 0.5418772563176896, 0.0, 0.0]
    Train  Label F1 [0.6519322033898306, 0.590044715247408, 0, 0]
    Train  Domain Accuracy [0.0, 0.5507445848375452, 0.39550992779783395]

    Val  Label Loss = 32186.416825294495
    Val  Domain Loss = 38703.9907913208
    Val  Regularization Loss = 1009.7782986164093
    Val  Total Loss = 71900.1859152317
    Val  Composite Score 42580.0
    Val  Label Accuracy [0.6387738435513037, 0.7662757973733584, 0.0, 0.0]
    Val  Label F1 [0.7160699689390224, 0.652931537508493, 0, 0]
    Val  Domain Accuracy [0.0, 0.9638887889796065, 0.002589648599072043]

    Test  Label Loss = 18122.790908813477
    Test  Domain Loss = 19833.140747070312
    Test  Regularization Loss = 516.6729176044464
    Test  Total Loss = 38472.604573488235
    Test  Composite Score 20455.0
    Test  Label Accuracy [0.5939799009472521, 0.7067708333333333, 0.0, 0.0]
    Test  Label F1 [0.6978701768261679, 0.5037119524870082, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0029146328616076133]

  EPOCH 6
    Train  Label Loss = 72205.14003753662
    Train  Domain Loss = 73886.13498306274
    Train  Regularization Loss = 1552.7560740709305
    Train  Total Loss = 147644.0310946703
    Train  Composite Score 63681.5
    Train  Label Accuracy [0.7040839350180506, 0.5450586642599278, 0.0, 0.0]
    Train  Label F1 [0.6522238943232171, 0.5921486438455221, 0, 0]
    Train  Domain Accuracy [0.0, 0.5344539711191336, 0.40146660649819493]

    Val  Label Loss = 31339.895013332367
    Val  Domain Loss = 37816.081585884094
    Val  Regularization Loss = 925.1729570627213
    Val  Total Loss = 70081.14955627918
    Val  Composite Score 43716.25
    Val  Label Accuracy [0.712302397480021, 0.7190900562851782, 0.0, 0.0]
    Val  Label F1 [0.7549654543487333, 0.6591852090723422, 0, 0]
    Val  Domain Accuracy [0.0, 0.9938136172355502, 0.08326439592849692]

    Test  Label Loss = 17211.543437957764
    Test  Domain Loss = 19092.68284225464
    Test  Regularization Loss = 473.3829313516617
    Test  Total Loss = 36777.609211564064
    Test  Composite Score 21277.0
    Test  Label Accuracy [0.6690388036736068, 0.6462239583333333, 0.0, 0.0]
    Test  Label F1 [0.7435075344661751, 0.5083478439004405, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.08410296028373776]

  EPOCH 7
    Train  Label Loss = 72811.2437210083
    Train  Domain Loss = 74866.0689201355
    Train  Regularization Loss = 1450.1859600543976
    Train  Total Loss = 149127.4986011982
    Train  Composite Score 63596.75
    Train  Label Accuracy [0.7021209386281588, 0.5444720216606498, 0.0, 0.0]
    Train  Label F1 [0.6508203749986928, 0.5910621777521953, 0, 0]
    Train  Domain Accuracy [0.0, 0.5395532490974729, 0.40212093862815884]

    Val  Label Loss = 31251.95190858841
    Val  Domain Loss = 38420.45586490631
    Val  Regularization Loss = 883.2941479682922
    Val  Total Loss = 70555.70192146301
    Val  Composite Score 43672.75
    Val  Label Accuracy [0.7209356588695094, 0.7024859287054409, 0.0, 0.0]
    Val  Label F1 [0.7565152187552604, 0.6530905919546496, 0, 0]
    Val  Domain Accuracy [0.0, 0.9984174369672337, 0.038916663669388195]

    New Best Val Loss

    Test  Label Loss = 17227.564838409424
    Test  Domain Loss = 20380.35516357422
    Test  Regularization Loss = 451.95481538772583
    Test  Total Loss = 38059.87481737137
    Test  Composite Score 21306.25
    Test  Label Accuracy [0.6706736548540655, 0.646875, 0.0, 0.0]
    Test  Label F1 [0.7447473102490857, 0.5096168641329436, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.04242019875689153]

  EPOCH 8
    Train  Label Loss = 71889.38748168945
    Train  Domain Loss = 73926.56199455261
    Train  Regularization Loss = 1422.6184175014496
    Train  Total Loss = 147238.56789374352
    Train  Composite Score 63904.25
    Train  Label Accuracy [0.7116425992779783, 0.5442012635379061, 0.0, 0.0]
    Train  Label F1 [0.656666076763723, 0.5939250667947156, 0, 0]
    Train  Domain Accuracy [0.0, 0.49032039711191333, 0.4460514440433213]

    Val  Label Loss = 30136.012469768524
    Val  Domain Loss = 38564.55901813507
    Val  Regularization Loss = 863.7174950838089
    Val  Total Loss = 69564.2889829874
    Val  Composite Score 44900.5
    Val  Label Accuracy [0.7932975558537012, 0.6628986866791745, 0.0, 0.0]
    Val  Label F1 [0.7921423578751164, 0.664456981664316, 0, 0]
    Val  Domain Accuracy [0.0, 1.0, 0.007013631622486782]

    New Best Val Loss

    Test  Label Loss = 16128.094829559326
    Test  Domain Loss = 20132.992233276367
    Test  Regularization Loss = 441.9380360841751
    Test  Total Loss = 36703.02509891987
    Test  Composite Score 22451.5
    Test  Label Accuracy [0.7833341347309708, 0.540625, 0.0, 0.0]
    Test  Label F1 [0.8021961788457751, 0.5082629452809402, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.008111809530498297]

  EPOCH 9
    Train  Label Loss = 71736.7926158905
    Train  Domain Loss = 73876.28397369385
    Train  Regularization Loss = 1375.6265325546265
    Train  Total Loss = 146988.70312213898
    Train  Composite Score 63888.5
    Train  Label Accuracy [0.708167870036101, 0.547202166064982, 0.0, 0.0]
    Train  Label F1 [0.6554179631215152, 0.5950972934507889, 0, 0]
    Train  Domain Accuracy [0.0, 0.6200586642599278, 0.32786552346570397]

    Val  Label Loss = 31113.764590740204
    Val  Domain Loss = 38570.59256839752
    Val  Regularization Loss = 863.9318993091583
    Val  Total Loss = 70548.28905844688
    Val  Composite Score 43654.75
    Val  Label Accuracy [0.7141982150148749, 0.7121951219512195, 0.0, 0.0]
    Val  Label F1 [0.7545024572863548, 0.6558538323650736, 0, 0]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    Test  Label Loss = 17175.396949768066
    Test  Domain Loss = 19520.820487976074
    Test  Regularization Loss = 442.04774022102356
    Test  Total Loss = 37138.265177965164
    Test  Composite Score 21290.5
    Test  Label Accuracy [0.6676924556426408, 0.6522135416666667, 0.0, 0.0]
    Test  Label F1 [0.7434812871446164, 0.5111224489795919, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 1.0]

  EPOCH 10
    Train  Label Loss = 71608.37926483154
    Train  Domain Loss = 73945.77182388306
    Train  Regularization Loss = 1344.5237836837769
    Train  Total Loss = 146898.67487239838
    Train  Composite Score 63830.0
    Train  Label Accuracy [0.7133574007220217, 0.5402527075812275, 0.0, 0.0]
    Train  Label F1 [0.6565329346291221, 0.5914435332477027, 0, 0]
    Train  Domain Accuracy [0.0, 0.5015342960288809, 0.43605595667870034]

    Val  Label Loss = 31260.4583735466
    Val  Domain Loss = 38559.49138593674
    Val  Regularization Loss = 816.9967626333237
    Val  Total Loss = 70636.94652211666
    Val  Composite Score 43776.25
    Val  Label Accuracy [0.7168231931400572, 0.7155722326454034, 0.0, 0.0]
    Val  Label F1 [0.7570656275509419, 0.6592200496921249, 0, 0]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    Test  Label Loss = 17154.207679748535
    Test  Domain Loss = 19379.965953826904
    Test  Regularization Loss = 418.0324548482895
    Test  Total Loss = 36952.20608842373
    Test  Composite Score 21367.0
    Test  Label Accuracy [0.6735586863489926, 0.649609375, 0.0, 0.0]
    Test  Label F1 [0.7471730317900577, 0.5127967930928153, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 1.0]

  EPOCH 11
    Train  Label Loss = 71716.77206039429
    Train  Domain Loss = 74128.54374694824
    Train  Regularization Loss = 1286.1388618946075
    Train  Total Loss = 147131.45466923714
    Train  Composite Score 63914.75
    Train  Label Accuracy [0.7135830324909748, 0.5425767148014441, 0.0, 0.0]
    Train  Label F1 [0.6573753624544009, 0.5933062755209041, 0, 0]
    Train  Domain Accuracy [0.0, 0.5674638989169675, 0.36755415162454874]
