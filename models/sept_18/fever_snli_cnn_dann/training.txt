Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading CNN vectors...
SIZE_TRAIN = 303791
SIZE_VAL = 55606
SIZE_TEST = 28477
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 88216.52523803711
    Train  Domain Loss = 61352.3310508728
    Train  Regularization Loss = 6298.59290933609
    Train  Total Loss = 155867.449198246
    Train  Composite Score 58250.5
    Train  Label Accuracy [0.6375451263537906, 0.4490749097472924, 0.0, 0.0]
    Train  Label F1 [0.5834099003768131, 0.49650131590435687, 0, 0]
    Train  Domain Accuracy [0.0, 0.7009927797833935, 0.549481046931408]

    Val  Label Loss = 35045.624510765076
    Val  Domain Loss = 28839.45433664322
    Val  Regularization Loss = 2188.998749256134
    Val  Total Loss = 66074.07759666443
    Val  Composite Score 41060.5
    Val  Label Accuracy [0.6770985241789652, 0.6096153846153847, 0.0, 0.0]
    Val  Label F1 [0.7053658240155567, 0.5727064422314269, 0, 0]
    Val  Domain Accuracy [0.0, 0.9645002337877208, 0.539438190123368]

    New Best Val Loss

    Test  Label Loss = 17708.358406066895
    Test  Domain Loss = 15846.720394134521
    Test  Regularization Loss = 1120.0442433357239
    Test  Total Loss = 34675.12304353714
    Test  Composite Score 21113.5
    Test  Label Accuracy [0.6971197768908978, 0.541796875, 0.0, 0.0]
    Test  Label F1 [0.7470500334930696, 0.45876515986769567, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.5477051655722162]

  EPOCH 1
    Train  Label Loss = 82105.11415100098
    Train  Domain Loss = 99578.50729370117
    Train  Regularization Loss = 3509.5913298130035
    Train  Total Loss = 185193.21277451515
    Train  Composite Score 58987.25
    Train  Label Accuracy [0.6328294223826715, 0.47547382671480143, 0.0, 0.0]
    Train  Label F1 [0.5871073757365793, 0.5164064988849951, 0, 0]
    Train  Domain Accuracy [0.0, 0.5432084837545126, 0.3768953068592058]

    Val  Label Loss = 34012.00972008705
    Val  Domain Loss = 37041.40206861496
    Val  Regularization Loss = 1919.8351933956146
    Val  Total Loss = 72973.24698209763
    Val  Composite Score 42186.25
    Val  Label Accuracy [0.806918275681036, 0.47124765478424013, 0.0, 0.0]
    Val  Label F1 [0.7556435643564356, 0.5289704372548503, 0, 0]
    Val  Domain Accuracy [0.0, 0.23188145164190915, 0.9580980469733482]

    New Best Val Loss

    Test  Label Loss = 17130.434379577637
    Test  Domain Loss = 16021.14924621582
    Test  Regularization Loss = 982.3214185237885
    Test  Total Loss = 34133.905044317245
    Test  Composite Score 22041.25
    Test  Label Accuracy [0.7953070154349186, 0.43697916666666664, 0.0, 0.0]
    Test  Label F1 [0.7940279878063417, 0.4388936114562218, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.9562453910173122]

  EPOCH 2
    Train  Label Loss = 80861.43588256836
    Train  Domain Loss = 80535.34006118774
    Train  Regularization Loss = 2774.7745468616486
    Train  Total Loss = 164171.55049061775
    Train  Composite Score 59429.25
    Train  Label Accuracy [0.6504287003610109, 0.4708709386281588, 0.0, 0.0]
    Train  Label F1 [0.5969249883522286, 0.5174046709971736, 0, 0]
    Train  Domain Accuracy [0.0, 0.5251353790613719, 0.40638537906137184]

    Val  Label Loss = 34603.4926366806
    Val  Domain Loss = 38120.69460964203
    Val  Regularization Loss = 1591.8645889759064
    Val  Total Loss = 74316.05183529854
    Val  Composite Score 40825.0
    Val  Label Accuracy [0.6540278831009742, 0.6319887429643527, 0.0, 0.0]
    Val  Label F1 [0.6947146663362043, 0.5775891632373114, 0, 0]
    Val  Domain Accuracy [0.0, 0.12549005503003274, 0.9611552710139194]

    Test  Label Loss = 17814.661960601807
    Test  Domain Loss = 17418.930946350098
    Test  Regularization Loss = 814.5088112354279
    Test  Total Loss = 36048.10171818733
    Test  Composite Score 20367.25
    Test  Label Accuracy [0.6118190123575515, 0.6432291666666666, 0.0, 0.0]
    Test  Label F1 [0.7018008328507211, 0.477456144589958, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.9538926150928819]

  EPOCH 3
    Train  Label Loss = 93034.05377960205
    Train  Domain Loss = 113119.0510673523
    Train  Regularization Loss = 3221.121541261673
    Train  Total Loss = 209374.22638821602
    Train  Composite Score 59373.25
    Train  Label Accuracy [0.6416516245487365, 0.47919675090252706, 0.0, 0.0]
    Train  Label F1 [0.5949994769327336, 0.5232194328792097, 0, 0]
    Train  Domain Accuracy [0.0, 0.5086642599277978, 0.4102662454873646]

    Val  Label Loss = 32959.12854337692
    Val  Domain Loss = 37246.58522605896
    Val  Regularization Loss = 1922.6984758377075
    Val  Total Loss = 72128.41224527359
    Val  Composite Score 42631.0
    Val  Label Accuracy [0.9289214256547862, 0.3028611632270169, 0.0, 0.0]
    Val  Label F1 [0.7864144793698609, 0.4274177533593698, 0, 0]
    Val  Domain Accuracy [0.0, 0.4426500737330504, 0.8833579110167967]

    New Best Val Loss

    Test  Label Loss = 15526.860916137695
    Test  Domain Loss = 18024.320484161377
    Test  Regularization Loss = 983.786473274231
    Test  Total Loss = 34534.9678735733
    Test  Composite Score 23377.0
    Test  Label Accuracy [0.9259989421551186, 0.31497395833333336, 0.0, 0.0]
    Test  Label F1 [0.8499426251213698, 0.41570716617975595, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.8740386978965481]

  EPOCH 4
    Train  Label Loss = 84552.90286254883
    Train  Domain Loss = 80195.55732727051
    Train  Regularization Loss = 2937.2446417808533
    Train  Total Loss = 167685.7048316002
    Train  Composite Score 59565.75
    Train  Label Accuracy [0.6505189530685921, 0.4751128158844765, 0.0, 0.0]
    Train  Label F1 [0.5983707777720128, 0.5211290262705258, 0, 0]
    Train  Domain Accuracy [0.0, 0.5379061371841155, 0.4125676895306859]

    Val  Label Loss = 34028.383392333984
    Val  Domain Loss = 38975.42327737808
    Val  Regularization Loss = 2337.237392425537
    Val  Total Loss = 75341.0440621376
    Val  Composite Score 41934.25
    Val  Label Accuracy [0.9821793151723736, 0.17363977485928705, 0.0, 0.0]
    Val  Label F1 [0.7869921359211957, 0.28884640892599384, 0, 0]
    Val  Domain Accuracy [0.0, 0.7642700428011365, 0.13922957954177606]

    Test  Label Loss = 15833.96766281128
    Test  Domain Loss = 20485.296226501465
    Test  Regularization Loss = 1195.8934593200684
    Test  Total Loss = 37515.15734863281
    Test  Composite Score 23542.0
    Test  Label Accuracy [0.9885079578785402, 0.17434895833333333, 0.0, 0.0]
    Test  Label F1 [0.8620429386112043, 0.2892633398142147, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.14667977666186746]

  EPOCH 5
    Train  Label Loss = 85785.72147750854
    Train  Domain Loss = 86762.35272979736
    Train  Regularization Loss = 3631.987973690033
    Train  Total Loss = 176180.06218099594
    Train  Composite Score 58763.0
    Train  Label Accuracy [0.6322427797833935, 0.46958483754512637, 0.0, 0.0]
    Train  Label F1 [0.5853561729684562, 0.5117788816210103, 0, 0]
    Train  Domain Accuracy [0.0, 0.5121164259927797, 0.41987815884476537]

    Val  Label Loss = 36046.55448675156
    Val  Domain Loss = 38550.424810409546
    Val  Regularization Loss = 2082.0903882980347
    Val  Total Loss = 76679.06968545914
    Val  Composite Score 38188.75
    Val  Label Accuracy [0.4456046199615003, 0.8022983114446529, 0.0, 0.0]
    Val  Label F1 [0.5681771695271388, 0.595650584158933, 0, 0]
    Val  Domain Accuracy [0.0, 0.01917059310146387, 0.9950724741934324]

    Test  Label Loss = 19329.47671508789
    Test  Domain Loss = 16480.851051330566
    Test  Regularization Loss = 1065.3424787521362
    Test  Total Loss = 36875.67024517059
    Test  Composite Score 18070.0
    Test  Label Accuracy [0.4079915372409482, 0.7963541666666667, 0.0, 0.0]
    Test  Label F1 [0.550152369837256, 0.468515397579286, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.9941356182182112]

  EPOCH 6
    Train  Label Loss = 82074.61168670654
    Train  Domain Loss = 78769.32612609863
    Train  Regularization Loss = 2900.0480165481567
    Train  Total Loss = 163743.98582935333
    Train  Composite Score 59511.5
    Train  Label Accuracy [0.6526624548736462, 0.47123194945848373, 0.0, 0.0]
    Train  Label F1 [0.5985164340620117, 0.5184762235765797, 0, 0]
    Train  Domain Accuracy [0.0, 0.5183438628158845, 0.4220216606498195]

    Val  Label Loss = 34141.99483680725
    Val  Domain Loss = 140269.71513260156
    Val  Regularization Loss = 2032.6642715930939
    Val  Total Loss = 176444.3742410019
    Val  Composite Score 41702.5
    Val  Label Accuracy [0.75246456279531, 0.5285647279549719, 0.0, 0.0]
    Val  Label F1 [0.7356849549446789, 0.5486902327393125, 0, 0]
    Val  Domain Accuracy [0.0, 0.0017623997410351401, 0.9997122612667698]

    Test  Label Loss = 17042.979663848877
    Test  Domain Loss = 61.34179505892098
    Test  Regularization Loss = 1040.0526344776154
    Test  Total Loss = 18144.374093385413
    Test  Composite Score 22120.0
    Test  Label Accuracy [0.8223301437707362, 0.37747395833333336, 0.0, 0.0]
    Test  Label F1 [0.8014058106841612, 0.4061930783242259, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.9996137233556905]

  EPOCH 7
    Train  Label Loss = 83344.98175048828
    Train  Domain Loss = 77296.01177978516
    Train  Regularization Loss = 3104.296570301056
    Train  Total Loss = 163745.2901005745
    Train  Composite Score 59464.75
    Train  Label Accuracy [0.6439305054151625, 0.4787680505415162, 0.0, 0.0]
    Train  Label F1 [0.5951824817518249, 0.5223074177548583, 0, 0]
    Train  Domain Accuracy [0.0, 0.5422382671480145, 0.4131768953068592]

    Val  Label Loss = 33891.442636966705
    Val  Domain Loss = 38661.06647872925
    Val  Regularization Loss = 1669.1675045490265
    Val  Total Loss = 74221.67662024498
    Val  Composite Score 41518.0
    Val  Label Accuracy [0.7161231989733419, 0.57546904315197, 0.0, 0.0]
    Val  Label F1 [0.723317130652526, 0.5664096763768987, 0, 0]
    Val  Domain Accuracy [0.0, 0.9912959033197857, 0.014315001978203791]

    Test  Label Loss = 17615.264583587646
    Test  Domain Loss = 20016.612354278564
    Test  Regularization Loss = 854.0623676776886
    Test  Total Loss = 38485.9393055439
    Test  Composite Score 21027.25
    Test  Label Accuracy [0.6807712650863105, 0.57109375, 0.0, 0.0]
    Test  Label F1 [0.7403069361290492, 0.4689655172413793, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.015556413948098466]

  EPOCH 8
    Train  Label Loss = 79680.52643585205
    Train  Domain Loss = 75399.65578460693
    Train  Regularization Loss = 2418.505095720291
    Train  Total Loss = 157498.68731617928
    Train  Composite Score 60112.0
    Train  Label Accuracy [0.6568592057761733, 0.48497292418772564, 0.0, 0.0]
    Train  Label F1 [0.6049561016156684, 0.5306243365344262, 0, 0]
    Train  Domain Accuracy [0.0, 0.53014440433213, 0.4102662454873646]

    Val  Label Loss = 33252.79989361763
    Val  Domain Loss = 38427.80791902542
    Val  Regularization Loss = 1369.3819258213043
    Val  Total Loss = 73049.98973846436
    Val  Composite Score 42139.75
    Val  Label Accuracy [0.8216181531820568, 0.4446998123827392, 0.0, 0.0]
    Val  Label F1 [0.758328285887341, 0.5136387030365414, 0, 0]
    Val  Domain Accuracy [0.0, 0.16631298780707118, 0.8528935726360465]

    Test  Label Loss = 16587.028285980225
    Test  Domain Loss = 18789.932544708252
    Test  Regularization Loss = 700.6711828708649
    Test  Total Loss = 36077.63201355934
    Test  Composite Score 22380.25
    Test  Label Accuracy [0.8202625378660384, 0.42825520833333336, 0.0, 0.0]
    Test  Label F1 [0.807583970459441, 0.4472700074794316, 0, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.8551111423253854]

  EPOCH 9