Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
Loading CNN vectors...
SIZE_TRAIN = 94441
SIZE_VAL = 2954
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 19075.907972335815
    Train  Domain Loss = 16578.28147125244
    Train  Regularization Loss = 2472.2422914505005
    Train  Total Loss = 38126.43173503876
    Train  Composite Score 15289.75
    Train  Label Accuracy [0.806991307598841, 0.16225066984221495, 0.6162891986062717, 0.0]
    Train  Label F1 [0.7218459994983697, 0.18976323119777158, 0.6977891016684474, 0]
    Train  Domain Accuracy [0.8339539768929629, 0.0, 0.6450873675164709]

    Val  Label Loss = 1950.015344619751
    Val  Domain Loss = 1014.708044052124
    Val  Regularization Loss = 387.4499988555908
    Val  Total Loss = 3352.173387527466
    Val  Composite Score 2314.25
    Val  Label Accuracy [0.6823056300268097, 0.053475935828877004, 0.7827808015833746, 0.0]
    Val  Label F1 [0.5793966989186112, 0.07633587786259542, 0.8135767549498586, 0]
    Val  Domain Accuracy [0.7894380501015572, 0.0, 0.0]

    Test  Label Loss = 112617.93718147278
    Test  Domain Loss = 11423.039253234863
    Test  Regularization Loss = 3293.324990272522
    Test  Total Loss = 127334.30142498016
    Test  Composite Score 4988.75
    Test  Label Accuracy [0.8649500788229112, 0.005738880918220947, 0.5929659498207885, 0.0]
    Test  Label F1 [0.5509623430962344, 0.011283497884344146, 0.7111767866738313, 0]
    Test  Domain Accuracy [0.7112107976232637, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 19407.15528488159
    Train  Domain Loss = 42508.5500869751
    Train  Regularization Loss = 2741.6001195907593
    Train  Total Loss = 64657.30549144745
    Train  Composite Score 15339.25
    Train  Label Accuracy [0.7932882120699379, 0.20877192982456141, 0.6306620209059234, 0.0]
    Train  Label F1 [0.7202048218476638, 0.230731943771207, 0.7128322940597309, 0]
    Train  Domain Accuracy [0.6578821732072949, 0.0, 0.48792132149336387]

    Val  Label Loss = 1779.654462814331
    Val  Domain Loss = 1300.9313583374023
    Val  Regularization Loss = 386.7944812774658
    Val  Total Loss = 3467.380302429199
    Val  Composite Score 2434.25
    Val  Label Accuracy [0.5670241286863271, 0.39572192513368987, 0.8728352300841168, 0.0]
    Val  Label F1 [0.6134880348078318, 0.36009732360097324, 0.8567265662943176, 0]
    Val  Domain Accuracy [0.7985781990521327, 0.0, 0.0]

    Test  Label Loss = 358042.62907123566
    Test  Domain Loss = 14050.461656570435
    Test  Regularization Loss = 3287.7530908584595
    Test  Total Loss = 375380.84381866455
    Test  Composite Score 5217.5
    Test  Label Accuracy [0.6720966894377299, 0.11047345767575323, 0.7271505376344086, 0.0]
    Test  Label F1 [0.5418343571277272, 0.1546184738955823, 0.7718463916300083, 0]
    Test  Domain Accuracy [0.7381261559044584, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 20922.73779296875
    Train  Domain Loss = 75606.23712921143
    Train  Regularization Loss = 2747.9914417266846
    Train  Total Loss = 99276.96636390686
    Train  Composite Score 15252.25
    Train  Label Accuracy [0.7904617426756424, 0.2173170037026488, 0.6219512195121951, 0.0]
    Train  Label F1 [0.7141205190800463, 0.24283895607893063, 0.704026294165982, 0]
    Train  Domain Accuracy [0.5682230497469684, 0.0, 0.40294089563639834]

    Val  Label Loss = 1942.7467193603516
    Val  Domain Loss = 2590.037910461426
    Val  Regularization Loss = 396.2800598144531
    Val  Total Loss = 4929.0646896362305
    Val  Composite Score 2402.0
    Val  Label Accuracy [0.3646112600536193, 0.5454545454545454, 0.9124195942602672, 0.0]
    Val  Label F1 [0.5009208103130754, 0.385633270321361, 0.8590729093873747, 0]
    Val  Domain Accuracy [0.3097494922139472, 0.0, 0.0]

    Test  Label Loss = 311541.5359725952
    Test  Domain Loss = 23803.786096572876
    Test  Regularization Loss = 3368.3805084228516
    Test  Total Loss = 338713.70257759094
    Test  Composite Score 5061.5
    Test  Label Accuracy [0.21912769311613242, 0.41606886657101866, 0.8259408602150538, 0.0]
    Test  Label F1 [0.3134160090191657, 0.2780441035474593, 0.786056923568916, 0]
    Test  Domain Accuracy [0.24129382599456972, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 22086.449417114258
    Train  Domain Loss = 38179.62113952637
    Train  Regularization Loss = 2779.531660079956
    Train  Total Loss = 63045.60221672058
    Train  Composite Score 14938.5
    Train  Label Accuracy [0.7608183275195626, 0.22457258765575194, 0.6016260162601627, 0.0]
    Train  Label F1 [0.7003992362437077, 0.23743872549019607, 0.681522901077214, 0]
    Train  Domain Accuracy [0.5764346414589898, 0.0, 0.4098157166046023]

    Val  Label Loss = 2120.057159423828
    Val  Domain Loss = 1427.0144672393799
    Val  Regularization Loss = 390.45387268066406
    Val  Total Loss = 3937.525499343872
    Val  Composite Score 2401.25
    Val  Label Accuracy [0.30563002680965146, 0.0106951871657754, 0.983176645225136, 0.0]
    Val  Label F1 [0.4401544401544401, 0.020618556701030927, 0.8495083368961095, 0]
    Val  Domain Accuracy [0.8161814488828707, 0.0, 0.0]

    Test  Label Loss = 500927.04138565063
    Test  Domain Loss = 14231.430752754211
    Test  Regularization Loss = 3318.8579177856445
    Test  Total Loss = 518477.3300561905
    Test  Composite Score 5238.5
    Test  Label Accuracy [0.16605359957961113, 0.00430416068866571, 0.9657258064516129, 0.0]
    Test  Label F1 [0.2545308095046315, 0.008522727272727272, 0.7880449684672334, 0]
    Test  Domain Accuracy [0.7421004997442254, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 20995.596252441406
    Train  Domain Loss = 28266.266578674316
    Train  Regularization Loss = 2694.7743310928345
    Train  Total Loss = 51956.63716220856
    Train  Composite Score 15131.0
    Train  Label Accuracy [0.7573446327683616, 0.2501454333915067, 0.6287746806039489, 0.0]
    Train  Label F1 [0.7029672682777608, 0.256563245823389, 0.7111074624415072, 0]
    Train  Domain Accuracy [0.5559056621789363, 0.0, 0.43139501575479805]

    Val  Label Loss = 2057.0914421081543
    Val  Domain Loss = 5114.128677368164
    Val  Regularization Loss = 402.5602626800537
    Val  Total Loss = 7573.780382156372
    Val  Composite Score 2291.75
    Val  Label Accuracy [0.8083109919571045, 0.0, 0.7263730826323602, 0.0]
    Val  Label F1 [0.5903083700440529, 0, 0.7982599238716694, 0]
    Val  Domain Accuracy [0.0006770480704129993, 0.0, 0.0]

    Test  Label Loss = 720028.2434005737
    Test  Domain Loss = 43947.105350494385
    Test  Regularization Loss = 3421.7622327804565
    Test  Total Loss = 767397.1109838486
    Test  Composite Score 4724.75
    Test  Label Accuracy [0.9148712559117184, 0.0, 0.49372759856630827, 0.0]
    Test  Label F1 [0.5303076454462382, 0, 0.6420975965040058, 0]
    Test  Domain Accuracy [0.00047219926809113444, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 31789.321392059326
    Train  Domain Loss = 69242.38255691528
    Train  Regularization Loss = 3244.801523208618
    Train  Total Loss = 104276.50547218323
    Train  Composite Score 14657.0
    Train  Label Accuracy [0.737079920926292, 0.22358078602620088, 0.5847851335656213, 0.0]
    Train  Label F1 [0.687686632706833, 0.22621502209131078, 0.6639195648590738, 0]
    Train  Domain Accuracy [0.5520863171966007, 0.0, 0.4009357395206722]

    Val  Label Loss = 4772.81526184082
    Val  Domain Loss = 2593.5263862609863
    Val  Regularization Loss = 455.00412940979004
    Val  Total Loss = 7821.345777511597
    Val  Composite Score 2255.75
    Val  Label Accuracy [0.0, 0.016042780748663103, 0.9995051954477981, 0.0]
    Val  Label F1 [0, 0.029850746268656716, 0.8143519451723442, 0]
    Val  Domain Accuracy [0.17298578199052134, 0.0, 0.0]

    Test  Label Loss = 1924128.7236175537
    Test  Domain Loss = 23859.830994606018
    Test  Regularization Loss = 3867.5350999832153
    Test  Total Loss = 1951856.089712143
    Test  Composite Score 5116.25
    Test  Label Accuracy [0.0, 0.015781922525107604, 0.9982078853046595, 0.0]
    Test  Label F1 [0, 0.03001364256480218, 0.7755634844661039, 0]
    Test  Domain Accuracy [0.051863219612009605, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 21491.986267089844
    Train  Domain Loss = 18724.94651031494
    Train  Regularization Loss = 2627.401696205139
    Train  Total Loss = 42844.334473609924
    Train  Composite Score 15336.75
    Train  Label Accuracy [0.7797844175491679, 0.24813325674899483, 0.6369047619047619, 0.0]
    Train  Label F1 [0.7199161974597356, 0.25520602569782896, 0.7241066270529009, 0]
    Train  Domain Accuracy [0.5619211305261148, 0.0, 0.4911677647283491]

    Val  Label Loss = 1646.1074104309082
    Val  Domain Loss = 2172.0761184692383
    Val  Regularization Loss = 337.798490524292
    Val  Total Loss = 4155.9820194244385
    Val  Composite Score 2414.0
    Val  Label Accuracy [0.6340482573726541, 0.0, 0.8713508164275111, 0.0]
    Val  Label F1 [0.5972222222222222, 0, 0.851341551849166, 0]
    Val  Domain Accuracy [0.42417061611374407, 0.0, 0.0]

    Test  Label Loss = 280414.15897369385
    Test  Domain Loss = 19715.004313468933
    Test  Regularization Loss = 2871.287169456482
    Test  Total Loss = 303000.45045661926
    Test  Composite Score 5161.25
    Test  Label Accuracy [0.7708880714661062, 0.0, 0.6854838709677419, 0.0]
    Test  Label F1 [0.5528547201808932, 0, 0.7533234859675036, 0]
    Test  Domain Accuracy [0.23928697910518237, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 17074.339193344116
    Train  Domain Loss = 20716.79759979248
    Train  Regularization Loss = 2391.453239440918
    Train  Total Loss = 40182.590032577515
    Train  Composite Score 15692.5
    Train  Label Accuracy [0.8124764417640407, 0.2309924550203134, 0.6608594657375145, 0.0]
    Train  Label F1 [0.7395779722079259, 0.25031446540880503, 0.7505358615004122, 0]
    Train  Domain Accuracy [0.5451160126038385, 0.0, 0.45335624940322733]

    Val  Label Loss = 1798.3316745758057
    Val  Domain Loss = 3241.940963745117
    Val  Regularization Loss = 327.8301429748535
    Val  Total Loss = 5368.102781295776
    Val  Composite Score 2381.75
    Val  Label Accuracy [0.7734584450402144, 0.0, 0.7986145472538347, 0.0]
    Val  Label F1 [0.6171122994652407, 0, 0.8382238379641652, 0]
    Val  Domain Accuracy [0.0, 0.0, 0.0]

    Test  Label Loss = 438696.78966522217
    Test  Domain Loss = 26665.460372924805
    Test  Regularization Loss = 2786.556215286255
    Test  Total Loss = 468148.8062534332
    Test  Composite Score 4958.0
    Test  Label Accuracy [0.8670520231213873, 0.0, 0.5837813620071685, 0.0]
    Test  Label F1 [0.5478997177486302, 0, 0.7035637149028078, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 16006.678211212158
    Train  Domain Loss = 18657.33490753174
    Train  Regularization Loss = 2167.9187955856323
    Train  Total Loss = 36831.93191432953
    Train  Composite Score 16034.75
    Train  Label Accuracy [0.8263568808202427, 0.2503647505106507, 0.6927990708478513, 0.0]
    Train  Label F1 [0.7513684570646596, 0.27350972266496654, 0.7834509932687572, 0]
    Train  Domain Accuracy [0.550176644705433, 0.0, 0.4602310703714313]

    Val  Label Loss = 1744.3905868530273
    Val  Domain Loss = 2226.3477363586426
    Val  Regularization Loss = 290.2053165435791
    Val  Total Loss = 4260.943639755249
    Val  Composite Score 2393.75
    Val  Label Accuracy [0.7908847184986595, 0.0, 0.8000989609104404, 0.0]
    Val  Label F1 [0.6273258904837853, 0, 0.842406876790831, 0]
    Val  Domain Accuracy [0.1909275558564658, 0.0, 0.0]

    Test  Label Loss = 485308.2991657257
    Test  Domain Loss = 19435.551000595093
    Test  Regularization Loss = 2466.7451906204224
    Test  Total Loss = 507210.5953569412
    Test  Composite Score 4838.75
    Test  Label Accuracy [0.8696794534944824, 0.005738880918220947, 0.546146953405018, 0.0]
    Test  Label F1 [0.533011272141707, 0.011235955056179775, 0.6766583402719956, 0]
    Test  Domain Accuracy [0.11096682800141659, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 17011.215435028076
    Train  Domain Loss = 20712.416885375977
    Train  Regularization Loss = 2047.1369094848633
    Train  Total Loss = 39770.769229888916
    Train  Composite Score 15774.75
    Train  Label Accuracy [0.8200958736723376, 0.2494881544311202, 0.6528745644599303, 0.0]
    Train  Label F1 [0.7431223916191125, 0.27352894019560686, 0.7432443599702504, 0]
    Train  Domain Accuracy [0.5957223336197842, 0.0, 0.42108278430249213]

    Val  Label Loss = 2416.409610748291
    Val  Domain Loss = 1944.4246444702148
    Val  Regularization Loss = 296.5309524536133
    Val  Total Loss = 4657.365207672119
    Val  Composite Score 2209.25
    Val  Label Accuracy [0.9249329758713136, 0.0, 0.6288965858485898, 0.0]
    Val  Label F1 [0.5852417302798981, 0, 0.7560975609756097, 0]
    Val  Domain Accuracy [0.6110358835477319, 0.0, 0.0]

    Test  Label Loss = 223423.72047424316
    Test  Domain Loss = 17120.6452293396
    Test  Regularization Loss = 2520.513095855713
    Test  Total Loss = 243064.87879943848
    Test  Composite Score 4286.75
    Test  Label Accuracy [0.9590120861797162, 0.00860832137733142, 0.34274193548387094, 0.0]
    Test  Label F1 [0.4973429622564382, 0.01680672268907563, 0.5037037037037037, 0]
    Test  Domain Accuracy [0.519694644473301, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 16386.82860183716
    Train  Domain Loss = 19230.606258392334
    Train  Regularization Loss = 2019.3912563323975
    Train  Total Loss = 37636.82611656189
    Train  Composite Score 16004.75
    Train  Label Accuracy [0.8267753419524078, 0.27364066193853426, 0.6726190476190477, 0.0]
    Train  Label F1 [0.7554033811256152, 0.29160762084711067, 0.7659750351326776, 0]
    Train  Domain Accuracy [0.5919029886374487, 0.0, 0.4222285877971928]

    Val  Label Loss = 2012.4519882202148
    Val  Domain Loss = 2156.1165466308594
    Val  Regularization Loss = 275.643310546875
    Val  Total Loss = 4444.211845397949
    Val  Composite Score 2321.0
    Val  Label Accuracy [0.8753351206434317, 0.0, 0.7209302325581395, 0.0]
    Val  Label F1 [0.6166194523135033, 0, 0.8092196612052207, 0]
    Val  Domain Accuracy [0.21834800270819227, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 371545.2657032013
    Test  Domain Loss = 19126.552209854126
    Test  Regularization Loss = 2342.9681396484375
    Test  Total Loss = 393014.78605270386
    Test  Composite Score 4621.25
    Test  Label Accuracy [0.9222280609563847, 0.01291248206599713, 0.4576612903225806, 0.0]
    Test  Label F1 [0.5208487906217539, 0.024930747922437674, 0.6128693565321734, 0]
    Test  Domain Accuracy [0.10840908196592296, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 15252.799728393555
    Train  Domain Loss = 17902.899394989014
    Train  Regularization Loss = 1820.408143043518
    Train  Total Loss = 34976.10726642609
    Train  Composite Score 16215.75
    Train  Label Accuracy [0.8399849042362487, 0.28649898814686325, 0.6906213704994193, 0.0]
    Train  Label F1 [0.7627655928718301, 0.31124371859296485, 0.7834321475625824, 0]
    Train  Domain Accuracy [0.5910436360164232, 0.0, 0.4279576052706961]

    Val  Label Loss = 1748.639268875122
    Val  Domain Loss = 2100.782371520996
    Val  Regularization Loss = 252.68268585205078
    Val  Total Loss = 4102.104326248169
    Val  Composite Score 2398.25
    Val  Label Accuracy [0.7037533512064343, 0.0, 0.8352300841167739, 0.0]
    Val  Label F1 [0.6180105944673338, 0, 0.8398009950248756, 0]
    Val  Domain Accuracy [0.2931618144888287, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 309940.72410583496
    Test  Domain Loss = 18358.062209129333
    Test  Regularization Loss = 2147.8028297424316
    Test  Total Loss = 330446.5891447067
    Test  Composite Score 5069.0
    Test  Label Accuracy [0.7976878612716763, 0.01721664275466284, 0.6438172043010753, 0.0]
    Test  Label F1 [0.548014440433213, 0.033012379642365884, 0.7312046813382521, 0]
    Test  Domain Accuracy [0.24121512611655452, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 17772.51033782959
    Train  Domain Loss = 23147.669151306152
    Train  Regularization Loss = 2066.759464263916
    Train  Total Loss = 42986.93895339966
    Train  Composite Score 15594.75
    Train  Label Accuracy [0.7944277108433735, 0.2722772277227723, 0.6489547038327527, 0.0]
    Train  Label F1 [0.7312740978209072, 0.289563332301022, 0.7298554984080333, 0]
    Train  Domain Accuracy [0.6071803685667908, 0.0, 0.4080015277379929]

    Val  Label Loss = 1637.454755783081
    Val  Domain Loss = 2824.933609008789
    Val  Regularization Loss = 293.9944553375244
    Val  Total Loss = 4756.3828201293945
    Val  Composite Score 2426.0
    Val  Label Accuracy [0.6970509383378016, 0.0053475935828877, 0.855517070757051, 0.0]
    Val  Label F1 [0.6227544910179641, 0.010526315789473684, 0.8542490118577074, 0]
    Val  Domain Accuracy [0.002031144211238998, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 804103.8611030579
    Test  Domain Loss = 24285.292358398438
    Test  Regularization Loss = 2498.9528703689575
    Test  Total Loss = 830888.1063318253
    Test  Composite Score 5096.75
    Test  Label Accuracy [0.7903310562270099, 0.00860832137733142, 0.6565860215053764, 0.0]
    Test  Label F1 [0.5453226976069615, 0.016783216783216783, 0.7423072052678232, 0]
    Test  Domain Accuracy [3.934993900759454e-05, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 15523.533187866211
    Train  Domain Loss = 17684.968872070312
    Train  Regularization Loss = 1925.8966445922852
    Train  Total Loss = 35134.39870452881
    Train  Composite Score 16225.75
    Train  Label Accuracy [0.8478709435377978, 0.2850412249705536, 0.6765389082462253, 0.0]
    Train  Label F1 [0.7665239326747785, 0.31357304826692584, 0.771267792121814, 0]
    Train  Domain Accuracy [0.5804449536904421, 0.0, 0.4489640026735415]

    Val  Label Loss = 1638.2009544372559
    Val  Domain Loss = 1946.7911338806152
    Val  Regularization Loss = 263.80130767822266
    Val  Total Loss = 3848.7933959960938
    Val  Composite Score 2435.0
    Val  Label Accuracy [0.6447721179624665, 0.1497326203208556, 0.867392380009896, 0.0]
    Val  Label F1 [0.634983498349835, 0.1971830985915493, 0.8532489656850815, 0]
    Val  Domain Accuracy [0.6313473256601219, 0.0, 0.0]

    Test  Label Loss = 609164.0883731842
    Test  Domain Loss = 17006.800596237183
    Test  Regularization Loss = 2242.3111152648926
    Test  Total Loss = 628413.2000846863
    Test  Composite Score 5117.75
    Test  Label Accuracy [0.7577509196006306, 0.047345767575322814, 0.6706989247311828, 0.0]
    Test  Label F1 [0.5410881801125703, 0.08516129032258064, 0.7463542315841954, 0]
    Test  Domain Accuracy [0.5855664423720143, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 15551.524295806885
    Train  Domain Loss = 19550.954914093018
    Train  Regularization Loss = 1896.0860776901245
    Train  Total Loss = 36998.56528759003
    Train  Composite Score 16216.75
    Train  Label Accuracy [0.8439830108541765, 0.28039272307248053, 0.6898954703832753, 0.0]
    Train  Label F1 [0.766008480746991, 0.30933418286078374, 0.7794636266710407, 0]
    Train  Domain Accuracy [0.5900887997708393, 0.0, 0.4243292275374773]

    Val  Label Loss = 1743.7222633361816
    Val  Domain Loss = 534.0597591400146
    Val  Regularization Loss = 282.6419162750244
    Val  Total Loss = 2560.4239387512207
    Val  Composite Score 2417.75
    Val  Label Accuracy [0.7225201072386059, 0.2727272727272727, 0.8159327065809006, 0.0]
    Val  Label F1 [0.6435820895522388, 0.3119266055045871, 0.8443420378904248, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 337182.8733110428
    Test  Domain Loss = 5312.814292430878
    Test  Regularization Loss = 2402.4562883377075
    Test  Total Loss = 344898.14389181137
    Test  Composite Score 4950.5
    Test  Label Accuracy [0.8455070940620073, 0.047345767575322814, 0.5833333333333334, 0.0]
    Test  Label F1 [0.543581081081081, 0.08229426433915212, 0.7032136105860114, 0]
    Test  Domain Accuracy [0.9996852004879393, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 15968.71049118042
    Train  Domain Loss = 20454.14389038086
    Train  Regularization Loss = 2026.6829166412354
    Train  Total Loss = 38449.537298202515
    Train  Composite Score 16128.75
    Train  Label Accuracy [0.8282876064333018, 0.29501146788990823, 0.6914924506387921, 0.0]
    Train  Label F1 [0.758205594526717, 0.31139355424421244, 0.786168193447223, 0]
    Train  Domain Accuracy [0.5925713740093574, 0.0, 0.4113434545975365]

    Val  Label Loss = 1718.1968536376953
    Val  Domain Loss = 2107.8319358825684
    Val  Regularization Loss = 281.8729877471924
    Val  Total Loss = 4107.901777267456
    Val  Composite Score 2437.25
    Val  Label Accuracy [0.6032171581769437, 0.0, 0.8980702622464126, 0.0]
    Val  Label F1 [0.600400266844563, 0, 0.8597820937944103, 0]
    Val  Domain Accuracy [0.2796208530805687, 0.0, 0.0]

    Test  Label Loss = 365178.3261833191
    Test  Domain Loss = 18677.171796798706
    Test  Regularization Loss = 2395.9203958511353
    Test  Total Loss = 386251.41837596893
    Test  Composite Score 5281.25
    Test  Label Accuracy [0.7125591171833946, 0.0, 0.7461917562724014, 0.0]
    Test  Label F1 [0.5540347293156281, 0, 0.7804592314901594, 0]
    Test  Domain Accuracy [0.13780348640459608, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 15490.207386016846
    Train  Domain Loss = 17679.174213409424
    Train  Regularization Loss = 1840.8691415786743
    Train  Total Loss = 35010.250741004944
    Train  Composite Score 16274.0
    Train  Label Accuracy [0.8424891077855654, 0.29285714285714287, 0.6984610917537747, 0.0]
    Train  Label F1 [0.765885999655588, 0.3184218701460081, 0.7897890503160141, 0]
    Train  Domain Accuracy [0.5760527069607563, 0.0, 0.44275756707724623]

    Val  Label Loss = 1814.8187160491943
    Val  Domain Loss = 2135.8820991516113
    Val  Regularization Loss = 254.37509536743164
    Val  Total Loss = 4205.075910568237
    Val  Composite Score 2437.25
    Val  Label Accuracy [0.40214477211796246, 0.21390374331550802, 0.9524987629886195, 0.0]
    Val  Label F1 [0.5235602094240838, 0.2768166089965398, 0.8607198748043818, 0]
    Val  Domain Accuracy [0.28672985781990523, 0.0, 0.0]

    Test  Label Loss = 272910.82750701904
    Test  Domain Loss = 19087.469165802002
    Test  Regularization Loss = 2162.188310623169
    Test  Total Loss = 294160.4849834442
    Test  Composite Score 5340.5
    Test  Label Accuracy [0.41355754072517076, 0.058823529411764705, 0.882168458781362, 0.0]
    Test  Label F1 [0.4575581395348837, 0.10135970333745366, 0.7972466848871343, 0]
    Test  Domain Accuracy [0.10612678550348247, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 18824.910175323486
    Train  Domain Loss = 24787.80117416382
    Train  Regularization Loss = 1893.676350593567
    Train  Total Loss = 45506.38770008087
    Train  Composite Score 15713.5
    Train  Label Accuracy [0.8135130041462495, 0.2597214161346489, 0.6537456445993032, 0.0]
    Train  Label F1 [0.745606080234918, 0.28548644338118023, 0.7333876221498372, 0]
    Train  Domain Accuracy [0.576243674209873, 0.0, 0.43702854960374293]

    Val  Label Loss = 2220.800148010254
    Val  Domain Loss = 2232.8023719787598
    Val  Regularization Loss = 319.20166969299316
    Val  Total Loss = 4772.804189682007
    Val  Composite Score 2278.25
    Val  Label Accuracy [0.29624664879356566, 0.6470588235294118, 0.8466105888174171, 0.0]
    Val  Label F1 [0.4341846758349705, 0.29656862745098034, 0.8399607265586647, 0]
    Val  Domain Accuracy [0.25998645903859174, 0.0, 0.0]

    Test  Label Loss = 620997.7181568146
    Test  Domain Loss = 19583.545084953308
    Test  Regularization Loss = 2713.214192390442
    Test  Total Loss = 643294.4774341583
    Test  Composite Score 4705.25
    Test  Label Accuracy [0.11297950604308986, 0.6685796269727403, 0.725358422939068, 0.0]
    Test  Label F1 [0.18711923411662315, 0.2930817610062893, 0.7486705202312138, 0]
    Test  Domain Accuracy [0.192932750954236, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 16875.971572875977
    Train  Domain Loss = 17996.51559829712
    Train  Regularization Loss = 2179.8054523468018
    Train  Total Loss = 37052.2926235199
    Train  Composite Score 15908.25
    Train  Label Accuracy [0.8074709933025186, 0.290714492334394, 0.6801684088269454, 0.0]
    Train  Label F1 [0.7429588161263724, 0.3118212845175303, 0.7593192868719612, 0]
    Train  Domain Accuracy [0.5233457462045259, 0.0, 0.4807600496514848]

    Val  Label Loss = 1723.0994491577148
    Val  Domain Loss = 2031.4167098999023
    Val  Regularization Loss = 302.59254455566406
    Val  Total Loss = 4057.1087036132812
    Val  Composite Score 2399.0
    Val  Label Accuracy [0.7386058981233244, 0.0053475935828877, 0.822365165759525, 0.0]
    Val  Label F1 [0.6208450704225352, 0.010582010582010581, 0.8427991886409736, 0]
    Val  Domain Accuracy [0.4820582261340555, 0.0, 0.0]

    Test  Label Loss = 301044.5651550293
    Test  Domain Loss = 17481.036907196045
    Test  Regularization Loss = 2572.0366287231445
    Test  Total Loss = 321097.6386909485
    Test  Composite Score 4965.5
    Test  Label Accuracy [0.8302679978980557, 0.0028694404591104736, 0.6012544802867383, 0.0]
    Test  Label F1 [0.5382388008857094, 0.005714285714285714, 0.710334788937409, 0]
    Test  Domain Accuracy [0.46794947467831427, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 15388.63516998291
    Train  Domain Loss = 17557.213047027588
    Train  Regularization Loss = 2034.2623796463013
    Train  Total Loss = 34980.1105966568
    Train  Composite Score 16287.25
    Train  Label Accuracy [0.8409890632429862, 0.31865650578605703, 0.6933797909407665, 0.0]
    Train  Label F1 [0.7662247638852786, 0.3416036308623298, 0.7855909203059462, 0]
    Train  Domain Accuracy [0.586078487539387, 0.0, 0.4423756325790127]

    Val  Label Loss = 1650.0921306610107
    Val  Domain Loss = 2488.125747680664
    Val  Regularization Loss = 278.2994556427002
    Val  Total Loss = 4416.517333984375
    Val  Composite Score 2420.0
    Val  Label Accuracy [0.739946380697051, 0.0053475935828877, 0.8357248886689758, 0.0]
    Val  Label F1 [0.6304968589377499, 0.010362694300518135, 0.8521695257315842, 0]
    Val  Domain Accuracy [0.01794177386594448, 0.0, 0.0]

    Test  Label Loss = 606173.0503196716
    Test  Domain Loss = 21063.670433044434
    Test  Regularization Loss = 2365.5453729629517
    Test  Total Loss = 629602.266125679
    Test  Composite Score 4979.75
    Test  Label Accuracy [0.8397267472411981, 0.020086083213773313, 0.5987903225806451, 0.0]
    Test  Label F1 [0.5428911160183455, 0.03862068965517241, 0.711282597126131, 0]
    Test  Domain Accuracy [0.02002911895486562, 0.0, 0.0]

  EPOCH 20
    Train  Label Loss = 14945.635196685791
    Train  Domain Loss = 18131.94843673706
    Train  Regularization Loss = 1875.730110168457
    Train  Total Loss = 34953.31374359131
    Train  Composite Score 16398.5
    Train  Label Accuracy [0.8565744600227359, 0.29354654483152487, 0.7009291521486644, 0.0]
    Train  Label F1 [0.7733162283515075, 0.3242390790096199, 0.7966996699669968, 0]
    Train  Domain Accuracy [0.627900315095961, 0.0, 0.39969445240141316]

    Val  Label Loss = 1550.8081951141357
    Val  Domain Loss = 2038.269374847412
    Val  Regularization Loss = 263.6355972290039
    Val  Total Loss = 3852.7131671905518
    Val  Composite Score 2459.75
    Val  Label Accuracy [0.6554959785522788, 0.08021390374331551, 0.8861949529935675, 0.0]
    Val  Label F1 [0.63671875, 0.12552301255230125, 0.8666827969997579, 0]
    Val  Domain Accuracy [0.559580230196344, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 409723.2632236481
    Test  Domain Loss = 17716.99994659424
    Test  Regularization Loss = 2240.902576446533
    Test  Total Loss = 429681.16574668884
    Test  Composite Score 5218.25
    Test  Label Accuracy [0.7393589069889648, 0.03730272596843615, 0.7101254480286738, 0.0]
    Test  Label F1 [0.5532835233975619, 0.06692406692406692, 0.7670901391409558, 0]
    Test  Domain Accuracy [0.44323771298154485, 0.0, 0.0]

  EPOCH 21
    Train  Label Loss = 15078.269050598145
    Train  Domain Loss = 19198.31667327881
    Train  Regularization Loss = 1842.6507244110107
    Train  Total Loss = 36119.236448287964
    Train  Composite Score 16371.25
    Train  Label Accuracy [0.8451485520872508, 0.3071303331385155, 0.7010743321718932, 0.0]
    Train  Label F1 [0.7717867261955869, 0.3294670846394984, 0.7948971193415637, 0]
    Train  Domain Accuracy [0.5947674973742003, 0.0, 0.40303637926095676]

    Val  Label Loss = 1861.2447700500488
    Val  Domain Loss = 1619.4608917236328
    Val  Regularization Loss = 263.1991195678711
    Val  Total Loss = 3743.9047813415527
    Val  Composite Score 2432.75
    Val  Label Accuracy [0.3512064343163539, 0.5294117647058824, 0.9391390400791687, 0.0]
    Val  Label F1 [0.4906367041198502, 0.41684210526315796, 0.8696449026345933, 0]
    Val  Domain Accuracy [0.9461746784021665, 0.0, 0.0]

    Test  Label Loss = 281694.44139671326
    Test  Domain Loss = 14008.821144104004
    Test  Regularization Loss = 2237.1925163269043
    Test  Total Loss = 297940.45505714417
    Test  Composite Score 5226.5
    Test  Label Accuracy [0.27377824487651076, 0.4131994261119082, 0.8523745519713262, 0.0]
    Test  Label F1 [0.3783587509077705, 0.3150984682713348, 0.7971925413785879, 0]
    Test  Domain Accuracy [0.9616731594066029, 0.0, 0.0]

  EPOCH 22
    Train  Label Loss = 14783.235290527344
    Train  Domain Loss = 19031.606163024902
    Train  Regularization Loss = 1844.1652507781982
    Train  Total Loss = 35659.006704330444
    Train  Composite Score 16467.5
    Train  Label Accuracy [0.8615936555891238, 0.2954414310444316, 0.7025261324041812, 0.0]
    Train  Label F1 [0.7781709656789597, 0.32364096080910243, 0.8020885131775236, 0]
    Train  Domain Accuracy [0.5910436360164232, 0.0, 0.41602215220089755]

    Val  Label Loss = 1697.8449668884277
    Val  Domain Loss = 1890.1122436523438
    Val  Regularization Loss = 264.2200183868408
    Val  Total Loss = 3852.1772289276123
    Val  Composite Score 2450.0
    Val  Label Accuracy [0.5067024128686327, 0.0, 0.9421078673923801, 0.0]
    Val  Label F1 [0.5770992366412214, 0, 0.8634920634920634, 0]
    Val  Domain Accuracy [0.9749492213947191, 0.0, 0.0]

    Test  Label Loss = 171184.24033737183
    Test  Domain Loss = 16622.30783843994
    Test  Regularization Loss = 2245.870156288147
    Test  Total Loss = 190052.4183320999
    Test  Composite Score 5369.0
    Test  Label Accuracy [0.5622700998423542, 0.01291248206599713, 0.8344534050179212, 0.0]
    Test  Label F1 [0.5211885046273745, 0.02510460251046025, 0.8006448146157981, 0]
    Test  Domain Accuracy [0.9450281352063904, 0.0, 0.0]

  EPOCH 23
    Train  Label Loss = 14689.458362579346
    Train  Domain Loss = 17977.159965515137
    Train  Regularization Loss = 1782.9514799118042
    Train  Total Loss = 34449.56980800629
    Train  Composite Score 16470.0
    Train  Label Accuracy [0.8632607062359129, 0.2870967741935484, 0.7002032520325203, 0.0]
    Train  Label F1 [0.7814333078296352, 0.31489224831135415, 0.7971900826446281, 0]
    Train  Domain Accuracy [0.6271364460994939, 0.0, 0.3743912918934403]

    Val  Label Loss = 1687.6351737976074
    Val  Domain Loss = 2071.1472206115723
    Val  Regularization Loss = 237.1329689025879
    Val  Total Loss = 3995.9153633117676
    Val  Composite Score 2446.25
    Val  Label Accuracy [0.4906166219839142, 0.31016042780748665, 0.9168728352300841, 0.0]
    Val  Label F1 [0.571875, 0.3372093023255814, 0.8650793650793651, 0]
    Val  Domain Accuracy [0.3994583615436696, 0.0, 0.0]

    Test  Label Loss = 378779.1767692566
    Test  Domain Loss = 17824.75222969055
    Test  Regularization Loss = 2015.630235671997
    Test  Total Loss = 398619.55923461914
    Test  Composite Score 5326.25
    Test  Label Accuracy [0.5559642669469259, 0.08034433285509325, 0.8138440860215054, 0.0]
    Test  Label F1 [0.5160975609756098, 0.12962962962962962, 0.7928852029681364, 0]
    Test  Domain Accuracy [0.3494668083264471, 0.0, 0.0]

  EPOCH 24
    Train  Label Loss = 14798.203506469727
    Train  Domain Loss = 19199.806564331055
    Train  Regularization Loss = 1717.5846552848816
    Train  Total Loss = 35715.59472608566
    Train  Composite Score 16479.5
    Train  Label Accuracy [0.8658673660547022, 0.2782377291543465, 0.7018002322880371, 0.0]
    Train  Label F1 [0.7816014204785661, 0.314452798663325, 0.794543063773833, 0]
    Train  Domain Accuracy [0.630096438460804, 0.0, 0.41115248734841975]

    Val  Label Loss = 1639.3845291137695
    Val  Domain Loss = 2606.1182899475098
    Val  Regularization Loss = 260.52924156188965
    Val  Total Loss = 4506.032060623169
    Val  Composite Score 2400.5
    Val  Label Accuracy [0.5026809651474531, 0.0106951871657754, 0.9099455714992578, 0.0]
    Val  Label F1 [0.552689756816507, 0.018691588785046728, 0.8480516486050265, 0]
    Val  Domain Accuracy [0.0971563981042654, 0.0, 0.0]

    Test  Label Loss = 388405.13765335083
    Test  Domain Loss = 23458.847578048706
    Test  Regularization Loss = 2214.498553276062
    Test  Total Loss = 414078.4837846756
    Test  Composite Score 5241.5
    Test  Label Accuracy [0.604834471886495, 0.03156384505021521, 0.7753136200716846, 0.0]
    Test  Label F1 [0.515565509518477, 0.058355437665782495, 0.7769671119093052, 0]
    Test  Domain Accuracy [0.04781017589422736, 0.0, 0.0]

  EPOCH 25
    Train  Label Loss = 14959.039077758789
    Train  Domain Loss = 18479.01410675049
    Train  Regularization Loss = 1799.7607145309448
    Train  Total Loss = 35237.81389904022
    Train  Composite Score 16382.0
    Train  Label Accuracy [0.8498345153664303, 0.31208728107952916, 0.6971544715447154, 0.0]
    Train  Label F1 [0.7723776374027761, 0.3378924463786136, 0.7910386294374434, 0]
    Train  Domain Accuracy [0.6125274515420606, 0.0, 0.38756803208249785]

    Val  Label Loss = 1623.0774421691895
    Val  Domain Loss = 1800.1744842529297
    Val  Regularization Loss = 248.20189476013184
    Val  Total Loss = 3671.453821182251
    Val  Composite Score 2428.25
    Val  Label Accuracy [0.6621983914209115, 0.016042780748663103, 0.8688767936665017, 0.0]
    Val  Label F1 [0.6198243412797991, 0.030303030303030304, 0.8532555879494654, 0]
    Val  Domain Accuracy [0.991198375084631, 0.0, 0.0]

    Test  Label Loss = 213174.3282775879
    Test  Domain Loss = 15620.775031089783
    Test  Regularization Loss = 2109.7161054611206
    Test  Total Loss = 230904.8194141388
    Test  Composite Score 5136.5
    Test  Label Accuracy [0.7687861271676301, 0.02582496413199426, 0.6749551971326165, 0.0]
    Test  Label F1 [0.5434621099554235, 0.049046321525885554, 0.7523096129837704, 0]
    Test  Domain Accuracy [0.9950419076850431, 0.0, 0.0]

  EPOCH 26
    Train  Label Loss = 14487.435619354248
    Train  Domain Loss = 17452.363388061523
    Train  Regularization Loss = 1635.02982711792
    Train  Total Loss = 33574.82883453369
    Train  Composite Score 16503.0
    Train  Label Accuracy [0.8719592683386762, 0.2812862108922364, 0.6984610917537747, 0.0]
    Train  Label F1 [0.783032047754117, 0.3142903382424341, 0.7973152137885317, 0]
    Train  Domain Accuracy [0.5569559820490786, 0.0, 0.472452974314905]

    Val  Label Loss = 1668.4143562316895
    Val  Domain Loss = 1516.6102199554443
    Val  Regularization Loss = 221.618070602417
    Val  Total Loss = 3406.642646789551
    Val  Composite Score 2417.75
    Val  Label Accuracy [0.710455764075067, 0.06417112299465241, 0.8396833250865908, 0.0]
    Val  Label F1 [0.620245757753072, 0.11059907834101383, 0.8523355097940735, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 303823.430021286
    Test  Domain Loss = 13385.481457233429
    Test  Regularization Loss = 1883.7536001205444
    Test  Total Loss = 319092.66507864
    Test  Composite Score 4973.75
    Test  Label Accuracy [0.8071466106148187, 0.028694404591104734, 0.6095430107526881, 0.0]
    Test  Label F1 [0.5327783558792925, 0.05434782608695651, 0.7136113296616837, 0]
    Test  Domain Accuracy [0.9984653523787038, 0.0, 0.0]

  EPOCH 27
    Train  Label Loss = 14216.728719711304
    Train  Domain Loss = 17759.322147369385
    Train  Regularization Loss = 1539.5171828269958
    Train  Total Loss = 33515.568049907684
    Train  Composite Score 16601.25
    Train  Label Accuracy [0.880037488284911, 0.29191263282172375, 0.6945412311265969, 0.0]
    Train  Label F1 [0.7886779774903411, 0.32988659106070717, 0.7937614070018251, 0]
    Train  Domain Accuracy [0.6025971545879881, 0.0, 0.43349565549508257]

    Val  Label Loss = 1604.156774520874
    Val  Domain Loss = 1880.5439186096191
    Val  Regularization Loss = 216.62030696868896
    Val  Total Loss = 3701.321000099182
    Val  Composite Score 2466.5
    Val  Label Accuracy [0.5442359249329759, 0.25133689839572193, 0.9158832261256804, 0.0]
    Val  Label F1 [0.6050670640834576, 0.2993630573248408, 0.8706491063029164, 0]
    Val  Domain Accuracy [0.9996614759647935, 0.0, 0.0]

    Test  Label Loss = 180383.21711540222
    Test  Domain Loss = 16497.44051837921
    Test  Regularization Loss = 1841.2726092338562
    Test  Total Loss = 198721.9302430153
    Test  Composite Score 5306.75
    Test  Label Accuracy [0.6016815554387809, 0.04878048780487805, 0.7934587813620072, 0.0]
    Test  Label F1 [0.5274067250115154, 0.08436724565756823, 0.7888641425389755, 0]
    Test  Domain Accuracy [0.9910675638452761, 0.0, 0.0]

  EPOCH 28
    Train  Label Loss = 14106.254056930542
    Train  Domain Loss = 17678.42018508911
    Train  Regularization Loss = 1465.1931381225586
    Train  Total Loss = 33249.86738014221
    Train  Composite Score 16702.0
    Train  Label Accuracy [0.8794379391100703, 0.3003251551877032, 0.7103658536585366, 0.0]
    Train  Label F1 [0.792136016537991, 0.335978835978836, 0.8079590488771466, 0]
    Train  Domain Accuracy [0.5910436360164232, 0.0, 0.44170724720710397]

    Val  Label Loss = 1606.6328964233398
    Val  Domain Loss = 1916.9769439697266
    Val  Regularization Loss = 201.84003353118896
    Val  Total Loss = 3725.4498739242554
    Val  Composite Score 2432.0
    Val  Label Accuracy [0.7064343163538874, 0.0481283422459893, 0.8520534388916378, 0.0]
    Val  Label F1 [0.6296296296296295, 0.08411214953271028, 0.8567164179104478, 0]
    Val  Domain Accuracy [0.979011509817197, 0.0, 0.0]

    Test  Label Loss = 192915.67567443848
    Test  Domain Loss = 16723.678111076355
    Test  Regularization Loss = 1715.6402850151062
    Test  Total Loss = 211354.99407052994
    Test  Composite Score 4960.25
    Test  Label Accuracy [0.8181818181818182, 0.027259684361549498, 0.6010304659498208, 0.0]
    Test  Label F1 [0.5343170899107755, 0.05121293800539083, 0.7099761841757078, 0]
    Test  Domain Accuracy [0.9508519261795144, 0.0, 0.0]

  EPOCH 29
    Train  Label Loss = 14285.905265808105
    Train  Domain Loss = 17797.830909729004
    Train  Regularization Loss = 1432.1835780143738
    Train  Total Loss = 33515.91975355148
    Train  Composite Score 16524.5
    Train  Label Accuracy [0.8621670300502418, 0.31148475349102306, 0.7080429732868757, 0.0]
    Train  Label F1 [0.780720202583802, 0.343171114599686, 0.8008210180623974, 0]
    Train  Domain Accuracy [0.5979184569846271, 0.0, 0.4407524109615201]

    Val  Label Loss = 1599.3997039794922
    Val  Domain Loss = 1231.345272064209
    Val  Regularization Loss = 208.94139289855957
    Val  Total Loss = 3039.6863689422607
    Val  Composite Score 2438.75
    Val  Label Accuracy [0.5884718498659517, 0.11229946524064172, 0.8941118258287977, 0.0]
    Val  Label F1 [0.5968728755948335, 0.17796610169491525, 0.8602713639609616, 0]
    Val  Domain Accuracy [0.9983073798239676, 0.0, 0.0]

    Test  Label Loss = 203917.0555486679
    Test  Domain Loss = 11301.724581718445
    Test  Regularization Loss = 1776.0018396377563
    Test  Total Loss = 216994.7819700241
    Test  Composite Score 5130.5
    Test  Label Accuracy [0.6342616920651603, 0.02582496413199426, 0.730510752688172, 0.0]
    Test  Label F1 [0.5070363369040117, 0.04793608521970706, 0.7569637883008355, 0]
    Test  Domain Accuracy [0.9977570534765671, 0.0, 0.0]
