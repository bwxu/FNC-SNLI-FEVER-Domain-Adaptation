Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
Loading CNN vectors...
SIZE_TRAIN = 94441
SIZE_VAL = 2954
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 19461.38556289673
    Train  Domain Loss = 17742.183126449585
    Train  Regularization Loss = 2495.2445249557495
    Train  Total Loss = 39698.81321430206
    Train  Composite Score 15337.5
    Train  Label Accuracy [0.8031591737545565, 0.16463233105090802, 0.6309523809523809, 0.0]
    Train  Label F1 [0.7207381002306564, 0.19697239536954586, 0.7032362459546925, 0]
    Train  Domain Accuracy [0.7957605270696075, 0.0, 0.626659027976702]

    Val  Label Loss = 1824.5701503753662
    Val  Domain Loss = 825.9063329696655
    Val  Regularization Loss = 328.0333614349365
    Val  Total Loss = 2978.5098447799683
    Val  Composite Score 2379.5
    Val  Label Accuracy [0.6394101876675603, 0.06951871657754011, 0.8401781296387927, 0.0]
    Val  Label F1 [0.5774818401937046, 0.12037037037037036, 0.8405940594059406, 0]
    Val  Domain Accuracy [0.8019634394041977, 0.0, 0.0]

    Test  Label Loss = 125585.53405666351
    Test  Domain Loss = 9062.272783279419
    Test  Regularization Loss = 2788.2835721969604
    Test  Total Loss = 137436.0904121399
    Test  Composite Score 4898.0
    Test  Label Accuracy [0.815028901734104, 0.00430416068866571, 0.5873655913978495, 0.0]
    Test  Label F1 [0.5254065040650407, 0.008426966292134831, 0.6980830670926518, 0]
    Test  Domain Accuracy [0.7515838350450557, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 19187.16167831421
    Train  Domain Loss = 40735.13049316406
    Train  Regularization Loss = 2443.4152040481567
    Train  Total Loss = 62365.70737552643
    Train  Composite Score 15291.25
    Train  Label Accuracy [0.7793758225230306, 0.22807017543859648, 0.6334204413472706, 0.0]
    Train  Label F1 [0.712989637528486, 0.25036109773712084, 0.7082217352487623, 0]
    Train  Domain Accuracy [0.6335338489449059, 0.0, 0.45163754416117635]

    Val  Label Loss = 1775.1641998291016
    Val  Domain Loss = 1599.8602142333984
    Val  Regularization Loss = 315.3456115722656
    Val  Total Loss = 3690.3700256347656
    Val  Composite Score 2376.5
    Val  Label Accuracy [0.6943699731903485, 0.026737967914438502, 0.8218703612073232, 0.0]
    Val  Label F1 [0.593016599885518, 0.04975124378109453, 0.838888888888889, 0]
    Val  Domain Accuracy [0.6215301286391334, 0.0, 0.0]

    Test  Label Loss = 173741.6620388031
    Test  Domain Loss = 16048.663999557495
    Test  Regularization Loss = 2680.437698364258
    Test  Total Loss = 192470.76373672485
    Test  Composite Score 4977.5
    Test  Label Accuracy [0.8418286915396742, 0.0028694404591104736, 0.599910394265233, 0.0]
    Test  Label F1 [0.5408507765023634, 0.005706134094151213, 0.713847794215647, 0]
    Test  Domain Accuracy [0.5090308110022429, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 19863.4870262146
    Train  Domain Loss = 36090.05634307861
    Train  Regularization Loss = 2216.46990776062
    Train  Total Loss = 58170.01327705383
    Train  Composite Score 15163.0
    Train  Label Accuracy [0.7790840997440031, 0.23241241811449728, 0.615418118466899, 0.0]
    Train  Label F1 [0.7115209767502273, 0.2525533890436397, 0.6936104066104885, 0]
    Train  Domain Accuracy [0.5805404373150005, 0.0, 0.426716318151437]

    Val  Label Loss = 1746.394687652588
    Val  Domain Loss = 8846.358093261719
    Val  Regularization Loss = 312.7356433868408
    Val  Total Loss = 10905.488424301147
    Val  Composite Score 2422.25
    Val  Label Accuracy [0.6032171581769437, 0.0, 0.8881741712023751, 0.0]
    Val  Label F1 [0.5921052631578947, 0, 0.8545584384670316, 0]
    Val  Domain Accuracy [0.0, 0.0, 0.0]

    Test  Label Loss = 161216.55507659912
    Test  Domain Loss = 77526.10934448242
    Test  Regularization Loss = 2658.252968788147
    Test  Total Loss = 241400.9173898697
    Test  Composite Score 5129.75
    Test  Label Accuracy [0.7761429322122964, 0.0, 0.6738351254480287, 0.0]
    Test  Label F1 [0.5465309898242368, 0, 0.7495639172688762, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 19275.594135284424
    Train  Domain Loss = 27486.533367156982
    Train  Regularization Loss = 2167.1954679489136
    Train  Total Loss = 48929.32297039032
    Train  Composite Score 15291.5
    Train  Label Accuracy [0.7786367493164891, 0.2535496957403651, 0.6245644599303136, 0.0]
    Train  Label F1 [0.7159947984395317, 0.266727632982777, 0.7068101536186643, 0]
    Train  Domain Accuracy [0.5293612145517044, 0.0, 0.4577484961329132]

    Val  Label Loss = 1796.7377433776855
    Val  Domain Loss = 2625.610912322998
    Val  Regularization Loss = 292.3777198791504
    Val  Total Loss = 4714.726375579834
    Val  Composite Score 2397.5
    Val  Label Accuracy [0.6957104557640751, 0.0, 0.8377041068777833, 0.0]
    Val  Label F1 [0.6017391304347827, 0, 0.8473473473473473, 0]
    Val  Domain Accuracy [0.08970886932972241, 0.0, 0.0]

    Test  Label Loss = 212370.23962783813
    Test  Domain Loss = 23401.744000434875
    Test  Regularization Loss = 2485.2106189727783
    Test  Total Loss = 238257.1942472458
    Test  Composite Score 4969.25
    Test  Label Accuracy [0.8549658434051498, 0.0, 0.5922939068100358, 0.0]
    Test  Label F1 [0.5443292070926732, 0, 0.7095129478062524, 0]
    Test  Domain Accuracy [0.04293078345728564, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 18967.568031311035
    Train  Domain Loss = 31863.750576019287
    Train  Regularization Loss = 1991.8985319137573
    Train  Total Loss = 52823.21713924408
    Train  Composite Score 15497.25
    Train  Label Accuracy [0.7998116760828625, 0.24461896451425247, 0.6369047619047619, 0.0]
    Train  Label F1 [0.7295683916684561, 0.26400878982891224, 0.7243457442417237, 0]
    Train  Domain Accuracy [0.5426334383653203, 0.0, 0.44285305070180464]

    Val  Label Loss = 1981.5129013061523
    Val  Domain Loss = 2602.5390663146973
    Val  Regularization Loss = 280.1652145385742
    Val  Total Loss = 4864.217182159424
    Val  Composite Score 2368.25
    Val  Label Accuracy [0.5576407506702413, 0.5935828877005348, 0.8144482929242949, 0.0]
    Val  Label F1 [0.5951359084406295, 0.376271186440678, 0.8397959183673469, 0]
    Val  Domain Accuracy [0.001015572105619499, 0.0, 0.0]

    Test  Label Loss = 162803.44675922394
    Test  Domain Loss = 22669.803608894348
    Test  Regularization Loss = 2381.404323577881
    Test  Total Loss = 187854.65469169617
    Test  Composite Score 4751.75
    Test  Label Accuracy [0.7220178665265371, 0.23529411764705882, 0.5472670250896058, 0.0]
    Test  Label F1 [0.5356725146198831, 0.18406285072951736, 0.6771064301552107, 0]
    Test  Domain Accuracy [0.0015739975603037816, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 19186.836227416992
    Train  Domain Loss = 35522.484375
    Train  Regularization Loss = 2060.9110288619995
    Train  Total Loss = 56770.23163127899
    Train  Composite Score 15426.25
    Train  Label Accuracy [0.7974206909535912, 0.2480349344978166, 0.6245644599303136, 0.0]
    Train  Label F1 [0.725660684456247, 0.26616682286785376, 0.7153903716637565, 0]
    Train  Domain Accuracy [0.5481714885897069, 0.0, 0.4131576434641459]

    Val  Label Loss = 1774.2755088806152
    Val  Domain Loss = 13561.238525390625
    Val  Regularization Loss = 322.70968437194824
    Val  Total Loss = 15658.223718643188
    Val  Composite Score 2432.75
    Val  Label Accuracy [0.435656836461126, 0.19786096256684493, 0.9386442355269669, 0.0]
    Val  Label F1 [0.5358615004122013, 0.26714801444043323, 0.8587596197374378, 0]
    Val  Domain Accuracy [0.0, 0.0, 0.0]

    Test  Label Loss = 245153.70867156982
    Test  Domain Loss = 106170.38139343262
    Test  Regularization Loss = 2743.03231716156
    Test  Total Loss = 354067.122382164
    Test  Composite Score 5315.0
    Test  Label Accuracy [0.4997372569626905, 0.058823529411764705, 0.8378136200716846, 0.0]
    Test  Label F1 [0.48869475847893123, 0.09820359281437126, 0.7956600361663653, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 22425.074291229248
    Train  Domain Loss = 21075.27638244629
    Train  Regularization Loss = 2155.5865268707275
    Train  Total Loss = 45655.937200546265
    Train  Composite Score 15176.5
    Train  Label Accuracy [0.7639939485627837, 0.2576105686387134, 0.6263066202090593, 0.0]
    Train  Label F1 [0.7094564931073842, 0.2640176600441501, 0.7068654759954122, 0]
    Train  Domain Accuracy [0.5655495082593335, 0.0, 0.4497278716700086]

    Val  Label Loss = 1656.1574668884277
    Val  Domain Loss = 3971.801559448242
    Val  Regularization Loss = 266.779146194458
    Val  Total Loss = 5894.738172531128
    Val  Composite Score 2412.5
    Val  Label Accuracy [0.6916890080428955, 0.016042780748663103, 0.8476001979218208, 0.0]
    Val  Label F1 [0.6113744075829384, 0.03076923076923077, 0.8511801242236025, 0]
    Val  Domain Accuracy [0.0, 0.0, 0.0]

    Test  Label Loss = 167365.02043533325
    Test  Domain Loss = 34297.71401977539
    Test  Regularization Loss = 2267.622742652893
    Test  Total Loss = 203930.35719776154
    Test  Composite Score 5028.0
    Test  Label Accuracy [0.8491854965843405, 0.0028694404591104736, 0.6117831541218638, 0.0]
    Test  Label F1 [0.5503150008513537, 0.005706134094151213, 0.7230606301297327, 0]
    Test  Domain Accuracy [0.0003934993900759454, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 17001.443548202515
    Train  Domain Loss = 20870.086875915527
    Train  Regularization Loss = 1905.171498298645
    Train  Total Loss = 39776.70192241669
    Train  Composite Score 15881.0
    Train  Label Accuracy [0.8158688277421786, 0.2626233313987232, 0.6761033681765389, 0.0]
    Train  Label F1 [0.7449023487911898, 0.2880330999363463, 0.7584690553745929, 0]
    Train  Domain Accuracy [0.5594385562875966, 0.0, 0.4423756325790127]

    Val  Label Loss = 1678.8768711090088
    Val  Domain Loss = 3725.5353088378906
    Val  Regularization Loss = 259.7050952911377
    Val  Total Loss = 5664.117275238037
    Val  Composite Score 2412.5
    Val  Label Accuracy [0.7265415549597856, 0.0106951871657754, 0.8352300841167739, 0.0]
    Val  Label F1 [0.6258660508083141, 0.02072538860103627, 0.8476023098167211, 0]
    Val  Domain Accuracy [0.007786052809749492, 0.0, 0.0]

    Test  Label Loss = 603852.8367652893
    Test  Domain Loss = 31197.473140716553
    Test  Regularization Loss = 2207.4933099746704
    Test  Total Loss = 637257.8032159805
    Test  Composite Score 4939.25
    Test  Label Accuracy [0.8481345244351025, 0.005738880918220947, 0.5853494623655914, 0.0]
    Test  Label F1 [0.5395286645495571, 0.011315417256011316, 0.7026082280182844, 0]
    Test  Domain Accuracy [0.005036792192972101, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 16306.942779541016
    Train  Domain Loss = 19863.70902633667
    Train  Regularization Loss = 1847.4905366897583
    Train  Total Loss = 38018.142342567444
    Train  Composite Score 15986.5
    Train  Label Accuracy [0.8296491393095664, 0.26466297052815874, 0.6729094076655052, 0.0]
    Train  Label F1 [0.7552016439763679, 0.2872525732383215, 0.7640319789005192, 0]
    Train  Domain Accuracy [0.5568604984245202, 0.0, 0.42480664566026927]

    Val  Label Loss = 1578.0924530029297
    Val  Domain Loss = 1940.0668182373047
    Val  Regularization Loss = 261.25648498535156
    Val  Total Loss = 3779.415756225586
    Val  Composite Score 2424.5
    Val  Label Accuracy [0.6152815013404825, 0.08021390374331551, 0.8777832756061356, 0.0]
    Val  Label F1 [0.6, 0.136986301369863, 0.8530896850204376, 0]
    Val  Domain Accuracy [0.7301963439404198, 0.0, 0.0]

    Test  Label Loss = 274705.09302711487
    Test  Domain Loss = 16995.324427604675
    Test  Regularization Loss = 2220.6801223754883
    Test  Total Loss = 293921.09757709503
    Test  Composite Score 5157.5
    Test  Label Accuracy [0.7582764056752496, 0.018651362984218076, 0.6868279569892473, 0.0]
    Test  Label F1 [0.5469016486640136, 0.03586206896551724, 0.7546148166379522, 0]
    Test  Domain Accuracy [0.6811474442214615, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 16498.883502960205
    Train  Domain Loss = 18911.176029205322
    Train  Regularization Loss = 1761.8196473121643
    Train  Total Loss = 37171.87917947769
    Train  Composite Score 16069.25
    Train  Label Accuracy [0.8279913525707303, 0.28517110266159695, 0.6798780487804879, 0.0]
    Train  Label F1 [0.7569820400446852, 0.3033602986932172, 0.7727722772277229, 0]
    Train  Domain Accuracy [0.5803494700658837, 0.0, 0.4277666380215793]

    Val  Label Loss = 1805.9267864227295
    Val  Domain Loss = 1982.3466987609863
    Val  Regularization Loss = 237.63121604919434
    Val  Total Loss = 4025.90470123291
    Val  Composite Score 2432.0
    Val  Label Accuracy [0.3914209115281501, 0.22994652406417113, 0.9515091538842158, 0.0]
    Val  Label F1 [0.5242369838420107, 0.26959247648902823, 0.859441340782123, 0]
    Val  Domain Accuracy [0.6415030467163169, 0.0, 0.0]

    Test  Label Loss = 393468.232585907
    Test  Domain Loss = 17414.296138763428
    Test  Regularization Loss = 2019.8653364181519
    Test  Total Loss = 412902.39406108856
    Test  Composite Score 5284.25
    Test  Label Accuracy [0.34839726747241195, 0.09325681492109039, 0.8877688172043011, 0.0]
    Test  Label F1 [0.41645728643216084, 0.13993541442411195, 0.7914128806789815, 0]
    Test  Domain Accuracy [0.5284303309329871, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 16196.64637374878
    Train  Domain Loss = 18732.798095703125
    Train  Regularization Loss = 1701.070517539978
    Train  Total Loss = 36630.51498699188
    Train  Composite Score 16203.25
    Train  Label Accuracy [0.8491661982387109, 0.2609338061465721, 0.6822009291521487, 0.0]
    Train  Label F1 [0.7674202015070697, 0.29492317969271875, 0.7696339366145278, 0]
    Train  Domain Accuracy [0.59419459562685, 0.0, 0.4324453356249403]

    Val  Label Loss = 1704.621259689331
    Val  Domain Loss = 2182.591667175293
    Val  Regularization Loss = 241.26279830932617
    Val  Total Loss = 4128.47572517395
    Val  Composite Score 2404.25
    Val  Label Accuracy [0.7225201072386059, 0.11764705882352941, 0.8213755566551212, 0.0]
    Val  Label F1 [0.6245654692931635, 0.17813765182186236, 0.8437102922490471, 0]
    Val  Domain Accuracy [0.25050778605280977, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 124087.9170703888
    Test  Domain Loss = 19281.987327575684
    Test  Regularization Loss = 2050.7337856292725
    Test  Total Loss = 145420.63818359375
    Test  Composite Score 4856.0
    Test  Label Accuracy [0.8476090383604834, 0.028694404591104734, 0.5571236559139785, 0.0]
    Test  Label F1 [0.5302432610124918, 0.052770448548812667, 0.6826791106231129, 0]
    Test  Domain Accuracy [0.15153661511824656, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 15314.222270965576
    Train  Domain Loss = 18414.56467437744
    Train  Regularization Loss = 1696.2832279205322
    Train  Total Loss = 35425.07017326355
    Train  Composite Score 16287.75
    Train  Label Accuracy [0.8486649683932447, 0.29141370338248046, 0.6894599303135889, 0.0]
    Train  Label F1 [0.769493990333205, 0.32025416997617157, 0.7806361469548779, 0]
    Train  Domain Accuracy [0.5948629809987587, 0.0, 0.4303446958846558]

    Val  Label Loss = 1722.9552421569824
    Val  Domain Loss = 2013.8866653442383
    Val  Regularization Loss = 233.36983680725098
    Val  Total Loss = 3970.2117443084717
    Val  Composite Score 2441.0
    Val  Label Accuracy [0.45308310991957107, 0.0106951871657754, 0.9549727857496288, 0.0]
    Val  Label F1 [0.5531914893617021, 0.020942408376963352, 0.8587319243604004, 0]
    Val  Domain Accuracy [0.9346648612051456, 0.0, 0.0]

    Test  Label Loss = 598731.6830310822
    Test  Domain Loss = 17522.372814178467
    Test  Regularization Loss = 1983.6436128616333
    Test  Total Loss = 618237.6994581223
    Test  Composite Score 5299.25
    Test  Label Accuracy [0.45401996847083553, 0.011477761836441894, 0.8599910394265233, 0.0]
    Test  Label F1 [0.46639676113360323, 0.0223463687150838, 0.7909755846296487, 0]
    Test  Domain Accuracy [0.8681777043245583, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 16725.461265563965
    Train  Domain Loss = 18944.85649871826
    Train  Regularization Loss = 1885.6991386413574
    Train  Total Loss = 37556.016902923584
    Train  Composite Score 15898.5
    Train  Label Accuracy [0.8231362951807228, 0.27606290040768783, 0.6614401858304297, 0.0]
    Train  Label F1 [0.7511918567194948, 0.30138292799237004, 0.7457238726573369, 0]
    Train  Domain Accuracy [0.613864222285878, 0.0, 0.4119163563448868]

    Val  Label Loss = 1683.5034885406494
    Val  Domain Loss = 2266.991569519043
    Val  Regularization Loss = 277.67578125
    Val  Total Loss = 4228.170839309692
    Val  Composite Score 2426.75
    Val  Label Accuracy [0.4544235924932976, 0.016042780748663103, 0.9445818901533894, 0.0]
    Val  Label F1 [0.5498783454987836, 0.02870813397129187, 0.8549037169726825, 0]
    Val  Domain Accuracy [0.0, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 1004077.4959163666
    Test  Domain Loss = 19335.831661224365
    Test  Regularization Loss = 2360.244140625
    Test  Total Loss = 1025773.571718216
    Test  Composite Score 5317.25
    Test  Label Accuracy [0.4571728849185497, 0.024390243902439025, 0.8620071684587813, 0.0]
    Test  Label F1 [0.46698872785829315, 0.04625850340136055, 0.7961104789490018, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 15309.403060913086
    Train  Domain Loss = 17616.057399749756
    Train  Regularization Loss = 1812.6648979187012
    Train  Total Loss = 34738.12535858154
    Train  Composite Score 16309.5
    Train  Label Accuracy [0.8512474207465767, 0.28239104829210837, 0.6877177700348432, 0.0]
    Train  Label F1 [0.7701315231226137, 0.31126257708536187, 0.7806526038233355, 0]
    Train  Domain Accuracy [0.5742385180941468, 0.0, 0.4475317483051657]

    Val  Label Loss = 1593.1360893249512
    Val  Domain Loss = 1915.0016555786133
    Val  Regularization Loss = 245.10191917419434
    Val  Total Loss = 3753.239664077759
    Val  Composite Score 2446.25
    Val  Label Accuracy [0.6353887399463807, 0.0053475935828877, 0.8916378030677882, 0.0]
    Val  Label F1 [0.6183953033268101, 0.010582010582010581, 0.860965121834687, 0]
    Val  Domain Accuracy [0.7711577522004063, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 638838.9955253601
    Test  Domain Loss = 16895.088019371033
    Test  Regularization Loss = 2083.366312980652
    Test  Total Loss = 657817.4498577118
    Test  Composite Score 5272.25
    Test  Label Accuracy [0.7125591171833946, 0.014347202295552367, 0.741263440860215, 0.0]
    Test  Label F1 [0.550436371016846, 0.028011204481792715, 0.7797808412866738, 0]
    Test  Domain Accuracy [0.7578011254082556, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 15250.890842437744
    Train  Domain Loss = 17749.979610443115
    Train  Regularization Loss = 1813.8017196655273
    Train  Total Loss = 34814.67217254639
    Train  Composite Score 16333.0
    Train  Label Accuracy [0.8588013213780085, 0.2650880739243431, 0.6962833914053427, 0.0]
    Train  Label F1 [0.7715266884300674, 0.30640854472630175, 0.7823817292006525, 0]
    Train  Domain Accuracy [0.5816862408097011, 0.0, 0.4494414207963334]

    Val  Label Loss = 1595.4209289550781
    Val  Domain Loss = 2258.5782585144043
    Val  Regularization Loss = 247.24019050598145
    Val  Total Loss = 4101.239377975464
    Val  Composite Score 2453.75
    Val  Label Accuracy [0.5697050938337802, 0.19786096256684493, 0.9030183077684315, 0.0]
    Val  Label F1 [0.604551920341394, 0.27819548872180455, 0.8616619452313503, 0]
    Val  Domain Accuracy [0.03046716316858497, 0.0, 0.0]

    Test  Label Loss = 770128.5266189575
    Test  Domain Loss = 19237.76117324829
    Test  Regularization Loss = 2101.5416193008423
    Test  Total Loss = 791467.8294115067
    Test  Composite Score 5283.5
    Test  Label Accuracy [0.6200735680504467, 0.02582496413199426, 0.782258064516129, 0.0]
    Test  Label F1 [0.5245610135585685, 0.04838709677419355, 0.7860438942037141, 0]
    Test  Domain Accuracy [0.046078778577893206, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 15087.595600128174
    Train  Domain Loss = 18222.380378723145
    Train  Regularization Loss = 1699.1811437606812
    Train  Total Loss = 35009.157122612
    Train  Composite Score 16328.0
    Train  Label Accuracy [0.8584673604541154, 0.2864105504587156, 0.6868466898954704, 0.0]
    Train  Label F1 [0.7711068621202464, 0.3229873908826383, 0.7803711340206185, 0]
    Train  Domain Accuracy [0.5963907189916929, 0.0, 0.43865177122123555]

    Val  Label Loss = 1595.5346565246582
    Val  Domain Loss = 2305.730724334717
    Val  Regularization Loss = 252.1688175201416
    Val  Total Loss = 4153.434198379517
    Val  Composite Score 2435.0
    Val  Label Accuracy [0.6380697050938338, 0.0106951871657754, 0.8827313211281543, 0.0]
    Val  Label F1 [0.6169799092676604, 0.020942408376963352, 0.8548155246765692, 0]
    Val  Domain Accuracy [0.36831415030467163, 0.0, 0.0]

    Test  Label Loss = 244746.7154045105
    Test  Domain Loss = 20171.40299129486
    Test  Regularization Loss = 2143.4349489212036
    Test  Total Loss = 267061.55334472656
    Test  Composite Score 5090.0
    Test  Label Accuracy [0.6778770362585391, 0.00860832137733142, 0.7025089605734767, 0.0]
    Test  Label F1 [0.5139442231075697, 0.01694915254237288, 0.7466666666666666, 0]
    Test  Domain Accuracy [0.3191673552905993, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 14924.076084136963
    Train  Domain Loss = 18583.967811584473
    Train  Regularization Loss = 1742.3157625198364
    Train  Total Loss = 35250.35965824127
    Train  Composite Score 16487.75
    Train  Label Accuracy [0.8600113657889752, 0.3057142857142857, 0.7063008130081301, 0.0]
    Train  Label F1 [0.7778301280678459, 0.3411989795918367, 0.7953895201504129, 0]
    Train  Domain Accuracy [0.5853146185429199, 0.0, 0.41029313472739426]

    Val  Label Loss = 1557.3931465148926
    Val  Domain Loss = 1945.6971130371094
    Val  Regularization Loss = 241.14386558532715
    Val  Total Loss = 3744.234125137329
    Val  Composite Score 2462.75
    Val  Label Accuracy [0.5442359249329759, 0.34759358288770054, 0.9045027214250371, 0.0]
    Val  Label F1 [0.6055182699478002, 0.38235294117647056, 0.8649160160870594, 0]
    Val  Domain Accuracy [0.8571428571428571, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 231864.09238624573
    Test  Domain Loss = 16883.797189712524
    Test  Regularization Loss = 2049.7228574752808
    Test  Total Loss = 250797.61243343353
    Test  Composite Score 5237.0
    Test  Label Accuracy [0.5827640567524961, 0.08177905308464849, 0.7755376344086021, 0.0]
    Test  Label F1 [0.5077838827838828, 0.1325581395348837, 0.7779775280898876, 0]
    Test  Domain Accuracy [0.8688466532876874, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 14442.584617614746
    Train  Domain Loss = 17636.334396362305
    Train  Regularization Loss = 1611.2719531059265
    Train  Total Loss = 33690.19096708298
    Train  Composite Score 16602.25
    Train  Label Accuracy [0.8728797587636637, 0.2988972721996518, 0.7067363530778165, 0.0]
    Train  Label F1 [0.7846342806319089, 0.3366563163915673, 0.8018448361060779, 0]
    Train  Domain Accuracy [0.584359782297336, 0.0, 0.4374104841019765]

    Val  Label Loss = 1566.515769958496
    Val  Domain Loss = 1824.8688468933105
    Val  Regularization Loss = 219.80432510375977
    Val  Total Loss = 3611.1889419555664
    Val  Composite Score 2462.0
    Val  Label Accuracy [0.5482573726541555, 0.0213903743315508, 0.9327065809005443, 0.0]
    Val  Label F1 [0.5966447848285923, 0.04, 0.8692644685266313, 0]
    Val  Domain Accuracy [0.8327691266079892, 0.0, 0.0]

    Test  Label Loss = 145377.10878753662
    Test  Domain Loss = 16359.410161972046
    Test  Regularization Loss = 1868.336763381958
    Test  Total Loss = 163604.85571289062
    Test  Composite Score 5278.25
    Test  Label Accuracy [0.5423016290068313, 0.01721664275466284, 0.8151881720430108, 0.0]
    Test  Label F1 [0.5018234865061999, 0.03337969401947149, 0.7829173838209982, 0]
    Test  Domain Accuracy [0.7831424861291465, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 14441.416069030762
    Train  Domain Loss = 17772.29898071289
    Train  Regularization Loss = 1495.2307267189026
    Train  Total Loss = 33708.945776462555
    Train  Composite Score 16535.75
    Train  Label Accuracy [0.8733138383171399, 0.3017066820943014, 0.6925087108013938, 0.0]
    Train  Label F1 [0.7844765495911536, 0.3354776455451914, 0.7913728743260058, 0]
    Train  Domain Accuracy [0.5821636589324931, 0.0, 0.44447627231929726]

    Val  Label Loss = 1532.472568511963
    Val  Domain Loss = 2098.620407104492
    Val  Regularization Loss = 208.28038215637207
    Val  Total Loss = 3839.373357772827
    Val  Composite Score 2453.0
    Val  Label Accuracy [0.7064343163538874, 0.06951871657754011, 0.863928748144483, 0.0]
    Val  Label F1 [0.636858006042296, 0.12380952380952381, 0.8637150630719763, 0]
    Val  Domain Accuracy [0.45700744752877454, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 206741.35375976562
    Test  Domain Loss = 17995.7265996933
    Test  Regularization Loss = 1770.3832483291626
    Test  Total Loss = 226507.4636077881
    Test  Composite Score 5063.0
    Test  Label Accuracy [0.7945349448239621, 0.020086083213773313, 0.642921146953405, 0.0]
    Test  Label F1 [0.5428109854604201, 0.03835616438356164, 0.7333588859077551, 0]
    Test  Domain Accuracy [0.42871758548774247, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 14233.44045639038
    Train  Domain Loss = 17789.105422973633
    Train  Regularization Loss = 1433.695158958435
    Train  Total Loss = 33456.24103832245
    Train  Composite Score 16572.25
    Train  Label Accuracy [0.8758915834522111, 0.30877787186000566, 0.6990418118466899, 0.0]
    Train  Label F1 [0.7841634738186463, 0.34445843828715367, 0.8000997008973081, 0]
    Train  Domain Accuracy [0.5583882364174544, 0.0, 0.46309557910818294]

    Val  Label Loss = 1594.816749572754
    Val  Domain Loss = 2127.0499877929688
    Val  Regularization Loss = 201.26471042633057
    Val  Total Loss = 3923.131447792053
    Val  Composite Score 2463.5
    Val  Label Accuracy [0.7091152815013405, 0.28342245989304815, 0.8500742206828302, 0.0]
    Val  Label F1 [0.6547029702970297, 0.34527687296416937, 0.8622333751568381, 0]
    Val  Domain Accuracy [0.25321597833446174, 0.0, 0.0]

    Test  Label Loss = 153266.20173168182
    Test  Domain Loss = 18641.510692596436
    Test  Regularization Loss = 1710.7500386238098
    Test  Total Loss = 173618.46246290207
    Test  Composite Score 5021.75
    Test  Label Accuracy [0.8060956384655806, 0.043041606886657105, 0.6220878136200717, 0.0]
    Test  Label F1 [0.5434898139946855, 0.07662835249042146, 0.7212987012987013, 0]
    Test  Domain Accuracy [0.14559477432809978, 0.0, 0.0]

  EPOCH 20
    Train  Label Loss = 14665.85934638977
    Train  Domain Loss = 18028.26279449463
    Train  Regularization Loss = 1422.033359527588
    Train  Total Loss = 34116.15550041199
    Train  Composite Score 16529.75
    Train  Label Accuracy [0.8723001136794241, 0.3026841804683038, 0.6978803716608595, 0.0]
    Train  Label F1 [0.7846612697060076, 0.3394172270252962, 0.7929726162982514, 0]
    Train  Domain Accuracy [0.5676501479996181, 0.0, 0.4581304306311468]

    Val  Label Loss = 1575.1431159973145
    Val  Domain Loss = 1843.0066223144531
    Val  Regularization Loss = 210.33804416656494
    Val  Total Loss = 3628.4877824783325
    Val  Composite Score 2442.5
    Val  Label Accuracy [0.6595174262734584, 0.08021390374331551, 0.8733300346363186, 0.0]
    Val  Label F1 [0.6323907455012853, 0.12820512820512822, 0.8572122389509471, 0]
    Val  Domain Accuracy [0.9353419092755586, 0.0, 0.0]

    Test  Label Loss = 342127.28125190735
    Test  Domain Loss = 16166.499897003174
    Test  Regularization Loss = 1787.873375415802
    Test  Total Loss = 360081.6545243263
    Test  Composite Score 5108.75
    Test  Label Accuracy [0.7703625853914872, 0.03156384505021521, 0.6650985663082437, 0.0]
    Test  Label F1 [0.5441722345953972, 0.059219380888290714, 0.742528448168063, 0]
    Test  Domain Accuracy [0.9305473576515957, 0.0, 0.0]

  EPOCH 21
    Train  Label Loss = 14143.861907958984
    Train  Domain Loss = 17906.3681640625
    Train  Regularization Loss = 1445.7918467521667
    Train  Total Loss = 33496.02191877365
    Train  Composite Score 16611.25
    Train  Label Accuracy [0.8784317412561113, 0.2869666861484512, 0.7045586527293844, 0.0]
    Train  Label F1 [0.78853863358231, 0.32403893746906454, 0.802215059095793, 0]
    Train  Domain Accuracy [0.5795856010694166, 0.0, 0.4374104841019765]

    Val  Label Loss = 1582.7428436279297
    Val  Domain Loss = 1996.157844543457
    Val  Regularization Loss = 201.34188652038574
    Val  Total Loss = 3780.2425746917725
    Val  Composite Score 2426.75
    Val  Label Accuracy [0.49865951742627346, 0.20320855614973263, 0.9109351806036615, 0.0]
    Val  Label F1 [0.5754060324825987, 0.24755700325732902, 0.8546889507892295, 0]
    Val  Domain Accuracy [0.4962762356127285, 0.0, 0.0]

    Test  Label Loss = 131694.57474899292
    Test  Domain Loss = 17552.348613739014
    Test  Regularization Loss = 1711.4060354232788
    Test  Total Loss = 150958.3293981552
    Test  Composite Score 5270.0
    Test  Label Accuracy [0.5675249605885444, 0.09182209469153516, 0.7903225806451613, 0.0]
    Test  Label F1 [0.5097946660372905, 0.1490104772991851, 0.7812223206377324, 0]
    Test  Domain Accuracy [0.38374060520206194, 0.0, 0.0]

  EPOCH 22
    Train  Label Loss = 14137.465017318726
    Train  Domain Loss = 17492.792064666748
    Train  Regularization Loss = 1363.396427154541
    Train  Total Loss = 32993.653509140015
    Train  Composite Score 16654.75
    Train  Label Accuracy [0.8788708459214502, 0.2911136757068667, 0.7131242740998839, 0.0]
    Train  Label F1 [0.7884305920216821, 0.3304404781398395, 0.8082935659042291, 0]
    Train  Domain Accuracy [0.5839778477991024, 0.0, 0.44361691969827177]

    Val  Label Loss = 1621.4568519592285
    Val  Domain Loss = 2189.692222595215
    Val  Regularization Loss = 188.37656021118164
    Val  Total Loss = 3999.525634765625
    Val  Composite Score 2430.5
    Val  Label Accuracy [0.7359249329758714, 0.06951871657754011, 0.8381989114299851, 0.0]
    Val  Label F1 [0.6485528647371529, 0.11607142857142858, 0.848910047607116, 0]
    Val  Domain Accuracy [0.22850372376438727, 0.0, 0.0]

    Test  Label Loss = 179045.67019939423
    Test  Domain Loss = 19299.739508628845
    Test  Regularization Loss = 1601.200761795044
    Test  Total Loss = 199946.61046981812
    Test  Composite Score 4974.5
    Test  Label Accuracy [0.8176563321071991, 0.020086083213773313, 0.6066308243727598, 0.0]
    Test  Label F1 [0.5369220151828847, 0.03814713896457765, 0.7128191629376152, 0]
    Test  Domain Accuracy [0.14433557627985677, 0.0, 0.0]

  EPOCH 23
    Train  Label Loss = 14169.340492248535
    Train  Domain Loss = 17782.725288391113
    Train  Regularization Loss = 1325.251895904541
    Train  Total Loss = 33277.31767654419
    Train  Composite Score 16705.5
    Train  Label Accuracy [0.8795078888054094, 0.30703812316715545, 0.7097851335656213, 0.0]
    Train  Label F1 [0.7924687962767083, 0.34634469070459806, 0.8025279054497702, 0]
    Train  Domain Accuracy [0.5957223336197842, 0.0, 0.43721951685285976]

    Val  Label Loss = 1637.9235935211182
    Val  Domain Loss = 2186.8673553466797
    Val  Regularization Loss = 191.98771476745605
    Val  Total Loss = 4016.778663635254
    Val  Composite Score 2426.75
    Val  Label Accuracy [0.4906166219839142, 0.21390374331550802, 0.912914398812469, 0.0]
    Val  Label F1 [0.571875, 0.2366863905325444, 0.8601398601398601, 0]
    Val  Domain Accuracy [0.2166553825321598, 0.0, 0.0]

    Test  Label Loss = 177762.28503894806
    Test  Domain Loss = 19077.32795906067
    Test  Regularization Loss = 1631.8955755233765
    Test  Total Loss = 198471.5085735321
    Test  Composite Score 5243.0
    Test  Label Accuracy [0.5312664214398318, 0.17073170731707318, 0.785394265232975, 0.0]
    Test  Label F1 [0.5093198992443325, 0.21268990169794463, 0.7757495298152451, 0]
    Test  Domain Accuracy [0.10758273324676347, 0.0, 0.0]

  EPOCH 24
    Train  Label Loss = 13779.750659942627
    Train  Domain Loss = 17526.34419631958
    Train  Regularization Loss = 1309.677170753479
    Train  Total Loss = 32615.772027015686
    Train  Composite Score 16834.5
    Train  Label Accuracy [0.8844136380666916, 0.3270254287403903, 0.7141405342624855, 0.0]
    Train  Label F1 [0.7991198002623672, 0.36208872155835653, 0.8101787037799555, 0]
    Train  Domain Accuracy [0.5662178936312422, 0.0, 0.4614723574906903]

    Val  Label Loss = 1584.8528633117676
    Val  Domain Loss = 1856.833740234375
    Val  Regularization Loss = 183.94988536834717
    Val  Total Loss = 3625.6364889144897
    Val  Composite Score 2441.75
    Val  Label Accuracy [0.599195710455764, 0.15508021390374332, 0.8881741712023751, 0.0]
    Val  Label F1 [0.6186851211072665, 0.20422535211267606, 0.8590571907154821, 0]
    Val  Domain Accuracy [0.6838185511171293, 0.0, 0.0]

    Test  Label Loss = 133105.6273908615
    Test  Domain Loss = 16480.685903549194
    Test  Regularization Loss = 1563.574025630951
    Test  Total Loss = 151149.88732004166
    Test  Composite Score 5146.25
    Test  Label Accuracy [0.6841828691539674, 0.05308464849354376, 0.7096774193548387, 0.0]
    Test  Label F1 [0.5360230547550432, 0.08862275449101796, 0.751155898043865, 0]
    Test  Domain Accuracy [0.721559831582261, 0.0, 0.0]

  EPOCH 25
    Train  Label Loss = 13968.22241973877
    Train  Domain Loss = 17829.524810791016
    Train  Regularization Loss = 1286.8837661743164
    Train  Total Loss = 33084.6309967041
    Train  Composite Score 16664.75
    Train  Label Accuracy [0.8789598108747045, 0.32184898076370944, 0.7012195121951219, 0.0]
    Train  Label F1 [0.7889487756227984, 0.35860524632117724, 0.8015267175572519, 0]
    Train  Domain Accuracy [0.5807314045641172, 0.0, 0.4439988541965053]

    Val  Label Loss = 1617.0442352294922
    Val  Domain Loss = 2232.346954345703
    Val  Regularization Loss = 184.5014476776123
    Val  Total Loss = 4033.8926372528076
    Val  Composite Score 2433.5
    Val  Label Accuracy [0.7211796246648794, 0.16042780748663102, 0.8372093023255814, 0.0]
    Val  Label F1 [0.6359338061465721, 0.24390243902439027, 0.8523929471032745, 0]
    Val  Domain Accuracy [0.04468517264725796, 0.0, 0.0]

    Test  Label Loss = 123040.12275981903
    Test  Domain Loss = 19196.043763160706
    Test  Regularization Loss = 1568.2623052597046
    Test  Total Loss = 143804.42882823944
    Test  Composite Score 4986.5
    Test  Label Accuracy [0.8081975827640567, 0.02295552367288379, 0.6137992831541219, 0.0]
    Test  Label F1 [0.5392706872370265, 0.043010752688172046, 0.7135416666666667, 0]
    Test  Domain Accuracy [0.032384999803250304, 0.0, 0.0]

  EPOCH 26
    Train  Label Loss = 13792.47953414917
    Train  Domain Loss = 17828.37713623047
    Train  Regularization Loss = 1277.9285507202148
    Train  Total Loss = 32898.78522109985
    Train  Composite Score 16756.75
    Train  Label Accuracy [0.8864793513105789, 0.3195249130938586, 0.7065911730545877, 0.0]
    Train  Label F1 [0.7949942924787553, 0.3566693613581245, 0.8098843497795157, 0]
    Train  Domain Accuracy [0.5673636971259429, 0.0, 0.4465769120595818]

    Val  Label Loss = 1554.028636932373
    Val  Domain Loss = 1968.3043594360352
    Val  Regularization Loss = 177.79804229736328
    Val  Total Loss = 3700.1310386657715
    Val  Composite Score 2431.25
    Val  Label Accuracy [0.6045576407506702, 0.0481283422459893, 0.8891637803067788, 0.0]
    Val  Label F1 [0.6021361815754339, 0.0857142857142857, 0.8557142857142855, 0]
    Val  Domain Accuracy [0.7464454976303317, 0.0, 0.0]

    Test  Label Loss = 149915.89622688293
    Test  Domain Loss = 17466.49997997284
    Test  Regularization Loss = 1511.283359527588
    Test  Total Loss = 168893.67956638336
    Test  Composite Score 5181.5
    Test  Label Accuracy [0.6773515501839201, 0.020086083213773313, 0.7282706093189965, 0.0]
    Test  Label F1 [0.5309989701338826, 0.03835616438356164, 0.7610909516563269, 0]
    Test  Domain Accuracy [0.6274347774760949, 0.0, 0.0]

  EPOCH 27
    Train  Label Loss = 13801.578216552734
    Train  Domain Loss = 17461.7352142334
    Train  Regularization Loss = 1213.493866443634
    Train  Total Loss = 32476.807297229767
    Train  Composite Score 16844.25
    Train  Label Accuracy [0.8874414245548267, 0.326741440377804, 0.7123983739837398, 0.0]
    Train  Label F1 [0.8005579979709165, 0.3642046389208752, 0.808468572370047, 0]
    Train  Domain Accuracy [0.5435882746109042, 0.0, 0.4829561730163277]

    Val  Label Loss = 1802.392183303833
    Val  Domain Loss = 2088.886032104492
    Val  Regularization Loss = 169.73074436187744
    Val  Total Loss = 4061.0089597702026
    Val  Composite Score 2420.0
    Val  Label Accuracy [0.7506702412868632, 0.35294117647058826, 0.7996041563582384, 0.0]
    Val  Label F1 [0.6451612903225805, 0.36666666666666664, 0.8478488982161595, 0]
    Val  Domain Accuracy [0.32329045362220715, 0.0, 0.0]

    Test  Label Loss = 168131.87780570984
    Test  Domain Loss = 18347.95298099518
    Test  Regularization Loss = 1442.7113270759583
    Test  Total Loss = 187922.54211378098
    Test  Composite Score 4820.0
    Test  Label Accuracy [0.8434051497635313, 0.05595408895265423, 0.5439068100358423, 0.0]
    Test  Label F1 [0.5327800829875519, 0.08955223880597014, 0.6714601769911505, 0]
    Test  Domain Accuracy [0.10498563727226223, 0.0, 0.0]

  EPOCH 28
    Train  Label Loss = 14187.084491729736
    Train  Domain Loss = 18160.720893859863
    Train  Regularization Loss = 1206.1906538009644
    Train  Total Loss = 33553.996039390564
    Train  Composite Score 16698.0
    Train  Label Accuracy [0.8772833723653396, 0.31303576707064734, 0.7063008130081301, 0.0]
    Train  Label F1 [0.7913638668244041, 0.3500247892910263, 0.8006912442396313, 0]
    Train  Domain Accuracy [0.5591521054139215, 0.0, 0.46853814570801106]

    Val  Label Loss = 1639.5584831237793
    Val  Domain Loss = 1694.5257949829102
    Val  Regularization Loss = 180.3748655319214
    Val  Total Loss = 3514.459143638611
    Val  Composite Score 2456.0
    Val  Label Accuracy [0.5375335120643432, 0.06951871657754011, 0.9282533399307273, 0.0]
    Val  Label F1 [0.600749063670412, 0.11353711790393012, 0.8637200736648251, 0]
    Val  Domain Accuracy [0.9976303317535545, 0.0, 0.0]

    Test  Label Loss = 152797.92014694214
    Test  Domain Loss = 14815.669794082642
    Test  Regularization Loss = 1533.1863570213318
    Test  Total Loss = 169146.7762980461
    Test  Composite Score 5228.0
    Test  Label Accuracy [0.5412506568575933, 0.04878048780487805, 0.7956989247311828, 0.0]
    Test  Label F1 [0.49507329968757513, 0.08865710560625815, 0.7721739130434783, 0]
    Test  Domain Accuracy [0.9983866525006886, 0.0, 0.0]

  EPOCH 29
    Train  Label Loss = 14177.166404724121
    Train  Domain Loss = 17685.8671875
    Train  Regularization Loss = 1246.1834058761597
    Train  Total Loss = 33109.21699810028
    Train  Composite Score 16639.5
    Train  Label Accuracy [0.8757228173286568, 0.3129096608720433, 0.7077526132404182, 0.0]
    Train  Label F1 [0.7857446627541039, 0.3515850144092219, 0.8050532573693336, 0]
    Train  Domain Accuracy [0.5376682898882842, 0.0, 0.4828606893917693]

    Val  Label Loss = 1651.460536956787
    Val  Domain Loss = 2129.0568771362305
    Val  Regularization Loss = 174.60787296295166
    Val  Total Loss = 3955.1252870559692
    Val  Composite Score 2426.75
    Val  Label Accuracy [0.6595174262734584, 0.25668449197860965, 0.8466105888174171, 0.0]
    Val  Label F1 [0.6283524904214559, 0.2972136222910217, 0.8514555859666585, 0]
    Val  Domain Accuracy [0.08700067704807041, 0.0, 0.0]

    Test  Label Loss = 147420.52013015747
    Test  Domain Loss = 18333.8021068573
    Test  Regularization Loss = 1484.166920185089
    Test  Total Loss = 167238.48915719986
    Test  Composite Score 5008.25
    Test  Label Accuracy [0.7698370993168681, 0.11477761836441894, 0.6223118279569892, 0.0]
    Test  Label F1 [0.5409896602658789, 0.16753926701570682, 0.7162562846461262, 0]
    Test  Domain Accuracy [0.026128359501042774, 0.0, 0.0]
