Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
Loading CNN vectors...
SIZE_TRAIN = 94441
SIZE_VAL = 2954
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 18491.954078674316
    Train  Domain Loss = 15433.079515457153
    Train  Regularization Loss = 2509.819071292877
    Train  Total Loss = 36434.85266542435
    Train  Composite Score 15437.5
    Train  Label Accuracy [0.81213197495093, 0.1625483774933016, 0.6358885017421603, 0.0]
    Train  Label F1 [0.7281488309729323, 0.19235511713933415, 0.7117322066948326, 0]
    Train  Domain Accuracy [0.8160030554759858, 0.0, 0.6298099875871288]

    Val  Label Loss = 2044.9557037353516
    Val  Domain Loss = 1260.4465217590332
    Val  Regularization Loss = 363.6320114135742
    Val  Total Loss = 3669.034236907959
    Val  Composite Score 2278.25
    Val  Label Accuracy [0.7131367292225201, 0.10160427807486631, 0.7431964374072242, 0.0]
    Val  Label F1 [0.564755838641189, 0.1484375, 0.79723991507431, 0]
    Val  Domain Accuracy [0.6980365605958023, 0.0, 0.0]

    Test  Label Loss = 152412.19061088562
    Test  Domain Loss = 13294.174333572388
    Test  Regularization Loss = 3090.872097015381
    Test  Total Loss = 168797.2370414734
    Test  Composite Score 4890.5
    Test  Label Accuracy [0.8696794534944824, 0.0014347202295552368, 0.5622759856630825, 0.0]
    Test  Label F1 [0.5391757615246783, 0.0028368794326241137, 0.6891817682591983, 0]
    Test  Domain Accuracy [0.6301105733286113, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 17601.77967453003
    Train  Domain Loss = 33327.44968414307
    Train  Regularization Loss = 2642.374605178833
    Train  Total Loss = 53571.60396385193
    Train  Composite Score 15595.0
    Train  Label Accuracy [0.8197029516826471, 0.20146198830409356, 0.6408246225319396, 0.0]
    Train  Label F1 [0.733914068089046, 0.2324561403508772, 0.7256288015781687, 0]
    Train  Domain Accuracy [0.6337248161940228, 0.0, 0.4239472930392438]

    Val  Label Loss = 1694.0745086669922
    Val  Domain Loss = 87.7341902256012
    Val  Regularization Loss = 376.2850570678711
    Val  Total Loss = 2158.0937559604645
    Val  Composite Score 2434.25
    Val  Label Accuracy [0.628686327077748, 0.0053475935828877, 0.8861949529935675, 0.0]
    Val  Label F1 [0.602827763496144, 0.010526315789473684, 0.8606439211917347, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 497817.9172515869
    Test  Domain Loss = 1035.5451177358627
    Test  Regularization Loss = 3198.4229850769043
    Test  Total Loss = 502051.8853543997
    Test  Composite Score 5123.0
    Test  Label Accuracy [0.7682606410930111, 0.0, 0.6751792114695341, 0.0]
    Test  Label F1 [0.5413812256989446, 0, 0.7506849315068492, 0]
    Test  Domain Accuracy [0.9998426002439696, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 22849.51295852661
    Train  Domain Loss = 57894.010887145996
    Train  Regularization Loss = 2700.409643173218
    Train  Total Loss = 83443.93348884583
    Train  Composite Score 14937.0
    Train  Label Accuracy [0.7772826396131601, 0.2084876103674167, 0.5871080139372822, 0.0]
    Train  Label F1 [0.7045679171501009, 0.22800186886777757, 0.6695364238410595, 0]
    Train  Domain Accuracy [0.5772939940800152, 0.0, 0.39959896877685475]

    Val  Label Loss = 4089.295608520508
    Val  Domain Loss = 1760.2052154541016
    Val  Regularization Loss = 372.52718925476074
    Val  Total Loss = 6222.02801322937
    Val  Composite Score 1730.0
    Val  Label Accuracy [0.9879356568364611, 0.0, 0.2894606630381, 0.0]
    Val  Label F1 [0.47471819645732694, 0, 0.44724770642201833, 0]
    Val  Domain Accuracy [0.6327014218009479, 0.0, 0.0]

    Test  Label Loss = 275701.5528450012
    Test  Domain Loss = 16581.72256088257
    Test  Regularization Loss = 3166.4811086654663
    Test  Total Loss = 295449.75651454926
    Test  Composite Score 3692.75
    Test  Label Accuracy [0.9957961114030478, 0.0, 0.15098566308243727, 0.0]
    Test  Label F1 [0.45745322872661437, 0, 0.2619510299261562, 0]
    Test  Domain Accuracy [0.5595561326879943, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 17682.457279205322
    Train  Domain Loss = 21151.179317474365
    Train  Regularization Loss = 2422.843086242676
    Train  Total Loss = 41256.47968292236
    Train  Composite Score 15630.25
    Train  Label Accuracy [0.817384745922504, 0.21732831063459868, 0.6485191637630662, 0.0]
    Train  Label F1 [0.7348080345792016, 0.24570024570024568, 0.7381640915475502, 0]
    Train  Domain Accuracy [0.5680320824978516, 0.0, 0.4360737133581591]

    Val  Label Loss = 1657.646614074707
    Val  Domain Loss = 3232.33065032959
    Val  Regularization Loss = 321.49492263793945
    Val  Total Loss = 5211.472187042236
    Val  Composite Score 2423.75
    Val  Label Accuracy [0.6702412868632708, 0.0, 0.8644235526966848, 0.0]
    Val  Label F1 [0.6075334143377886, 0, 0.8576337751595483, 0]
    Val  Domain Accuracy [0.15572105619498985, 0.0, 0.0]

    Test  Label Loss = 188527.23732757568
    Test  Domain Loss = 29116.21206855774
    Test  Regularization Loss = 2732.7068424224854
    Test  Total Loss = 220376.1562385559
    Test  Composite Score 5093.0
    Test  Label Accuracy [0.792433000525486, 0.0014347202295552368, 0.6556899641577061, 0.0]
    Test  Label F1 [0.5445026178010471, 0.0028653295128939827, 0.7418578126980103, 0]
    Test  Domain Accuracy [0.07751937984496124, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 18893.461311340332
    Train  Domain Loss = 26901.21514892578
    Train  Regularization Loss = 2271.8750772476196
    Train  Total Loss = 48066.55153751373
    Train  Composite Score 15594.5
    Train  Label Accuracy [0.8107344632768362, 0.24956369982547993, 0.6335656213704994, 0.0]
    Train  Label F1 [0.7365584498909278, 0.26947236180904527, 0.7224567502690175, 0]
    Train  Domain Accuracy [0.5588656545402464, 0.0, 0.4409433782106369]

    Val  Label Loss = 1688.662754058838
    Val  Domain Loss = 3372.1039657592773
    Val  Regularization Loss = 305.59289932250977
    Val  Total Loss = 5366.359619140625
    Val  Composite Score 2399.0
    Val  Label Accuracy [0.7117962466487936, 0.016042780748663103, 0.8312716476991588, 0.0]
    Val  Label F1 [0.607899255867201, 0.030303030303030304, 0.8478425435276307, 0]
    Val  Domain Accuracy [0.053148273527420443, 0.0, 0.0]

    Test  Label Loss = 116351.20952415466
    Test  Domain Loss = 29231.639720916748
    Test  Regularization Loss = 2597.539644241333
    Test  Total Loss = 148180.38888931274
    Test  Composite Score 5051.25
    Test  Label Accuracy [0.8328954282711508, 0.0028694404591104736, 0.6256720430107527, 0.0]
    Test  Label F1 [0.5493934142114385, 0.005681818181818182, 0.7299098392787142, 0]
    Test  Domain Accuracy [0.02601030968401999, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 16864.30917739868
    Train  Domain Loss = 19657.819595336914
    Train  Regularization Loss = 2122.2124462127686
    Train  Total Loss = 38644.341218948364
    Train  Composite Score 15863.0
    Train  Label Accuracy [0.8237785936176222, 0.26055312954876275, 0.6611498257839721, 0.0]
    Train  Label F1 [0.7481085702073094, 0.2853499123226526, 0.7508656224237427, 0]
    Train  Domain Accuracy [0.5480760049651485, 0.0, 0.47493554855342307]

    Val  Label Loss = 1917.0969867706299
    Val  Domain Loss = 2507.5573348999023
    Val  Regularization Loss = 286.6787910461426
    Val  Total Loss = 4711.333112716675
    Val  Composite Score 2342.0
    Val  Label Accuracy [0.6193029490616622, 0.47593582887700536, 0.785254824344384, 0.0]
    Val  Label F1 [0.5919282511210762, 0.3510848126232742, 0.8265625, 0]
    Val  Domain Accuracy [0.491875423155044, 0.0, 0.0]

    Test  Label Loss = 168768.24303150177
    Test  Domain Loss = 23665.27940750122
    Test  Regularization Loss = 2436.769723892212
    Test  Total Loss = 194870.2921628952
    Test  Composite Score 4918.25
    Test  Label Accuracy [0.8160798738833421, 0.13486370157819225, 0.5725806451612904, 0.0]
    Test  Label F1 [0.5483757062146893, 0.16622458001768348, 0.6971225964816583, 0]
    Test  Domain Accuracy [0.4516585999291701, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 17653.292015075684
    Train  Domain Loss = 22844.579315185547
    Train  Regularization Loss = 2105.6511125564575
    Train  Total Loss = 42603.52244281769
    Train  Composite Score 15622.25
    Train  Label Accuracy [0.8013426626323752, 0.27197013210798393, 0.6472125435540069, 0.0]
    Train  Label F1 [0.7318020896295657, 0.2889397406559878, 0.7382016890213611, 0]
    Train  Domain Accuracy [0.5731881982240046, 0.0, 0.4123937744676788]

    Val  Label Loss = 1645.308162689209
    Val  Domain Loss = 2391.284767150879
    Val  Regularization Loss = 293.12424659729004
    Val  Total Loss = 4329.717176437378
    Val  Composite Score 2438.75
    Val  Label Accuracy [0.5536193029490617, 0.0, 0.917367639782286, 0.0]
    Val  Label F1 [0.5825105782792666, 0, 0.8619246861924685, 0]
    Val  Domain Accuracy [0.006431956668923494, 0.0, 0.0]

    Test  Label Loss = 287593.15618133545
    Test  Domain Loss = 20451.858578681946
    Test  Regularization Loss = 2491.5560960769653
    Test  Total Loss = 310536.57085609436
    Test  Composite Score 5236.25
    Test  Label Accuracy [0.6248029427220179, 0.00430416068866571, 0.769489247311828, 0.0]
    Test  Label F1 [0.523673199735741, 0.008522727272727272, 0.7733873691320499, 0]
    Test  Domain Accuracy [0.00338409475465313, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 16776.99896621704
    Train  Domain Loss = 20072.711181640625
    Train  Regularization Loss = 2015.9957752227783
    Train  Total Loss = 38865.705923080444
    Train  Composite Score 15892.5
    Train  Label Accuracy [0.8215228043724085, 0.2614625652930934, 0.6697154471544715, 0.0]
    Train  Label F1 [0.7494841815680879, 0.2818707961833255, 0.7585299679355423, 0]
    Train  Domain Accuracy [0.5704191731118113, 0.0, 0.41439893058340493]

    Val  Label Loss = 2700.0498275756836
    Val  Domain Loss = 1757.4409484863281
    Val  Regularization Loss = 275.6059741973877
    Val  Total Loss = 4733.096750259399
    Val  Composite Score 2167.25
    Val  Label Accuracy [0.7372654155495979, 0.6256684491978609, 0.6125680356259278, 0.0]
    Val  Label F1 [0.6053935057787562, 0.30000000000000004, 0.7478103292056781, 0]
    Val  Domain Accuracy [0.9928909952606635, 0.0, 0.0]

    Test  Label Loss = 445254.90298843384
    Test  Domain Loss = 15746.192001342773
    Test  Regularization Loss = 2342.6507806777954
    Test  Total Loss = 463343.7457704544
    Test  Composite Score 4358.75
    Test  Label Accuracy [0.8512874408828166, 0.1994261119081779, 0.3803763440860215, 0.0]
    Test  Label F1 [0.5221595487510072, 0.16656680647094066, 0.5430124720179086, 0]
    Test  Domain Accuracy [0.9736355408649117, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 16028.186887741089
    Train  Domain Loss = 18602.907207489014
    Train  Regularization Loss = 1867.7396879196167
    Train  Total Loss = 36498.83378314972
    Train  Composite Score 16119.25
    Train  Label Accuracy [0.8430063023233938, 0.27195798074117306, 0.6736353077816493, 0.0]
    Train  Label F1 [0.7614597051701432, 0.30230295167045085, 0.7659293496203367, 0]
    Train  Domain Accuracy [0.5981094242337439, 0.0, 0.4291988923899551]

    Val  Label Loss = 1780.2733726501465
    Val  Domain Loss = 2237.1262130737305
    Val  Regularization Loss = 260.9765625
    Val  Total Loss = 4278.376148223877
    Val  Composite Score 2439.5
    Val  Label Accuracy [0.38873994638069703, 0.2887700534759358, 0.9520039584364176, 0.0]
    Val  Label F1 [0.5128205128205129, 0.3292682926829268, 0.8649134636997078, 0]
    Val  Domain Accuracy [0.10934326337169939, 0.0, 0.0]

    Test  Label Loss = 408679.10125541687
    Test  Domain Loss = 19449.91039466858
    Test  Regularization Loss = 2218.30078125
    Test  Total Loss = 430347.31243133545
    Test  Composite Score 5281.25
    Test  Label Accuracy [0.34944823962165, 0.14634146341463414, 0.8781362007168458, 0.0]
    Test  Label F1 [0.4138145612943373, 0.2, 0.7923994340004042, 0]
    Test  Domain Accuracy [0.057883760280171566, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 16355.907228469849
    Train  Domain Loss = 19225.931526184082
    Train  Regularization Loss = 1924.2965230941772
    Train  Total Loss = 37506.13527774811
    Train  Composite Score 16012.75
    Train  Label Accuracy [0.8286493091455964, 0.2869260017548991, 0.6681184668989547, 0.0]
    Train  Label F1 [0.7554736706799777, 0.3098057792515395, 0.758905013192612, 0]
    Train  Domain Accuracy [0.6189248543874726, 0.0, 0.42089181705337536]

    Val  Label Loss = 1961.7344703674316
    Val  Domain Loss = 2073.037311553955
    Val  Regularization Loss = 279.9950695037842
    Val  Total Loss = 4314.766851425171
    Val  Composite Score 2322.5
    Val  Label Accuracy [0.8525469168900804, 0.06951871657754011, 0.7238990598713508, 0.0]
    Val  Label F1 [0.6144927536231883, 0.12093023255813952, 0.8076179961357991, 0]
    Val  Domain Accuracy [0.3906567366283006, 0.0, 0.0]

    Test  Label Loss = 541904.3525524139
    Test  Domain Loss = 18592.517015457153
    Test  Regularization Loss = 2379.9580907821655
    Test  Total Loss = 562876.8276586533
    Test  Composite Score 4685.0
    Test  Label Accuracy [0.9132947976878613, 0.015781922525107604, 0.4800627240143369, 0.0]
    Test  Label F1 [0.5256313322244064, 0.02997275204359673, 0.632060168116797, 0]
    Test  Domain Accuracy [0.2234683036241294, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 16338.815872192383
    Train  Domain Loss = 19837.70477294922
    Train  Regularization Loss = 2005.924723625183
    Train  Total Loss = 38182.445368766785
    Train  Composite Score 16113.75
    Train  Label Accuracy [0.832864905377553, 0.2789598108747045, 0.6810394889663183, 0.0]
    Train  Label F1 [0.758467707533487, 0.3038300611522369, 0.7709120788824979, 0]
    Train  Domain Accuracy [0.5750023870906139, 0.0, 0.4215602024252841]

    Val  Label Loss = 1750.4440155029297
    Val  Domain Loss = 1936.3647918701172
    Val  Regularization Loss = 278.85366439819336
    Val  Total Loss = 3965.6624717712402
    Val  Composite Score 2422.25
    Val  Label Accuracy [0.47587131367292224, 0.0, 0.9351806036615536, 0.0]
    Val  Label F1 [0.5407463823305407, 0, 0.8575317604355717, 0]
    Val  Domain Accuracy [0.6628300609343263, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 319009.13526916504
    Test  Domain Loss = 17039.18021965027
    Test  Regularization Loss = 2370.2561473846436
    Test  Total Loss = 338418.57163619995
    Test  Composite Score 5297.75
    Test  Label Accuracy [0.4503415659485024, 0.005738880918220947, 0.8620071684587813, 0.0]
    Test  Label F1 [0.4624932541824069, 0.0113314447592068, 0.7920955125566076, 0]
    Test  Domain Accuracy [0.5716365639633258, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 16084.53642654419
    Train  Domain Loss = 19456.473976135254
    Train  Regularization Loss = 1840.9027967453003
    Train  Total Loss = 37381.913199424744
    Train  Composite Score 16126.5
    Train  Label Accuracy [0.8382866308142277, 0.2760913558832032, 0.6833623693379791, 0.0]
    Train  Label F1 [0.7623991762484983, 0.3061388042955602, 0.7676125244618396, 0]
    Train  Domain Accuracy [0.5652630573856584, 0.0, 0.4584168815048219]

    Val  Label Loss = 1820.0045776367188
    Val  Domain Loss = 4433.375579833984
    Val  Regularization Loss = 289.8761558532715
    Val  Total Loss = 6543.256313323975
    Val  Composite Score 2420.75
    Val  Label Accuracy [0.5053619302949062, 0.0, 0.9233052944087086, 0.0]
    Val  Label F1 [0.5639491398653702, 0, 0.8512773722627737, 0]
    Val  Domain Accuracy [0.0050778605280974946, 0.0, 0.0]

    Test  Label Loss = 515407.03111839294
    Test  Domain Loss = 36959.88370513916
    Test  Regularization Loss = 2463.9473247528076
    Test  Total Loss = 554830.8621482849
    Test  Composite Score 5274.5
    Test  Label Accuracy [0.5065685759327377, 0.0014347202295552368, 0.8317652329749103, 0.0]
    Test  Label F1 [0.4822411205602802, 0.0028653295128939827, 0.7873197625106021, 0]
    Test  Domain Accuracy [0.0034234446936607247, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 16268.572242736816
    Train  Domain Loss = 19137.698181152344
    Train  Regularization Loss = 2015.7335691452026
    Train  Total Loss = 37422.00399303436
    Train  Composite Score 16087.25
    Train  Label Accuracy [0.8283132530120482, 0.2949912638322656, 0.6784262485481998, 0.0]
    Train  Label F1 [0.7581631773929526, 0.316859555833594, 0.7642489165099354, 0]
    Train  Domain Accuracy [0.589515898023489, 0.0, 0.40876539673446005]

    Val  Label Loss = 1785.3135795593262
    Val  Domain Loss = 2224.766311645508
    Val  Regularization Loss = 276.32171630859375
    Val  Total Loss = 4286.401607513428
    Val  Composite Score 2359.25
    Val  Label Accuracy [0.7734584450402144, 0.11229946524064172, 0.7733795150915388, 0.0]
    Val  Label F1 [0.6164529914529914, 0.16799999999999998, 0.8256735340729001, 0]
    Val  Domain Accuracy [0.06702775897088693, 0.0, 0.0]

    Test  Label Loss = 225979.13012313843
    Test  Domain Loss = 19175.213108062744
    Test  Regularization Loss = 2348.734588623047
    Test  Total Loss = 247503.07781982422
    Test  Composite Score 4901.0
    Test  Label Accuracy [0.8670520231213873, 0.04447632711621234, 0.5598118279569892, 0.0]
    Test  Label F1 [0.5405405405405406, 0.07989690721649485, 0.68966468883676, 0]
    Test  Domain Accuracy [0.04804627552827293, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 15026.690996170044
    Train  Domain Loss = 18357.448448181152
    Train  Regularization Loss = 1847.8122272491455
    Train  Total Loss = 35231.95167160034
    Train  Composite Score 16460.25
    Train  Label Accuracy [0.8584693303320202, 0.2865135453474676, 0.7047038327526133, 0.0]
    Train  Label F1 [0.7780847536872529, 0.31885957725708663, 0.7946304330031924, 0]
    Train  Domain Accuracy [0.5884655781533467, 0.0, 0.4091473312326936]

    Val  Label Loss = 1586.303867340088
    Val  Domain Loss = 1383.1502532958984
    Val  Regularization Loss = 254.66772079467773
    Val  Total Loss = 3224.121841430664
    Val  Composite Score 2429.0
    Val  Label Accuracy [0.6447721179624665, 0.08021390374331551, 0.8698664027709055, 0.0]
    Val  Label F1 [0.6038920276208413, 0.13953488372093023, 0.8575609756097562, 0]
    Val  Domain Accuracy [0.9322951929587001, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 194380.9671268463
    Test  Domain Loss = 12932.98607635498
    Test  Regularization Loss = 2164.6756267547607
    Test  Total Loss = 209478.62882995605
    Test  Composite Score 5142.5
    Test  Label Accuracy [0.7388334209143458, 0.03299856527977044, 0.6883960573476703, 0.0]
    Test  Label F1 [0.539834901132655, 0.06108897742363878, 0.7526328679892237, 0]
    Test  Domain Accuracy [0.9233463188132058, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 14706.115421295166
    Train  Domain Loss = 18398.611152648926
    Train  Regularization Loss = 1754.0250263214111
    Train  Total Loss = 34858.7516002655
    Train  Composite Score 16524.75
    Train  Label Accuracy [0.8644643699858424, 0.3043603811723939, 0.7047038327526133, 0.0]
    Train  Label F1 [0.7803194888178914, 0.33956185567010305, 0.798289614340926, 0]
    Train  Domain Accuracy [0.5802539864413253, 0.0, 0.42977179413730543]

    Val  Label Loss = 1736.6856231689453
    Val  Domain Loss = 2032.0894165039062
    Val  Regularization Loss = 242.78071403503418
    Val  Total Loss = 4011.5557537078857
    Val  Composite Score 2386.25
    Val  Label Accuracy [0.6434316353887399, 0.41711229946524064, 0.8109846610588818, 0.0]
    Val  Label F1 [0.6007509386733417, 0.39, 0.8383631713554986, 0]
    Val  Domain Accuracy [0.596817874069059, 0.0, 0.0]

    Test  Label Loss = 216223.17507362366
    Test  Domain Loss = 17843.079315185547
    Test  Regularization Loss = 2063.6360692977905
    Test  Total Loss = 236129.890458107
    Test  Composite Score 5045.75
    Test  Label Accuracy [0.7756174461376774, 0.11764705882352941, 0.630600358422939, 0.0]
    Test  Label F1 [0.5453537779419916, 0.16889804325437693, 0.7270144628099173, 0]
    Test  Domain Accuracy [0.46720182583716996, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 15498.551601409912
    Train  Domain Loss = 18484.40536880493
    Train  Regularization Loss = 1763.6922645568848
    Train  Total Loss = 35746.64923477173
    Train  Composite Score 16229.25
    Train  Label Accuracy [0.8466414380321665, 0.29644495412844035, 0.6806039488966318, 0.0]
    Train  Label F1 [0.7653951419774204, 0.32572058591904235, 0.7737888916398449, 0]
    Train  Domain Accuracy [0.5799675355676501, 0.0, 0.4488685190489831]

    Val  Label Loss = 1791.7868003845215
    Val  Domain Loss = 3168.3113555908203
    Val  Regularization Loss = 278.0658531188965
    Val  Total Loss = 5238.164009094238
    Val  Composite Score 2411.75
    Val  Label Accuracy [0.4195710455764075, 0.0748663101604278, 0.9421078673923801, 0.0]
    Val  Label F1 [0.527379949452401, 0.10447761194029849, 0.8551538288794072, 0]
    Val  Domain Accuracy [0.002369668246445498, 0.0, 0.0]

    Test  Label Loss = 291860.1375389099
    Test  Domain Loss = 27404.64573574066
    Test  Regularization Loss = 2363.55975151062
    Test  Total Loss = 321628.3430261612
    Test  Composite Score 5237.0
    Test  Label Accuracy [0.40567524960588547, 0.047345767575322814, 0.8564068100358423, 0.0]
    Test  Label F1 [0.43407365757660954, 0.07773851590106007, 0.7864636905986423, 0]
    Test  Domain Accuracy [0.0024396962184708615, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 15086.090744018555
    Train  Domain Loss = 17863.78839111328
    Train  Regularization Loss = 1846.8352165222168
    Train  Total Loss = 34796.71435165405
    Train  Composite Score 16300.25
    Train  Label Accuracy [0.8501610153438152, 0.282, 0.6971544715447154, 0.0]
    Train  Label F1 [0.7666880204996798, 0.31493299298021693, 0.7892185060399375, 0]
    Train  Domain Accuracy [0.56812756612241, 0.0, 0.45402463477513605]

    Val  Label Loss = 1606.3116855621338
    Val  Domain Loss = 4208.889427185059
    Val  Regularization Loss = 252.39355087280273
    Val  Total Loss = 6067.594663619995
    Val  Composite Score 2433.5
    Val  Label Accuracy [0.5817694369973191, 0.03208556149732621, 0.9005442850074221, 0.0]
    Val  Label F1 [0.6015246015246016, 0.05741626794258374, 0.855263157894737, 0]
    Val  Domain Accuracy [0.008801624915368992, 0.0, 0.0]

    Test  Label Loss = 245068.01849746704
    Test  Domain Loss = 30951.777883529663
    Test  Regularization Loss = 2145.3451824188232
    Test  Total Loss = 278165.1415634155
    Test  Composite Score 5208.5
    Test  Label Accuracy [0.648975302154493, 0.03730272596843615, 0.7457437275985663, 0.0]
    Test  Label F1 [0.5226407109606432, 0.0695187165775401, 0.7693552114629074, 0]
    Test  Domain Accuracy [0.003305394876637941, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 15022.14432144165
    Train  Domain Loss = 19454.019981384277
    Train  Regularization Loss = 1784.9849843978882
    Train  Total Loss = 36261.149287223816
    Train  Composite Score 16430.75
    Train  Label Accuracy [0.8579909536373916, 0.2887405687753918, 0.701945412311266, 0.0]
    Train  Label F1 [0.7753225188402094, 0.321590174531351, 0.7933382558044138, 0]
    Train  Domain Accuracy [0.6060345650720901, 0.0, 0.4234698749164518]

    Val  Label Loss = 2130.964153289795
    Val  Domain Loss = 1940.6361656188965
    Val  Regularization Loss = 246.30589485168457
    Val  Total Loss = 4317.906213760376
    Val  Composite Score 2423.0
    Val  Label Accuracy [0.353887399463807, 0.03208556149732621, 0.9777337951509154, 0.0]
    Val  Label F1 [0.4911627906976744, 0.058823529411764705, 0.8537481097429251, 0]
    Val  Domain Accuracy [0.7874069058903183, 0.0, 0.0]

    Test  Label Loss = 160828.3558959961
    Test  Domain Loss = 17111.017652511597
    Test  Regularization Loss = 2093.600106239319
    Test  Total Loss = 180032.973654747
    Test  Composite Score 5255.0
    Test  Label Accuracy [0.2443510246978455, 0.028694404591104734, 0.9334677419354839, 0.0]
    Test  Label F1 [0.3333333333333333, 0.053691275167785234, 0.7867459643160577, 0]
    Test  Domain Accuracy [0.7397395034037697, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 14439.488893508911
    Train  Domain Loss = 17607.858753204346
    Train  Regularization Loss = 1633.535517692566
    Train  Total Loss = 33680.88316440582
    Train  Composite Score 16577.75
    Train  Label Accuracy [0.8703895858881238, 0.30922765403529073, 0.7020905923344948, 0.0]
    Train  Label F1 [0.7851763604646216, 0.34126097366320834, 0.799801538079881, 0]
    Train  Domain Accuracy [0.5885610617779051, 0.0, 0.43502339348801683]

    Val  Label Loss = 1555.5449485778809
    Val  Domain Loss = 2195.0653381347656
    Val  Regularization Loss = 227.48850345611572
    Val  Total Loss = 3978.098790168762
    Val  Composite Score 2458.25
    Val  Label Accuracy [0.5844504021447721, 0.09090909090909091, 0.9104403760514597, 0.0]
    Val  Label F1 [0.6162544169611307, 0.14345991561181434, 0.8646616541353384, 0]
    Val  Domain Accuracy [0.2542315504400812, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 110714.5189704895
    Test  Domain Loss = 19155.511255264282
    Test  Regularization Loss = 1933.6522793769836
    Test  Total Loss = 131803.68250513077
    Test  Composite Score 5209.0
    Test  Label Accuracy [0.6321597477666842, 0.05595408895265423, 0.75, 0.0]
    Test  Label F1 [0.5203287197231834, 0.09774436090225563, 0.7691247415575466, 0]
    Test  Domain Accuracy [0.1959626962578208, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 14549.207904815674
    Train  Domain Loss = 17779.310096740723
    Train  Regularization Loss = 1563.7851886749268
    Train  Total Loss = 33892.30319023132
    Train  Composite Score 16518.75
    Train  Label Accuracy [0.8646695197337138, 0.30962461191081003, 0.7060104529616724, 0.0]
    Train  Label F1 [0.78009438009438, 0.3429732687197123, 0.7999670998519492, 0]
    Train  Domain Accuracy [0.5769120595817817, 0.0, 0.43836532034756037]

    Val  Label Loss = 1645.6716575622559
    Val  Domain Loss = 1916.8181037902832
    Val  Regularization Loss = 218.85087490081787
    Val  Total Loss = 3781.340636253357
    Val  Composite Score 2452.25
    Val  Label Accuracy [0.6380697050938338, 0.37433155080213903, 0.8604651162790697, 0.0]
    Val  Label F1 [0.6312997347480106, 0.3804347826086957, 0.8625992063492064, 0]
    Val  Domain Accuracy [0.7207176709546378, 0.0, 0.0]

    Test  Label Loss = 198866.29342651367
    Test  Domain Loss = 16704.06039571762
    Test  Regularization Loss = 1860.232436656952
    Test  Total Loss = 217430.58625888824
    Test  Composite Score 5010.5
    Test  Label Accuracy [0.7598528638991067, 0.12625538020086083, 0.6254480286738351, 0.0]
    Test  Label F1 [0.5307395852449991, 0.18683651804670912, 0.7217267674809357, 0]
    Test  Domain Accuracy [0.6911423287293905, 0.0, 0.0]

  EPOCH 20
    Train  Label Loss = 14508.161725997925
    Train  Domain Loss = 19763.54483795166
    Train  Regularization Loss = 1587.2086763381958
    Train  Total Loss = 35858.91524028778
    Train  Composite Score 16552.5
    Train  Label Accuracy [0.8751420992800303, 0.2921187892632781, 0.70267131242741, 0.0]
    Train  Label F1 [0.7845768397808824, 0.3287275064267352, 0.8013245033112583, 0]
    Train  Domain Accuracy [0.5817817244342596, 0.0, 0.41898214456220756]

    Val  Label Loss = 1648.4808139801025
    Val  Domain Loss = 1701.9260902404785
    Val  Regularization Loss = 233.25453758239746
    Val  Total Loss = 3583.6614418029785
    Val  Composite Score 2455.25
    Val  Label Accuracy [0.4571045576407507, 0.24598930481283424, 0.9411182582879762, 0.0]
    Val  Label F1 [0.5603944124897289, 0.3097643097643098, 0.8657259899863451, 0]
    Val  Domain Accuracy [0.9983073798239676, 0.0, 0.0]

    Test  Label Loss = 293618.5065860748
    Test  Domain Loss = 14815.003616333008
    Test  Regularization Loss = 1982.6635694503784
    Test  Total Loss = 310416.1737718582
    Test  Composite Score 5243.75
    Test  Label Accuracy [0.42038885969521805, 0.06886657101865136, 0.8487903225806451, 0.0]
    Test  Label F1 [0.44419766796224314, 0.11387900355871886, 0.782608695652174, 0]
    Test  Domain Accuracy [0.9975996537205367, 0.0, 0.0]

  EPOCH 21
    Train  Label Loss = 14520.864082336426
    Train  Domain Loss = 19294.542503356934
    Train  Regularization Loss = 1691.2393131256104
    Train  Total Loss = 35506.64589881897
    Train  Composite Score 16554.0
    Train  Label Accuracy [0.8690297104174501, 0.3141437755698422, 0.6948315911730546, 0.0]
    Train  Label F1 [0.7863371474754349, 0.34148665819567975, 0.794686591946866, 0]
    Train  Domain Accuracy [0.563448868519049, 0.0, 0.4230879404182183]

    Val  Label Loss = 1603.5619201660156
    Val  Domain Loss = 1294.3601417541504
    Val  Regularization Loss = 251.53538703918457
    Val  Total Loss = 3149.4574489593506
    Val  Composite Score 2448.5
    Val  Label Accuracy [0.6997319034852547, 0.0, 0.8698664027709055, 0.0]
    Val  Label F1 [0.6315789473684211, 0, 0.864306784660767, 0]
    Val  Domain Accuracy [0.9996614759647935, 0.0, 0.0]

    Test  Label Loss = 525176.9907302856
    Test  Domain Loss = 11914.309382915497
    Test  Regularization Loss = 2138.050789833069
    Test  Total Loss = 539229.3509030342
    Test  Composite Score 5097.5
    Test  Label Accuracy [0.7630057803468208, 0.00860832137733142, 0.6684587813620072, 0.0]
    Test  Label F1 [0.5385756676557863, 0.01694915254237288, 0.7433981066268062, 0]
    Test  Domain Accuracy [0.9999213001219848, 0.0, 0.0]

  EPOCH 22
    Train  Label Loss = 15112.558685302734
    Train  Domain Loss = 17914.826778411865
    Train  Regularization Loss = 1668.3172039985657
    Train  Total Loss = 34695.702667713165
    Train  Composite Score 16424.0
    Train  Label Accuracy [0.853379909365559, 0.3087132140796307, 0.6997677119628339, 0.0]
    Train  Label F1 [0.7744837631736783, 0.3317829457364342, 0.7991378595705878, 0]
    Train  Domain Accuracy [0.5593430726630383, 0.0, 0.4489640026735415]

    Val  Label Loss = 1591.4463920593262
    Val  Domain Loss = 2169.341480255127
    Val  Regularization Loss = 219.28829669952393
    Val  Total Loss = 3980.076169013977
    Val  Composite Score 2433.5
    Val  Label Accuracy [0.7479892761394102, 0.0053475935828877, 0.8416625432953984, 0.0]
    Val  Label F1 [0.6355353075170843, 0.010582010582010581, 0.858440575321726, 0]
    Val  Domain Accuracy [0.015910629654705483, 0.0, 0.0]

    Test  Label Loss = 224439.38414764404
    Test  Domain Loss = 18658.939310073853
    Test  Regularization Loss = 1863.9505219459534
    Test  Total Loss = 244962.27397966385
    Test  Composite Score 5036.75
    Test  Label Accuracy [0.8134524435102469, 0.014347202295552367, 0.6279121863799283, 0.0]
    Test  Label F1 [0.5442081209351379, 0.027972027972027972, 0.7257897462454687, 0]
    Test  Domain Accuracy [0.003580844449691103, 0.0, 0.0]

  EPOCH 23
    Train  Label Loss = 14547.687808990479
    Train  Domain Loss = 17762.019382476807
    Train  Regularization Loss = 1459.0323066711426
    Train  Total Loss = 33768.73949813843
    Train  Composite Score 16546.0
    Train  Label Accuracy [0.867862509391435, 0.3041055718475073, 0.6991869918699187, 0.0]
    Train  Label F1 [0.7844651952461801, 0.3339236837868298, 0.7975490601970688, 0]
    Train  Domain Accuracy [0.5761481905853146, 0.0, 0.45679365988732934]

    Val  Label Loss = 1664.3017044067383
    Val  Domain Loss = 2412.620536804199
    Val  Regularization Loss = 214.37687873840332
    Val  Total Loss = 4291.299119949341
    Val  Composite Score 2420.0
    Val  Label Accuracy [0.4718498659517426, 0.39572192513368987, 0.8985650667986146, 0.0]
    Val  Label F1 [0.5538945712037765, 0.36097560975609755, 0.8592382304234681, 0]
    Val  Domain Accuracy [0.1976980365605958, 0.0, 0.0]

    Test  Label Loss = 193487.61390399933
    Test  Domain Loss = 20643.199566841125
    Test  Regularization Loss = 1822.2034692764282
    Test  Total Loss = 215953.01694011688
    Test  Composite Score 5214.5
    Test  Label Accuracy [0.4776668418286915, 0.22094691535150646, 0.7918906810035843, 0.0]
    Test  Label F1 [0.4756671899529043, 0.2541254125412541, 0.7774356718715637, 0]
    Test  Domain Accuracy [0.17494982882776533, 0.0, 0.0]

  EPOCH 24
    Train  Label Loss = 14294.113021850586
    Train  Domain Loss = 18090.78148651123
    Train  Regularization Loss = 1526.711594581604
    Train  Total Loss = 33911.60610294342
    Train  Composite Score 16612.25
    Train  Label Accuracy [0.8696140876732859, 0.306327616794796, 0.7051393728222997, 0.0]
    Train  Label F1 [0.7879482283046891, 0.3368557958055601, 0.7996378004609812, 0]
    Train  Domain Accuracy [0.5866513892867373, 0.0, 0.43110856488112287]

    Val  Label Loss = 1573.417163848877
    Val  Domain Loss = 1875.7927894592285
    Val  Regularization Loss = 212.73797035217285
    Val  Total Loss = 3661.9479236602783
    Val  Composite Score 2448.5
    Val  Label Accuracy [0.532171581769437, 0.22459893048128343, 0.9109351806036615, 0.0]
    Val  Label F1 [0.5821114369501467, 0.30656934306569344, 0.862295081967213, 0]
    Val  Domain Accuracy [0.9617467840216656, 0.0, 0.0]

    Test  Label Loss = 164659.92626953125
    Test  Domain Loss = 16481.044507026672
    Test  Regularization Loss = 1808.2727479934692
    Test  Total Loss = 182949.2435245514
    Test  Composite Score 5227.25
    Test  Label Accuracy [0.5895953757225434, 0.06169296987087518, 0.7728494623655914, 0.0]
    Test  Label F1 [0.5078071961982349, 0.10643564356435643, 0.7751937984496123, 0]
    Test  Domain Accuracy [0.9755243379372762, 0.0, 0.0]

  EPOCH 25
    Train  Label Loss = 13946.820463180542
    Train  Domain Loss = 17445.026554107666
    Train  Regularization Loss = 1432.0180339813232
    Train  Total Loss = 32823.86505126953
    Train  Composite Score 16673.0
    Train  Label Accuracy [0.879338061465721, 0.30806775768016076, 0.7086236933797909, 0.0]
    Train  Label F1 [0.7911349327888377, 0.3423193491784974, 0.8066435299950422, 0]
    Train  Domain Accuracy [0.5793946338202998, 0.0, 0.4376014513510933]

    Val  Label Loss = 1573.9482326507568
    Val  Domain Loss = 1929.7858810424805
    Val  Regularization Loss = 199.57011222839355
    Val  Total Loss = 3703.304225921631
    Val  Composite Score 2438.75
    Val  Label Accuracy [0.5764075067024129, 0.0855614973262032, 0.901039089559624, 0.0]
    Val  Label F1 [0.5922865013774105, 0.13617021276595745, 0.8628287135749821, 0]
    Val  Domain Accuracy [0.7789438050101557, 0.0, 0.0]

    Test  Label Loss = 151661.6088695526
    Test  Domain Loss = 17253.49205970764
    Test  Regularization Loss = 1696.3459539413452
    Test  Total Loss = 170611.4468832016
    Test  Composite Score 5164.25
    Test  Label Accuracy [0.5864424592748292, 0.047345767575322814, 0.7576164874551972, 0.0]
    Test  Label F1 [0.49544950055493886, 0.08627450980392158, 0.7636035222397833, 0]
    Test  Domain Accuracy [0.7023964112855625, 0.0, 0.0]

  EPOCH 26
    Train  Label Loss = 14341.809940338135
    Train  Domain Loss = 17876.08921813965
    Train  Regularization Loss = 1423.5461721420288
    Train  Total Loss = 33641.44533061981
    Train  Composite Score 16587.25
    Train  Label Accuracy [0.8670563831793324, 0.32329084588644263, 0.7022357723577236, 0.0]
    Train  Label F1 [0.7848760295310032, 0.3557539050047816, 0.7968042171155588, 0]
    Train  Domain Accuracy [0.5932397593812662, 0.0, 0.4317769502530316]

    Val  Label Loss = 1635.2353706359863
    Val  Domain Loss = 2119.101230621338
    Val  Regularization Loss = 209.08119678497314
    Val  Total Loss = 3963.4177980422974
    Val  Composite Score 2443.25
    Val  Label Accuracy [0.4772117962466488, 0.24064171122994651, 0.9262741217219198, 0.0]
    Val  Label F1 [0.557556773688332, 0.3202846975088968, 0.8606896551724137, 0]
    Val  Domain Accuracy [0.1905890318212593, 0.0, 0.0]

    Test  Label Loss = 259165.99541854858
    Test  Domain Loss = 18443.66449356079
    Test  Regularization Loss = 1777.1901726722717
    Test  Total Loss = 279386.85008478165
    Test  Composite Score 5267.0
    Test  Label Accuracy [0.45612191276931163, 0.08034433285509325, 0.8387096774193549, 0.0]
    Test  Label F1 [0.46491697911087304, 0.1309941520467836, 0.7849879442289549, 0]
    Test  Domain Accuracy [0.11706606854759376, 0.0, 0.0]

  EPOCH 27
    Train  Label Loss = 13725.445505142212
    Train  Domain Loss = 17667.20719909668
    Train  Regularization Loss = 1424.6973328590393
    Train  Total Loss = 32817.35003709793
    Train  Composite Score 16867.0
    Train  Label Accuracy [0.8924086223055295, 0.3069657615112161, 0.718931475029036, 0.0]
    Train  Label F1 [0.8018526315789474, 0.3477679317839826, 0.815748290915081, 0]
    Train  Domain Accuracy [0.5648811228874248, 0.0, 0.4611859066170152]

    Val  Label Loss = 1560.2712440490723
    Val  Domain Loss = 1509.5488052368164
    Val  Regularization Loss = 197.31719970703125
    Val  Total Loss = 3267.13724899292
    Val  Composite Score 2448.5
    Val  Label Accuracy [0.6260053619302949, 0.24064171122994651, 0.8748144482929243, 0.0]
    Val  Label F1 [0.624331550802139, 0.28662420382165604, 0.8628599316739874, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 163354.95098114014
    Test  Domain Loss = 13548.710227012634
    Test  Regularization Loss = 1677.1961975097656
    Test  Total Loss = 178580.85740566254
    Test  Composite Score 5097.5
    Test  Label Accuracy [0.6636889122438255, 0.06312769010043041, 0.7022849462365591, 0.0]
    Test  Label F1 [0.516247700797057, 0.10640870616686819, 0.7457183634633682, 0]
    Test  Domain Accuracy [0.9986227521347342, 0.0, 0.0]

  EPOCH 28
    Train  Label Loss = 13733.195014953613
    Train  Domain Loss = 17596.358779907227
    Train  Regularization Loss = 1340.4061155319214
    Train  Total Loss = 32669.95991039276
    Train  Composite Score 16816.0
    Train  Label Accuracy [0.8908665105386416, 0.3000295595625185, 0.7145760743321719, 0.0]
    Train  Label F1 [0.798555714165757, 0.3408900083963056, 0.8138227513227513, 0]
    Train  Domain Accuracy [0.5618256469015563, 0.0, 0.4561252745154206]

    Val  Label Loss = 1581.4438076019287
    Val  Domain Loss = 1951.6229553222656
    Val  Regularization Loss = 185.9172821044922
    Val  Total Loss = 3718.9840450286865
    Val  Composite Score 2449.25
    Val  Label Accuracy [0.7345844504021448, 0.03208556149732621, 0.8545274616526473, 0.0]
    Val  Label F1 [0.6439482961222092, 0.057971014492753624, 0.8637159289822456, 0]
    Val  Domain Accuracy [0.9157075152335816, 0.0, 0.0]

    Test  Label Loss = 211720.9054031372
    Test  Domain Loss = 17158.49747657776
    Test  Regularization Loss = 1580.2968978881836
    Test  Total Loss = 230459.69977760315
    Test  Composite Score 4929.5
    Test  Label Accuracy [0.765633210719916, 0.03299856527977044, 0.6133512544802867, 0.0]
    Test  Label F1 [0.518689925240299, 0.06108897742363878, 0.7059430192084569, 0]
    Test  Domain Accuracy [0.8738834454806595, 0.0, 0.0]

  EPOCH 29
    Train  Label Loss = 13731.82095336914
    Train  Domain Loss = 17475.93590927124
    Train  Regularization Loss = 1270.8372950553894
    Train  Total Loss = 32478.59415769577
    Train  Composite Score 16837.0
    Train  Label Accuracy [0.887193098871931, 0.32886862353946994, 0.7198025551684089, 0.0]
    Train  Label F1 [0.7970193740685544, 0.36821952776005107, 0.8176121372031663, 0]
    Train  Domain Accuracy [0.5861739711639454, 0.0, 0.45068270791559245]

    Val  Label Loss = 1602.2783851623535
    Val  Domain Loss = 2021.6159133911133
    Val  Regularization Loss = 178.20472240447998
    Val  Total Loss = 3802.099020957947
    Val  Composite Score 2445.5
    Val  Label Accuracy [0.6501340482573726, 0.23529411764705882, 0.8644235526966848, 0.0]
    Val  Label F1 [0.6209987195902689, 0.29431438127090304, 0.8633555720286633, 0]
    Val  Domain Accuracy [0.6692620176032499, 0.0, 0.0]

    Test  Label Loss = 184702.3276233673
    Test  Domain Loss = 17666.17533302307
    Test  Regularization Loss = 1514.7401404380798
    Test  Total Loss = 203883.24309682846
    Test  Composite Score 4984.25
    Test  Label Accuracy [0.721492380451918, 0.047345767575322814, 0.6462813620071685, 0.0]
    Test  Label F1 [0.5144248782315474, 0.08672798948751642, 0.7186449121932992, 0]
    Test  Domain Accuracy [0.5672293707944752, 0.0, 0.0]
