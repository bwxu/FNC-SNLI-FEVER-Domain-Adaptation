Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
Loading CNN vectors...
SIZE_TRAIN = 94441
SIZE_VAL = 2954
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 18658.733932495117
    Train  Domain Loss = 18515.828426361084
    Train  Regularization Loss = 2512.3055987358093
    Train  Total Loss = 39686.86795759201
    Train  Composite Score 15366.25
    Train  Label Accuracy [0.7982054397607253, 0.17683834474545995, 0.6367595818815331, 0.0]
    Train  Label F1 [0.7218324740089596, 0.20560747663551404, 0.7067923616146967, 0]
    Train  Domain Accuracy [0.8335720423947293, 0.0, 0.6252267736083261]

    Val  Label Loss = 1872.9869632720947
    Val  Domain Loss = 918.7600727081299
    Val  Regularization Loss = 362.68198013305664
    Val  Total Loss = 3154.4290161132812
    Val  Composite Score 2366.0
    Val  Label Accuracy [0.6662198391420912, 0.13903743315508021, 0.8149430974764967, 0.0]
    Val  Label F1 [0.5864306784660768, 0.21487603305785122, 0.8295139763283808, 0]
    Val  Domain Accuracy [0.8188896411645227, 0.0, 0.0]

    Test  Label Loss = 159359.28931236267
    Test  Domain Loss = 10343.75484752655
    Test  Regularization Loss = 3082.7968311309814
    Test  Total Loss = 172785.8409910202
    Test  Composite Score 5027.75
    Test  Label Accuracy [0.8470835522858644, 0.005738880918220947, 0.6122311827956989, 0.0]
    Test  Label F1 [0.5523385300668151, 0.010973936899862825, 0.7228246495636075, 0]
    Test  Domain Accuracy [0.7636249163813796, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 17787.581758499146
    Train  Domain Loss = 32821.940032958984
    Train  Regularization Loss = 2575.6662034988403
    Train  Total Loss = 53185.18799495697
    Train  Composite Score 15557.0
    Train  Label Accuracy [0.8039105094942658, 0.23128654970760235, 0.6444541231126597, 0.0]
    Train  Label F1 [0.73034715402024, 0.25231259968102077, 0.7313617266661174, 0]
    Train  Domain Accuracy [0.6596963620739044, 0.0, 0.44762723192972403]

    Val  Label Loss = 1842.658390045166
    Val  Domain Loss = 2886.1588745117188
    Val  Regularization Loss = 347.25683212280273
    Val  Total Loss = 5076.0740966796875
    Val  Composite Score 2435.0
    Val  Label Accuracy [0.4249329758713137, 0.0, 0.9623948540326571, 0.0]
    Val  Label F1 [0.5332211942809083, 0, 0.8583406884377758, 0]
    Val  Domain Accuracy [0.2877454299255247, 0.0, 0.0]

    Test  Label Loss = 289652.572681427
    Test  Domain Loss = 27478.493633270264
    Test  Regularization Loss = 2951.6830730438232
    Test  Total Loss = 320082.7493877411
    Test  Composite Score 5335.25
    Test  Label Accuracy [0.41093011035207566, 0.0, 0.890905017921147, 0.0]
    Test  Label F1 [0.45438698431144675, 0, 0.7962759034938433, 0]
    Test  Domain Accuracy [0.19796954314720813, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 21941.743377685547
    Train  Domain Loss = 59779.27212142944
    Train  Regularization Loss = 2427.675477027893
    Train  Total Loss = 84148.69097614288
    Train  Composite Score 14998.75
    Train  Label Accuracy [0.7699819853986916, 0.23611506693249787, 0.596835075493612, 0.0]
    Train  Label F1 [0.703147322394909, 0.2521289537712895, 0.6804601506248448, 0]
    Train  Domain Accuracy [0.6172061491454216, 0.0, 0.3982621980330373]

    Val  Label Loss = 2111.365432739258
    Val  Domain Loss = 224.45483207702637
    Val  Regularization Loss = 341.04952812194824
    Val  Total Loss = 2676.8697929382324
    Val  Composite Score 2285.75
    Val  Label Accuracy [0.4316353887399464, 0.7379679144385026, 0.793171697179614, 0.0]
    Val  Label F1 [0.5322314049586777, 0.3325301204819277, 0.828852119958635, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 390658.1885662079
    Test  Domain Loss = 2675.9691195487976
    Test  Regularization Loss = 2898.92098903656
    Test  Total Loss = 396233.07867479324
    Test  Composite Score 4460.0
    Test  Label Accuracy [0.2947976878612717, 0.6556671449067432, 0.5766129032258065, 0.0]
    Test  Label F1 [0.3695652173913043, 0.2467602591792657, 0.6968056307525717, 0]
    Test  Domain Accuracy [0.9998819501829772, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 17332.551612854004
    Train  Domain Loss = 21018.994773864746
    Train  Regularization Loss = 2268.685359954834
    Train  Total Loss = 40620.231746673584
    Train  Composite Score 15740.5
    Train  Label Accuracy [0.818327519562553, 0.22602144305998262, 0.6633275261324042, 0.0]
    Train  Label F1 [0.739100817438692, 0.2523455192494338, 0.7520368693934656, 0]
    Train  Domain Accuracy [0.5766256087081065, 0.0, 0.45975365224863934]

    Val  Label Loss = 2250.0590019226074
    Val  Domain Loss = 1516.8410358428955
    Val  Regularization Loss = 304.3356513977051
    Val  Total Loss = 4071.235689163208
    Val  Composite Score 2220.5
    Val  Label Accuracy [0.853887399463807, 0.10160427807486631, 0.6531420089064819, 0.0]
    Val  Label F1 [0.5790909090909091, 0.1557377049180328, 0.7621247113163973, 0]
    Val  Domain Accuracy [0.6855111712931619, 0.0, 0.0]

    Test  Label Loss = 231059.21453666687
    Test  Domain Loss = 17560.57602787018
    Test  Regularization Loss = 2586.853036880493
    Test  Total Loss = 251206.64360141754
    Test  Composite Score 4324.25
    Test  Label Accuracy [0.9337887545980031, 0.010043041606886656, 0.36447132616487454, 0.0]
    Test  Label F1 [0.49491714245926743, 0.01917808219178082, 0.5234035708541097, 0]
    Test  Domain Accuracy [0.5282729311769567, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 19212.292682647705
    Train  Domain Loss = 30219.56401824951
    Train  Regularization Loss = 2316.7518339157104
    Train  Total Loss = 51748.60853481293
    Train  Composite Score 15282.5
    Train  Label Accuracy [0.7778719397363465, 0.2370564281559046, 0.632404181184669, 0.0]
    Train  Label F1 [0.7142486598651219, 0.2545681711697642, 0.7114740710494079, 0]
    Train  Domain Accuracy [0.5950539482478755, 0.0, 0.4157357013272224]

    Val  Label Loss = 1591.8710441589355
    Val  Domain Loss = 3182.288188934326
    Val  Regularization Loss = 319.62178230285645
    Val  Total Loss = 5093.781015396118
    Val  Composite Score 2453.0
    Val  Label Accuracy [0.6112600536193029, 0.0, 0.9054923305294409, 0.0]
    Val  Label F1 [0.6092184368737474, 0, 0.8666824532322992, 0]
    Val  Domain Accuracy [0.0, 0.0, 0.0]

    Test  Label Loss = 213935.6079902649
    Test  Domain Loss = 27545.765745162964
    Test  Regularization Loss = 2716.78514957428
    Test  Total Loss = 244198.15888500214
    Test  Composite Score 5303.0
    Test  Label Accuracy [0.6931161324224908, 0.0, 0.7609767025089605, 0.0]
    Test  Label F1 [0.556070826306914, 0, 0.7820881777368482, 0]
    Test  Domain Accuracy [0.0007869987801518908, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 17184.687580108643
    Train  Domain Loss = 22892.576690673828
    Train  Regularization Loss = 2160.7733793258667
    Train  Total Loss = 42238.03765010834
    Train  Composite Score 15728.0
    Train  Label Accuracy [0.8073049044526028, 0.25181950509461426, 0.6652148664343787, 0.0]
    Train  Label F1 [0.7384191493025658, 0.2704815509693559, 0.7533086724208795, 0]
    Train  Domain Accuracy [0.5675546643750596, 0.0, 0.4197460135586747]

    Val  Label Loss = 1555.7286987304688
    Val  Domain Loss = 3357.198230743408
    Val  Regularization Loss = 303.7936592102051
    Val  Total Loss = 5216.720588684082
    Val  Composite Score 2463.5
    Val  Label Accuracy [0.6528150134048257, 0.0748663101604278, 0.8901533894111826, 0.0]
    Val  Label F1 [0.6251604621309372, 0.1320754716981132, 0.8695021749637507, 0]
    Val  Domain Accuracy [0.0, 0.0, 0.0]

    Test  Label Loss = 226316.79621887207
    Test  Domain Loss = 27965.51891708374
    Test  Regularization Loss = 2582.246103286743
    Test  Total Loss = 256864.56123924255
    Test  Composite Score 5223.5
    Test  Label Accuracy [0.767209668943773, 0.005738880918220947, 0.7047491039426523, 0.0]
    Test  Label F1 [0.5601381162478419, 0.0111731843575419, 0.7674106598365654, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 16679.859897613525
    Train  Domain Loss = 19001.54002380371
    Train  Regularization Loss = 1994.8093690872192
    Train  Total Loss = 37676.209290504456
    Train  Composite Score 15922.25
    Train  Label Accuracy [0.8196860816944024, 0.2759908098793797, 0.6734901277584204, 0.0]
    Train  Label F1 [0.7455280357757137, 0.29469487887151186, 0.7699585062240664, 0]
    Train  Domain Accuracy [0.5406282822495942, 0.0, 0.4494414207963334]

    Val  Label Loss = 1678.9897556304932
    Val  Domain Loss = 2627.8469047546387
    Val  Regularization Loss = 265.46021461486816
    Val  Total Loss = 4572.296875
    Val  Composite Score 2440.25
    Val  Label Accuracy [0.435656836461126, 0.23529411764705882, 0.9401286491835725, 0.0]
    Val  Label F1 [0.5434782608695653, 0.2953020134228188, 0.8608971454463072, 0]
    Val  Domain Accuracy [0.023696682464454975, 0.0, 0.0]

    Test  Label Loss = 232324.17224121094
    Test  Domain Loss = 22730.78642463684
    Test  Regularization Loss = 2256.4118242263794
    Test  Total Loss = 257311.37049007416
    Test  Composite Score 5327.0
    Test  Label Accuracy [0.4077771939043615, 0.07747489239598278, 0.8776881720430108, 0.0]
    Test  Label F1 [0.45526547374596654, 0.12428078250863059, 0.7955329949238579, 0]
    Test  Domain Accuracy [0.006886239326329044, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 16815.2448387146
    Train  Domain Loss = 23832.231826782227
    Train  Regularization Loss = 2006.7361307144165
    Train  Total Loss = 42654.21279621124
    Train  Composite Score 15881.75
    Train  Label Accuracy [0.8233132303053148, 0.2521764364480557, 0.6697154471544715, 0.0]
    Train  Label F1 [0.7482230024835147, 0.28154867973432685, 0.7507527056717389, 0]
    Train  Domain Accuracy [0.5833094624271937, 0.0, 0.4504917406664757]

    Val  Label Loss = 1771.186336517334
    Val  Domain Loss = 1939.683006286621
    Val  Regularization Loss = 332.45341300964355
    Val  Total Loss = 4043.3227558135986
    Val  Composite Score 2416.25
    Val  Label Accuracy [0.41152815013404825, 0.1443850267379679, 0.9416130628401781, 0.0]
    Val  Label F1 [0.5203389830508475, 0.20532319391634982, 0.8524076147816348, 0]
    Val  Domain Accuracy [0.6391333784698714, 0.0, 0.0]

    Test  Label Loss = 901457.3898067474
    Test  Domain Loss = 17773.34134578705
    Test  Regularization Loss = 2825.85401058197
    Test  Total Loss = 922056.5851631165
    Test  Composite Score 5360.75
    Test  Label Accuracy [0.4345769837099317, 0.028694404591104734, 0.8839605734767025, 0.0]
    Test  Label F1 [0.47109085730561095, 0.05154639175257732, 0.8019510212376793, 0]
    Test  Domain Accuracy [0.41250541061661355, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 18329.75694656372
    Train  Domain Loss = 20265.1443939209
    Train  Regularization Loss = 2273.3752584457397
    Train  Total Loss = 40868.27659893036
    Train  Composite Score 15512.75
    Train  Label Accuracy [0.7894835857398175, 0.2567843594981033, 0.6473577235772358, 0.0]
    Train  Label F1 [0.7247841105354058, 0.2728259184622539, 0.7315832649712879, 0]
    Train  Domain Accuracy [0.5837868805499857, 0.0, 0.42232407142175116]

    Val  Label Loss = 1820.8494091033936
    Val  Domain Loss = 2237.7379760742188
    Val  Regularization Loss = 316.95101737976074
    Val  Total Loss = 4375.538402557373
    Val  Composite Score 2426.0
    Val  Label Accuracy [0.4343163538873995, 0.0, 0.9529935675408214, 0.0]
    Val  Label F1 [0.5364238410596027, 0, 0.8548601864181092, 0]
    Val  Domain Accuracy [0.2017603249830738, 0.0, 0.0]

    Test  Label Loss = 723370.840763092
    Test  Domain Loss = 18987.539702415466
    Test  Regularization Loss = 2694.0836477279663
    Test  Total Loss = 745052.4641132355
    Test  Composite Score 5371.25
    Test  Label Accuracy [0.4393063583815029, 0.010043041606886656, 0.8879928315412187, 0.0]
    Test  Label F1 [0.4751349815288434, 0.01952580195258019, 0.8014557217953902, 0]
    Test  Domain Accuracy [0.14382402707275804, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 16868.66843032837
    Train  Domain Loss = 18291.23120880127
    Train  Regularization Loss = 2094.459593772888
    Train  Total Loss = 37254.35923290253
    Train  Composite Score 15976.25
    Train  Label Accuracy [0.8162421280195508, 0.2898508335770693, 0.6775551684088269, 0.0]
    Train  Label F1 [0.749040410574891, 0.3087227414330218, 0.7639548207562611, 0]
    Train  Domain Accuracy [0.5730927145994462, 0.0, 0.43569177885992555]

    Val  Label Loss = 1634.9060401916504
    Val  Domain Loss = 2595.2314453125
    Val  Regularization Loss = 275.6173896789551
    Val  Total Loss = 4505.7548751831055
    Val  Composite Score 2430.5
    Val  Label Accuracy [0.6943699731903485, 0.058823529411764705, 0.8545274616526473, 0.0]
    Val  Label F1 [0.6211031175059951, 0.10185185185185185, 0.8583499005964215, 0]
    Val  Domain Accuracy [0.01794177386594448, 0.0, 0.0]

    Test  Label Loss = 352801.08175849915
    Test  Domain Loss = 21637.158088684082
    Test  Regularization Loss = 2342.747812271118
    Test  Total Loss = 376780.98765945435
    Test  Composite Score 4956.5
    Test  Label Accuracy [0.8339464004203888, 0.018651362984218076, 0.5945340501792115, 0.0]
    Test  Label F1 [0.539795918367347, 0.0348993288590604, 0.7074503531920565, 0]
    Test  Domain Accuracy [0.01995041907685043, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 15519.608186721802
    Train  Domain Loss = 19481.83798599243
    Train  Regularization Loss = 1914.9280061721802
    Train  Total Loss = 36916.37417888641
    Train  Composite Score 16243.0
    Train  Label Accuracy [0.8466366872774967, 0.2712765957446808, 0.6888792102206737, 0.0]
    Train  Label F1 [0.7666270783847982, 0.3038728897715988, 0.7778688524590165, 0]
    Train  Domain Accuracy [0.5931442757567077, 0.0, 0.42958082688818866]

    Val  Label Loss = 1642.1959495544434
    Val  Domain Loss = 1867.9975318908691
    Val  Regularization Loss = 276.5395259857178
    Val  Total Loss = 3786.7330074310303
    Val  Composite Score 2460.5
    Val  Label Accuracy [0.6219839142091153, 0.0053475935828877, 0.9059871350816427, 0.0]
    Val  Label F1 [0.6236559139784946, 0.010526315789473684, 0.8657210401891252, 0]
    Val  Domain Accuracy [0.5910629654705484, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 128657.02562713623
    Test  Domain Loss = 16037.803694725037
    Test  Regularization Loss = 2350.585970878601
    Test  Total Loss = 147045.41529273987
    Test  Composite Score 5185.25
    Test  Label Accuracy [0.6915396741986337, 0.0014347202295552368, 0.7262544802867383, 0.0]
    Test  Label F1 [0.531287848203472, 0.002861230329041488, 0.7650737463126844, 0]
    Test  Domain Accuracy [0.5865895407862117, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 16002.393669128418
    Train  Domain Loss = 19288.03516769409
    Train  Regularization Loss = 1909.710521697998
    Train  Total Loss = 37200.13935852051
    Train  Composite Score 16122.5
    Train  Label Accuracy [0.8305500518916878, 0.2940156114483955, 0.6839430894308943, 0.0]
    Train  Label F1 [0.7574753689282794, 0.31422833307585357, 0.77694400923559, 0]
    Train  Domain Accuracy [0.5757662560870811, 0.0, 0.41659505394824786]

    Val  Label Loss = 1589.5437774658203
    Val  Domain Loss = 2609.166301727295
    Val  Regularization Loss = 260.90932846069336
    Val  Total Loss = 4459.619407653809
    Val  Composite Score 2432.75
    Val  Label Accuracy [0.7319034852546917, 0.0106951871657754, 0.8466105888174171, 0.0]
    Val  Label F1 [0.6337782936738248, 0.020100502512562814, 0.8585047666833918, 0]
    Val  Domain Accuracy [0.013879485443466486, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 206916.08297348022
    Test  Domain Loss = 21938.642107963562
    Test  Regularization Loss = 2217.7292919158936
    Test  Total Loss = 231072.45437335968
    Test  Composite Score 5034.5
    Test  Label Accuracy [0.8124014713610089, 0.01291248206599713, 0.6279121863799283, 0.0]
    Test  Label F1 [0.5430277485072005, 0.025034770514603618, 0.7266364225534673, 0]
    Test  Domain Accuracy [0.012788730177468226, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 15548.55944442749
    Train  Domain Loss = 18455.624744415283
    Train  Regularization Loss = 1754.9777278900146
    Train  Total Loss = 35759.16191673279
    Train  Composite Score 16239.25
    Train  Label Accuracy [0.8442206325301205, 0.2929528246942341, 0.6848141695702671, 0.0]
    Train  Label F1 [0.7663519459990601, 0.3202801655523719, 0.7772285384742132, 0]
    Train  Domain Accuracy [0.5799675355676501, 0.0, 0.44533562494032275]

    Val  Label Loss = 2680.7069816589355
    Val  Domain Loss = 570.307731628418
    Val  Regularization Loss = 272.12021827697754
    Val  Total Loss = 3523.134931564331
    Val  Composite Score 2173.25
    Val  Label Accuracy [0.8525469168900804, 0.39037433155080214, 0.5957446808510638, 0.0]
    Val  Label F1 [0.5878003696857671, 0.3325740318906606, 0.7285930408472011, 0]
    Val  Domain Accuracy [0.9996614759647935, 0.0, 0.0]

    Test  Label Loss = 566040.9636888504
    Test  Domain Loss = 5500.990474700928
    Test  Regularization Loss = 2313.021855354309
    Test  Total Loss = 573854.9760189056
    Test  Composite Score 4361.75
    Test  Label Accuracy [0.905937992643195, 0.08608321377331421, 0.3756720430107527, 0.0]
    Test  Label F1 [0.5017462165308498, 0.1198801198801199, 0.5362110311750599, 0]
    Test  Domain Accuracy [0.9996852004879393, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 15618.814037322998
    Train  Domain Loss = 17716.074340820312
    Train  Regularization Loss = 1821.8815727233887
    Train  Total Loss = 35156.7699508667
    Train  Composite Score 16281.25
    Train  Label Accuracy [0.8504033014443819, 0.284452296819788, 0.6833623693379791, 0.0]
    Train  Label F1 [0.7698904644646345, 0.31849653808110784, 0.7696835908756439, 0]
    Train  Domain Accuracy [0.6184474362646806, 0.0, 0.4154492504535472]

    Val  Label Loss = 1611.6094188690186
    Val  Domain Loss = 1265.643175125122
    Val  Regularization Loss = 248.94853591918945
    Val  Total Loss = 3126.20112991333
    Val  Composite Score 2435.75
    Val  Label Accuracy [0.5522788203753352, 0.18181818181818182, 0.8990598713508164, 0.0]
    Val  Label F1 [0.5911047345767575, 0.23448275862068965, 0.8603219696969696, 0]
    Val  Domain Accuracy [0.9739336492890995, 0.0, 0.0]

    Test  Label Loss = 446217.77001190186
    Test  Domain Loss = 11684.685457706451
    Test  Regularization Loss = 2116.0625553131104
    Test  Total Loss = 460018.5180249214
    Test  Composite Score 5122.25
    Test  Label Accuracy [0.6988964792433, 0.04878048780487805, 0.6969086021505376, 0.0]
    Test  Label F1 [0.5322128851540616, 0.08395061728395062, 0.7478365384615385, 0]
    Test  Domain Accuracy [0.9757997875103294, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 15668.468551635742
    Train  Domain Loss = 19391.155975341797
    Train  Regularization Loss = 1861.090739250183
    Train  Total Loss = 36920.71526622772
    Train  Composite Score 16223.75
    Train  Label Accuracy [0.8459650778669183, 0.2902107998844932, 0.6835075493612079, 0.0]
    Train  Label F1 [0.7661666025558832, 0.32047193877551017, 0.7753623188405797, 0]
    Train  Domain Accuracy [0.5773894777045737, 0.0, 0.4388427384703523]

    Val  Label Loss = 1723.1129188537598
    Val  Domain Loss = 2140.3940811157227
    Val  Regularization Loss = 260.8264446258545
    Val  Total Loss = 4124.333444595337
    Val  Composite Score 2405.75
    Val  Label Accuracy [0.579088471849866, 0.4919786096256685, 0.8406729341909945, 0.0]
    Val  Label F1 [0.611032531824611, 0.36078431372549025, 0.8529116465863453, 0]
    Val  Domain Accuracy [0.37508463100880163, 0.0, 0.0]

    Test  Label Loss = 291575.3143520355
    Test  Domain Loss = 18548.848405838013
    Test  Regularization Loss = 2217.024779319763
    Test  Total Loss = 312341.1875371933
    Test  Composite Score 5009.0
    Test  Label Accuracy [0.7498686284813453, 0.1449067431850789, 0.6263440860215054, 0.0]
    Test  Label F1 [0.5388972809667674, 0.1816546762589928, 0.7243523316062176, 0]
    Test  Domain Accuracy [0.3076378231613741, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 15391.54402923584
    Train  Domain Loss = 17452.703155517578
    Train  Regularization Loss = 1706.0401902198792
    Train  Total Loss = 34550.2873749733
    Train  Composite Score 16241.25
    Train  Label Accuracy [0.8473036896877957, 0.2904243119266055, 0.6852497096399536, 0.0]
    Train  Label F1 [0.765830091068451, 0.31700829291190735, 0.7824933687002652, 0]
    Train  Domain Accuracy [0.5999236131003532, 0.0, 0.4275756707724625]

    Val  Label Loss = 1637.551368713379
    Val  Domain Loss = 2146.000514984131
    Val  Regularization Loss = 230.5066967010498
    Val  Total Loss = 4014.0585803985596
    Val  Composite Score 2446.25
    Val  Label Accuracy [0.5898123324396782, 0.2887700534759358, 0.8822365165759525, 0.0]
    Val  Label F1 [0.6085753803596127, 0.3292682926829268, 0.8626028059990324, 0]
    Val  Domain Accuracy [0.7417061611374408, 0.0, 0.0]

    Test  Label Loss = 316311.5194234848
    Test  Domain Loss = 18475.86584854126
    Test  Regularization Loss = 1959.3069219589233
    Test  Total Loss = 336746.692193985
    Test  Composite Score 5130.5
    Test  Label Accuracy [0.7472411981082502, 0.06169296987087518, 0.676747311827957, 0.0]
    Test  Label F1 [0.5463976945244956, 0.10336538461538461, 0.7467556544308491, 0]
    Test  Domain Accuracy [0.7421004997442254, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 15229.02812576294
    Train  Domain Loss = 18256.927810668945
    Train  Regularization Loss = 1723.4758100509644
    Train  Total Loss = 35209.43174648285
    Train  Composite Score 16312.5
    Train  Label Accuracy [0.8580223527183178, 0.27, 0.6948315911730546, 0.0]
    Train  Label F1 [0.7710115324056341, 0.3101411224154907, 0.7824736368838388, 0]
    Train  Domain Accuracy [0.6024061873388714, 0.0, 0.4219421369235176]

    Val  Label Loss = 1557.9919357299805
    Val  Domain Loss = 2127.839553833008
    Val  Regularization Loss = 244.78116989135742
    Val  Total Loss = 3930.6126594543457
    Val  Composite Score 2451.5
    Val  Label Accuracy [0.6447721179624665, 0.0481283422459893, 0.8876793666501732, 0.0]
    Val  Label F1 [0.6186495176848874, 0.0857142857142857, 0.8660391020999276, 0]
    Val  Domain Accuracy [0.2020988490182803, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 288688.8026590347
    Test  Domain Loss = 18414.721676826477
    Test  Regularization Loss = 2080.639944076538
    Test  Total Loss = 309184.16427993774
    Test  Composite Score 5126.0
    Test  Label Accuracy [0.7635312664214399, 0.027259684361549498, 0.6738351254480287, 0.0]
    Test  Label F1 [0.5437874251497006, 0.051771117166212535, 0.7473291925465839, 0]
    Test  Domain Accuracy [0.16877188840357296, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 14503.103672027588
    Train  Domain Loss = 17673.509147644043
    Train  Regularization Loss = 1629.1190967559814
    Train  Total Loss = 33805.73191642761
    Train  Composite Score 16508.5
    Train  Label Accuracy [0.8636449302676216, 0.3105049332559489, 0.6972996515679443, 0.0]
    Train  Label F1 [0.7802324096539395, 0.34158020750199525, 0.7933597621407336, 0]
    Train  Domain Accuracy [0.5726152964766542, 0.0, 0.44447627231929726]

    Val  Label Loss = 1585.8935737609863
    Val  Domain Loss = 1869.3446769714355
    Val  Regularization Loss = 225.69504261016846
    Val  Total Loss = 3680.9332933425903
    Val  Composite Score 2454.5
    Val  Label Accuracy [0.6715817694369973, 0.13368983957219252, 0.871845620979713, 0.0]
    Val  Label F1 [0.6369993642720915, 0.1851851851851852, 0.8669126691266914, 0]
    Val  Domain Accuracy [0.7034529451591063, 0.0, 0.0]

    Test  Label Loss = 114802.59924888611
    Test  Domain Loss = 17424.11750793457
    Test  Regularization Loss = 1918.4078621864319
    Test  Total Loss = 134145.1246190071
    Test  Composite Score 5033.75
    Test  Label Accuracy [0.7735155018392013, 0.058823529411764705, 0.6370967741935484, 0.0]
    Test  Label F1 [0.5373243292571638, 0.1, 0.7265295695491123, 0]
    Test  Domain Accuracy [0.4934875850942431, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 14595.338813781738
    Train  Domain Loss = 19508.070930480957
    Train  Regularization Loss = 1619.3890433311462
    Train  Total Loss = 35722.79878759384
    Train  Composite Score 16542.75
    Train  Label Accuracy [0.8715215545703235, 0.30257448654903096, 0.6977351916376306, 0.0]
    Train  Label F1 [0.7824356368563685, 0.3386757325562571, 0.7976101568334579, 0]
    Train  Domain Accuracy [0.5905662178936313, 0.0, 0.410961520099303]

    Val  Label Loss = 1590.6043319702148
    Val  Domain Loss = 725.8836288452148
    Val  Regularization Loss = 243.59564781188965
    Val  Total Loss = 2560.0836086273193
    Val  Composite Score 2464.25
    Val  Label Accuracy [0.5053619302949062, 0.4385026737967914, 0.9114299851558635, 0.0]
    Val  Label F1 [0.5867704280155642, 0.39709443099273606, 0.875059382422803, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 141164.6682434082
    Test  Domain Loss = 7388.355270385742
    Test  Regularization Loss = 2070.563006401062
    Test  Total Loss = 150623.586520195
    Test  Composite Score 5249.0
    Test  Label Accuracy [0.6190225959012087, 0.08034433285509325, 0.7638888888888888, 0.0]
    Test  Label F1 [0.5281327056713742, 0.1236203090507726, 0.7784499486360004, 0]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 14762.708824157715
    Train  Domain Loss = 18870.823848724365
    Train  Regularization Loss = 1709.67720413208
    Train  Total Loss = 35343.20987701416
    Train  Composite Score 16477.25
    Train  Label Accuracy [0.8642891107941036, 0.30793113180920123, 0.6999128919860628, 0.0]
    Train  Label F1 [0.7758569172322535, 0.34157795867251095, 0.8008305647840532, 0]
    Train  Domain Accuracy [0.5963907189916929, 0.0, 0.4131576434641459]

    Val  Label Loss = 2028.949670791626
    Val  Domain Loss = 2171.7969245910645
    Val  Regularization Loss = 236.22050285339355
    Val  Total Loss = 4436.967098236084
    Val  Composite Score 2348.0
    Val  Label Accuracy [0.7278820375335121, 0.5721925133689839, 0.7402276100940128, 0.0]
    Val  Label F1 [0.6468135795116141, 0.36518771331058014, 0.8213011254460608, 0]
    Val  Domain Accuracy [0.014556533513879486, 0.0, 0.0]

    Test  Label Loss = 146379.66054916382
    Test  Domain Loss = 18830.800844192505
    Test  Regularization Loss = 2007.8742742538452
    Test  Total Loss = 167218.33566761017
    Test  Composite Score 4633.25
    Test  Label Accuracy [0.8644245927482922, 0.14777618364418937, 0.46482974910394265, 0.0]
    Test  Label F1 [0.5274971941638609, 0.1769759450171821, 0.616916902036569, 0]
    Test  Domain Accuracy [0.001692047377326565, 0.0, 0.0]

  EPOCH 20
    Train  Label Loss = 14584.91361618042
    Train  Domain Loss = 17620.62114715576
    Train  Regularization Loss = 1557.5388269424438
    Train  Total Loss = 33763.073590278625
    Train  Composite Score 16500.75
    Train  Label Accuracy [0.8649109511178477, 0.3149628783552256, 0.6967189314750291, 0.0]
    Train  Label F1 [0.7795090715048025, 0.34517289938976686, 0.7973747611531112, 0]
    Train  Domain Accuracy [0.5572424329227538, 0.0, 0.4571755943855629]

    Val  Label Loss = 1568.0968208312988
    Val  Domain Loss = 1944.3514785766602
    Val  Regularization Loss = 206.73316955566406
    Val  Total Loss = 3719.181468963623
    Val  Composite Score 2484.5
    Val  Label Accuracy [0.6662198391420912, 0.24064171122994651, 0.8837209302325582, 0.0]
    Val  Label F1 [0.64629388816645, 0.3, 0.8776412776412776, 0]
    Val  Domain Accuracy [0.8825321597833446, 0.0, 0.0]

    Test  Label Loss = 141801.83460617065
    Test  Domain Loss = 16970.23920726776
    Test  Regularization Loss = 1757.2319412231445
    Test  Total Loss = 160529.30575466156
    Test  Composite Score 5074.25
    Test  Label Accuracy [0.7619548081975828, 0.054519368723098996, 0.6547939068100358, 0.0]
    Test  Label F1 [0.5409438537586271, 0.09440993788819876, 0.7342376287364983, 0]
    Test  Domain Accuracy [0.8642427104237989, 0.0, 0.0]

  EPOCH 21
    Train  Label Loss = 14938.801685333252
    Train  Domain Loss = 18291.3307762146
    Train  Regularization Loss = 1547.956464767456
    Train  Total Loss = 34778.08892631531
    Train  Composite Score 16456.75
    Train  Label Accuracy [0.8563369687852577, 0.3082992402104033, 0.6991869918699187, 0.0]
    Train  Label F1 [0.7790608160123171, 0.33792440743113394, 0.7888615888615889, 0]
    Train  Domain Accuracy [0.6011649002196123, 0.0, 0.42499761290938604]

    Val  Label Loss = 1590.6622161865234
    Val  Domain Loss = 1933.4535751342773
    Val  Regularization Loss = 220.69331645965576
    Val  Total Loss = 3744.8091077804565
    Val  Composite Score 2455.25
    Val  Label Accuracy [0.4959785522788204, 0.0427807486631016, 0.9455714992577932, 0.0]
    Val  Label F1 [0.578125, 0.07692307692307693, 0.8647058823529412, 0]
    Val  Domain Accuracy [0.9861205145565335, 0.0, 0.0]

    Test  Label Loss = 261721.7820739746
    Test  Domain Loss = 16825.88035106659
    Test  Regularization Loss = 1875.893189907074
    Test  Total Loss = 280423.5556149483
    Test  Composite Score 5269.25
    Test  Label Accuracy [0.4634787178139779, 0.03012912482065997, 0.8440860215053764, 0.0]
    Test  Label F1 [0.46543535620052773, 0.05722070844686649, 0.7846730528946272, 0]
    Test  Domain Accuracy [0.9826860268366584, 0.0, 0.0]

  EPOCH 22
    Train  Label Loss = 14368.501358032227
    Train  Domain Loss = 17658.738216400146
    Train  Regularization Loss = 1480.6822800636292
    Train  Total Loss = 33507.921854496
    Train  Composite Score 16586.5
    Train  Label Accuracy [0.8660309667673716, 0.3190998268897865, 0.7061556329849012, 0.0]
    Train  Label F1 [0.7841846548407779, 0.34961277066540225, 0.8012519561815337, 0]
    Train  Domain Accuracy [0.5950539482478755, 0.0, 0.420318915306025]

    Val  Label Loss = 1552.0285205841064
    Val  Domain Loss = 1757.2484436035156
    Val  Regularization Loss = 206.41279220581055
    Val  Total Loss = 3515.6897563934326
    Val  Composite Score 2429.75
    Val  Label Accuracy [0.6836461126005362, 0.0962566844919786, 0.8545274616526473, 0.0]
    Val  Label F1 [0.624235006119951, 0.14754098360655735, 0.8570719602977668, 0]
    Val  Domain Accuracy [0.997968855788761, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 181218.00506973267
    Test  Domain Loss = 15323.856221199036
    Test  Regularization Loss = 1754.5087337493896
    Test  Total Loss = 198296.3700246811
    Test  Composite Score 5102.0
    Test  Label Accuracy [0.7682606410930111, 0.02582496413199426, 0.6648745519713262, 0.0]
    Test  Label F1 [0.5437976566858843, 0.04891304347826087, 0.7406113537117904, 0]
    Test  Domain Accuracy [0.9992917010978632, 0.0, 0.0]

  EPOCH 23
    Train  Label Loss = 14276.056396484375
    Train  Domain Loss = 18034.150943756104
    Train  Regularization Loss = 1435.9745659828186
    Train  Total Loss = 33746.1819062233
    Train  Composite Score 16691.25
    Train  Label Accuracy [0.8783809166040571, 0.3085043988269795, 0.7089140534262486, 0.0]
    Train  Label F1 [0.7902830587241234, 0.3493275776191267, 0.8035214744117162, 0]
    Train  Domain Accuracy [0.5986823259810943, 0.0, 0.42471116203571085]

    Val  Label Loss = 1684.4966354370117
    Val  Domain Loss = 1894.1647605895996
    Val  Regularization Loss = 207.65111446380615
    Val  Total Loss = 3786.3125104904175
    Val  Composite Score 2454.5
    Val  Label Accuracy [0.47050938337801607, 0.17647058823529413, 0.9421078673923801, 0.0]
    Val  Label F1 [0.5679611650485437, 0.23741007194244607, 0.866636322257624, 0]
    Val  Domain Accuracy [0.7979011509817197, 0.0, 0.0]

    Test  Label Loss = 494451.9094390869
    Test  Domain Loss = 16916.92499256134
    Test  Regularization Loss = 1765.0344729423523
    Test  Total Loss = 513133.8689045906
    Test  Composite Score 5247.5
    Test  Label Accuracy [0.4929059379926432, 0.03443328550932568, 0.8243727598566308, 0.0]
    Test  Label F1 [0.47723225642330197, 0.06258148631029986, 0.7804878048780488, 0]
    Test  Domain Accuracy [0.7168378389013497, 0.0, 0.0]

  EPOCH 24
    Train  Label Loss = 14204.358795166016
    Train  Domain Loss = 17932.09197998047
    Train  Regularization Loss = 1424.9113101959229
    Train  Total Loss = 33561.36208534241
    Train  Composite Score 16678.25
    Train  Label Accuracy [0.8759835144248782, 0.3095801301005322, 0.7058652729384437, 0.0]
    Train  Label F1 [0.7912013536379019, 0.33856103476151983, 0.8069039913700108, 0]
    Train  Domain Accuracy [0.5920939558865654, 0.0, 0.42929437601451353]

    Val  Label Loss = 1547.6580829620361
    Val  Domain Loss = 2072.694652557373
    Val  Regularization Loss = 197.91498184204102
    Val  Total Loss = 3818.26771736145
    Val  Composite Score 2439.5
    Val  Label Accuracy [0.7117962466487936, 0.0427807486631016, 0.855517070757051, 0.0]
    Val  Label F1 [0.6374549819927972, 0.07373271889400922, 0.8591304347826086, 0]
    Val  Domain Accuracy [0.44414353419092756, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 313603.19098854065
    Test  Domain Loss = 18220.91415977478
    Test  Regularization Loss = 1682.2773456573486
    Test  Total Loss = 333506.3824939728
    Test  Composite Score 5003.0
    Test  Label Accuracy [0.8276405675249606, 0.014347202295552367, 0.6117831541218638, 0.0]
    Test  Label F1 [0.5457380457380457, 0.027816411682892905, 0.7152023045698572, 0]
    Test  Domain Accuracy [0.252036359343643, 0.0, 0.0]

  EPOCH 25
    Train  Label Loss = 14069.691974639893
    Train  Domain Loss = 17515.298347473145
    Train  Regularization Loss = 1335.7717633247375
    Train  Total Loss = 32920.762085437775
    Train  Composite Score 16693.75
    Train  Label Accuracy [0.8773522458628842, 0.3155325868504163, 0.7123983739837398, 0.0]
    Train  Label F1 [0.7893818862466501, 0.3530923694779116, 0.808601796160501, 0]
    Train  Domain Accuracy [0.5725198128520959, 0.0, 0.4503962570419173]

    Val  Label Loss = 1550.2002716064453
    Val  Domain Loss = 1938.937271118164
    Val  Regularization Loss = 185.71190357208252
    Val  Total Loss = 3674.849446296692
    Val  Composite Score 2467.25
    Val  Label Accuracy [0.599195710455764, 0.0213903743315508, 0.917367639782286, 0.0]
    Val  Label F1 [0.6157024793388429, 0.03980099502487562, 0.87144535840188, 0]
    Val  Domain Accuracy [0.946513202437373, 0.0, 0.0]

    Test  Label Loss = 159665.29630851746
    Test  Domain Loss = 16869.02096748352
    Test  Regularization Loss = 1578.5511803627014
    Test  Total Loss = 178112.86845636368
    Test  Composite Score 5210.75
    Test  Label Accuracy [0.6636889122438255, 0.020086083213773313, 0.742831541218638, 0.0]
    Test  Label F1 [0.5346031746031746, 0.03899721448467966, 0.763615428900403, 0]
    Test  Domain Accuracy [0.9408176917325778, 0.0, 0.0]

  EPOCH 26
    Train  Label Loss = 13955.872344970703
    Train  Domain Loss = 17469.067081451416
    Train  Regularization Loss = 1287.0730996131897
    Train  Total Loss = 32712.01252603531
    Train  Composite Score 16759.25
    Train  Label Accuracy [0.8810107486328493, 0.31315179606025495, 0.7179152148664344, 0.0]
    Train  Label F1 [0.7931751623445524, 0.35332570681483905, 0.8111211350775036, 0]
    Train  Domain Accuracy [0.5658359591330087, 0.0, 0.4627136446099494]

    Val  Label Loss = 1602.5495338439941
    Val  Domain Loss = 2299.579746246338
    Val  Regularization Loss = 185.84027767181396
    Val  Total Loss = 4087.969557762146
    Val  Composite Score 2450.0
    Val  Label Accuracy [0.5375335120643432, 0.16042780748663102, 0.9158832261256804, 0.0]
    Val  Label F1 [0.5949554896142434, 0.21978021978021978, 0.8635409377186845, 0]
    Val  Domain Accuracy [0.15538253215978334, 0.0, 0.0]

    Test  Label Loss = 202359.45468902588
    Test  Domain Loss = 19633.541338920593
    Test  Regularization Loss = 1579.6423602104187
    Test  Total Loss = 223572.6383881569
    Test  Composite Score 5267.75
    Test  Label Accuracy [0.5937992643194955, 0.06599713055954089, 0.7824820788530465, 0.0]
    Test  Label F1 [0.5169258920402562, 0.11557788944723618, 0.7796875, 0]
    Test  Domain Accuracy [0.09865029709203951, 0.0, 0.0]

  EPOCH 27
    Train  Label Loss = 13840.69787979126
    Train  Domain Loss = 17755.367095947266
    Train  Regularization Loss = 1324.2775197029114
    Train  Total Loss = 32920.34249544144
    Train  Composite Score 16760.25
    Train  Label Accuracy [0.8871602624179944, 0.30785123966942146, 0.7065911730545877, 0.0]
    Train  Label F1 [0.7954287634973319, 0.34818895009180434, 0.8066627993701833, 0]
    Train  Domain Accuracy [0.6020242528406379, 0.0, 0.43053566313377256]

    Val  Label Loss = 1577.2528266906738
    Val  Domain Loss = 1768.0216178894043
    Val  Regularization Loss = 186.55230045318604
    Val  Total Loss = 3531.826745033264
    Val  Composite Score 2446.25
    Val  Label Accuracy [0.6367292225201072, 0.22459893048128343, 0.8708560118753093, 0.0]
    Val  Label F1 [0.6245890861275476, 0.29065743944636674, 0.8589555880917522, 0]
    Val  Domain Accuracy [0.9779959377115776, 0.0, 0.0]

    Test  Label Loss = 156733.95689964294
    Test  Domain Loss = 15986.36534690857
    Test  Regularization Loss = 1585.6945538520813
    Test  Total Loss = 174306.0168004036
    Test  Composite Score 5089.25
    Test  Label Accuracy [0.7756174461376774, 0.04447632711621234, 0.6550179211469535, 0.0]
    Test  Label F1 [0.5446494464944649, 0.08020698576972833, 0.7369880277252678, 0]
    Test  Domain Accuracy [0.9626175579427851, 0.0, 0.0]

  EPOCH 28
    Train  Label Loss = 13728.127521514893
    Train  Domain Loss = 17594.307250976562
    Train  Regularization Loss = 1273.8936429023743
    Train  Total Loss = 32596.32841539383
    Train  Composite Score 16840.25
    Train  Label Accuracy [0.8906791569086651, 0.3221992314513745, 0.7083333333333334, 0.0]
    Train  Label F1 [0.80016831474858, 0.3591433278418451, 0.8103978074910723, 0]
    Train  Domain Accuracy [0.5780578630764824, 0.0, 0.45020528979280056]

    Val  Label Loss = 1544.907356262207
    Val  Domain Loss = 1983.5816497802734
    Val  Regularization Loss = 176.7504644393921
    Val  Total Loss = 3705.2394704818726
    Val  Composite Score 2448.5
    Val  Label Accuracy [0.6501340482573726, 0.1497326203208556, 0.8743196437407225, 0.0]
    Val  Label F1 [0.6282383419689118, 0.21621621621621623, 0.8609013398294761, 0]
    Val  Domain Accuracy [0.7125930941096817, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 153348.5465450287
    Test  Domain Loss = 17456.40002632141
    Test  Regularization Loss = 1502.3789477348328
    Test  Total Loss = 172307.32551908493
    Test  Composite Score 5102.75
    Test  Label Accuracy [0.7740409879138203, 0.04447632711621234, 0.6597222222222222, 0.0]
    Test  Label F1 [0.5465677179962894, 0.07908163265306124, 0.7405079205431229, 0]
    Test  Domain Accuracy [0.5899736355408649, 0.0, 0.0]

  EPOCH 29
    Train  Label Loss = 13728.981178283691
    Train  Domain Loss = 17476.36870574951
    Train  Regularization Loss = 1213.2175917625427
    Train  Total Loss = 32418.567475795746
    Train  Composite Score 16777.25
    Train  Label Accuracy [0.8862451417195942, 0.32459390139640926, 0.7118176538908246, 0.0]
    Train  Label F1 [0.7947126827609656, 0.3622773536895674, 0.812696834079231, 0]
    Train  Domain Accuracy [0.5773894777045737, 0.0, 0.45898978325217227]

    Val  Label Loss = 1615.0343704223633
    Val  Domain Loss = 2120.087074279785
    Val  Regularization Loss = 170.39461612701416
    Val  Total Loss = 3905.5160608291626
    Val  Composite Score 2455.25
    Val  Label Accuracy [0.5442359249329759, 0.06951871657754011, 0.9252845126175161, 0.0]
    Val  Label F1 [0.5961820851688693, 0.11353711790393012, 0.8663423673847579, 0]
    Val  Domain Accuracy [0.25998645903859174, 0.0, 0.0]

    Test  Label Loss = 148284.36442947388
    Test  Domain Loss = 18652.95324897766
    Test  Regularization Loss = 1448.3542370796204
    Test  Total Loss = 168385.67191553116
    Test  Composite Score 5243.0
    Test  Label Accuracy [0.5633210719915922, 0.03156384505021521, 0.7934587813620072, 0.0]
    Test  Label F1 [0.5041147425346814, 0.058666666666666666, 0.7763287671232878, 0]
    Test  Domain Accuracy [0.08334317081808523, 0.0, 0.0]
