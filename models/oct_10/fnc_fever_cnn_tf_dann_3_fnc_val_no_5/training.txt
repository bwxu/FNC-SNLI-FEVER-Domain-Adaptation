Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
Loading CNN vectors...
SIZE_TRAIN = 94441
SIZE_VAL = 2954
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 18666.51393508911
    Train  Domain Loss = 16306.707069396973
    Train  Regularization Loss = 2449.9998803138733
    Train  Total Loss = 37423.22088479996
    Train  Composite Score 15393.5
    Train  Label Accuracy [0.806150107486681, 0.16493003870199463, 0.6366144018583043, 0.0]
    Train  Label F1 [0.7240901649666289, 0.19821109123434702, 0.7064035440998792, 0]
    Train  Domain Accuracy [0.8096056526305738, 0.0, 0.6253222572328846]

    Val  Label Loss = 1952.9944343566895
    Val  Domain Loss = 1239.0787467956543
    Val  Regularization Loss = 348.44801902770996
    Val  Total Loss = 3540.5212001800537
    Val  Composite Score 2289.5
    Val  Label Accuracy [0.7533512064343163, 0.026737967914438502, 0.7427016328550222, 0.0]
    Val  Label F1 [0.5720101781170482, 0.04926108374384236, 0.8026737967914438, 0]
    Val  Domain Accuracy [0.7718348002708192, 0.0, 0.0]

    Test  Label Loss = 215187.893119812
    Test  Domain Loss = 14497.79833984375
    Test  Regularization Loss = 2961.8081617355347
    Test  Total Loss = 232647.4996213913
    Test  Composite Score 4781.75
    Test  Label Accuracy [0.8954282711508145, 0.0014347202295552368, 0.5188172043010753, 0.0]
    Test  Label F1 [0.5310065440947336, 0.0028653295128939827, 0.6605818596691386, 0]
    Test  Domain Accuracy [0.6675717152638413, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 18681.937953948975
    Train  Domain Loss = 42611.70650482178
    Train  Regularization Loss = 2388.1659936904907
    Train  Total Loss = 63681.81045246124
    Train  Composite Score 15447.0
    Train  Label Accuracy [0.7970483173528858, 0.23391812865497075, 0.633855981416957, 0.0]
    Train  Label F1 [0.7270310825294748, 0.2554686252594603, 0.7150929489804274, 0]
    Train  Domain Accuracy [0.6165377637735129, 0.0, 0.48792132149336387]

    Val  Label Loss = 1798.4427680969238
    Val  Domain Loss = 6525.980079650879
    Val  Regularization Loss = 341.48789405822754
    Val  Total Loss = 8665.91074180603
    Val  Composite Score 2429.75
    Val  Label Accuracy [0.5120643431635389, 0.3850267379679144, 0.8911429985155863, 0.0]
    Val  Label F1 [0.5836516424751719, 0.36734693877551017, 0.8561920608509627, 0]
    Val  Domain Accuracy [0.03419092755585647, 0.0, 0.0]

    Test  Label Loss = 134643.51490974426
    Test  Domain Loss = 57563.38315963745
    Test  Regularization Loss = 2902.647099494934
    Test  Total Loss = 195109.54516887665
    Test  Composite Score 5195.0
    Test  Label Accuracy [0.6631634261692065, 0.06886657101865136, 0.7307347670250897, 0.0]
    Test  Label F1 [0.5324894514767933, 0.1023454157782516, 0.7720710059171599, 0]
    Test  Domain Accuracy [0.013772478652658088, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 33155.7233505249
    Train  Domain Loss = 200029.2355041504
    Train  Regularization Loss = 2827.758575439453
    Train  Total Loss = 236012.71743011475
    Train  Composite Score 14172.25
    Train  Label Accuracy [0.7164122499288897, 0.2307035032754201, 0.525842044134727, 0.0]
    Train  Label F1 [0.6634471858811134, 0.24545454545454543, 0.5892784511510616, 0]
    Train  Domain Accuracy [0.5649766065119832, 0.0, 0.3879499665807314]

    Val  Label Loss = 2085.9709701538086
    Val  Domain Loss = 3.826615099455921e-05
    Val  Regularization Loss = 446.9502925872803
    Val  Total Loss = 2532.92130100724
    Val  Composite Score 2294.75
    Val  Label Accuracy [0.6796246648793566, 0.37967914438502676, 0.7407224146462148, 0.0]
    Val  Label F1 [0.5874855156431055, 0.31696428571428575, 0.8018211033743975, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 789806.3412246704
    Test  Domain Loss = 0.00450047753332683
    Test  Regularization Loss = 3799.0774869918823
    Test  Total Loss = 793605.4232121399
    Test  Composite Score 4681.25
    Test  Label Accuracy [0.8754598003152917, 0.04591104734576758, 0.49036738351254483, 0.0]
    Test  Label F1 [0.5243940824677368, 0.07111111111111111, 0.6368926389292989, 0]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 49747.48181915283
    Train  Domain Loss = 106441.04859924316
    Train  Regularization Loss = 3192.32742023468
    Train  Total Loss = 159380.85783863068
    Train  Composite Score 13647.0
    Train  Label Accuracy [0.6864334873196946, 0.21529991306867574, 0.47444831591173053, 0.0]
    Train  Label F1 [0.6428003884523704, 0.2170927684441198, 0.5375442059379882, 0]
    Train  Domain Accuracy [0.5750978707151724, 0.0, 0.3796428912441516]

    Val  Label Loss = 5394.883880615234
    Val  Domain Loss = 26.25834012031555
    Val  Regularization Loss = 431.12889289855957
    Val  Total Loss = 5852.2711136341095
    Val  Composite Score 2254.25
    Val  Label Accuracy [0.0, 0.0, 1.0, 0.0]
    Val  Label F1 [0, 0, 0.812462311557789, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 1456954.588191986
    Test  Domain Loss = 318.54759407043457
    Test  Regularization Loss = 3664.5955896377563
    Test  Total Loss = 1460937.7313756943
    Test  Composite Score 5114.0
    Test  Label Accuracy [0.0, 0.0028694404591104736, 0.9995519713261649, 0.0]
    Test  Label F1 [0, 0.005689900426742532, 0.7745183127929179, 0]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 28742.567306518555
    Train  Domain Loss = 72964.84785461426
    Train  Regularization Loss = 3197.114921569824
    Train  Total Loss = 104904.53008270264
    Train  Composite Score 14717.5
    Train  Label Accuracy [0.7496233521657251, 0.23734729493891799, 0.5686701509872242, 0.0]
    Train  Label F1 [0.6922307725751056, 0.24961762006729887, 0.6423944239442395, 0]
    Train  Domain Accuracy [0.5686049842452019, 0.0, 0.39329704955600114]

    Val  Label Loss = 3078.965679168701
    Val  Domain Loss = 188.62824201583862
    Val  Regularization Loss = 487.2352981567383
    Val  Total Loss = 3754.829219341278
    Val  Composite Score 2252.0
    Val  Label Accuracy [0.022788203753351208, 0.45454545454545453, 0.9480455220188025, 0.0]
    Val  Label F1 [0.04456094364351245, 0.28716216216216217, 0.8416428728311003, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 1665173.5454864502
    Test  Domain Loss = 2119.158887863159
    Test  Regularization Loss = 4141.500034332275
    Test  Total Loss = 1671434.2044086456
    Test  Composite Score 4988.0
    Test  Label Accuracy [0.0, 0.40889526542324245, 0.8985215053763441, 0.0]
    Test  Label F1 [0, 0.2906680265170831, 0.781718963165075, 0]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 35228.327056884766
    Train  Domain Loss = 66201.91731262207
    Train  Regularization Loss = 3676.6176471710205
    Train  Total Loss = 105106.86201667786
    Train  Composite Score 14129.25
    Train  Label Accuracy [0.7044149486962251, 0.23260553129548764, 0.528164924506388, 0.0]
    Train  Label F1 [0.6615099009900989, 0.23002734993522383, 0.5997362347510716, 0]
    Train  Domain Accuracy [0.5631624176453738, 0.0, 0.39119640981571663]

    Val  Label Loss = 1836.2451210021973
    Val  Domain Loss = 20829.548461914062
    Val  Regularization Loss = 568.9290618896484
    Val  Total Loss = 23234.72264480591
    Val  Composite Score 2382.5
    Val  Label Accuracy [0.6916890080428955, 0.0, 0.8292924294903513, 0.0]
    Val  Label F1 [0.5954991344489324, 0, 0.8405215646940822, 0]
    Val  Domain Accuracy [0.0, 0.0, 0.0]

    Test  Label Loss = 2248701.7416591644
    Test  Domain Loss = 164558.0270690918
    Test  Regularization Loss = 4835.897026062012
    Test  Total Loss = 2418095.6657543182
    Test  Composite Score 4993.25
    Test  Label Accuracy [0.8113504992117709, 0.0, 0.6180555555555556, 0.0]
    Test  Label F1 [0.5358320319278154, 0, 0.7196139801773606, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 40166.841232299805
    Train  Domain Loss = 50954.33846282959
    Train  Regularization Loss = 3797.383539199829
    Train  Total Loss = 94918.56323432922
    Train  Composite Score 14169.25
    Train  Label Accuracy [0.7065998487140696, 0.2148190695002872, 0.5468931475029036, 0.0]
    Train  Label F1 [0.6612396584524179, 0.22391857506361323, 0.6088080808080809, 0]
    Train  Domain Accuracy [0.5592475890384799, 0.0, 0.41057958560106944]

    Val  Label Loss = 2727.097625732422
    Val  Domain Loss = 345.79188442230225
    Val  Regularization Loss = 500.064697265625
    Val  Total Loss = 3572.954207420349
    Val  Composite Score 2327.75
    Val  Label Accuracy [0.14343163538873996, 0.11229946524064172, 0.9851558634339436, 0.0]
    Val  Label F1 [0.24513172966781216, 0.16535433070866143, 0.8328801505961095, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 2415418.5049972534
    Test  Domain Loss = 3823.850914001465
    Test  Regularization Loss = 4250.5499267578125
    Test  Total Loss = 2423492.9058380127
    Test  Composite Score 5158.25
    Test  Label Accuracy [0.043615344193378876, 0.08464849354375897, 0.9814068100358423, 0.0]
    Test  Label F1 [0.08077858880778589, 0.12896174863387977, 0.7852661767341818, 0]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 29553.306442260742
    Train  Domain Loss = 29056.672653198242
    Train  Regularization Loss = 3114.417300224304
    Train  Total Loss = 61724.39639568329
    Train  Composite Score 14710.5
    Train  Label Accuracy [0.7337919336600075, 0.2321532211259431, 0.593931475029036, 0.0]
    Train  Label F1 [0.6851737791465023, 0.23788284269997026, 0.6653114327532933, 0]
    Train  Domain Accuracy [0.5702282058626945, 0.0, 0.42814857251981286]

    Val  Label Loss = 2668.1942405700684
    Val  Domain Loss = 2561.427131652832
    Val  Regularization Loss = 376.7593288421631
    Val  Total Loss = 5606.3807010650635
    Val  Composite Score 2150.75
    Val  Label Accuracy [0.8954423592493298, 0.0, 0.6011875309252845, 0.0]
    Val  Label F1 [0.5592298032649644, 0, 0.7292917166866747, 0]
    Val  Domain Accuracy [0.14454976303317535, 0.0, 0.0]

    Test  Label Loss = 1365227.0377426147
    Test  Domain Loss = 23254.153022766113
    Test  Regularization Loss = 3202.4542951583862
    Test  Total Loss = 1391683.6450605392
    Test  Composite Score 4311.5
    Test  Label Accuracy [0.955333683657383, 0.0, 0.35304659498207885, 0.0]
    Test  Label F1 [0.49801397068894676, 0, 0.5141924959216966, 0]
    Test  Domain Accuracy [0.044976980285680555, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 18282.24778366089
    Train  Domain Loss = 19204.001110076904
    Train  Regularization Loss = 2402.1931324005127
    Train  Total Loss = 39888.442026138306
    Train  Composite Score 15652.5
    Train  Label Accuracy [0.8012416517731163, 0.26145316603443247, 0.6522938443670151, 0.0]
    Train  Label F1 [0.7327942188575362, 0.2774852895633323, 0.7408689916728503, 0]
    Train  Domain Accuracy [0.5296476654253796, 0.0, 0.4633820299818581]

    Val  Label Loss = 1656.0852165222168
    Val  Domain Loss = 2128.7966690063477
    Val  Regularization Loss = 320.10077476501465
    Val  Total Loss = 4104.982660293579
    Val  Composite Score 2416.25
    Val  Label Accuracy [0.5871313672922251, 0.10695187165775401, 0.880257298367145, 0.0]
    Val  Label F1 [0.5898989898989899, 0.15444015444015444, 0.8544668587896255, 0]
    Val  Domain Accuracy [0.5368991198375085, 0.0, 0.0]

    Test  Label Loss = 632247.356798172
    Test  Domain Loss = 18931.922174453735
    Test  Regularization Loss = 2720.8565855026245
    Test  Total Loss = 653900.1355581284
    Test  Composite Score 5111.0
    Test  Label Accuracy [0.767209668943773, 0.020086083213773313, 0.6689068100358423, 0.0]
    Test  Label F1 [0.5418444980515865, 0.037037037037037035, 0.7480896905925092, 0]
    Test  Domain Accuracy [0.3883838980049581, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 17020.92779159546
    Train  Domain Loss = 32437.661109924316
    Train  Regularization Loss = 2194.735231399536
    Train  Total Loss = 51653.32413291931
    Train  Composite Score 15883.0
    Train  Label Accuracy [0.8215057806184792, 0.24510090669786488, 0.6743612078977933, 0.0]
    Train  Label F1 [0.7487364002398699, 0.271285205568145, 0.7562067562067563, 0]
    Train  Domain Accuracy [0.5601069416595054, 0.0, 0.4360737133581591]

    Val  Label Loss = 1996.9610614776611
    Val  Domain Loss = 12355.73583984375
    Val  Regularization Loss = 347.33004570007324
    Val  Total Loss = 14700.026947021484
    Val  Composite Score 2287.25
    Val  Label Accuracy [0.8310991957104558, 0.053475935828877004, 0.7100445324096981, 0.0]
    Val  Label F1 [0.5958673714560307, 0.09478672985781991, 0.7936946902654867, 0]
    Val  Domain Accuracy [0.0, 0.0, 0.0]

    Test  Label Loss = 678652.5963020325
    Test  Domain Loss = 95812.05472564697
    Test  Regularization Loss = 2952.3053884506226
    Test  Total Loss = 777416.9564161301
    Test  Composite Score 4622.0
    Test  Label Accuracy [0.9038360483447189, 0.007173601147776184, 0.46662186379928317, 0.0]
    Test  Label F1 [0.5154330236739586, 0.014064697609001404, 0.6178258935192051, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 26209.29639816284
    Train  Domain Loss = 35095.768547058105
    Train  Regularization Loss = 2604.514977455139
    Train  Total Loss = 63909.57992267609
    Train  Composite Score 14799.25
    Train  Label Accuracy [0.7381487727187559, 0.2556146572104019, 0.5903019744483159, 0.0]
    Train  Label F1 [0.6944603587325372, 0.25174621653084983, 0.6693004115226338, 0]
    Train  Domain Accuracy [0.5644037047646329, 0.0, 0.40217702663993127]

    Val  Label Loss = 1713.7043991088867
    Val  Domain Loss = 2992.3821144104004
    Val  Regularization Loss = 370.2561664581299
    Val  Total Loss = 5076.342679977417
    Val  Composite Score 2435.75
    Val  Label Accuracy [0.5697050938337802, 0.0, 0.909450766947056, 0.0]
    Val  Label F1 [0.5862068965517241, 0, 0.8606883633809413, 0]
    Val  Domain Accuracy [0.0, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 990053.1353225708
    Test  Domain Loss = 25223.435978889465
    Test  Regularization Loss = 3147.177414894104
    Test  Total Loss = 1018423.7487163544
    Test  Composite Score 5268.5
    Test  Label Accuracy [0.6552811350499211, 0.0014347202295552368, 0.7665770609318996, 0.0]
    Test  Label F1 [0.5332478084242035, 0.002857142857142857, 0.7820820477659696, 0]
    Test  Domain Accuracy [0.00011804981702278361, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 20344.764514923096
    Train  Domain Loss = 19431.4979057312
    Train  Regularization Loss = 2462.6296758651733
    Train  Total Loss = 42238.89209651947
    Train  Composite Score 15318.75
    Train  Label Accuracy [0.773940937824323, 0.25845620121422375, 0.6364692218350755, 0.0]
    Train  Label F1 [0.7170141165158865, 0.2640673460345591, 0.7230743856176809, 0]
    Train  Domain Accuracy [0.5839778477991024, 0.0, 0.4409433782106369]

    Val  Label Loss = 2064.25532913208
    Val  Domain Loss = 3571.92179107666
    Val  Regularization Loss = 359.9799156188965
    Val  Total Loss = 5996.157035827637
    Val  Composite Score 2420.75
    Val  Label Accuracy [0.37935656836461124, 0.0, 0.9698169223156853, 0.0]
    Val  Label F1 [0.5031111111111112, 0, 0.8529155787641428, 0]
    Val  Domain Accuracy [0.002708192281651997, 0.0, 0.0]

    Test  Label Loss = 860962.7745685577
    Test  Domain Loss = 29683.236696243286
    Test  Regularization Loss = 3059.82928276062
    Test  Total Loss = 893705.8405475616
    Test  Composite Score 5276.0
    Test  Label Accuracy [0.3510246978455071, 0.0, 0.8987455197132617, 0.0]
    Test  Label F1 [0.4073170731707318, 0, 0.7904639936952024, 0]
    Test  Domain Accuracy [0.0012198481092354308, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 18414.453426361084
    Train  Domain Loss = 20334.41367340088
    Train  Regularization Loss = 2392.847062110901
    Train  Total Loss = 41141.714161872864
    Train  Composite Score 15594.5
    Train  Label Accuracy [0.7965926204819277, 0.26499708794408855, 0.6496806039488966, 0.0]
    Train  Label F1 [0.7314290652953631, 0.28012929044174234, 0.7371108548838742, 0]
    Train  Domain Accuracy [0.594672013749642, 0.0, 0.41268022534135396]

    Val  Label Loss = 1939.6674938201904
    Val  Domain Loss = 1918.6653213500977
    Val  Regularization Loss = 300.9942054748535
    Val  Total Loss = 4159.327020645142
    Val  Composite Score 2336.75
    Val  Label Accuracy [0.675603217158177, 0.4919786096256685, 0.7595249876298862, 0.0]
    Val  Label F1 [0.6043165467625898, 0.3658051689860835, 0.8215145838908214, 0]
    Val  Domain Accuracy [0.5978334461746784, 0.0, 0.0]

    Test  Label Loss = 660345.8199415207
    Test  Domain Loss = 17298.02136516571
    Test  Regularization Loss = 2558.450746536255
    Test  Total Loss = 680202.2920532227
    Test  Composite Score 4864.25
    Test  Label Accuracy [0.8166053599579611, 0.12195121951219512, 0.5582437275985663, 0.0]
    Test  Label F1 [0.5428820960698689, 0.148471615720524, 0.6866905483604299, 0]
    Test  Domain Accuracy [0.5023806713099594, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 15494.216781616211
    Train  Domain Loss = 18415.93128967285
    Train  Regularization Loss = 1991.017876625061
    Train  Total Loss = 35901.16594791412
    Train  Composite Score 16271.75
    Train  Label Accuracy [0.8526542862502344, 0.2673733804475854, 0.6868466898954704, 0.0]
    Train  Label F1 [0.7701300351560845, 0.29834072613767043, 0.778957767349963, 0]
    Train  Domain Accuracy [0.5947674973742003, 0.0, 0.4333046882459658]

    Val  Label Loss = 1592.1808032989502
    Val  Domain Loss = 1911.4147186279297
    Val  Regularization Loss = 261.754732131958
    Val  Total Loss = 3765.350254058838
    Val  Composite Score 2437.25
    Val  Label Accuracy [0.6166219839142091, 0.06417112299465241, 0.8871845620979713, 0.0]
    Val  Label F1 [0.6044678055190539, 0.10344827586206898, 0.8632643235435725, 0]
    Val  Domain Accuracy [0.8476641841570751, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 273168.76610183716
    Test  Domain Loss = 16794.779331207275
    Test  Regularization Loss = 2224.915223121643
    Test  Total Loss = 292188.4606561661
    Test  Composite Score 5182.25
    Test  Label Accuracy [0.697320021019443, 0.035868005738880916, 0.7175179211469535, 0.0]
    Test  Label F1 [0.534757203304453, 0.06605019815059444, 0.7618934348239772, 0]
    Test  Domain Accuracy [0.8469680871994648, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 17053.297527313232
    Train  Domain Loss = 20032.367485046387
    Train  Regularization Loss = 2037.1181592941284
    Train  Total Loss = 39122.78317165375
    Train  Composite Score 15823.5
    Train  Label Accuracy [0.8134969325153374, 0.2832803927230725, 0.6607142857142857, 0.0]
    Train  Label F1 [0.7434017595307918, 0.3103939250118652, 0.7413259488516045, 0]
    Train  Domain Accuracy [0.5901842833953976, 0.0, 0.42833953976892963]

    Val  Label Loss = 1589.8056869506836
    Val  Domain Loss = 1525.907398223877
    Val  Regularization Loss = 288.6895751953125
    Val  Total Loss = 3404.402660369873
    Val  Composite Score 2439.5
    Val  Label Accuracy [0.6689008042895442, 0.0053475935828877, 0.8748144482929243, 0.0]
    Val  Label F1 [0.6187228766274024, 0.010582010582010581, 0.8611787627861667, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 250277.80198669434
    Test  Domain Loss = 13781.267904281616
    Test  Regularization Loss = 2453.8613891601562
    Test  Total Loss = 266512.9312801361
    Test  Composite Score 5093.0
    Test  Label Accuracy [0.8024172359432475, 0.007173601147776184, 0.6505376344086021, 0.0]
    Test  Label F1 [0.548196015078083, 0.014164305949008497, 0.7397783721818877, 0]
    Test  Domain Accuracy [0.999409750914886, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 15890.778053283691
    Train  Domain Loss = 18406.36036300659
    Train  Regularization Loss = 1929.9820709228516
    Train  Total Loss = 36227.120487213135
    Train  Composite Score 16177.0
    Train  Label Accuracy [0.8415326395458845, 0.2930045871559633, 0.681184668989547, 0.0]
    Train  Label F1 [0.764142433744255, 0.31882701606613634, 0.773300370828183, 0]
    Train  Domain Accuracy [0.5774849613291321, 0.0, 0.43320920462140744]

    Val  Label Loss = 1651.952247619629
    Val  Domain Loss = 2154.8041229248047
    Val  Regularization Loss = 267.4034786224365
    Val  Total Loss = 4074.15984916687
    Val  Composite Score 2427.5
    Val  Label Accuracy [0.4262734584450402, 0.0, 0.9569520039584364, 0.0]
    Val  Label F1 [0.531328320802005, 0, 0.8557522123893805, 0]
    Val  Domain Accuracy [0.3229519295870007, 0.0, 0.0]

    Test  Label Loss = 273242.3086929321
    Test  Domain Loss = 18862.60664844513
    Test  Regularization Loss = 2272.9295682907104
    Test  Total Loss = 294377.84490966797
    Test  Composite Score 5254.25
    Test  Label Accuracy [0.3788754598003153, 0.00860832137733142, 0.8790322580645161, 0.0]
    Test  Label F1 [0.41436781609195406, 0.016853932584269662, 0.7898550724637682, 0]
    Test  Domain Accuracy [0.26222799354661, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 15104.924156188965
    Train  Domain Loss = 20440.890800476074
    Train  Regularization Loss = 1939.1481399536133
    Train  Total Loss = 37484.96309661865
    Train  Composite Score 16431.5
    Train  Label Accuracy [0.8581170676264444, 0.2988571428571429, 0.7025261324041812, 0.0]
    Train  Label F1 [0.7757513485743642, 0.33174754202346973, 0.7950381992935184, 0]
    Train  Domain Accuracy [0.5897068652726057, 0.0, 0.40637830612050035]

    Val  Label Loss = 1946.0999755859375
    Val  Domain Loss = 2123.396041870117
    Val  Regularization Loss = 275.1477527618408
    Val  Total Loss = 4344.6437702178955
    Val  Composite Score 2359.25
    Val  Label Accuracy [0.5844504021447721, 0.7219251336898396, 0.7867392380009897, 0.0]
    Val  Label F1 [0.6153846153846154, 0.3744798890429959, 0.8435013262599469, 0]
    Val  Domain Accuracy [0.16587677725118483, 0.0, 0.0]

    Test  Label Loss = 1089319.2318286896
    Test  Domain Loss = 18418.739763259888
    Test  Regularization Loss = 2338.755898475647
    Test  Total Loss = 1110076.727490425
    Test  Composite Score 4740.5
    Test  Label Accuracy [0.6500262743037309, 0.3500717360114778, 0.5566756272401434, 0.0]
    Test  Label F1 [0.5328451432263623, 0.22011727559765448, 0.6838194826637314, 0]
    Test  Domain Accuracy [0.09837484751898634, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 15376.459354400635
    Train  Domain Loss = 17463.789291381836
    Train  Regularization Loss = 1776.8004426956177
    Train  Total Loss = 34617.04908847809
    Train  Composite Score 16189.0
    Train  Label Accuracy [0.8527139087825104, 0.2684271619268717, 0.6737804878048781, 0.0]
    Train  Label F1 [0.7662799559657888, 0.2984833817360439, 0.7708662071256541, 0]
    Train  Domain Accuracy [0.5875107419077629, 0.0, 0.4418027308316624]

    Val  Label Loss = 1715.2631301879883
    Val  Domain Loss = 1816.3778686523438
    Val  Regularization Loss = 246.48602485656738
    Val  Total Loss = 3778.1270236968994
    Val  Composite Score 2417.75
    Val  Label Accuracy [0.6300268096514745, 0.22459893048128343, 0.8545274616526473, 0.0]
    Val  Label F1 [0.6048906048906049, 0.2772277227722772, 0.8526289804986423, 0]
    Val  Domain Accuracy [0.7115775220040623, 0.0, 0.0]

    Test  Label Loss = 225377.5750732422
    Test  Domain Loss = 16468.923377990723
    Test  Regularization Loss = 2095.1312112808228
    Test  Total Loss = 243941.62966251373
    Test  Composite Score 5021.75
    Test  Label Accuracy [0.7698370993168681, 0.06599713055954089, 0.6339605734767025, 0.0]
    Test  Label F1 [0.533794862452177, 0.11031175059952039, 0.7251761691223575, 0]
    Test  Domain Accuracy [0.6499822925274465, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 15577.679443359375
    Train  Domain Loss = 19307.61152267456
    Train  Regularization Loss = 1822.8132705688477
    Train  Total Loss = 36708.10423660278
    Train  Composite Score 16249.75
    Train  Label Accuracy [0.8454862748797283, 0.28984668787966444, 0.6880081300813008, 0.0]
    Train  Label F1 [0.7663631311188064, 0.320025550942191, 0.7781609195402299, 0]
    Train  Domain Accuracy [0.6088035901842834, 0.0, 0.420318915306025]

    Val  Label Loss = 1578.6754608154297
    Val  Domain Loss = 3617.2602157592773
    Val  Regularization Loss = 260.91814041137695
    Val  Total Loss = 5456.853816986084
    Val  Composite Score 2442.5
    Val  Label Accuracy [0.5415549597855228, 0.016042780748663103, 0.9228104898565067, 0.0]
    Val  Label F1 [0.5855072463768117, 0.028846153846153848, 0.863425925925926, 0]
    Val  Domain Accuracy [0.0, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 197928.47566223145
    Test  Domain Loss = 29455.689167022705
    Test  Regularization Loss = 2217.804193496704
    Test  Total Loss = 229601.96902275085
    Test  Composite Score 5202.5
    Test  Label Accuracy [0.5959012086179716, 0.027259684361549498, 0.7681451612903226, 0.0]
    Test  Label F1 [0.5024368630926008, 0.051144010767160165, 0.7730808251606358, 0]
    Test  Domain Accuracy [3.934993900759454e-05, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 15106.988674163818
    Train  Domain Loss = 18426.167366027832
    Train  Regularization Loss = 1782.5733013153076
    Train  Total Loss = 35315.72934150696
    Train  Composite Score 16312.0
    Train  Label Accuracy [0.8457441749881123, 0.31837425910245554, 0.6906213704994193, 0.0]
    Train  Label F1 [0.765944619094785, 0.34022017795204346, 0.7923051299133911, 0]
    Train  Domain Accuracy [0.5714694929819536, 0.0, 0.4222285877971928]

    Val  Label Loss = 1548.200345993042
    Val  Domain Loss = 1975.4626770019531
    Val  Regularization Loss = 243.1632900238037
    Val  Total Loss = 3766.826313018799
    Val  Composite Score 2432.75
    Val  Label Accuracy [0.6689008042895442, 0.0855614973262032, 0.8629391390400791, 0.0]
    Val  Label F1 [0.6194909993792675, 0.13389121338912133, 0.8595367175948743, 0]
    Val  Domain Accuracy [0.9542992552471226, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 216490.06448364258
    Test  Domain Loss = 17105.808095932007
    Test  Regularization Loss = 2066.8879652023315
    Test  Total Loss = 235662.76054477692
    Test  Composite Score 5017.25
    Test  Label Accuracy [0.7945349448239621, 0.03443328550932568, 0.6270161290322581, 0.0]
    Test  Label F1 [0.5366459627329192, 0.06332453825857519, 0.7237233354880415, 0]
    Test  Domain Accuracy [0.9445952858773069, 0.0, 0.0]

  EPOCH 20
    Train  Label Loss = 14668.022861480713
    Train  Domain Loss = 17648.146697998047
    Train  Regularization Loss = 1614.79856300354
    Train  Total Loss = 33930.9681224823
    Train  Composite Score 16460.0
    Train  Label Accuracy [0.8649109511178477, 0.28897772701313534, 0.701945412311266, 0.0]
    Train  Label F1 [0.7759646438891722, 0.327031830667313, 0.7969342343827263, 0]
    Train  Domain Accuracy [0.5810178554377924, 0.0, 0.44352143607371336]

    Val  Label Loss = 1590.8939037322998
    Val  Domain Loss = 2145.9584197998047
    Val  Regularization Loss = 220.60039043426514
    Val  Total Loss = 3957.4527139663696
    Val  Composite Score 2434.25
    Val  Label Accuracy [0.6581769436997319, 0.06951871657754011, 0.8693715982187036, 0.0]
    Val  Label F1 [0.6156739811912225, 0.11206896551724138, 0.8610634648370499, 0]
    Val  Domain Accuracy [0.3916723087339201, 0.0, 0.0]

    Test  Label Loss = 174172.5615901947
    Test  Domain Loss = 18953.423051834106
    Test  Regularization Loss = 1875.1033186912537
    Test  Total Loss = 195001.08796072006
    Test  Composite Score 5100.5
    Test  Label Accuracy [0.7588018917498687, 0.024390243902439025, 0.6686827956989247, 0.0]
    Test  Label F1 [0.5387054653982466, 0.045272969374167776, 0.7447604790419162, 0]
    Test  Domain Accuracy [0.2837917601227718, 0.0, 0.0]

  EPOCH 21
    Train  Label Loss = 14565.303785324097
    Train  Domain Loss = 18167.176666259766
    Train  Regularization Loss = 1580.0065174102783
    Train  Total Loss = 34312.48696899414
    Train  Composite Score 16460.5
    Train  Label Accuracy [0.8661150808574652, 0.2966101694915254, 0.6894599303135889, 0.0]
    Train  Label F1 [0.7811082375885021, 0.326524046967991, 0.787823490378235, 0]
    Train  Domain Accuracy [0.5889429962761387, 0.0, 0.4327317864986155]

    Val  Label Loss = 1604.6872673034668
    Val  Domain Loss = 934.4091377258301
    Val  Regularization Loss = 220.7043743133545
    Val  Total Loss = 2759.8007793426514
    Val  Composite Score 2410.25
    Val  Label Accuracy [0.6353887399463807, 0.026737967914438502, 0.8659079663532905, 0.0]
    Val  Label F1 [0.5943573667711599, 0.05, 0.8509603695599318, 0]
    Val  Domain Accuracy [0.999322951929587, 0.0, 0.0]

    Test  Label Loss = 83038.38386440277
    Test  Domain Loss = 9122.673202037811
    Test  Regularization Loss = 1875.9871816635132
    Test  Total Loss = 94037.0442481041
    Test  Composite Score 5027.0
    Test  Label Accuracy [0.7393589069889648, 0.027259684361549498, 0.6545698924731183, 0.0]
    Test  Label F1 [0.5226597325408617, 0.051630434782608696, 0.7297702297702297, 0]
    Test  Domain Accuracy [0.9999213001219848, 0.0, 0.0]

  EPOCH 22
    Train  Label Loss = 14546.170238494873
    Train  Domain Loss = 19401.55039215088
    Train  Regularization Loss = 1564.3558411598206
    Train  Total Loss = 35512.07647180557
    Train  Composite Score 16596.5
    Train  Label Accuracy [0.8724509063444109, 0.30727062896710905, 0.7044134727061556, 0.0]
    Train  Label F1 [0.7851316907391673, 0.3428295509415741, 0.8016522098306484, 0]
    Train  Domain Accuracy [0.5903752506445145, 0.0, 0.40294089563639834]

    Val  Label Loss = 1610.9811363220215
    Val  Domain Loss = 2269.1167068481445
    Val  Regularization Loss = 223.39005947113037
    Val  Total Loss = 4103.487902641296
    Val  Composite Score 2460.5
    Val  Label Accuracy [0.561662198391421, 0.0106951871657754, 0.9277585353785255, 0.0]
    Val  Label F1 [0.5960170697012803, 0.020942408376963352, 0.8698677800974253, 0]
    Val  Domain Accuracy [0.20785375761679079, 0.0, 0.0]

    Test  Label Loss = 203138.83673667908
    Test  Domain Loss = 20043.436650276184
    Test  Regularization Loss = 1898.8155055046082
    Test  Total Loss = 225081.08889245987
    Test  Composite Score 5276.0
    Test  Label Accuracy [0.5937992643194955, 0.014347202295552367, 0.793010752688172, 0.0]
    Test  Label F1 [0.5187055313288961, 0.02785515320334262, 0.7820611951839169, 0]
    Test  Domain Accuracy [0.08841931295006493, 0.0, 0.0]

  EPOCH 23
    Train  Label Loss = 14269.466800689697
    Train  Domain Loss = 17626.355068206787
    Train  Regularization Loss = 1493.6247210502625
    Train  Total Loss = 33389.44658994675
    Train  Composite Score 16574.0
    Train  Label Accuracy [0.8642937640871525, 0.32316715542521995, 0.7000580720092915, 0.0]
    Train  Label F1 [0.7837342984883968, 0.35112314800063726, 0.7970906686503018, 0]
    Train  Domain Accuracy [0.5635443521436073, 0.0, 0.4408478945860785]

    Val  Label Loss = 1530.8411445617676
    Val  Domain Loss = 2058.456703186035
    Val  Regularization Loss = 203.48228931427002
    Val  Total Loss = 3792.7801370620728
    Val  Composite Score 2447.0
    Val  Label Accuracy [0.6380697050938338, 0.11764705882352941, 0.8807521029193469, 0.0]
    Val  Label F1 [0.6185834957764782, 0.17600000000000002, 0.8642874484098082, 0]
    Val  Domain Accuracy [0.6916046039268788, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 138834.7906551361
    Test  Domain Loss = 17817.31481361389
    Test  Regularization Loss = 1729.5994591712952
    Test  Total Loss = 158381.7049279213
    Test  Composite Score 5072.75
    Test  Label Accuracy [0.7193904361534419, 0.03873744619799139, 0.6749551971326165, 0.0]
    Test  Label F1 [0.5229182582123758, 0.07058823529411765, 0.7414790205487881, 0]
    Test  Domain Accuracy [0.6251131310746468, 0.0, 0.0]

  EPOCH 24
    Train  Label Loss = 14464.180835723877
    Train  Domain Loss = 17594.14015197754
    Train  Regularization Loss = 1396.2952427864075
    Train  Total Loss = 33454.61623048782
    Train  Composite Score 16615.0
    Train  Label Accuracy [0.8750468340202323, 0.29834417504435246, 0.7010743321718932, 0.0]
    Train  Label F1 [0.7879886972291342, 0.33650158412539605, 0.7943740746833361, 0]
    Train  Domain Accuracy [0.5824501098061683, 0.0, 0.4496323880454502]

    Val  Label Loss = 1619.4085159301758
    Val  Domain Loss = 1217.0015392303467
    Val  Regularization Loss = 206.95432662963867
    Val  Total Loss = 3043.364381790161
    Val  Composite Score 2420.0
    Val  Label Accuracy [0.6849865951742627, 0.06951871657754011, 0.8500742206828302, 0.0]
    Val  Label F1 [0.6145520144317499, 0.12149532710280372, 0.8523939469114364, 0]
    Val  Domain Accuracy [0.9908598510494245, 0.0, 0.0]

    Test  Label Loss = 162116.69234371185
    Test  Domain Loss = 11542.116109848022
    Test  Regularization Loss = 1759.1117763519287
    Test  Total Loss = 175417.9202299118
    Test  Composite Score 5027.75
    Test  Label Accuracy [0.7871781397792958, 0.02295552367288379, 0.6350806451612904, 0.0]
    Test  Label F1 [0.5384615384615384, 0.043243243243243246, 0.7246932515337424, 0]
    Test  Domain Accuracy [0.9840239247629167, 0.0, 0.0]

  EPOCH 25
    Train  Label Loss = 14188.591243743896
    Train  Domain Loss = 17906.432411193848
    Train  Regularization Loss = 1455.0996108055115
    Train  Total Loss = 33550.123265743256
    Train  Composite Score 16651.25
    Train  Label Accuracy [0.8798108747044917, 0.29342520815389034, 0.7119628339140535, 0.0]
    Train  Label F1 [0.7874069058903183, 0.33662714097496704, 0.8067779879904582, 0]
    Train  Domain Accuracy [0.5979184569846271, 0.0, 0.4367420987300678]

    Val  Label Loss = 1479.5477409362793
    Val  Domain Loss = 2307.579391479492
    Val  Regularization Loss = 203.5710096359253
    Val  Total Loss = 3990.698142051697
    Val  Composite Score 2455.25
    Val  Label Accuracy [0.7091152815013405, 0.016042780748663103, 0.8693715982187036, 0.0]
    Val  Label F1 [0.638118214716526, 0.03076923076923077, 0.8665844636251541, 0]
    Val  Domain Accuracy [0.12322274881516587, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 194051.57976150513
    Test  Domain Loss = 20114.637380599976
    Test  Regularization Loss = 1730.353581905365
    Test  Total Loss = 215896.57072401047
    Test  Composite Score 5052.5
    Test  Label Accuracy [0.7834997372569626, 0.018651362984218076, 0.6447132616487455, 0.0]
    Test  Label F1 [0.5376848178867653, 0.035812672176308534, 0.7326883910386967, 0]
    Test  Domain Accuracy [0.04765277613819698, 0.0, 0.0]

  EPOCH 26
    Train  Label Loss = 14129.652559280396
    Train  Domain Loss = 17577.981884002686
    Train  Regularization Loss = 1376.406337738037
    Train  Total Loss = 33084.04078102112
    Train  Composite Score 16673.75
    Train  Label Accuracy [0.8791250235715633, 0.31170336037079954, 0.7051393728222997, 0.0]
    Train  Label F1 [0.7892331132554595, 0.3487279209204343, 0.8047386297738381, 0]
    Train  Domain Accuracy [0.5691778859925523, 0.0, 0.4391291893440275]

    Val  Label Loss = 1499.832233428955
    Val  Domain Loss = 2132.173698425293
    Val  Regularization Loss = 190.24718284606934
    Val  Total Loss = 3822.2531147003174
    Val  Composite Score 2448.5
    Val  Label Accuracy [0.6152815013404825, 0.09090909090909091, 0.892627412172192, 0.0]
    Val  Label F1 [0.6115922718187874, 0.1504424778761062, 0.8629514470222434, 0]
    Val  Domain Accuracy [0.11408259986459039, 0.0, 0.0]

    Test  Label Loss = 209527.75558280945
    Test  Domain Loss = 18374.363034248352
    Test  Regularization Loss = 1617.1010541915894
    Test  Total Loss = 229519.2196712494
    Test  Composite Score 5120.75
    Test  Label Accuracy [0.6678928008407777, 0.03873744619799139, 0.7112455197132617, 0.0]
    Test  Label F1 [0.5176135206678883, 0.07171314741035857, 0.7502362948960303, 0]
    Test  Domain Accuracy [0.06618659741077401, 0.0, 0.0]

  EPOCH 27
    Train  Label Loss = 13952.113098144531
    Train  Domain Loss = 17660.033950805664
    Train  Regularization Loss = 1297.9686694145203
    Train  Total Loss = 32910.115718364716
    Train  Composite Score 16746.25
    Train  Label Accuracy [0.8838800374882849, 0.2975206611570248, 0.7134146341463414, 0.0]
    Train  Label F1 [0.7953280485748019, 0.3344392833443928, 0.8103562005277043, 0]
    Train  Domain Accuracy [0.5624940322734651, 0.0, 0.4505872242910341]

    Val  Label Loss = 1589.301513671875
    Val  Domain Loss = 2069.1624755859375
    Val  Regularization Loss = 180.80889701843262
    Val  Total Loss = 3839.272886276245
    Val  Composite Score 2456.0
    Val  Label Accuracy [0.631367292225201, 0.45989304812834225, 0.8574962889658585, 0.0]
    Val  Label F1 [0.6296791443850267, 0.4236453201970444, 0.8652021967049426, 0]
    Val  Domain Accuracy [0.3713608666215301, 0.0, 0.0]

    Test  Label Loss = 131216.94355773926
    Test  Domain Loss = 18276.74239063263
    Test  Regularization Loss = 1536.8756246566772
    Test  Total Loss = 151030.56157302856
    Test  Composite Score 5009.75
    Test  Label Accuracy [0.743037309511298, 0.09469153515064563, 0.6373207885304659, 0.0]
    Test  Label F1 [0.5292906606775221, 0.14316702819956617, 0.7236423756835813, 0]
    Test  Domain Accuracy [0.19556919686774485, 0.0, 0.0]

  EPOCH 28
    Train  Label Loss = 14075.945013046265
    Train  Domain Loss = 17704.509349822998
    Train  Regularization Loss = 1255.015127658844
    Train  Total Loss = 33035.46949052811
    Train  Composite Score 16650.5
    Train  Label Accuracy [0.8769086651053865, 0.30239432456399645, 0.7029616724738676, 0.0]
    Train  Label F1 [0.7892584629653051, 0.3375123721544045, 0.8011913626209978, 0]
    Train  Domain Accuracy [0.5910436360164232, 0.0, 0.4394156402177027]

    Val  Label Loss = 1640.5862941741943
    Val  Domain Loss = 2271.438678741455
    Val  Regularization Loss = 184.87086296081543
    Val  Total Loss = 4096.895835876465
    Val  Composite Score 2447.0
    Val  Label Accuracy [0.5308310991957105, 0.11229946524064172, 0.9208312716476992, 0.0]
    Val  Label F1 [0.5849335302806499, 0.18025751072961374, 0.8613746817866235, 0]
    Val  Domain Accuracy [0.35003385240352064, 0.0, 0.0]

    Test  Label Loss = 123111.86327934265
    Test  Domain Loss = 21022.36910057068
    Test  Regularization Loss = 1571.4023351669312
    Test  Total Loss = 145705.63471508026
    Test  Composite Score 5216.75
    Test  Label Accuracy [0.6290068313189701, 0.04160688665710186, 0.7560483870967742, 0.0]
    Test  Label F1 [0.5176216216216216, 0.07682119205298013, 0.7716049382716049, 0]
    Test  Domain Accuracy [0.16908668791563372, 0.0, 0.0]

  EPOCH 29
    Train  Label Loss = 13811.780540466309
    Train  Domain Loss = 18072.055709838867
    Train  Regularization Loss = 1295.1193652153015
    Train  Total Loss = 33178.95561552048
    Train  Composite Score 16704.75
    Train  Label Accuracy [0.8806521945208077, 0.3194642348247364, 0.709349593495935, 0.0]
    Train  Label F1 [0.7906382978723403, 0.35729083665338646, 0.8076700553764774, 0]
    Train  Domain Accuracy [0.5970591043636017, 0.0, 0.4278621216461377]

    Val  Label Loss = 1579.5097465515137
    Val  Domain Loss = 1847.8917083740234
    Val  Regularization Loss = 183.24158191680908
    Val  Total Loss = 3610.643036842346
    Val  Composite Score 2426.75
    Val  Label Accuracy [0.7024128686327078, 0.016042780748663103, 0.8530430479960416, 0.0]
    Val  Label F1 [0.6249254621347645, 0.030150753768844223, 0.8551587301587302, 0]
    Val  Domain Accuracy [0.8317535545023697, 0.0, 0.0]

    Test  Label Loss = 118336.30276870728
    Test  Domain Loss = 16048.746179580688
    Test  Regularization Loss = 1557.5534462928772
    Test  Total Loss = 135942.60239458084
    Test  Composite Score 4876.25
    Test  Label Accuracy [0.7940094587493431, 0.018651362984218076, 0.587589605734767, 0.0]
    Test  Label F1 [0.5174657534246576, 0.036211699164345405, 0.692998678996037, 0]
    Test  Domain Accuracy [0.8370912525085586, 0.0, 0.0]
