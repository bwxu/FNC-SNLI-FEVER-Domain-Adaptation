Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
Loading CNN vectors...
SIZE_TRAIN = 94441
SIZE_VAL = 2954
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 18292.3854637146
    Train  Domain Loss = 13936.401021957397
    Train  Regularization Loss = 2635.8442311286926
    Train  Total Loss = 34864.63071680069
    Train  Composite Score 15426.25
    Train  Label Accuracy [0.8086737078231611, 0.16790711521286097, 0.6354529616724739, 0.0]
    Train  Label F1 [0.7245624319571226, 0.19904711487559557, 0.7103789661608375, 0]
    Train  Domain Accuracy [0.8414971832330755, 0.0, 0.641172538909577]

    Val  Label Loss = 1791.511194229126
    Val  Domain Loss = 471.77839374542236
    Val  Regularization Loss = 401.89805030822754
    Val  Total Loss = 2665.187638282776
    Val  Composite Score 2345.0
    Val  Label Accuracy [0.6970509383378016, 0.0106951871657754, 0.801583374567046, 0.0]
    Val  Label F1 [0.5813303521520403, 0.021052631578947368, 0.8246373122932044, 0]
    Val  Domain Accuracy [0.9218009478672986, 0.0, 0.0]

    Test  Label Loss = 150844.67804336548
    Test  Domain Loss = 4898.499837636948
    Test  Regularization Loss = 3416.133427619934
    Test  Total Loss = 159159.31130862236
    Test  Composite Score 4990.25
    Test  Label Accuracy [0.8386757750919601, 0.0, 0.605510752688172, 0.0]
    Test  Label F1 [0.5437819420783646, 0, 0.7152685895739613, 0]
    Test  Domain Accuracy [0.9033958997363554, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 18025.422010421753
    Train  Domain Loss = 32005.55146408081
    Train  Regularization Loss = 2833.184274673462
    Train  Total Loss = 52864.157749176025
    Train  Composite Score 15534.75
    Train  Label Accuracy [0.8072006016168453, 0.22105263157894736, 0.639808362369338, 0.0]
    Train  Label F1 [0.7291640130768904, 0.24633431085043989, 0.7257905138339921, 0]
    Train  Domain Accuracy [0.6465196218848468, 0.0, 0.4571755943855629]

    Val  Label Loss = 1696.2888832092285
    Val  Domain Loss = 1654.2065563201904
    Val  Regularization Loss = 357.63487815856934
    Val  Total Loss = 3708.1303176879883
    Val  Composite Score 2442.5
    Val  Label Accuracy [0.4597855227882037, 0.0, 0.954477981197427, 0.0]
    Val  Label F1 [0.5559157212317667, 0, 0.860008916629514, 0]
    Val  Domain Accuracy [0.7464454976303317, 0.0, 0.0]

    Test  Label Loss = 194061.17497062683
    Test  Domain Loss = 15685.370351791382
    Test  Regularization Loss = 3039.8964643478394
    Test  Total Loss = 212786.44178676605
    Test  Composite Score 5390.0
    Test  Label Accuracy [0.5002627430373096, 0.0028694404591104736, 0.8687275985663082, 0.0]
    Test  Label F1 [0.5090909090909091, 0.005681818181818182, 0.8009087154068566, 0]
    Test  Domain Accuracy [0.6561602329516389, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 31712.39315032959
    Train  Domain Loss = 95592.7307472229
    Train  Regularization Loss = 2878.3524103164673
    Train  Total Loss = 130183.47630786896
    Train  Composite Score 13969.75
    Train  Label Accuracy [0.6811415568408078, 0.23526060951295927, 0.5386178861788617, 0.0]
    Train  Label F1 [0.6433528858639681, 0.23549536707056307, 0.602419420313388, 0]
    Train  Domain Accuracy [0.6262770934784685, 0.0, 0.3950157547980521]

    Val  Label Loss = 2011.9838218688965
    Val  Domain Loss = 2784.8334350585938
    Val  Regularization Loss = 406.669979095459
    Val  Total Loss = 5203.487236022949
    Val  Composite Score 2322.5
    Val  Label Accuracy [0.7788203753351206, 0.0, 0.7575457694210787, 0.0]
    Val  Label F1 [0.5925548189699134, 0, 0.8143617021276596, 0]
    Val  Domain Accuracy [0.25389302640487477, 0.0, 0.0]

    Test  Label Loss = 2087038.52186203
    Test  Domain Loss = 23943.077281951904
    Test  Regularization Loss = 3456.6948223114014
    Test  Total Loss = 2114438.2939662933
    Test  Composite Score 4923.5
    Test  Label Accuracy [0.8675775091960063, 0.0, 0.573252688172043, 0.0]
    Test  Label F1 [0.5419333661578861, 0, 0.6974652493867539, 0]
    Test  Domain Accuracy [0.15881635383465156, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 29031.587089538574
    Train  Domain Loss = 37688.39087677002
    Train  Regularization Loss = 2852.761311531067
    Train  Total Loss = 69572.73927783966
    Train  Composite Score 14468.5
    Train  Label Accuracy [0.7209390025454888, 0.23268617791944363, 0.5685249709639953, 0.0]
    Train  Label F1 [0.6756195608958785, 0.2333963086760645, 0.6417568010488365, 0]
    Train  Domain Accuracy [0.5901842833953976, 0.0, 0.42566599828129476]

    Val  Label Loss = 2266.048049926758
    Val  Domain Loss = 1393.3813552856445
    Val  Regularization Loss = 382.81811714172363
    Val  Total Loss = 4042.247522354126
    Val  Composite Score 2421.5
    Val  Label Accuracy [0.403485254691689, 0.0, 0.9614052449282533, 0.0]
    Val  Label F1 [0.5127768313458262, 0, 0.8546294259951617, 0]
    Val  Domain Accuracy [0.7484766418415707, 0.0, 0.0]

    Test  Label Loss = 1017247.3227443695
    Test  Domain Loss = 14501.387739181519
    Test  Regularization Loss = 3253.953995704651
    Test  Total Loss = 1035002.6644792557
    Test  Composite Score 5343.5
    Test  Label Accuracy [0.36363636363636365, 0.0, 0.9135304659498208, 0.0]
    Test  Label F1 [0.43563109852061693, 0, 0.7953969182757948, 0]
    Test  Domain Accuracy [0.658678629048125, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 21473.779930114746
    Train  Domain Loss = 43008.60430908203
    Train  Regularization Loss = 2811.039499282837
    Train  Total Loss = 67293.42373847961
    Train  Composite Score 14944.5
    Train  Label Accuracy [0.757909604519774, 0.20506108202443282, 0.6145470383275261, 0.0]
    Train  Label F1 [0.6980919340849957, 0.22549176395330242, 0.6799999999999999, 0]
    Train  Domain Accuracy [0.5687959514943187, 0.0, 0.42050988255514177]

    Val  Label Loss = 1802.1010074615479
    Val  Domain Loss = 2301.08060836792
    Val  Regularization Loss = 392.5934886932373
    Val  Total Loss = 4495.775104522705
    Val  Composite Score 2371.25
    Val  Label Accuracy [0.7654155495978552, 0.0, 0.7946561108362197, 0.0]
    Val  Label F1 [0.6113490364025697, 0, 0.833636127692707, 0]
    Val  Domain Accuracy [0.06668923493568044, 0.0, 0.0]

    Test  Label Loss = 782585.9742126465
    Test  Domain Loss = 20006.4205493927
    Test  Regularization Loss = 3337.044653892517
    Test  Total Loss = 805929.4394159317
    Test  Composite Score 4993.25
    Test  Label Accuracy [0.8744088281660536, 0.0, 0.5911738351254481, 0.0]
    Test  Label F1 [0.5518156193002819, 0, 0.7132432432432433, 0]
    Test  Domain Accuracy [0.02333451383150356, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 18578.865306854248
    Train  Domain Loss = 23187.36479949951
    Train  Regularization Loss = 2575.2147178649902
    Train  Total Loss = 44341.44482421875
    Train  Composite Score 15454.75
    Train  Label Accuracy [0.789513320154382, 0.2410480349344978, 0.6435830429732868, 0.0]
    Train  Label F1 [0.7214933975654867, 0.2543388112425127, 0.7350965923223614, 0]
    Train  Domain Accuracy [0.5490308412107323, 0.0, 0.4433304688245966]

    Val  Label Loss = 1905.125690460205
    Val  Domain Loss = 9965.410888671875
    Val  Regularization Loss = 362.5590705871582
    Val  Total Loss = 12233.095649719238
    Val  Composite Score 2345.75
    Val  Label Accuracy [0.8619302949061662, 0.0, 0.7422068283028204, 0.0]
    Val  Label F1 [0.6230620155038761, 0, 0.8203445447087778, 0]
    Val  Domain Accuracy [0.0, 0.0, 0.0]

    Test  Label Loss = 119220.9903717041
    Test  Domain Loss = 77091.37872314453
    Test  Regularization Loss = 3081.7520999908447
    Test  Total Loss = 199394.12119483948
    Test  Composite Score 4731.5
    Test  Label Accuracy [0.9159222280609564, 0.0, 0.4952956989247312, 0.0]
    Test  Label F1 [0.5310786106032906, 0, 0.6440431109816487, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 18542.996826171875
    Train  Domain Loss = 23920.233016967773
    Train  Regularization Loss = 2504.714020729065
    Train  Total Loss = 44967.94386386871
    Train  Composite Score 15594.0
    Train  Label Accuracy [0.806732223903177, 0.23549684089603676, 0.6498257839721254, 0.0]
    Train  Label F1 [0.73160692848568, 0.2536736272235112, 0.7429662212631754, 0]
    Train  Domain Accuracy [0.556096629428053, 0.0, 0.4263343836532035]

    Val  Label Loss = 1573.7757377624512
    Val  Domain Loss = 4382.371894836426
    Val  Regularization Loss = 344.80493545532227
    Val  Total Loss = 6300.952568054199
    Val  Composite Score 2444.0
    Val  Label Accuracy [0.6943699731903485, 0.0, 0.8688767936665017, 0.0]
    Val  Label F1 [0.6274984857662023, 0, 0.8628992628992629, 0]
    Val  Domain Accuracy [0.007447528774542992, 0.0, 0.0]

    Test  Label Loss = 412263.4065361023
    Test  Domain Loss = 37983.255058288574
    Test  Regularization Loss = 2930.8419513702393
    Test  Total Loss = 453177.5035457611
    Test  Composite Score 5183.75
    Test  Label Accuracy [0.7577509196006306, 0.005738880918220947, 0.6969086021505376, 0.0]
    Test  Label F1 [0.5512232415902141, 0.011299435028248588, 0.7598925256472888, 0]
    Test  Domain Accuracy [0.002911895486561996, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 16727.154628753662
    Train  Domain Loss = 19686.02574157715
    Train  Regularization Loss = 2329.1108894348145
    Train  Total Loss = 38742.291259765625
    Train  Composite Score 15960.25
    Train  Label Accuracy [0.8266113833396155, 0.2556587347649449, 0.6761033681765389, 0.0]
    Train  Label F1 [0.7477623391015258, 0.2790624010136205, 0.7709626686532572, 0]
    Train  Domain Accuracy [0.5557146949298195, 0.0, 0.4526878640313186]

    Val  Label Loss = 1640.3501319885254
    Val  Domain Loss = 1608.1254787445068
    Val  Regularization Loss = 315.8536434173584
    Val  Total Loss = 3564.3292541503906
    Val  Composite Score 2450.0
    Val  Label Accuracy [0.6635388739946381, 0.0, 0.88421573478476, 0.0]
    Val  Label F1 [0.6230333543108874, 0, 0.8649564375605033, 0]
    Val  Domain Accuracy [0.9278943805010156, 0.0, 0.0]

    Test  Label Loss = 456159.90406036377
    Test  Domain Loss = 14835.736293792725
    Test  Regularization Loss = 2684.7559690475464
    Test  Total Loss = 473680.39632320404
    Test  Composite Score 5214.5
    Test  Label Accuracy [0.7309511297950604, 0.0, 0.7184139784946236, 0.0]
    Test  Label F1 [0.5477456192163811, 0, 0.7679597701149425, 0]
    Test  Domain Accuracy [0.9315704560657931, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 15870.522701263428
    Train  Domain Loss = 18434.407871246338
    Train  Regularization Loss = 2077.3430786132812
    Train  Total Loss = 36382.27365112305
    Train  Composite Score 16095.5
    Train  Label Accuracy [0.8385852694948734, 0.2602859644003502, 0.6800232288037166, 0.0]
    Train  Label F1 [0.7580460014455168, 0.28640231176753894, 0.7738950846757537, 0]
    Train  Domain Accuracy [0.5421560202425284, 0.0, 0.4633820299818581]

    Val  Label Loss = 1721.9195098876953
    Val  Domain Loss = 2940.5298194885254
    Val  Regularization Loss = 277.01013565063477
    Val  Total Loss = 4939.4594650268555
    Val  Composite Score 2438.0
    Val  Label Accuracy [0.4865951742627346, 0.0, 0.9416130628401781, 0.0]
    Val  Label F1 [0.5576036866359447, 0, 0.8614757808963333, 0]
    Val  Domain Accuracy [0.05890318212593094, 0.0, 0.0]

    Test  Label Loss = 367562.74994277954
    Test  Domain Loss = 23097.768765449524
    Test  Regularization Loss = 2354.5861530303955
    Test  Total Loss = 393015.10486125946
    Test  Composite Score 5312.0
    Test  Label Accuracy [0.4766158696794535, 0.007173601147776184, 0.8548387096774194, 0.0]
    Test  Label F1 [0.48308921438082564, 0.014084507042253521, 0.7898168270723379, 0]
    Test  Domain Accuracy [0.05324046747727541, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 16370.05892944336
    Train  Domain Loss = 19483.344772338867
    Train  Regularization Loss = 2034.5630617141724
    Train  Total Loss = 37887.9667634964
    Train  Composite Score 15916.0
    Train  Label Accuracy [0.8227276999718018, 0.26177244808423517, 0.6688443670150988, 0.0]
    Train  Label F1 [0.7486315429353404, 0.28621682123441, 0.7548128123207996, 0]
    Train  Domain Accuracy [0.6098539100544257, 0.0, 0.44256659982812946]

    Val  Label Loss = 2442.802947998047
    Val  Domain Loss = 763.940975189209
    Val  Regularization Loss = 298.194522857666
    Val  Total Loss = 3504.938446044922
    Val  Composite Score 2170.25
    Val  Label Accuracy [0.8458445040214477, 0.0427807486631016, 0.6284017812963879, 0.0]
    Val  Label F1 [0.5618878005342831, 0.07207207207207207, 0.7383720930232558, 0]
    Val  Domain Accuracy [0.998645903859174, 0.0, 0.0]

    Test  Label Loss = 345811.0122947693
    Test  Domain Loss = 7713.9766635894775
    Test  Regularization Loss = 2534.653444290161
    Test  Total Loss = 356059.6424026489
    Test  Composite Score 4522.25
    Test  Label Accuracy [0.9211770888071467, 0.05021520803443329, 0.4227150537634409, 0.0]
    Test  Label F1 [0.5131733021077284, 0.08760951188986232, 0.5808834846852393, 0]
    Test  Domain Accuracy [0.9918152126864204, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 17765.959941864014
    Train  Domain Loss = 21152.2911529541
    Train  Regularization Loss = 2099.9687309265137
    Train  Total Loss = 41018.21982574463
    Train  Composite Score 15739.0
    Train  Label Accuracy [0.8008244332021736, 0.2715721040189125, 0.6624564459930313, 0.0]
    Train  Label F1 [0.7395103382645558, 0.28421215401267974, 0.7463809601701153, 0]
    Train  Domain Accuracy [0.5673636971259429, 0.0, 0.42241955504630957]

    Val  Label Loss = 1884.7289791107178
    Val  Domain Loss = 2091.1669273376465
    Val  Regularization Loss = 285.2219295501709
    Val  Total Loss = 4261.117835998535
    Val  Composite Score 2348.75
    Val  Label Accuracy [0.7868632707774799, 0.0, 0.7718951014349332, 0.0]
    Val  Label F1 [0.6070320579110652, 0, 0.8238711381040402, 0]
    Val  Domain Accuracy [0.34055517941773866, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 1455533.2736759186
    Test  Domain Loss = 18333.800884246826
    Test  Regularization Loss = 2424.3864011764526
    Test  Total Loss = 1476291.4609613419
    Test  Composite Score 4961.75
    Test  Label Accuracy [0.8791382028376248, 0.00860832137733142, 0.578405017921147, 0.0]
    Test  Label F1 [0.5507818930041152, 0.01702127659574468, 0.7027762656505172, 0]
    Test  Domain Accuracy [0.1821115177271475, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 17504.862689971924
    Train  Domain Loss = 20710.42791748047
    Train  Regularization Loss = 1950.935733795166
    Train  Total Loss = 40166.22634124756
    Train  Composite Score 15692.5
    Train  Label Accuracy [0.8091329370695348, 0.2653946227233304, 0.6499709639953543, 0.0]
    Train  Label F1 [0.7399163107717528, 0.2899557801642451, 0.7285598047192839, 0]
    Train  Domain Accuracy [0.5650720901365416, 0.0, 0.45918075050128904]

    Val  Label Loss = 1751.8339767456055
    Val  Domain Loss = 2469.0559616088867
    Val  Regularization Loss = 298.50053787231445
    Val  Total Loss = 4519.390476226807
    Val  Composite Score 2420.75
    Val  Label Accuracy [0.4517426273458445, 0.0, 0.9430974764967838, 0.0]
    Val  Label F1 [0.5387689848121503, 0, 0.8531781557743957, 0]
    Val  Domain Accuracy [0.06567366283006093, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 812873.193403244
    Test  Domain Loss = 20799.84853744507
    Test  Regularization Loss = 2537.254571914673
    Test  Total Loss = 836210.2965126038
    Test  Composite Score 5342.75
    Test  Label Accuracy [0.45664739884393063, 0.02295552367288379, 0.8700716845878136, 0.0]
    Test  Label F1 [0.47408619749045283, 0.044137931034482755, 0.7977816575947417, 0]
    Test  Domain Accuracy [0.06827214417817652, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 17239.61961746216
    Train  Domain Loss = 17911.348358154297
    Train  Regularization Loss = 1957.6710453033447
    Train  Total Loss = 37108.6390209198
    Train  Composite Score 15732.75
    Train  Label Accuracy [0.8046875, 0.28159580663948747, 0.6536004645760743, 0.0]
    Train  Label F1 [0.7381281298566742, 0.29910300030931025, 0.7384564914295088, 0]
    Train  Domain Accuracy [0.564212737515516, 0.0, 0.4478181991788408]

    Val  Label Loss = 1724.7827758789062
    Val  Domain Loss = 1413.9703006744385
    Val  Regularization Loss = 262.8866672515869
    Val  Total Loss = 3401.6397438049316
    Val  Composite Score 2438.0
    Val  Label Accuracy [0.6554959785522788, 0.37433155080213903, 0.8446313706086096, 0.0]
    Val  Label F1 [0.6330097087378641, 0.37735849056603776, 0.8552104208416834, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 271003.0659790039
    Test  Domain Loss = 12596.334524154663
    Test  Regularization Loss = 2234.5366716384888
    Test  Total Loss = 285833.93717479706
    Test  Composite Score 5082.5
    Test  Label Accuracy [0.7635312664214399, 0.08034433285509325, 0.6525537634408602, 0.0]
    Test  Label F1 [0.5465488057175099, 0.12458286985539486, 0.7363498483316482, 0]
    Test  Domain Accuracy [0.9996852004879393, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 15467.433910369873
    Train  Domain Loss = 19599.77880859375
    Train  Regularization Loss = 1810.8889999389648
    Train  Total Loss = 36878.10171890259
    Train  Composite Score 16324.75
    Train  Label Accuracy [0.8564997186268992, 0.2617785630153121, 0.6941056910569106, 0.0]
    Train  Label F1 [0.7714792599476219, 0.29932659932659933, 0.7821676891615542, 0]
    Train  Domain Accuracy [0.6001145803494701, 0.0, 0.39959896877685475]

    Val  Label Loss = 1581.1724014282227
    Val  Domain Loss = 1103.5329322814941
    Val  Regularization Loss = 260.87745666503906
    Val  Total Loss = 2945.582790374756
    Val  Composite Score 2452.25
    Val  Label Accuracy [0.646112600536193, 0.10695187165775401, 0.8822365165759525, 0.0]
    Val  Label F1 [0.6304774362328319, 0.16260162601626016, 0.8628115170578272, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 561039.959022522
    Test  Domain Loss = 10279.306581020355
    Test  Regularization Loss = 2217.458381652832
    Test  Total Loss = 573536.7239851952
    Test  Composite Score 5201.0
    Test  Label Accuracy [0.7136100893326327, 0.03873744619799139, 0.7157258064516129, 0.0]
    Test  Label F1 [0.5427657873701038, 0.07086614173228346, 0.7641712508969146, 0]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 15620.53296661377
    Train  Domain Loss = 18922.755714416504
    Train  Regularization Loss = 1805.115460395813
    Train  Total Loss = 36348.40414142609
    Train  Composite Score 16188.25
    Train  Label Accuracy [0.835205285512034, 0.29829627490615074, 0.6877177700348432, 0.0]
    Train  Label F1 [0.7628119477608725, 0.318237831176833, 0.7798172689110215, 0]
    Train  Domain Accuracy [0.6128139024157357, 0.0, 0.3943473694261434]

    Val  Label Loss = 1639.5321025848389
    Val  Domain Loss = 1976.946273803711
    Val  Regularization Loss = 246.7001438140869
    Val  Total Loss = 3863.1785202026367
    Val  Composite Score 2447.0
    Val  Label Accuracy [0.7533512064343163, 0.0, 0.8490846115784265, 0.0]
    Val  Label F1 [0.6448651749856569, 0, 0.8627450980392156, 0]
    Val  Domain Accuracy [0.9326337169939065, 0.0, 0.0]

    Test  Label Loss = 256267.5428161621
    Test  Domain Loss = 17133.89264011383
    Test  Regularization Loss = 2096.9512224197388
    Test  Total Loss = 275498.3866786957
    Test  Composite Score 4982.0
    Test  Label Accuracy [0.8386757750919601, 0.007173601147776184, 0.6019265232974911, 0.0]
    Test  Label F1 [0.5440599965911028, 0.014184397163120567, 0.7112228692429857, 0]
    Test  Domain Accuracy [0.9688741982449928, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 15671.010452270508
    Train  Domain Loss = 18471.361793518066
    Train  Regularization Loss = 1688.2825059890747
    Train  Total Loss = 35830.65475177765
    Train  Composite Score 16191.5
    Train  Label Accuracy [0.8401135288552507, 0.30275229357798167, 0.681184668989547, 0.0]
    Train  Label F1 [0.7615453882766605, 0.3284603421461898, 0.777014159145483, 0]
    Train  Domain Accuracy [0.6076577866895827, 0.0, 0.40933829848181036]

    Val  Label Loss = 1630.2383499145508
    Val  Domain Loss = 2110.305561065674
    Val  Regularization Loss = 238.12744617462158
    Val  Total Loss = 3978.671357154846
    Val  Composite Score 2446.25
    Val  Label Accuracy [0.7506702412868632, 0.10695187165775401, 0.8396833250865908, 0.0]
    Val  Label F1 [0.6466512702078522, 0.17167381974248927, 0.8607659142784682, 0]
    Val  Domain Accuracy [0.27860528097494924, 0.0, 0.0]

    Test  Label Loss = 136685.01203727722
    Test  Domain Loss = 18619.193586349487
    Test  Regularization Loss = 2024.0832924842834
    Test  Total Loss = 157328.288916111
    Test  Composite Score 4886.75
    Test  Label Accuracy [0.8423541776142932, 0.04591104734576758, 0.5658602150537635, 0.0]
    Test  Label F1 [0.5329122340425533, 0.08258064516129032, 0.6885648085048385, 0]
    Test  Domain Accuracy [0.1376854365875733, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 15227.110187530518
    Train  Domain Loss = 18189.55084991455
    Train  Regularization Loss = 1673.6221480369568
    Train  Total Loss = 35090.283185482025
    Train  Composite Score 16258.25
    Train  Label Accuracy [0.8539496116688767, 0.2857142857142857, 0.6823461091753774, 0.0]
    Train  Label F1 [0.7686602156954688, 0.31984647369262753, 0.7756415545837115, 0]
    Train  Domain Accuracy [0.5918075050128903, 0.0, 0.43072663038288933]

    Val  Label Loss = 1624.6934700012207
    Val  Domain Loss = 1878.1846504211426
    Val  Regularization Loss = 241.42373085021973
    Val  Total Loss = 3744.301851272583
    Val  Composite Score 2454.5
    Val  Label Accuracy [0.5455764075067024, 0.3422459893048128, 0.8990598713508164, 0.0]
    Val  Label F1 [0.5928623452294246, 0.38323353293413176, 0.8650321352059033, 0]
    Val  Domain Accuracy [0.7095463777928233, 0.0, 0.0]

    Test  Label Loss = 430116.34736824036
    Test  Domain Loss = 16708.99394416809
    Test  Regularization Loss = 2052.1017122268677
    Test  Total Loss = 448877.4430246353
    Test  Composite Score 5215.25
    Test  Label Accuracy [0.6636889122438255, 0.06025824964131994, 0.7379032258064516, 0.0]
    Test  Label F1 [0.5332488917036099, 0.0997624703087886, 0.7706164463679963, 0]
    Test  Domain Accuracy [0.7065675048203676, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 15001.278505325317
    Train  Domain Loss = 19361.231956481934
    Train  Regularization Loss = 1698.175323009491
    Train  Total Loss = 36060.68578481674
    Train  Composite Score 16373.5
    Train  Label Accuracy [0.861666038447041, 0.2777132907719095, 0.6922183507549361, 0.0]
    Train  Label F1 [0.7745214297814671, 0.3122858541360744, 0.7886205755871651, 0]
    Train  Domain Accuracy [0.5923804067602406, 0.0, 0.404086699131099]

    Val  Label Loss = 1608.8351516723633
    Val  Domain Loss = 2355.334259033203
    Val  Regularization Loss = 244.9211597442627
    Val  Total Loss = 4209.090570449829
    Val  Composite Score 2438.75
    Val  Label Accuracy [0.7412868632707775, 0.053475935828877004, 0.8431469569520039, 0.0]
    Val  Label F1 [0.6400462962962963, 0.09132420091324202, 0.8603887907094168, 0]
    Val  Domain Accuracy [0.10798916723087339, 0.0, 0.0]

    Test  Label Loss = 236964.81360816956
    Test  Domain Loss = 20475.317381858826
    Test  Regularization Loss = 2081.829857826233
    Test  Total Loss = 259521.9608478546
    Test  Composite Score 5039.75
    Test  Label Accuracy [0.8034682080924855, 0.027259684361549498, 0.6310483870967742, 0.0]
    Test  Label F1 [0.5439345428673069, 0.051144010767160165, 0.7257503542444931, 0]
    Test  Domain Accuracy [0.04741667650415142, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 14838.197132110596
    Train  Domain Loss = 17687.383186340332
    Train  Regularization Loss = 1604.2662115097046
    Train  Total Loss = 34129.84652996063
    Train  Composite Score 16450.75
    Train  Label Accuracy [0.8643524195830582, 0.2910037604859705, 0.6958478513356562, 0.0]
    Train  Label F1 [0.7790010626992562, 0.32295345104333867, 0.7917079616782292, 0]
    Train  Domain Accuracy [0.5761481905853146, 0.0, 0.4357872624844839]

    Val  Label Loss = 1525.9967994689941
    Val  Domain Loss = 1814.3310508728027
    Val  Regularization Loss = 216.36938095092773
    Val  Total Loss = 3556.6972312927246
    Val  Composite Score 2459.75
    Val  Label Accuracy [0.6796246648793566, 0.06417112299465241, 0.8787728847105394, 0.0]
    Val  Label F1 [0.6373350094280327, 0.11009174311926608, 0.8665528177604295, 0]
    Val  Domain Accuracy [0.8869329722410291, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 161678.85214233398
    Test  Domain Loss = 15664.418011665344
    Test  Regularization Loss = 1839.1397380828857
    Test  Total Loss = 179182.4098920822
    Test  Composite Score 5006.75
    Test  Label Accuracy [0.7819232790331057, 0.02295552367288379, 0.6310483870967742, 0.0]
    Test  Label F1 [0.5299145299145299, 0.043596730245231606, 0.7243507328362047, 0]
    Test  Domain Accuracy [0.9297997088104514, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 15929.985450744629
    Train  Domain Loss = 19883.43229675293
    Train  Regularization Loss = 1693.6304836273193
    Train  Total Loss = 37507.04823112488
    Train  Composite Score 16139.5
    Train  Label Accuracy [0.8310033285782216, 0.30313293818797626, 0.6896051103368177, 0.0]
    Train  Label F1 [0.7588363004776378, 0.33143033482487266, 0.7719184204111481, 0]
    Train  Domain Accuracy [0.5913300868900984, 0.0, 0.43836532034756037]

    Val  Label Loss = 1611.2095355987549
    Val  Domain Loss = 2048.509651184082
    Val  Regularization Loss = 241.2831687927246
    Val  Total Loss = 3901.0023555755615
    Val  Composite Score 2428.25
    Val  Label Accuracy [0.693029490616622, 0.10160427807486631, 0.8495794161306284, 0.0]
    Val  Label F1 [0.633578431372549, 0.14960629921259844, 0.8538040775733465, 0]
    Val  Domain Accuracy [0.4414353419092756, 0.0, 0.0]

    Test  Label Loss = 280680.89011764526
    Test  Domain Loss = 17814.87990283966
    Test  Regularization Loss = 2050.906934738159
    Test  Total Loss = 300546.6769552231
    Test  Composite Score 5044.25
    Test  Label Accuracy [0.7771939043615345, 0.040172166427546625, 0.6415770609318996, 0.0]
    Test  Label F1 [0.5354815351194787, 0.07291666666666666, 0.7309851965288413, 0]
    Test  Domain Accuracy [0.3248730964467005, 0.0, 0.0]

  EPOCH 20
    Train  Label Loss = 14910.310306549072
    Train  Domain Loss = 17654.863384246826
    Train  Regularization Loss = 1595.648518562317
    Train  Total Loss = 34160.822209358215
    Train  Composite Score 16404.75
    Train  Label Accuracy [0.8596059113300493, 0.3012564249000571, 0.6926538908246226, 0.0]
    Train  Label F1 [0.7747278548559233, 0.3321265543837557, 0.7894432034417144, 0]
    Train  Domain Accuracy [0.5897068652726057, 0.0, 0.4225150386708679]

    Val  Label Loss = 1592.8679428100586
    Val  Domain Loss = 2080.7875480651855
    Val  Regularization Loss = 219.06715393066406
    Val  Total Loss = 3892.722644805908
    Val  Composite Score 2437.25
    Val  Label Accuracy [0.693029490616622, 0.0481283422459893, 0.8604651162790697, 0.0]
    Val  Label F1 [0.6359163591635917, 0.07792207792207792, 0.8585534435941742, 0]
    Val  Domain Accuracy [0.4052132701421801, 0.0, 0.0]

    Test  Label Loss = 150543.6639213562
    Test  Domain Loss = 17638.518531799316
    Test  Regularization Loss = 1862.0708084106445
    Test  Total Loss = 170044.25326156616
    Test  Composite Score 5042.0
    Test  Label Accuracy [0.7619548081975828, 0.03443328550932568, 0.6482974910394266, 0.0]
    Test  Label F1 [0.5330882352941176, 0.06340819022457067, 0.7297944773672929, 0]
    Test  Domain Accuracy [0.5070239641128557, 0.0, 0.0]

  EPOCH 21
    Train  Label Loss = 14443.319515228271
    Train  Domain Loss = 18115.296394348145
    Train  Regularization Loss = 1569.61137008667
    Train  Total Loss = 34128.227279663086
    Train  Composite Score 16530.25
    Train  Label Accuracy [0.8729785633696878, 0.28667445938047925, 0.6977351916376306, 0.0]
    Train  Label F1 [0.7837757987591272, 0.3236021771400297, 0.7947085572550642, 0]
    Train  Domain Accuracy [0.5930487921321493, 0.0, 0.438269836723002]

    Val  Label Loss = 1561.4053897857666
    Val  Domain Loss = 1898.8225364685059
    Val  Regularization Loss = 219.0644645690918
    Val  Total Loss = 3679.2923908233643
    Val  Composite Score 2435.75
    Val  Label Accuracy [0.6541554959785523, 0.053475935828877004, 0.8733300346363186, 0.0]
    Val  Label F1 [0.621656050955414, 0.08695652173913043, 0.8592989289191819, 0]
    Val  Domain Accuracy [0.8784698713608666, 0.0, 0.0]

    Test  Label Loss = 197502.07190799713
    Test  Domain Loss = 17130.514749526978
    Test  Regularization Loss = 1862.0479488372803
    Test  Total Loss = 216494.6346063614
    Test  Composite Score 5077.25
    Test  Label Accuracy [0.7167630057803468, 0.03730272596843615, 0.6776433691756273, 0.0]
    Test  Label F1 [0.5254237288135593, 0.06797385620915032, 0.7404234487822787, 0]
    Test  Domain Accuracy [0.7165623893282965, 0.0, 0.0]

  EPOCH 22
    Train  Label Loss = 14468.177436828613
    Train  Domain Loss = 17609.538539886475
    Train  Regularization Loss = 1479.5100965499878
    Train  Total Loss = 33557.226073265076
    Train  Composite Score 16553.25
    Train  Label Accuracy [0.8757552870090635, 0.29688401615695326, 0.6965737514518002, 0.0]
    Train  Label F1 [0.7849043831443561, 0.338042049934297, 0.7913574138215405, 0]
    Train  Domain Accuracy [0.5732836818485629, 0.0, 0.4464814284350234]

    Val  Label Loss = 1689.3060302734375
    Val  Domain Loss = 2337.69002532959
    Val  Regularization Loss = 210.75561046600342
    Val  Total Loss = 4237.751666069031
    Val  Composite Score 2438.75
    Val  Label Accuracy [0.693029490616622, 0.1711229946524064, 0.8500742206828302, 0.0]
    Val  Label F1 [0.64504054897068, 0.2222222222222222, 0.8553647000248942, 0]
    Val  Domain Accuracy [0.0, 0.0, 0.0]

    Test  Label Loss = 263790.9145298004
    Test  Domain Loss = 19727.956747055054
    Test  Regularization Loss = 1791.422688961029
    Test  Total Loss = 285310.2939658165
    Test  Composite Score 5086.25
    Test  Label Accuracy [0.7561744613767735, 0.047345767575322814, 0.6619623655913979, 0.0]
    Test  Label F1 [0.5404694835680751, 0.08088235294117647, 0.7399524226868661, 0]
    Test  Domain Accuracy [7.869987801518908e-05, 0.0, 0.0]

  EPOCH 23
    Train  Label Loss = 14373.89342880249
    Train  Domain Loss = 17975.354568481445
    Train  Regularization Loss = 1511.8996329307556
    Train  Total Loss = 33861.14763021469
    Train  Composite Score 16630.5
    Train  Label Accuracy [0.8803531179564238, 0.29530791788856303, 0.6994773519163763, 0.0]
    Train  Label F1 [0.7881947363995628, 0.3383168150512347, 0.7942631058358061, 0]
    Train  Domain Accuracy [0.5940036283777332, 0.0, 0.43187243387759]

    Val  Label Loss = 1633.0540580749512
    Val  Domain Loss = 2493.805824279785
    Val  Regularization Loss = 210.9087324142456
    Val  Total Loss = 4337.768614768982
    Val  Composite Score 2426.0
    Val  Label Accuracy [0.5723860589812333, 0.0, 0.9020286986640277, 0.0]
    Val  Label F1 [0.5813478556841389, 0, 0.8576805457539403, 0]
    Val  Domain Accuracy [0.00033852403520649965, 0.0, 0.0]

    Test  Label Loss = 120492.61972045898
    Test  Domain Loss = 21335.447326660156
    Test  Regularization Loss = 1792.7242255210876
    Test  Total Loss = 143620.79127264023
    Test  Composite Score 5207.0
    Test  Label Accuracy [0.6405675249605886, 0.015781922525107604, 0.7522401433691757, 0.0]
    Test  Label F1 [0.520384204909285, 0.030683403068340304, 0.7696539078615632, 0]
    Test  Domain Accuracy [0.0001967496950379727, 0.0, 0.0]

  EPOCH 24
    Train  Label Loss = 14231.163970947266
    Train  Domain Loss = 17555.48105621338
    Train  Regularization Loss = 1418.5968523025513
    Train  Total Loss = 33205.241879463196
    Train  Composite Score 16673.25
    Train  Label Accuracy [0.8811352566504309, 0.28681253696037845, 0.7081881533101045, 0.0]
    Train  Label F1 [0.7919016752251873, 0.32495812395309875, 0.8032273999670674, 0]
    Train  Domain Accuracy [0.5785352811992743, 0.0, 0.44380788694738854]

    Val  Label Loss = 1615.137580871582
    Val  Domain Loss = 1347.3125400543213
    Val  Regularization Loss = 198.99945259094238
    Val  Total Loss = 3161.4495735168457
    Val  Composite Score 2425.25
    Val  Label Accuracy [0.7265415549597856, 0.08021390374331551, 0.8372093023255814, 0.0]
    Val  Label F1 [0.6317016317016316, 0.1276595744680851, 0.8551933282789994, 0]
    Val  Domain Accuracy [0.998645903859174, 0.0, 0.0]

    Test  Label Loss = 225579.6543416977
    Test  Domain Loss = 12384.822849750519
    Test  Regularization Loss = 1691.4953470230103
    Test  Total Loss = 239655.97253847122
    Test  Composite Score 4877.0
    Test  Label Accuracy [0.8003152916447714, 0.024390243902439025, 0.5842293906810035, 0.0]
    Test  Label F1 [0.5209509149991448, 0.045576407506702415, 0.6922362309223623, 0]
    Test  Domain Accuracy [0.9997639003659544, 0.0, 0.0]

  EPOCH 25
    Train  Label Loss = 14074.025625228882
    Train  Domain Loss = 17514.76298904419
    Train  Regularization Loss = 1363.5157651901245
    Train  Total Loss = 32952.304379463196
    Train  Composite Score 16695.75
    Train  Label Accuracy [0.8773522458628842, 0.3158196956646569, 0.712253193960511, 0.0]
    Train  Label F1 [0.7888114266281245, 0.3539253539253539, 0.8084370107934415, 0]
    Train  Domain Accuracy [0.5857920366657118, 0.0, 0.44380788694738854]

    Val  Label Loss = 1582.787836074829
    Val  Domain Loss = 1842.7814178466797
    Val  Regularization Loss = 191.7765712738037
    Val  Total Loss = 3617.3458251953125
    Val  Composite Score 2419.25
    Val  Label Accuracy [0.6300268096514745, 0.026737967914438502, 0.8738248391885205, 0.0]
    Val  Label F1 [0.5987261146496815, 0.04878048780487805, 0.8545850471812242, 0]
    Val  Domain Accuracy [0.8429248476641842, 0.0, 0.0]

    Test  Label Loss = 145230.41213417053
    Test  Domain Loss = 16011.67855834961
    Test  Regularization Loss = 1630.1008558273315
    Test  Total Loss = 162872.19154834747
    Test  Composite Score 5081.0
    Test  Label Accuracy [0.7178139779295849, 0.02295552367288379, 0.6805555555555556, 0.0]
    Test  Label F1 [0.5233716475095785, 0.04377564979480164, 0.7430598018833313, 0]
    Test  Domain Accuracy [0.8328021091567308, 0.0, 0.0]

  EPOCH 26
    Train  Label Loss = 13786.608386993408
    Train  Domain Loss = 18118.479751586914
    Train  Regularization Loss = 1365.8954858779907
    Train  Total Loss = 33270.98362445831
    Train  Composite Score 16701.5
    Train  Label Accuracy [0.8784650198001132, 0.31431054461181923, 0.7109465737514518, 0.0]
    Train  Label F1 [0.790681885687614, 0.3487064116985376, 0.8117695814338997, 0]
    Train  Domain Accuracy [0.6084216556860499, 0.0, 0.4239472930392438]

    Val  Label Loss = 1607.7734489440918
    Val  Domain Loss = 1524.1311225891113
    Val  Regularization Loss = 194.63905334472656
    Val  Total Loss = 3326.5436248779297
    Val  Composite Score 2420.75
    Val  Label Accuracy [0.7184986595174263, 0.0053475935828877, 0.8441365660564077, 0.0]
    Val  Label F1 [0.6243447874199185, 0.010526315789473684, 0.8527868032991751, 0]
    Val  Domain Accuracy [0.999322951929587, 0.0, 0.0]

    Test  Label Loss = 140753.13106155396
    Test  Domain Loss = 13640.080474853516
    Test  Regularization Loss = 1654.4319534301758
    Test  Total Loss = 156047.64348983765
    Test  Composite Score 5000.0
    Test  Label Accuracy [0.7882291119285338, 0.011477761836441894, 0.6281362007168458, 0.0]
    Test  Label F1 [0.5322924059616749, 0.02247191011235955, 0.7208226221079691, 0]
    Test  Domain Accuracy [0.9993310510368709, 0.0, 0.0]

  EPOCH 27
    Train  Label Loss = 13721.487424850464
    Train  Domain Loss = 18290.8780708313
    Train  Regularization Loss = 1351.9545612335205
    Train  Total Loss = 33364.32005691528
    Train  Composite Score 16807.25
    Train  Label Accuracy [0.8916588566073103, 0.30962219598583235, 0.7073170731707317, 0.0]
    Train  Label F1 [0.7987909827463162, 0.3472934944545605, 0.8114590273151231, 0]
    Train  Domain Accuracy [0.5814952735605844, 0.0, 0.4291034087653967]

    Val  Label Loss = 1636.3586235046387
    Val  Domain Loss = 1430.4508018493652
    Val  Regularization Loss = 192.36056327819824
    Val  Total Loss = 3259.169988632202
    Val  Composite Score 2420.75
    Val  Label Accuracy [0.7091152815013405, 0.18716577540106952, 0.830776843146957, 0.0]
    Val  Label F1 [0.6392749244712991, 0.23411371237458195, 0.8492665655032877, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 116818.87318611145
    Test  Domain Loss = 12926.60914850235
    Test  Regularization Loss = 1635.064787864685
    Test  Total Loss = 131380.54712247849
    Test  Composite Score 4919.75
    Test  Label Accuracy [0.8223857067787703, 0.058823529411764705, 0.5822132616487455, 0.0]
    Test  Label F1 [0.5320414754377019, 0.10199004975124379, 0.6985620212337051, 0]
    Test  Domain Accuracy [0.9996852004879393, 0.0, 0.0]

  EPOCH 28
    Train  Label Loss = 13721.136329650879
    Train  Domain Loss = 18221.84064102173
    Train  Regularization Loss = 1342.4743719100952
    Train  Total Loss = 33285.4513425827
    Train  Composite Score 16866.5
    Train  Label Accuracy [0.8917096018735363, 0.29559562518474725, 0.725609756097561, 0.0]
    Train  Label F1 [0.8007570977917982, 0.33517680576504105, 0.8248205297466789, 0]
    Train  Domain Accuracy [0.5503676119545498, 0.0, 0.46223622648715745]

    Val  Label Loss = 1568.5131511688232
    Val  Domain Loss = 2014.6497344970703
    Val  Regularization Loss = 188.89928340911865
    Val  Total Loss = 3772.062169075012
    Val  Composite Score 2447.0
    Val  Label Accuracy [0.5482573726541555, 0.10160427807486631, 0.9153884215734784, 0.0]
    Val  Label F1 [0.5872218234027279, 0.1645021645021645, 0.8636788048552755, 0]
    Val  Domain Accuracy [0.7704807041299933, 0.0, 0.0]

    Test  Label Loss = 229742.85969161987
    Test  Domain Loss = 17432.678241729736
    Test  Regularization Loss = 1605.6439089775085
    Test  Total Loss = 248781.18184232712
    Test  Composite Score 5233.25
    Test  Label Accuracy [0.6064109301103521, 0.03012912482065997, 0.7724014336917563, 0.0]
    Test  Label F1 [0.5135736537605696, 0.056451612903225805, 0.7757030371203599, 0]
    Test  Domain Accuracy [0.7818045882028883, 0.0, 0.0]

  EPOCH 29
    Train  Label Loss = 13835.573568344116
    Train  Domain Loss = 17510.868286132812
    Train  Regularization Loss = 1283.4511036872864
    Train  Total Loss = 32629.892958164215
    Train  Composite Score 16761.75
    Train  Label Accuracy [0.8790406673618353, 0.3248788828726133, 0.7198025551684089, 0.0]
    Train  Label F1 [0.7919210897134806, 0.36007580543272266, 0.8175447275125731, 0]
    Train  Domain Accuracy [0.548935357586174, 0.0, 0.4768452210445909]

    Val  Label Loss = 1717.2041664123535
    Val  Domain Loss = 2134.2474403381348
    Val  Regularization Loss = 177.54199504852295
    Val  Total Loss = 4028.9936017990112
    Val  Composite Score 2408.75
    Val  Label Accuracy [0.7573726541554959, 0.0374331550802139, 0.8189015338941118, 0.0]
    Val  Label F1 [0.6295264623955432, 0.06829268292682927, 0.8469805527123848, 0]
    Val  Domain Accuracy [0.14556533513879485, 0.0, 0.0]

    Test  Label Loss = 182057.815284729
    Test  Domain Loss = 18550.51687335968
    Test  Regularization Loss = 1509.106957912445
    Test  Total Loss = 202117.43911600113
    Test  Composite Score 4820.0
    Test  Label Accuracy [0.8591697320021019, 0.020086083213773313, 0.5427867383512545, 0.0]
    Test  Label F1 [0.5296404275996112, 0.03862068965517241, 0.6703555125190206, 0]
    Test  Domain Accuracy [0.04548852949277929, 0.0, 0.0]
