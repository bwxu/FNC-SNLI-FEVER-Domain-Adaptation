Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
Loading CNN vectors...
SIZE_TRAIN = 94441
SIZE_VAL = 5908
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 18707.557258605957
    Train  Domain Loss = 14785.893743515015
    Train  Regularization Loss = 2447.4500789642334
    Train  Total Loss = 35940.901081085205
    Train  Composite Score 15396.0
    Train  Label Accuracy [0.8134405084587345, 0.16135754688895504, 0.6264518002322881, 0.0]
    Train  Label F1 [0.7270069334224376, 0.19305431878895815, 0.7020255429919466, 0]
    Train  Domain Accuracy [0.8115153251217416, 0.0, 0.6314332092046214]

    Val  Label Loss = 3806.825915336609
    Val  Domain Loss = 2100.698083758354
    Val  Regularization Loss = 680.4801177978516
    Val  Total Loss = 6588.004116892815
    Val  Composite Score 4666.0
    Val  Label Accuracy [0.9443496073745306, 0.009394572025052192, 0.7308263236021771, 0.0]
    Val  Label F1 [0.7741393786733837, 0.018556701030927835, 0.7983783783783783, 0]
    Val  Domain Accuracy [0.6134055517941774, 0.0, 0.995260663507109]

    Test  Label Loss = 142837.2685394287
    Test  Domain Loss = 18574.63349533081
    Test  Regularization Loss = 2892.040500640869
    Test  Total Loss = 164303.9425354004
    Test  Composite Score 4615.25
    Test  Label Accuracy [0.9085654230162901, 0.0, 0.4637096774193548, 0.0]
    Test  Label F1 [0.5166591961751084, 0, 0.6146080760095012, 0]
    Test  Domain Accuracy [0.5301223783103136, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 18773.075744628906
    Train  Domain Loss = 61548.86687088013
    Train  Regularization Loss = 2385.557734489441
    Train  Total Loss = 82707.50034999847
    Train  Composite Score 15474.0
    Train  Label Accuracy [0.8042865200225606, 0.2213450292397661, 0.6332752613240418, 0.0]
    Train  Label F1 [0.7282321899736147, 0.2500825900231252, 0.7112922951487973, 0]
    Train  Domain Accuracy [0.6367802921798912, 0.0, 0.4473407810560489]

    Val  Label Loss = 4481.933502197266
    Val  Domain Loss = 7538.284468173981
    Val  Regularization Loss = 694.0111541748047
    Val  Total Loss = 12714.229124546051
    Val  Composite Score 4256.5
    Val  Label Accuracy [0.5732331853875042, 0.6805845511482255, 0.6803562592775854, 0.0]
    Val  Label F1 [0.6468888460797534, 0.4232392080493346, 0.7759593679458241, 0]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    Test  Label Loss = 946139.4764490128
    Test  Domain Loss = 59426.83337402344
    Test  Regularization Loss = 2949.54740524292
    Test  Total Loss = 1008515.8572282791
    Test  Composite Score 4407.5
    Test  Label Accuracy [0.6610614818707304, 0.4835007173601148, 0.43167562724014336, 0.0]
    Test  Label F1 [0.5198347107438016, 0.2485250737463127, 0.5860705596107056, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 22316.107498168945
    Train  Domain Loss = 31405.198303222656
    Train  Regularization Loss = 2359.9334802627563
    Train  Total Loss = 56081.23928165436
    Train  Composite Score 14899.75
    Train  Label Accuracy [0.7485540912107709, 0.23440615209342067, 0.6100464576074333, 0.0]
    Train  Label F1 [0.695288419198591, 0.24755602346217473, 0.6763238371157252, 0]
    Train  Domain Accuracy [0.555810178554378, 0.0, 0.4547885037716032]

    Val  Label Loss = 4499.918523788452
    Val  Domain Loss = 3977.307599544525
    Val  Regularization Loss = 642.8186988830566
    Val  Total Loss = 9120.044822216034
    Val  Composite Score 3955.75
    Val  Label Accuracy [0.2560600887674974, 0.8716075156576201, 0.851063829787234, 0.0]
    Val  Label F1 [0.3896103896103896, 0.4287548138639281, 0.8450012281994596, 0]
    Val  Domain Accuracy [0.07142857142857142, 0.0, 0.9143534190927556]

    Test  Label Loss = 1109590.5484275818
    Test  Domain Loss = 20822.588947296143
    Test  Regularization Loss = 2731.9794702529907
    Test  Total Loss = 1133145.116845131
    Test  Composite Score 4796.75
    Test  Label Accuracy [0.3152916447714136, 0.6341463414634146, 0.6718189964157706, 0.0]
    Test  Label F1 [0.3868471953578337, 0.29281218946671084, 0.749094542275509, 0]
    Test  Domain Accuracy [0.06536024869161453, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 17256.21640777588
    Train  Domain Loss = 48225.872871398926
    Train  Regularization Loss = 2195.5124683380127
    Train  Total Loss = 67677.60174751282
    Train  Composite Score 15740.25
    Train  Label Accuracy [0.812576600358254, 0.25065198493190377, 0.6610046457607434, 0.0]
    Train  Label F1 [0.7377070227243547, 0.2751272264631043, 0.7500205913845647, 0]
    Train  Domain Accuracy [0.5548553423087941, 0.0, 0.428435023393488]

    Val  Label Loss = 4364.604259490967
    Val  Domain Loss = 6589.806683540344
    Val  Regularization Loss = 647.8443717956543
    Val  Total Loss = 11602.255314826965
    Val  Composite Score 4773.25
    Val  Label Accuracy [0.9265961078866507, 0.0, 0.8317664522513607, 0.0]
    Val  Label F1 [0.7884950610110402, 0, 0.8459989934574734, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 224571.43786239624
    Test  Domain Loss = 4540.335873126984
    Test  Regularization Loss = 2753.3385801315308
    Test  Total Loss = 231865.11231565475
    Test  Composite Score 5000.0
    Test  Label Accuracy [0.8507619548081976, 0.0, 0.6032706093189965, 0.0]
    Test  Label F1 [0.5473292765382015, 0, 0.7166999334664005, 0]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 22660.566478729248
    Train  Domain Loss = 35847.43268966675
    Train  Regularization Loss = 2271.0430221557617
    Train  Total Loss = 60779.04219055176
    Train  Composite Score 14892.25
    Train  Label Accuracy [0.75, 0.23472949389179756, 0.6009001161440186, 0.0]
    Train  Label F1 [0.6955420687246212, 0.2422695887120985, 0.6775804207252191, 0]
    Train  Domain Accuracy [0.5545688914351189, 0.0, 0.4042776663802158]

    Val  Label Loss = 3708.81151676178
    Val  Domain Loss = 4671.111186027527
    Val  Regularization Loss = 640.9087371826172
    Val  Total Loss = 9020.831439971924
    Val  Composite Score 4711.75
    Val  Label Accuracy [0.804028678729942, 0.3893528183716075, 0.7842652152399802, 0.0]
    Val  Label F1 [0.7713724205699313, 0.3911903513371788, 0.8335524585853273, 0]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    Test  Label Loss = 264477.84108638763
    Test  Domain Loss = 31798.74005317688
    Test  Regularization Loss = 2723.862133026123
    Test  Total Loss = 299000.44327259064
    Test  Composite Score 4937.0
    Test  Label Accuracy [0.7945349448239621, 0.1908177905308465, 0.5786290322580645, 0.0]
    Test  Label F1 [0.5422270037654653, 0.22390572390572389, 0.701616189053375, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 18851.32806777954
    Train  Domain Loss = 19199.350074768066
    Train  Regularization Loss = 2126.68807220459
    Train  Total Loss = 40177.3662147522
    Train  Composite Score 15391.5
    Train  Label Accuracy [0.7812294078885438, 0.24512372634643376, 0.6430023228803716, 0.0]
    Train  Label F1 [0.7207121146330874, 0.25342362678705793, 0.7304362167065226, 0]
    Train  Domain Accuracy [0.5527547025685094, 0.0, 0.46089945574334]

    Val  Label Loss = 3711.1965103149414
    Val  Domain Loss = 4051.574921607971
    Val  Regularization Loss = 546.9885635375977
    Val  Total Loss = 8309.75999546051
    Val  Composite Score 4796.5
    Val  Label Accuracy [0.7753499487879822, 0.2567849686847599, 0.9445818901533894, 0.0]
    Val  Label F1 [0.7752176139272913, 0.33814432989690724, 0.8480675255442026, 0]
    Val  Domain Accuracy [0.02911306702775897, 0.0, 0.999322951929587]

    Test  Label Loss = 237731.39578533173
    Test  Domain Loss = 21087.288858413696
    Test  Regularization Loss = 2324.70139503479
    Test  Total Loss = 261143.3860387802
    Test  Composite Score 5258.75
    Test  Label Accuracy [0.36573830793483975, 0.0746054519368723, 0.8756720430107527, 0.0]
    Test  Label F1 [0.4153983885407341, 0.1265206812652068, 0.785334003013561, 0]
    Test  Domain Accuracy [0.019635619564789673, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 19252.72568130493
    Train  Domain Loss = 31165.360290527344
    Train  Regularization Loss = 2151.865252494812
    Train  Total Loss = 52569.95122432709
    Train  Composite Score 15319.25
    Train  Label Accuracy [0.7913199697428139, 0.21280873061458933, 0.6340011614401858, 0.0]
    Train  Label F1 [0.7196663513629719, 0.23557463042441584, 0.7133872416891285, 0]
    Train  Domain Accuracy [0.6123364842929437, 0.0, 0.40695120786785066]

    Val  Label Loss = 3942.263002872467
    Val  Domain Loss = 5206.401725769043
    Val  Regularization Loss = 659.4133758544922
    Val  Total Loss = 9808.078104496002
    Val  Composite Score 4806.25
    Val  Label Accuracy [0.8682144076476613, 0.005219206680584551, 0.9356754082137556, 0.0]
    Val  Label F1 [0.7913489964213474, 0.010384215991692628, 0.8544961590600993, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 450777.1918735504
    Test  Domain Loss = 4022.881372451782
    Test  Regularization Loss = 2802.506847381592
    Test  Total Loss = 457602.5800933838
    Test  Composite Score 5324.75
    Test  Label Accuracy [0.535470310036784, 0.0, 0.8346774193548387, 0.0]
    Test  Label F1 [0.5050805452292441, 0, 0.7931034482758622, 0]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 20961.35768508911
    Train  Domain Loss = 30894.48676300049
    Train  Regularization Loss = 2389.907509803772
    Train  Total Loss = 54245.75195789337
    Train  Composite Score 15078.25
    Train  Label Accuracy [0.7712024123633622, 0.2179338363319791, 0.6164343786295006, 0.0]
    Train  Label F1 [0.7083261208239571, 0.23509156362498043, 0.6949832228496603, 0]
    Train  Domain Accuracy [0.613386804163086, 0.0, 0.3632197078201089]

    Val  Label Loss = 5436.653555393219
    Val  Domain Loss = 6518.193044662476
    Val  Regularization Loss = 718.4813690185547
    Val  Total Loss = 12673.32796907425
    Val  Composite Score 4279.75
    Val  Label Accuracy [0.99419597132127, 0.04279749478079332, 0.38792676892627415, 0.0]
    Val  Label F1 [0.7322102087000252, 0.0784688995215311, 0.5566205182818602, 0]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    Test  Label Loss = 1252455.200345993
    Test  Domain Loss = 48482.25232887268
    Test  Regularization Loss = 3053.5458183288574
    Test  Total Loss = 1303990.9984931946
    Test  Composite Score 3842.0
    Test  Label Accuracy [0.9826589595375722, 0.00860832137733142, 0.19982078853046595, 0.0]
    Test  Label F1 [0.46627602543323776, 0.01652892561983471, 0.3315368890540792, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 24890.861888885498
    Train  Domain Loss = 27787.53614807129
    Train  Regularization Loss = 2682.136224746704
    Train  Total Loss = 55360.53426170349
    Train  Composite Score 14761.5
    Train  Label Accuracy [0.7334211268930486, 0.2521155529617741, 0.5937862950058072, 0.0]
    Train  Label F1 [0.6878087508821454, 0.2503622138510576, 0.6724208795725442, 0]
    Train  Domain Accuracy [0.6118590661701518, 0.0, 0.3847035233457462]

    Val  Label Loss = 4264.4528341293335
    Val  Domain Loss = 3965.3029136657715
    Val  Regularization Loss = 748.9831352233887
    Val  Total Loss = 8978.738883018494
    Val  Composite Score 4799.5
    Val  Label Accuracy [0.8511437350631615, 0.0041753653444676405, 0.9564571994062345, 0.0]
    Val  Label F1 [0.7900491205831089, 0.008316008316008315, 0.8509795289456307, 0]
    Val  Domain Accuracy [0.527758970886933, 0.0, 0.6330399458361544]

    Test  Label Loss = 1676693.6080265045
    Test  Domain Loss = 17565.688479423523
    Test  Regularization Loss = 3183.178324699402
    Test  Total Loss = 1697442.4748306274
    Test  Composite Score 5308.25
    Test  Label Accuracy [0.41723594324750396, 0.0, 0.880152329749104, 0.0]
    Test  Label F1 [0.44960362400906, 0, 0.7938175573290231, 0]
    Test  Domain Accuracy [0.4310785818281982, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 18422.29360961914
    Train  Domain Loss = 17626.138179779053
    Train  Regularization Loss = 2249.900884628296
    Train  Total Loss = 38298.33267402649
    Train  Composite Score 15570.25
    Train  Label Accuracy [0.788983927060814, 0.2351564785024861, 0.6684088269454123, 0.0]
    Train  Label F1 [0.7289938772851623, 0.24776579352850542, 0.7484961794830108, 0]
    Train  Domain Accuracy [0.6187338871383558, 0.0, 0.43769693497565165]

    Val  Label Loss = 3786.4002137184143
    Val  Domain Loss = 3943.243540763855
    Val  Regularization Loss = 552.8171539306641
    Val  Total Loss = 8282.460908412933
    Val  Composite Score 4809.25
    Val  Label Accuracy [0.8863093205872311, 0.014613778705636743, 0.9069767441860465, 0.0]
    Val  Label F1 [0.7915840829394726, 0.02880658436213992, 0.8555425904317386, 0]
    Val  Domain Accuracy [0.9867975626269465, 0.0, 0.18855788761002032]

    Test  Label Loss = 675742.1504402161
    Test  Domain Loss = 15114.376724243164
    Test  Regularization Loss = 2349.4729042053223
    Test  Total Loss = 693206.0000686646
    Test  Composite Score 5252.0
    Test  Label Accuracy [0.6305832895428272, 0.0, 0.7724014336917563, 0.0]
    Test  Label F1 [0.5279366476022878, 0, 0.7761395610579628, 0]
    Test  Domain Accuracy [0.9812300790933774, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 17244.587589263916
    Train  Domain Loss = 20765.646530151367
    Train  Regularization Loss = 2037.7328548431396
    Train  Total Loss = 40047.96697425842
    Train  Composite Score 15796.75
    Train  Label Accuracy [0.817781525201424, 0.25325059101654845, 0.656068524970964, 0.0]
    Train  Label F1 [0.7435580731717706, 0.2757400257400257, 0.7455250350573289, 0]
    Train  Domain Accuracy [0.6079442375632579, 0.0, 0.4253795474076196]

    Val  Label Loss = 3883.359208583832
    Val  Domain Loss = 3949.754376411438
    Val  Regularization Loss = 615.6769752502441
    Val  Total Loss = 8448.790560245514
    Val  Composite Score 4826.5
    Val  Label Accuracy [0.8514851485148515, 0.030271398747390398, 0.9614052449282533, 0.0]
    Val  Label F1 [0.7943940117853161, 0.058704453441295545, 0.8542536821279402, 0]
    Val  Domain Accuracy [0.24373730534867977, 0.0, 0.9306025727826676]

    Test  Label Loss = 826843.832698822
    Test  Domain Loss = 19406.20516204834
    Test  Regularization Loss = 2616.6271448135376
    Test  Total Loss = 848866.6650056839
    Test  Composite Score 5340.5
    Test  Label Accuracy [0.4576983709931687, 0.0014347202295552368, 0.8723118279569892, 0.0]
    Test  Label F1 [0.4756963407973785, 0.002861230329041488, 0.7973789290467903, 0]
    Test  Domain Accuracy [0.14205327981741628, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 16314.372379302979
    Train  Domain Loss = 17839.58588409424
    Train  Regularization Loss = 2019.6188488006592
    Train  Total Loss = 36173.577112197876
    Train  Composite Score 15981.25
    Train  Label Accuracy [0.8323426738371544, 0.2500722752240532, 0.6759581881533101, 0.0]
    Train  Label F1 [0.753148077005165, 0.27460317460317457, 0.7686339248865044, 0]
    Train  Domain Accuracy [0.5460708488494224, 0.0, 0.4665329895922849]

    Val  Label Loss = 3485.025541782379
    Val  Domain Loss = 4112.111199378967
    Val  Regularization Loss = 529.9341773986816
    Val  Total Loss = 8127.070918560028
    Val  Composite Score 4829.5
    Val  Label Accuracy [0.9119153294639809, 0.03966597077244259, 0.8713508164275111, 0.0]
    Val  Label F1 [0.7966000596480763, 0.07622868605817452, 0.8563092633114514, 0]
    Val  Domain Accuracy [0.051117129316181446, 0.0, 0.9644549763033176]

    Test  Label Loss = 665301.9325294495
    Test  Domain Loss = 19277.222774505615
    Test  Regularization Loss = 2252.220253944397
    Test  Total Loss = 686831.3755578995
    Test  Composite Score 5016.5
    Test  Label Accuracy [0.8055701523909616, 0.0014347202295552368, 0.6272401433691757, 0.0]
    Test  Label F1 [0.5394088669950738, 0.002857142857142857, 0.7231404958677685, 0]
    Test  Domain Accuracy [0.08420886947625231, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 16079.616916656494
    Train  Domain Loss = 20567.36312866211
    Train  Regularization Loss = 1886.3930006027222
    Train  Total Loss = 38533.373045921326
    Train  Composite Score 16066.5
    Train  Label Accuracy [0.8347138554216867, 0.262085032032615, 0.6820557491289199, 0.0]
    Train  Label F1 [0.7576573112905293, 0.28850777368167974, 0.7723162913036331, 0]
    Train  Domain Accuracy [0.6051752124510646, 0.0, 0.4162131194500143]

    Val  Label Loss = 3932.298819541931
    Val  Domain Loss = 4052.8446254730225
    Val  Regularization Loss = 572.9898262023926
    Val  Total Loss = 8558.133271217346
    Val  Composite Score 4679.5
    Val  Label Accuracy [0.9784909525435302, 0.04801670146137787, 0.6719445818901534, 0.0]
    Val  Label F1 [0.7801823873689941, 0.09154228855721394, 0.7840646651270209, 0]
    Val  Domain Accuracy [0.35815842924847663, 0.0, 0.7786052809749492]

    Test  Label Loss = 1115521.0381355286
    Test  Domain Loss = 18003.530128479004
    Test  Regularization Loss = 2435.2067613601685
    Test  Total Loss = 1135959.7750253677
    Test  Composite Score 4583.75
    Test  Label Accuracy [0.929584866001051, 0.021520803443328552, 0.44198028673835127, 0.0]
    Test  Label F1 [0.5185402315696908, 0.041436464088397795, 0.5996049232639417, 0]
    Test  Domain Accuracy [0.3236138983984575, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 18363.258642196655
    Train  Domain Loss = 24299.011688232422
    Train  Regularization Loss = 2185.8691234588623
    Train  Total Loss = 44848.13945388794
    Train  Composite Score 15674.5
    Train  Label Accuracy [0.8056649784280623, 0.2661955241460542, 0.6475029036004646, 0.0]
    Train  Label F1 [0.7391790723689873, 0.2806146205183921, 0.737372902372489, 0]
    Train  Domain Accuracy [0.5730927145994462, 0.0, 0.39539768929628566]

    Val  Label Loss = 4604.5726861953735
    Val  Domain Loss = 4091.777090072632
    Val  Regularization Loss = 629.2766189575195
    Val  Total Loss = 9325.626395225525
    Val  Composite Score 4807.0
    Val  Label Accuracy [0.9221577330146807, 0.010438413361169102, 0.855517070757051, 0.0]
    Val  Label F1 [0.7944117647058824, 0.020639834881320953, 0.8544600938967137, 0]
    Val  Domain Accuracy [0.17907921462423831, 0.0, 0.8337846987136087]

    Test  Label Loss = 861818.8330497742
    Test  Domain Loss = 18908.591265678406
    Test  Regularization Loss = 2674.425630569458
    Test  Total Loss = 883401.849946022
    Test  Composite Score 5161.25
    Test  Label Accuracy [0.7792958486600106, 0.0014347202295552368, 0.6816756272401434, 0.0]
    Test  Label F1 [0.55325498974072, 0.002861230329041488, 0.7543381259295984, 0]
    Test  Domain Accuracy [0.20517058198559793, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 16431.155960083008
    Train  Domain Loss = 17621.80954360962
    Train  Regularization Loss = 1954.9032745361328
    Train  Total Loss = 36007.86877822876
    Train  Composite Score 16089.75
    Train  Label Accuracy [0.8235960358659745, 0.28905573202425644, 0.6909117305458768, 0.0]
    Train  Label F1 [0.7571038132835884, 0.3019152465691449, 0.7824085491163172, 0]
    Train  Domain Accuracy [0.5752888379642891, 0.0, 0.44132531270887043]

    Val  Label Loss = 3244.8074169158936
    Val  Domain Loss = 4154.615407943726
    Val  Regularization Loss = 503.9673042297363
    Val  Total Loss = 7903.3901290893555
    Val  Composite Score 4869.25
    Val  Label Accuracy [0.9184021850460908, 0.17745302713987474, 0.8228599703117269, 0.0]
    Val  Label F1 [0.805268672354438, 0.28475711892797323, 0.8439482364882009, 0]
    Val  Domain Accuracy [0.994583615436696, 0.0, 0.001015572105619499]

    Test  Label Loss = 203977.58212471008
    Test  Domain Loss = 16495.355810165405
    Test  Regularization Loss = 2141.8610429763794
    Test  Total Loss = 222614.79897785187
    Test  Composite Score 4994.0
    Test  Label Accuracy [0.8255386232264845, 0.05738880918220947, 0.6032706093189965, 0.0]
    Test  Label F1 [0.544163491513682, 0.10050251256281406, 0.7126223868748347, 0]
    Test  Domain Accuracy [0.9913823633573368, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 15554.134168624878
    Train  Domain Loss = 18095.26435470581
    Train  Regularization Loss = 1776.6795749664307
    Train  Total Loss = 35426.07809829712
    Train  Composite Score 16233.75
    Train  Label Accuracy [0.8493850520340587, 0.27035550458715596, 0.6909117305458768, 0.0]
    Train  Label F1 [0.7665642076502731, 0.3038504913806992, 0.7795249795249795, 0]
    Train  Domain Accuracy [0.5920939558865654, 0.0, 0.4339730736178745]

    Val  Label Loss = 3552.3437271118164
    Val  Domain Loss = 4021.4912843704224
    Val  Regularization Loss = 494.6891212463379
    Val  Total Loss = 8068.524132728577
    Val  Composite Score 4873.0
    Val  Label Accuracy [0.8508023216114715, 0.12734864300626306, 0.9470559129143988, 0.0]
    Val  Label F1 [0.8010286081645773, 0.22202001819836217, 0.8516129032258064, 0]
    Val  Domain Accuracy [0.35815842924847663, 0.0, 0.7670954637779283]

    Test  Label Loss = 247756.3366165161
    Test  Domain Loss = 18652.310272216797
    Test  Regularization Loss = 2102.428765296936
    Test  Total Loss = 268511.07565402985
    Test  Composite Score 5341.25
    Test  Label Accuracy [0.4771413557540725, 0.021520803443328552, 0.8611111111111112, 0.0]
    Test  Label F1 [0.48452508004268946, 0.041436464088397795, 0.7961888980944491, 0]
    Test  Domain Accuracy [0.3609569905166647, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 15309.26834487915
    Train  Domain Loss = 18674.575492858887
    Train  Regularization Loss = 1792.8688287734985
    Train  Total Loss = 35776.712666511536
    Train  Composite Score 16246.25
    Train  Label Accuracy [0.8456146997537413, 0.2957142857142857, 0.6877177700348432, 0.0]
    Train  Label F1 [0.7657275183326899, 0.326601451562007, 0.7782158698866436, 0]
    Train  Domain Accuracy [0.5916165377637735, 0.0, 0.4213692351761673]

    Val  Label Loss = 3579.280631542206
    Val  Domain Loss = 4030.415535926819
    Val  Regularization Loss = 496.0800361633301
    Val  Total Loss = 8105.776203632355
    Val  Composite Score 4840.0
    Val  Label Accuracy [0.9378627517924206, 0.31315240083507306, 0.7110341415141019, 0.0]
    Val  Label F1 [0.8094887284514513, 0.4092769440654843, 0.8066236317709794, 0]
    Val  Domain Accuracy [0.7538930264048748, 0.0, 0.5057549085985105]

    Test  Label Loss = 247361.72139549255
    Test  Domain Loss = 17149.07032585144
    Test  Regularization Loss = 2108.340153694153
    Test  Total Loss = 266619.13187503815
    Test  Composite Score 4601.75
    Test  Label Accuracy [0.8938518129269575, 0.10473457675753228, 0.4495967741935484, 0.0]
    Test  Label F1 [0.526299504950495, 0.1411992263056093, 0.6054298642533937, 0]
    Test  Domain Accuracy [0.7208121827411168, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 15128.062442779541
    Train  Domain Loss = 18070.75654220581
    Train  Regularization Loss = 1678.4451966285706
    Train  Total Loss = 34877.26418161392
    Train  Composite Score 16300.5
    Train  Label Accuracy [0.8469656992084432, 0.2864190365641323, 0.695993031358885, 0.0]
    Train  Label F1 [0.7687636316982422, 0.3139312977099237, 0.7878389482333608, 0]
    Train  Domain Accuracy [0.5965816862408096, 0.0, 0.4302492122600974]

    Val  Label Loss = 3100.8084206581116
    Val  Domain Loss = 4264.129034996033
    Val  Regularization Loss = 472.5779056549072
    Val  Total Loss = 7837.5153613090515
    Val  Composite Score 4888.0
    Val  Label Accuracy [0.9180607715944008, 0.15762004175365343, 0.8451261751608115, 0.0]
    Val  Label F1 [0.8083571321208478, 0.2610198789974071, 0.8527209186220668, 0]
    Val  Domain Accuracy [0.07345971563981042, 0.0, 0.909952606635071]

    Test  Label Loss = 630428.9922981262
    Test  Domain Loss = 18822.61958217621
    Test  Regularization Loss = 2008.4560990333557
    Test  Total Loss = 651260.0679793358
    Test  Composite Score 5033.75
    Test  Label Accuracy [0.7966368891224382, 0.03299856527977044, 0.6312724014336918, 0.0]
    Test  Label F1 [0.5402708481824662, 0.06108897742363878, 0.7260079866031175, 0]
    Test  Domain Accuracy [0.0454098296147641, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 14657.679912567139
    Train  Domain Loss = 17626.51537322998
    Train  Regularization Loss = 1578.1127758026123
    Train  Total Loss = 33862.30806159973
    Train  Composite Score 16481.25
    Train  Label Accuracy [0.8687859635883407, 0.2944749783048886, 0.6936701509872242, 0.0]
    Train  Label F1 [0.7808393387028401, 0.3314881146206447, 0.7883837967164424, 0]
    Train  Domain Accuracy [0.5761481905853146, 0.0, 0.4260479327795283]

    Val  Label Loss = 3250.5705823898315
    Val  Domain Loss = 3917.6338901519775
    Val  Regularization Loss = 453.96474838256836
    Val  Total Loss = 7622.169220924377
    Val  Composite Score 4844.5
    Val  Label Accuracy [0.9166951177876408, 0.13674321503131523, 0.8283028203859476, 0.0]
    Val  Label F1 [0.8006560310123751, 0.23083700440528632, 0.8424760946149975, 0]
    Val  Domain Accuracy [0.974272173324306, 0.0, 0.3832092078537576]

    Test  Label Loss = 342731.345741272
    Test  Domain Loss = 16156.678518295288
    Test  Regularization Loss = 1929.3501806259155
    Test  Total Loss = 360817.3744401932
    Test  Composite Score 5006.75
    Test  Label Accuracy [0.8192327903310562, 0.03730272596843615, 0.6129032258064516, 0.0]
    Test  Label F1 [0.5452002098268928, 0.06806282722513088, 0.7157619359058208, 0]
    Test  Domain Accuracy [0.9784755833628458, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 15859.59557723999
    Train  Domain Loss = 18707.506774902344
    Train  Regularization Loss = 1729.5937490463257
    Train  Total Loss = 36296.69610118866
    Train  Composite Score 16104.5
    Train  Label Accuracy [0.8435568235853542, 0.2763195032458369, 0.676829268292683, 0.0]
    Train  Label F1 [0.7581196581196581, 0.31509494689411005, 0.7631988213145617, 0]
    Train  Domain Accuracy [0.5989687768547695, 0.0, 0.4343550081161081]

    Val  Label Loss = 3275.3405055999756
    Val  Domain Loss = 4087.5386567115784
    Val  Regularization Loss = 491.74072265625
    Val  Total Loss = 7854.619884967804
    Val  Composite Score 4880.5
    Val  Label Accuracy [0.8265619665414817, 0.32150313152400833, 0.8951014349332014, 0.0]
    Val  Label F1 [0.7971682581494898, 0.40473061760840995, 0.8573459715639812, 0]
    Val  Domain Accuracy [0.8327691266079892, 0.0, 0.22173324306025727]

    Test  Label Loss = 382210.10639190674
    Test  Domain Loss = 16838.179843902588
    Test  Regularization Loss = 2089.8980712890625
    Test  Total Loss = 401138.1843070984
    Test  Composite Score 5226.5
    Test  Label Accuracy [0.6452968996321597, 0.10616929698708752, 0.7419354838709677, 0.0]
    Test  Label F1 [0.5331018016062513, 0.16228070175438597, 0.7694273434777558, 0]
    Test  Domain Accuracy [0.8418525951284775, 0.0, 0.0]

  EPOCH 20
    Train  Label Loss = 14846.703611373901
    Train  Domain Loss = 18704.280311584473
    Train  Regularization Loss = 1683.2905707359314
    Train  Total Loss = 35234.274493694305
    Train  Composite Score 16348.75
    Train  Label Accuracy [0.8564797271693824, 0.29154768703597944, 0.6919279907084785, 0.0]
    Train  Label F1 [0.770824452212465, 0.3233058898036732, 0.7888769345361252, 0]
    Train  Domain Accuracy [0.6096629428053089, 0.0, 0.3993125179031796]

    Val  Label Loss = 3375.957923412323
    Val  Domain Loss = 4107.485391616821
    Val  Regularization Loss = 480.8226013183594
    Val  Total Loss = 7964.265916347504
    Val  Composite Score 4795.0
    Val  Label Accuracy [0.7354045749402527, 0.4509394572025052, 0.909450766947056, 0.0]
    Val  Label F1 [0.7636943804290018, 0.45665961945031713, 0.858276908708849, 0]
    Val  Domain Accuracy [0.9996614759647935, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 318452.12440109253
    Test  Domain Loss = 14520.080923080444
    Test  Regularization Loss = 2043.4960556030273
    Test  Total Loss = 335015.701379776
    Test  Composite Score 5252.0
    Test  Label Accuracy [0.5412506568575933, 0.12625538020086083, 0.7907706093189965, 0.0]
    Test  Label F1 [0.5063913470993117, 0.17374136229022705, 0.780369183154637, 0]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 21
    Train  Label Loss = 14286.125961303711
    Train  Domain Loss = 20550.627143859863
    Train  Regularization Loss = 1717.9076662063599
    Train  Total Loss = 36554.660771369934
    Train  Composite Score 16640.5
    Train  Label Accuracy [0.8760812335464461, 0.2787843366452367, 0.7176248548199767, 0.0]
    Train  Label F1 [0.7873589927753603, 0.31662794556920015, 0.8124589086127548, 0]
    Train  Domain Accuracy [0.5983003914828607, 0.0, 0.3919602788121837]

    Val  Label Loss = 3387.2540321350098
    Val  Domain Loss = 4067.753701210022
    Val  Regularization Loss = 496.3545799255371
    Val  Total Loss = 7951.362313270569
    Val  Composite Score 4786.0
    Val  Label Accuracy [0.7698873335609423, 0.5, 0.830282038594755, 0.0]
    Val  Label F1 [0.7715996578272027, 0.47378832838773494, 0.8498354013674349, 0]
    Val  Domain Accuracy [0.011509817197020988, 0.0, 0.998645903859174]

    Test  Label Loss = 424855.12536239624
    Test  Domain Loss = 19802.942640304565
    Test  Regularization Loss = 2109.5069646835327
    Test  Total Loss = 446767.57496738434
    Test  Composite Score 5023.25
    Test  Label Accuracy [0.7162375197057278, 0.1994261119081779, 0.6364247311827957, 0.0]
    Test  Label F1 [0.5413026211278792, 0.2171875, 0.7273425499231951, 0]
    Test  Domain Accuracy [0.023098414197457996, 0.0, 0.0]

  EPOCH 22
    Train  Label Loss = 14900.346849441528
    Train  Domain Loss = 17877.95030593872
    Train  Regularization Loss = 1697.6163969039917
    Train  Total Loss = 34475.91355228424
    Train  Composite Score 16465.5
    Train  Label Accuracy [0.8579116314199395, 0.29486439699942296, 0.7073170731707317, 0.0]
    Train  Label F1 [0.7762022721448706, 0.3237250554323725, 0.8028343083134217, 0]
    Train  Domain Accuracy [0.6128139024157357, 0.0, 0.41182087272032847]

    Val  Label Loss = 3189.855080127716
    Val  Domain Loss = 4030.1623315811157
    Val  Regularization Loss = 472.36398696899414
    Val  Total Loss = 7692.381398677826
    Val  Composite Score 4903.75
    Val  Label Accuracy [0.8497780812564015, 0.22233820459290188, 0.9238000989609104, 0.0]
    Val  Label F1 [0.8045902699208017, 0.3341176470588236, 0.8576022048690859, 0]
    Val  Domain Accuracy [0.17197020988490183, 0.0, 0.9962762356127285]

    New Best Val Loss

    Test  Label Loss = 187160.71337127686
    Test  Domain Loss = 19721.388339996338
    Test  Regularization Loss = 2007.546944618225
    Test  Total Loss = 208889.64865589142
    Test  Composite Score 5308.25
    Test  Label Accuracy [0.5470310036784025, 0.04591104734576758, 0.817652329749104, 0.0]
    Test  Label F1 [0.5074335851815744, 0.08300907911802853, 0.7888480657013184, 0]
    Test  Domain Accuracy [0.10077519379844961, 0.0, 0.0]

  EPOCH 23
    Train  Label Loss = 14294.324645996094
    Train  Domain Loss = 17531.615589141846
    Train  Regularization Loss = 1570.1092858314514
    Train  Total Loss = 33396.04952096939
    Train  Composite Score 16617.0
    Train  Label Accuracy [0.8699286250939143, 0.30058651026392963, 0.7106562137049942, 0.0]
    Train  Label F1 [0.7868003057844221, 0.3310723514211886, 0.8072895192545559, 0]
    Train  Domain Accuracy [0.5984913587319775, 0.0, 0.4194595626849995]

    Val  Label Loss = 3423.418409347534
    Val  Domain Loss = 4193.657133102417
    Val  Regularization Loss = 421.0531425476074
    Val  Total Loss = 8038.128684997559
    Val  Composite Score 4852.0
    Val  Label Accuracy [0.7558893820416525, 0.4175365344467641, 0.9332013854527461, 0.0]
    Val  Label F1 [0.7769784172661871, 0.46003450258769407, 0.8615806304248516, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 351200.7486305237
    Test  Domain Loss = 16877.077503204346
    Test  Regularization Loss = 1789.4758558273315
    Test  Total Loss = 369867.30198955536
    Test  Composite Score 5267.75
    Test  Label Accuracy [0.4235417761429322, 0.11764705882352941, 0.8469982078853047, 0.0]
    Test  Label F1 [0.45860597439544815, 0.1680327868852459, 0.7846840302998859, 0]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 24
    Train  Label Loss = 14345.481231689453
    Train  Domain Loss = 17585.37893295288
    Train  Regularization Loss = 1448.7636156082153
    Train  Total Loss = 33379.62378025055
    Train  Composite Score 16597.5
    Train  Label Accuracy [0.8694267515923567, 0.29804849201655825, 0.7067363530778165, 0.0]
    Train  Label F1 [0.7866435018432985, 0.3322346736980883, 0.7983599835998361, 0]
    Train  Domain Accuracy [0.601069416595054, 0.0, 0.43234985200038195]

    Val  Label Loss = 3172.6626262664795
    Val  Domain Loss = 4129.20814037323
    Val  Regularization Loss = 416.30702018737793
    Val  Total Loss = 7718.177786827087
    Val  Composite Score 4924.75
    Val  Label Accuracy [0.9160122908842608, 0.2244258872651357, 0.8406729341909945, 0.0]
    Val  Label F1 [0.8145112325440195, 0.3404592240696754, 0.856998738965952, 0]
    Val  Domain Accuracy [0.5318212593094109, 0.0, 0.35240352064996616]

    New Best Val Loss

    Test  Label Loss = 208980.97029590607
    Test  Domain Loss = 17679.89003753662
    Test  Regularization Loss = 1769.3048357963562
    Test  Total Loss = 228430.16516923904
    Test  Composite Score 4851.5
    Test  Label Accuracy [0.8360483447188649, 0.05021520803443329, 0.557347670250896, 0.0]
    Test  Label F1 [0.5295390247961391, 0.08684863523573201, 0.6804321072063448, 0]
    Test  Domain Accuracy [0.5207964427655137, 0.0, 0.0]

  EPOCH 25
    Train  Label Loss = 14391.135929107666
    Train  Domain Loss = 17651.859886169434
    Train  Regularization Loss = 1402.7708988189697
    Train  Total Loss = 33445.76671409607
    Train  Composite Score 16554.5
    Train  Label Accuracy [0.870354609929078, 0.29313809933964974, 0.7076074332171893, 0.0]
    Train  Label F1 [0.7821542383683874, 0.33219456645518136, 0.8, 0]
    Train  Domain Accuracy [0.5852191349183615, 0.0, 0.4286259906426048]

    Val  Label Loss = 3130.5443110466003
    Val  Domain Loss = 4044.1087503433228
    Val  Regularization Loss = 391.16769790649414
    Val  Total Loss = 7565.820759296417
    Val  Composite Score 4913.5
    Val  Label Accuracy [0.904404233526801, 0.1951983298538622, 0.863928748144483, 0.0]
    Val  Label F1 [0.810091743119266, 0.3083264633140973, 0.8594634506522275, 0]
    Val  Domain Accuracy [0.7714962762356127, 0.0, 0.3063642518618822]

    New Best Val Loss

    Test  Label Loss = 119983.72802352905
    Test  Domain Loss = 16767.62756538391
    Test  Regularization Loss = 1662.4627161026
    Test  Total Loss = 138413.81830501556
    Test  Composite Score 5002.25
    Test  Label Accuracy [0.7635312664214399, 0.04160688665710186, 0.6346326164874552, 0.0]
    Test  Label F1 [0.5299051787016776, 0.0754226267880364, 0.7194920634920635, 0]
    Test  Domain Accuracy [0.7064888049423523, 0.0, 0.0]

  EPOCH 26
    Train  Label Loss = 13953.980903625488
    Train  Domain Loss = 18189.970867156982
    Train  Regularization Loss = 1384.6024703979492
    Train  Total Loss = 33528.55424118042
    Train  Composite Score 16718.25
    Train  Label Accuracy [0.8828964736941354, 0.3137311703360371, 0.7068815331010453, 0.0]
    Train  Label F1 [0.7919820696071384, 0.35397940840006537, 0.8044609665427509, 0]
    Train  Domain Accuracy [0.6061300486966485, 0.0, 0.41936407906044115]

    Val  Label Loss = 3047.537163734436
    Val  Domain Loss = 4046.1797008514404
    Val  Regularization Loss = 388.1671714782715
    Val  Total Loss = 7481.884036064148
    Val  Composite Score 4922.5
    Val  Label Accuracy [0.890406282007511, 0.18580375782881003, 0.8946066303809995, 0.0]
    Val  Label F1 [0.8123345273321912, 0.2969140950792327, 0.8617731172545281, 0]
    Val  Domain Accuracy [0.9969532836831415, 0.0, 0.02064996614759648]

    New Best Val Loss

    Test  Label Loss = 121780.1446762085
    Test  Domain Loss = 15866.86281967163
    Test  Regularization Loss = 1649.7104787826538
    Test  Total Loss = 139296.71797466278
    Test  Composite Score 5158.25
    Test  Label Accuracy [0.6894377299001576, 0.03443328550932568, 0.7139336917562724, 0.0]
    Test  Label F1 [0.5299939406180569, 0.0642570281124498, 0.7561091340450771, 0]
    Test  Domain Accuracy [0.9826073269586432, 0.0, 0.0]

  EPOCH 27
    Train  Label Loss = 14028.172477722168
    Train  Domain Loss = 17515.896144866943
    Train  Regularization Loss = 1310.4938468933105
    Train  Total Loss = 32854.56246948242
    Train  Composite Score 16758.25
    Train  Label Accuracy [0.8944704779756326, 0.28187721369539553, 0.707171893147503, 0.0]
    Train  Label F1 [0.7975598545940751, 0.3262726340963444, 0.8063234563813939, 0]
    Train  Domain Accuracy [0.5559056621789363, 0.0, 0.4730258760622553]

    Val  Label Loss = 3206.021008491516
    Val  Domain Loss = 4219.880783081055
    Val  Regularization Loss = 358.30055236816406
    Val  Total Loss = 7784.202343940735
    Val  Composite Score 4902.25
    Val  Label Accuracy [0.8511437350631615, 0.29018789144050106, 0.8886689757545769, 0.0]
    Val  Label F1 [0.8036750483558994, 0.3912737508796622, 0.8570746838463374, 0]
    Val  Domain Accuracy [0.22681110358835477, 0.0, 0.6760324983073798]

    Test  Label Loss = 158245.3850517273
    Test  Domain Loss = 18781.494636535645
    Test  Regularization Loss = 1522.7773475646973
    Test  Total Loss = 178549.65703582764
    Test  Composite Score 5249.0
    Test  Label Accuracy [0.6852338413032054, 0.06169296987087518, 0.7385752688172043, 0.0]
    Test  Label F1 [0.5432201624661529, 0.10804020100502512, 0.7729457273473215, 0]
    Test  Domain Accuracy [0.06823279423916893, 0.0, 0.0]

  EPOCH 28
    Train  Label Loss = 14076.633892059326
    Train  Domain Loss = 17449.883728027344
    Train  Regularization Loss = 1226.0448241233826
    Train  Total Loss = 32752.562444210052
    Train  Composite Score 16754.75
    Train  Label Accuracy [0.8810304449648712, 0.30062075081288797, 0.7173344947735192, 0.0]
    Train  Label F1 [0.7945089757127771, 0.33996322914925625, 0.8088066786708135, 0]
    Train  Domain Accuracy [0.535663133772558, 0.0, 0.4917406664756994]

    Val  Label Loss = 3174.478487968445
    Val  Domain Loss = 4060.0897216796875
    Val  Regularization Loss = 350.26988983154297
    Val  Total Loss = 7584.838099479675
    Val  Composite Score 4899.25
    Val  Label Accuracy [0.8494366678047115, 0.2661795407098121, 0.9005442850074221, 0.0]
    Val  Label F1 [0.803228410008071, 0.37307973664959765, 0.8556652562294312, 0]
    Val  Domain Accuracy [0.8202437373053487, 0.0, 0.3290453622207177]

    Test  Label Loss = 177860.0303249359
    Test  Domain Loss = 16006.00781917572
    Test  Regularization Loss = 1488.6470317840576
    Test  Total Loss = 195354.6851758957
    Test  Composite Score 5210.75
    Test  Label Accuracy [0.5680504466631634, 0.08321377331420372, 0.7737455197132617, 0.0]
    Test  Label F1 [0.5016241299303944, 0.13472706155632985, 0.7712403706598192, 0]
    Test  Domain Accuracy [0.8038405540471413, 0.0, 0.0]

  EPOCH 29
    Train  Label Loss = 14369.061290740967
    Train  Domain Loss = 17676.21164703369
    Train  Regularization Loss = 1299.6960043907166
    Train  Total Loss = 33344.968942165375
    Train  Composite Score 16572.0
    Train  Label Accuracy [0.8695610958384681, 0.30350527215730977, 0.7094947735191638, 0.0]
    Train  Label F1 [0.7824455154177508, 0.3448275862068966, 0.7988557417245608, 0]
    Train  Domain Accuracy [0.6030745727107801, 0.0, 0.44533562494032275]

    Val  Label Loss = 3195.1286182403564
    Val  Domain Loss = 4082.2243938446045
    Val  Regularization Loss = 372.15808868408203
    Val  Total Loss = 7649.511100769043
    Val  Composite Score 4903.0
    Val  Label Accuracy [0.8876749743939911, 0.2828810020876827, 0.8396833250865908, 0.0]
    Val  Label F1 [0.8067018305926156, 0.38964773544212794, 0.8529781352098517, 0]
    Val  Domain Accuracy [0.7762356127285037, 0.0, 0.2525389302640487]

    Test  Label Loss = 176549.41848754883
    Test  Domain Loss = 17145.022192955017
    Test  Regularization Loss = 1581.6718769073486
    Test  Total Loss = 195276.1125574112
    Test  Composite Score 5039.75
    Test  Label Accuracy [0.7714135575407252, 0.09899569583931134, 0.6335125448028673, 0.0]
    Test  Label F1 [0.5396066899467009, 0.153503893214683, 0.7262455059065228, 0]
    Test  Domain Accuracy [0.800181009719435, 0.0, 0.0]
