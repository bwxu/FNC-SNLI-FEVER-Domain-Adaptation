Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
Loading CNN vectors...
SIZE_TRAIN = 94441
SIZE_VAL = 5908
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 18477.770362854004
    Train  Domain Loss = 14038.245378494263
    Train  Regularization Loss = 2280.040529727936
    Train  Total Loss = 34796.0562710762
    Train  Composite Score 15436.75
    Train  Label Accuracy [0.8125993083465745, 0.1562965168204823, 0.6376306620209059, 0.0]
    Train  Label F1 [0.7278968519758875, 0.18861146039159332, 0.7081015719467957, 0]
    Train  Domain Accuracy [0.8362455838823641, 0.0, 0.6343932015659315]

    Val  Label Loss = 3575.22043132782
    Val  Domain Loss = 1633.3847932815552
    Val  Regularization Loss = 641.883373260498
    Val  Total Loss = 5850.488597869873
    Val  Composite Score 4753.75
    Val  Label Accuracy [0.9153294639808809, 0.011482254697286013, 0.8297872340425532, 0.0]
    Val  Label F1 [0.7852958406561219, 0.022587268993839834, 0.8355754857997011, 0]
    Val  Domain Accuracy [0.8270142180094787, 0.0, 0.9773188896411645]

    Test  Label Loss = 147890.0797290802
    Test  Domain Loss = 10125.951156616211
    Test  Regularization Loss = 2728.0043363571167
    Test  Total Loss = 160744.03522205353
    Test  Composite Score 4983.5
    Test  Label Accuracy [0.8339464004203888, 0.0, 0.605510752688172, 0.0]
    Test  Label F1 [0.5411764705882353, 0, 0.7147012162876785, 0]
    Test  Domain Accuracy [0.746114193523, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 20160.02649307251
    Train  Domain Loss = 56978.91622924805
    Train  Regularization Loss = 2304.646026611328
    Train  Total Loss = 79443.58874893188
    Train  Composite Score 15095.75
    Train  Label Accuracy [0.7781537883060726, 0.21549707602339183, 0.6055458768873403, 0.0]
    Train  Label F1 [0.7102835814492257, 0.23471337579617832, 0.6847808241668034, 0]
    Train  Domain Accuracy [0.5990642604793278, 0.0, 0.4696839492027117]

    Val  Label Loss = 4505.010712146759
    Val  Domain Loss = 32743.240125915
    Val  Regularization Loss = 633.453426361084
    Val  Total Loss = 37881.70426442284
    Val  Composite Score 4289.5
    Val  Label Accuracy [0.42301126664390576, 0.5981210855949896, 0.9589312221672439, 0.0]
    Val  Label F1 [0.5584854631507776, 0.41703056768558955, 0.8369682573958108, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.003046716316858497]

    Test  Label Loss = 275316.9365348816
    Test  Domain Loss = 7.353092847763037
    Test  Regularization Loss = 2692.177062034607
    Test  Total Loss = 278016.46668976394
    Test  Composite Score 5288.75
    Test  Label Accuracy [0.20336311087756173, 0.14777618364418937, 0.9424283154121864, 0.0]
    Test  Label F1 [0.2990726429675425, 0.208502024291498, 0.7973843821076574, 0]
    Test  Domain Accuracy [0.9999606500609924, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 19880.354248046875
    Train  Domain Loss = 52411.83554840088
    Train  Regularization Loss = 2312.9047632217407
    Train  Total Loss = 74605.0945596695
    Train  Composite Score 15161.5
    Train  Label Accuracy [0.7729212098226984, 0.22614639703788095, 0.6264518002322881, 0.0]
    Train  Label F1 [0.7066880499328161, 0.24758341128780795, 0.7002596559558586, 0]
    Train  Domain Accuracy [0.5983003914828607, 0.0, 0.3632197078201089]

    Val  Label Loss = 4351.5762367248535
    Val  Domain Loss = 5747.659448623657
    Val  Regularization Loss = 653.866081237793
    Val  Total Loss = 10753.101766586304
    Val  Composite Score 4290.25
    Val  Label Accuracy [0.4206213724820758, 0.6377870563674322, 0.9440870856011875, 0.0]
    Val  Label F1 [0.5548299932447647, 0.42225293711126477, 0.8515956259763445, 0]
    Val  Domain Accuracy [0.014556533513879486, 0.0, 1.0]

    Test  Label Loss = 664524.4969577789
    Test  Domain Loss = 42473.265365600586
    Test  Regularization Loss = 2778.93084526062
    Test  Total Loss = 709776.6931686401
    Test  Composite Score 5203.25
    Test  Label Accuracy [0.21492380451918025, 0.2582496413199426, 0.8947132616487455, 0.0]
    Test  Label F1 [0.30442873092668404, 0.2595529920692141, 0.7945096479013328, 0]
    Test  Domain Accuracy [0.0026757958525164285, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 21827.274646759033
    Train  Domain Loss = 34020.284423828125
    Train  Regularization Loss = 2289.2457180023193
    Train  Total Loss = 58136.80478858948
    Train  Composite Score 14931.75
    Train  Label Accuracy [0.7726029980201754, 0.1947261663286004, 0.5955284552845529, 0.0]
    Train  Label F1 [0.702950763424258, 0.21455938697318006, 0.6732315772197605, 0]
    Train  Domain Accuracy [0.5850281676692447, 0.0, 0.4061873388713836]

    Val  Label Loss = 3580.8275394439697
    Val  Domain Loss = 4497.468414306641
    Val  Regularization Loss = 642.9982566833496
    Val  Total Loss = 8721.29421043396
    Val  Composite Score 4818.25
    Val  Label Accuracy [0.8637760327756914, 0.05010438413361169, 0.9287481444829292, 0.0]
    Val  Label F1 [0.7922342257710975, 0.09430255402750491, 0.8510541827250057, 0]
    Val  Domain Accuracy [0.9766418415707515, 0.0, 0.07176709546377792]

    Test  Label Loss = 370185.4578590393
    Test  Domain Loss = 9964.009318351746
    Test  Regularization Loss = 2732.742590904236
    Test  Total Loss = 382882.2097682953
    Test  Composite Score 5324.75
    Test  Label Accuracy [0.5633210719915922, 0.0028694404591104736, 0.8223566308243727, 0.0]
    Test  Label F1 [0.5145188384929205, 0.005673758865248227, 0.7932152117545376, 0]
    Test  Domain Accuracy [0.965844252941408, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 18595.870792388916
    Train  Domain Loss = 22926.6841506958
    Train  Regularization Loss = 2136.9342346191406
    Train  Total Loss = 43659.48917770386
    Train  Composite Score 15467.5
    Train  Label Accuracy [0.7916195856873823, 0.23472949389179756, 0.6454703832752613, 0.0]
    Train  Label F1 [0.7250851696925267, 0.24743216311513105, 0.7334213130979875, 0]
    Train  Domain Accuracy [0.5722333619784207, 0.0, 0.4390337057194691]

    Val  Label Loss = 3459.859112262726
    Val  Domain Loss = 4792.161885261536
    Val  Regularization Loss = 580.0057411193848
    Val  Total Loss = 8832.026738643646
    Val  Composite Score 4822.75
    Val  Label Accuracy [0.895868897234551, 0.011482254697286013, 0.9035131123206334, 0.0]
    Val  Label F1 [0.7949106331414723, 0.022703818369453045, 0.8603062426383982, 0]
    Val  Domain Accuracy [0.046039268788083954, 0.0, 0.9996614759647935]

    Test  Label Loss = 286053.548910141
    Test  Domain Loss = 36233.87310600281
    Test  Regularization Loss = 2465.0243997573853
    Test  Total Loss = 324752.4464159012
    Test  Composite Score 5272.25
    Test  Label Accuracy [0.7262217551234892, 0.0, 0.7376792114695341, 0.0]
    Test  Label F1 [0.5601945683015809, 0, 0.7750970930916794, 0]
    Test  Domain Accuracy [0.011214732617164443, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 19891.498947143555
    Train  Domain Loss = 26595.05850982666
    Train  Regularization Loss = 2042.438549041748
    Train  Total Loss = 48528.99600601196
    Train  Composite Score 15460.5
    Train  Label Accuracy [0.7990209921867646, 0.22882096069868996, 0.6361788617886179, 0.0]
    Train  Label F1 [0.7266501155722968, 0.24444098895972632, 0.7286937723455558, 0]
    Train  Domain Accuracy [0.5421560202425284, 0.0, 0.4456220758139979]

    Val  Label Loss = 3744.201018810272
    Val  Domain Loss = 4023.0249400138855
    Val  Regularization Loss = 542.970142364502
    Val  Total Loss = 8310.19610118866
    Val  Composite Score 4828.75
    Val  Label Accuracy [0.9201092523045408, 0.0020876826722338203, 0.8767936665017318, 0.0]
    Val  Label F1 [0.79757324652264, 0.004166666666666666, 0.864812103465105, 0]
    Val  Domain Accuracy [0.22884224779959378, 0.0, 0.8977657413676371]

    Test  Label Loss = 161715.97952079773
    Test  Domain Loss = 20710.673489570618
    Test  Regularization Loss = 2307.6231050491333
    Test  Total Loss = 184734.27611541748
    Test  Composite Score 5054.0
    Test  Label Accuracy [0.7961114030478192, 0.0, 0.6426971326164874, 0.0]
    Test  Label F1 [0.5409748259239421, 0, 0.7328224776500639, 0]
    Test  Domain Accuracy [0.0755518828945815, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 16516.402339935303
    Train  Domain Loss = 22236.86367034912
    Train  Regularization Loss = 1838.6049509048462
    Train  Total Loss = 40591.87096118927
    Train  Composite Score 15848.0
    Train  Label Accuracy [0.8226172465960666, 0.24124066628374496, 0.6726190476190477, 0.0]
    Train  Label F1 [0.7462046487691911, 0.2659490264365996, 0.760505581089954, 0]
    Train  Domain Accuracy [0.5579108182946625, 0.0, 0.4581304306311468]

    Val  Label Loss = 3967.5952563285828
    Val  Domain Loss = 4528.16406416893
    Val  Regularization Loss = 544.9353790283203
    Val  Total Loss = 9040.694699525833
    Val  Composite Score 4791.25
    Val  Label Accuracy [0.791396381017412, 0.14718162839248433, 0.9698169223156853, 0.0]
    Val  Label F1 [0.7813922130456766, 0.23959218351741715, 0.832979175520612, 0]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    Test  Label Loss = 299631.9548301697
    Test  Domain Loss = 28529.850922584534
    Test  Regularization Loss = 2315.9753608703613
    Test  Total Loss = 330477.7811136246
    Test  Composite Score 5301.5
    Test  Label Accuracy [0.3137151865475565, 0.010043041606886656, 0.9206989247311828, 0.0]
    Test  Label F1 [0.39173228346456695, 0.019718309859154928, 0.7926711668273867, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 16900.612602233887
    Train  Domain Loss = 19123.747371673584
    Train  Regularization Loss = 1809.7334184646606
    Train  Total Loss = 37834.09339237213
    Train  Composite Score 15801.25
    Train  Label Accuracy [0.8197323784395024, 0.2437608821822403, 0.6637630662020906, 0.0]
    Train  Label F1 [0.7439811845199914, 0.26666666666666666, 0.7536470782164345, 0]
    Train  Domain Accuracy [0.5719469111047455, 0.0, 0.44285305070180464]

    Val  Label Loss = 3297.8852224349976
    Val  Domain Loss = 4522.3259744644165
    Val  Regularization Loss = 493.8530158996582
    Val  Total Loss = 8314.064212799072
    Val  Composite Score 4870.0
    Val  Label Accuracy [0.8733356094230112, 0.22129436325678498, 0.867887184562098, 0.0]
    Val  Label F1 [0.7988757026858213, 0.31547619047619047, 0.8623402163225172, 0]
    Val  Domain Accuracy [0.008124576844955992, 0.0, 0.999322951929587]

    Test  Label Loss = 119931.53417015076
    Test  Domain Loss = 26136.28304862976
    Test  Regularization Loss = 2098.8753175735474
    Test  Total Loss = 148166.69253635406
    Test  Composite Score 5024.0
    Test  Label Accuracy [0.7703625853914872, 0.028694404591104734, 0.6402329749103942, 0.0]
    Test  Label F1 [0.5335759781619654, 0.05181347150259067, 0.7271339524233558, 0]
    Test  Domain Accuracy [0.0003934993900759454, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 16698.478324890137
    Train  Domain Loss = 25450.657627105713
    Train  Regularization Loss = 1815.4645805358887
    Train  Total Loss = 43964.60053253174
    Train  Composite Score 15903.5
    Train  Label Accuracy [0.8325651396858245, 0.24423694193171872, 0.6621660859465738, 0.0]
    Train  Label F1 [0.7516772823779193, 0.26754035480262106, 0.7597867732800268, 0]
    Train  Domain Accuracy [0.5736656163467965, 0.0, 0.4073331423660842]

    Val  Label Loss = 3461.5530462265015
    Val  Domain Loss = 5422.485280990601
    Val  Regularization Loss = 535.8645057678223
    Val  Total Loss = 9419.902832984924
    Val  Composite Score 4840.0
    Val  Label Accuracy [0.8910891089108911, 0.03549060542797495, 0.9104403760514597, 0.0]
    Val  Label F1 [0.7958530263759719, 0.06847935548841894, 0.8630393996247656, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 540554.2280387878
    Test  Domain Loss = 6243.479341506958
    Test  Regularization Loss = 2277.4241495132446
    Test  Total Loss = 549075.131529808
    Test  Composite Score 5316.5
    Test  Label Accuracy [0.7015239096163952, 0.0, 0.7614247311827957, 0.0]
    Test  Label F1 [0.5609243697478992, 0, 0.7839926190750778, 0]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 17659.92250061035
    Train  Domain Loss = 17929.27197265625
    Train  Regularization Loss = 1746.6611943244934
    Train  Total Loss = 37335.855667591095
    Train  Composite Score 15779.5
    Train  Label Accuracy [0.8090985994924335, 0.26323486399532026, 0.6636178861788617, 0.0]
    Train  Label F1 [0.7436395836033001, 0.273972602739726, 0.7551627292251776, 0]
    Train  Domain Accuracy [0.5252554186956937, 0.0, 0.4814284350233935]

    Val  Label Loss = 3483.0301551818848
    Val  Domain Loss = 4055.0488333702087
    Val  Regularization Loss = 455.3700828552246
    Val  Total Loss = 7993.449071407318
    Val  Composite Score 4853.5
    Val  Label Accuracy [0.8716285421645613, 0.07411273486430063, 0.9292429490351312, 0.0]
    Val  Label F1 [0.7965678627145085, 0.13719806763285025, 0.8592999313658201, 0]
    Val  Domain Accuracy [0.08598510494245092, 0.0, 0.997968855788761]

    Test  Label Loss = 245854.7077255249
    Test  Domain Loss = 20466.307809829712
    Test  Regularization Loss = 1935.3228521347046
    Test  Total Loss = 268256.3383874893
    Test  Composite Score 5396.75
    Test  Label Accuracy [0.5748817656332107, 0.015781922525107604, 0.8369175627240143, 0.0]
    Test  Label F1 [0.5345712191546543, 0.030555555555555555, 0.8021470746108427, 0]
    Test  Domain Accuracy [0.03919253925156416, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 18316.440502166748
    Train  Domain Loss = 23865.846725463867
    Train  Regularization Loss = 1943.235246181488
    Train  Total Loss = 44125.5224738121
    Train  Composite Score 15567.75
    Train  Label Accuracy [0.7975454375117107, 0.25620567375886527, 0.6428571428571429, 0.0]
    Train  Label F1 [0.7332472006890611, 0.2792270531400966, 0.7163309876243631, 0]
    Train  Domain Accuracy [0.6095674591807505, 0.0, 0.4234698749164518]

    Val  Label Loss = 3764.476095199585
    Val  Domain Loss = 5561.816877365112
    Val  Regularization Loss = 637.7213287353516
    Val  Total Loss = 9964.014301300049
    Val  Composite Score 4727.5
    Val  Label Accuracy [0.9433253670194606, 0.022964509394572025, 0.7664522513607125, 0.0]
    Val  Label F1 [0.7839409845368138, 0.04485219164118246, 0.8182778658214475, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 609413.9956588745
    Test  Domain Loss = 7258.13734292984
    Test  Regularization Loss = 2710.315647125244
    Test  Total Loss = 619382.4486489296
    Test  Composite Score 4667.0
    Test  Label Accuracy [0.8959537572254336, 0.0028694404591104736, 0.48409498207885304, 0.0]
    Test  Label F1 [0.5196586406583359, 0.005673758865248227, 0.629937326920274, 0]
    Test  Domain Accuracy [0.9999606500609924, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 19372.13200378418
    Train  Domain Loss = 23470.208213806152
    Train  Regularization Loss = 2296.024121284485
    Train  Total Loss = 45138.36433887482
    Train  Composite Score 15331.25
    Train  Label Accuracy [0.7712048306444004, 0.2760913558832032, 0.6341463414634146, 0.0]
    Train  Label F1 [0.7175210674157303, 0.28084105278635496, 0.7163591635916359, 0]
    Train  Domain Accuracy [0.572806263725771, 0.0, 0.41057958560106944]

    Val  Label Loss = 6469.861714363098
    Val  Domain Loss = 4250.085669517517
    Val  Regularization Loss = 679.3662643432617
    Val  Total Loss = 11399.313648223877
    Val  Composite Score 4383.25
    Val  Label Accuracy [0.9866848753840901, 0.0, 0.487382483918852, 0.0]
    Val  Label F1 [0.7408356831581645, 0, 0.6446335078534031, 0]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    Test  Label Loss = 1984823.3354187012
    Test  Domain Loss = 22761.714750289917
    Test  Regularization Loss = 2887.3066234588623
    Test  Total Loss = 2010472.35679245
    Test  Composite Score 4076.75
    Test  Label Accuracy [0.9700472937467157, 0.0, 0.27665770609318996, 0.0]
    Test  Label F1 [0.4814186986569305, 0, 0.42867060048594235, 0]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 17970.834915161133
    Train  Domain Loss = 17854.25238800049
    Train  Regularization Loss = 2121.6430139541626
    Train  Total Loss = 37946.730317115784
    Train  Composite Score 15653.0
    Train  Label Accuracy [0.8026167168674698, 0.25713453698311006, 0.6540360046457607, 0.0]
    Train  Label F1 [0.7369603733632946, 0.27185960591133007, 0.7399802890932984, 0]
    Train  Domain Accuracy [0.5399598968776855, 0.0, 0.4748400649288647]

    Val  Label Loss = 3330.7681980133057
    Val  Domain Loss = 4204.031435012817
    Val  Regularization Loss = 527.3968505859375
    Val  Total Loss = 8062.196483612061
    Val  Composite Score 4829.5
    Val  Label Accuracy [0.800273130761352, 0.3288100208768267, 0.8960910440376052, 0.0]
    Val  Label F1 [0.781854569713142, 0.390818858560794, 0.8607414448669201, 0]
    Val  Domain Accuracy [0.004062288422477996, 0.0, 1.0]

    Test  Label Loss = 816761.3636035919
    Test  Domain Loss = 20562.540764808655
    Test  Regularization Loss = 2241.4366149902344
    Test  Total Loss = 839565.3409833908
    Test  Composite Score 5257.25
    Test  Label Accuracy [0.6389910667367315, 0.10043041606886657, 0.7547043010752689, 0.0]
    Test  Label F1 [0.5391265794724007, 0.15503875968992248, 0.7732384668349782, 0]
    Test  Domain Accuracy [0.0019281470113721325, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 15900.078666687012
    Train  Domain Loss = 18289.417961120605
    Train  Regularization Loss = 1850.6874294281006
    Train  Total Loss = 36040.18405723572
    Train  Composite Score 16125.5
    Train  Label Accuracy [0.8442130932282874, 0.25618374558303886, 0.6766840882694541, 0.0]
    Train  Label F1 [0.7610230395265273, 0.29199530122503775, 0.7617257721849975, 0]
    Train  Domain Accuracy [0.5707056239854865, 0.0, 0.44352143607371336]

    Val  Label Loss = 3288.1323795318604
    Val  Domain Loss = 4046.8274898529053
    Val  Regularization Loss = 544.5807266235352
    Val  Total Loss = 7879.540596008301
    Val  Composite Score 4891.75
    Val  Label Accuracy [0.8596790713554114, 0.21711899791231734, 0.9040079168728352, 0.0]
    Val  Label F1 [0.8028056751155748, 0.3270440251572327, 0.855537344884102, 0]
    Val  Domain Accuracy [0.5531482735274205, 0.0, 0.5781990521327014]

    Test  Label Loss = 398319.1327934265
    Test  Domain Loss = 17367.99684047699
    Test  Regularization Loss = 2314.4680881500244
    Test  Total Loss = 418001.5977220535
    Test  Composite Score 5242.25
    Test  Label Accuracy [0.6473988439306358, 0.021520803443328552, 0.7589605734767025, 0.0]
    Test  Label F1 [0.5333333333333333, 0.040160642570281124, 0.773427690902865, 0]
    Test  Domain Accuracy [0.5617990792114272, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 15366.288208007812
    Train  Domain Loss = 17639.16822052002
    Train  Regularization Loss = 1788.4905467033386
    Train  Total Loss = 34793.94697523117
    Train  Composite Score 16231.75
    Train  Label Accuracy [0.8477583765927325, 0.2714409471556454, 0.6898954703832753, 0.0]
    Train  Label F1 [0.7660227708839709, 0.3041087026852151, 0.7778687182844982, 0]
    Train  Domain Accuracy [0.5861739711639454, 0.0, 0.4499188389191254]

    Val  Label Loss = 3511.1901054382324
    Val  Domain Loss = 4104.121263027191
    Val  Regularization Loss = 479.20618057250977
    Val  Total Loss = 8094.517549037933
    Val  Composite Score 4861.75
    Val  Label Accuracy [0.7890064868555821, 0.33716075156576203, 0.929737753587333, 0.0]
    Val  Label F1 [0.7857871472288337, 0.4222222222222223, 0.8533151680290646, 0]
    Val  Domain Accuracy [0.00033852403520649965, 0.0, 0.995937711577522]

    Test  Label Loss = 242416.56294059753
    Test  Domain Loss = 20894.472652435303
    Test  Regularization Loss = 2036.6262674331665
    Test  Total Loss = 265347.661860466
    Test  Composite Score 5305.25
    Test  Label Accuracy [0.5386232264844981, 0.03443328550932568, 0.8221326164874552, 0.0]
    Test  Label F1 [0.5070492208755875, 0.06290956749672345, 0.7873846813988415, 0]
    Test  Domain Accuracy [0.0007869987801518908, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 15135.606815338135
    Train  Domain Loss = 19516.688331604004
    Train  Regularization Loss = 1728.8273277282715
    Train  Total Loss = 36381.12247467041
    Train  Composite Score 16325.0
    Train  Label Accuracy [0.8626300851466414, 0.25745412844036697, 0.6939605110336817, 0.0]
    Train  Label F1 [0.772450016943409, 0.2945227943588062, 0.7867017774851877, 0]
    Train  Domain Accuracy [0.5910436360164232, 0.0, 0.41535376682898884]

    Val  Label Loss = 3351.373688697815
    Val  Domain Loss = 4058.4773120880127
    Val  Regularization Loss = 505.8442497253418
    Val  Total Loss = 7915.695250511169
    Val  Composite Score 4887.25
    Val  Label Accuracy [0.8610447251621713, 0.1336116910229645, 0.9386442355269669, 0.0]
    Val  Label F1 [0.8019077901430842, 0.23063063063063063, 0.8591485507246377, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.015572105619498984]

    Test  Label Loss = 159688.11421203613
    Test  Domain Loss = 15126.600156784058
    Test  Regularization Loss = 2149.8380613327026
    Test  Total Loss = 176964.5524301529
    Test  Composite Score 5339.75
    Test  Label Accuracy [0.48975302154492906, 0.020086083213773313, 0.855510752688172, 0.0]
    Test  Label F1 [0.4933827421916358, 0.03835616438356164, 0.793970893970894, 0]
    Test  Domain Accuracy [0.9970487545744304, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 14894.281200408936
    Train  Domain Loss = 17753.974243164062
    Train  Regularization Loss = 1696.7484107017517
    Train  Total Loss = 34345.00385427475
    Train  Composite Score 16400.25
    Train  Label Accuracy [0.8530024625876113, 0.29428571428571426, 0.7065911730545877, 0.0]
    Train  Label F1 [0.7739108017530292, 0.324358368760825, 0.7970195693113896, 0]
    Train  Domain Accuracy [0.555810178554378, 0.0, 0.44524014131576434]

    Val  Label Loss = 3160.4830269813538
    Val  Domain Loss = 4067.7866864204407
    Val  Regularization Loss = 453.4544277191162
    Val  Total Loss = 7681.724141120911
    Val  Composite Score 4861.0
    Val  Label Accuracy [0.9221577330146807, 0.10960334029227557, 0.8441365660564077, 0.0]
    Val  Label F1 [0.8032713754646841, 0.19498607242339835, 0.8500249128051818, 0]
    Val  Domain Accuracy [0.07616790792146243, 0.0, 0.975626269465132]

    Test  Label Loss = 490903.748916626
    Test  Domain Loss = 18582.511984825134
    Test  Regularization Loss = 1927.181317806244
    Test  Total Loss = 511413.44221925735
    Test  Composite Score 5078.0
    Test  Label Accuracy [0.7955859169732002, 0.021520803443328552, 0.6467293906810035, 0.0]
    Test  Label F1 [0.5461760461760462, 0.041039671682626545, 0.7352604100343818, 0]
    Test  Domain Accuracy [0.09876834690906229, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 15228.230979919434
    Train  Domain Loss = 17781.23572921753
    Train  Regularization Loss = 1610.0165100097656
    Train  Total Loss = 34619.48321914673
    Train  Composite Score 16359.75
    Train  Label Accuracy [0.8532793064455334, 0.2884503772489843, 0.6957026713124274, 0.0]
    Train  Label F1 [0.7699175240200664, 0.32584822160301585, 0.7830705122967563, 0]
    Train  Domain Accuracy [0.605748114198415, 0.0, 0.4336866227441994]

    Val  Label Loss = 3252.546856880188
    Val  Domain Loss = 4078.6881132125854
    Val  Regularization Loss = 489.2406463623047
    Val  Total Loss = 7820.475616455078
    Val  Composite Score 4915.0
    Val  Label Accuracy [0.8463639467395015, 0.22129436325678498, 0.9366650173181593, 0.0]
    Val  Label F1 [0.8042173560421736, 0.3411102172164119, 0.8588929219600726, 0]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 429833.1670036316
    Test  Domain Loss = 16158.84728050232
    Test  Regularization Loss = 2079.272747039795
    Test  Total Loss = 448071.2870311737
    Test  Composite Score 5295.5
    Test  Label Accuracy [0.4834471886495008, 0.04160688665710186, 0.8416218637992832, 0.0]
    Test  Label F1 [0.47767393561786087, 0.07661822985468955, 0.7893686311587352, 0]
    Test  Domain Accuracy [0.9999606500609924, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 15037.122848510742
    Train  Domain Loss = 17665.050479888916
    Train  Regularization Loss = 1624.4524812698364
    Train  Total Loss = 34326.625809669495
    Train  Composite Score 16369.25
    Train  Label Accuracy [0.8502971417790774, 0.2831935203934047, 0.7051393728222997, 0.0]
    Train  Label F1 [0.7717135396601172, 0.3131797824696097, 0.7923327895595433, 0]
    Train  Domain Accuracy [0.6060345650720901, 0.0, 0.4161176358254559]

    Val  Label Loss = 3075.5155262947083
    Val  Domain Loss = 3755.2886991500854
    Val  Regularization Loss = 443.8514041900635
    Val  Total Loss = 7274.655629634857
    Val  Composite Score 4893.25
    Val  Label Accuracy [0.901672925913281, 0.12526096033402923, 0.8876793666501732, 0.0]
    Val  Label F1 [0.8067817320910341, 0.2173913043478261, 0.8614645858343338, 0]
    Val  Domain Accuracy [0.26032498307379826, 0.0, 0.9478672985781991]

    Test  Label Loss = 265594.51428222656
    Test  Domain Loss = 19843.195203781128
    Test  Regularization Loss = 1886.3684678077698
    Test  Total Loss = 287324.07795381546
    Test  Composite Score 5174.75
    Test  Label Accuracy [0.7141355754072517, 0.027259684361549498, 0.7094534050179212, 0.0]
    Test  Label F1 [0.5372603281280885, 0.051560379918588875, 0.7602016322611618, 0]
    Test  Domain Accuracy [0.24357612245701019, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 14573.704814910889
    Train  Domain Loss = 18148.176109313965
    Train  Regularization Loss = 1546.8258309364319
    Train  Total Loss = 34268.706755161285
    Train  Composite Score 16515.5
    Train  Label Accuracy [0.8684736091298145, 0.2901495907423088, 0.7092044134727061, 0.0]
    Train  Label F1 [0.7811470852401522, 0.3268680445151034, 0.8006884117357811, 0]
    Train  Domain Accuracy [0.5992552277284445, 0.0, 0.40695120786785066]

    Val  Label Loss = 3025.506790161133
    Val  Domain Loss = 4057.1319456100464
    Val  Regularization Loss = 429.3507957458496
    Val  Total Loss = 7511.989531517029
    Val  Composite Score 4915.75
    Val  Label Accuracy [0.9067941276886309, 0.13987473903966596, 0.8881741712023751, 0.0]
    Val  Label F1 [0.8107448107448108, 0.24035874439461882, 0.8652687394552904, 0]
    Val  Domain Accuracy [0.9996614759647935, 0.0, 0.0013540961408259986]

    Test  Label Loss = 197107.5946521759
    Test  Domain Loss = 15293.755212783813
    Test  Regularization Loss = 1824.7408819198608
    Test  Total Loss = 214226.09074687958
    Test  Composite Score 5198.75
    Test  Label Accuracy [0.7320021019442985, 0.024390243902439025, 0.7094534050179212, 0.0]
    Test  Label F1 [0.54691794267766, 0.04625850340136055, 0.7632244848776961, 0]
    Test  Domain Accuracy [0.9982686026836658, 0.0, 0.0]

  EPOCH 20
    Train  Label Loss = 14388.648321151733
    Train  Domain Loss = 17548.614936828613
    Train  Regularization Loss = 1439.2702741622925
    Train  Total Loss = 33376.53353214264
    Train  Composite Score 16569.0
    Train  Label Accuracy [0.8769420234937476, 0.288692175899486, 0.7038327526132404, 0.0]
    Train  Label F1 [0.7857567269331975, 0.32518494692827277, 0.8017198610881429, 0]
    Train  Domain Accuracy [0.5660269263821255, 0.0, 0.4553614055189535]

    Val  Label Loss = 3062.825846672058
    Val  Domain Loss = 4033.4263277053833
    Val  Regularization Loss = 392.8194522857666
    Val  Total Loss = 7489.071626663208
    Val  Composite Score 4909.75
    Val  Label Accuracy [0.8801638784568112, 0.20041753653444677, 0.8941118258287977, 0.0]
    Val  Label F1 [0.8063809821707851, 0.31143552311435524, 0.862735736452614, 0]
    Val  Domain Accuracy [0.007447528774542992, 0.0, 1.0]

    New Best Val Loss

    Test  Label Loss = 195080.3652229309
    Test  Domain Loss = 20902.03691482544
    Test  Regularization Loss = 1669.482672214508
    Test  Total Loss = 217651.88480997086
    Test  Composite Score 5246.75
    Test  Label Accuracy [0.6142932212296374, 0.04591104734576758, 0.7706093189964157, 0.0]
    Test  Label F1 [0.5224581005586592, 0.08311688311688312, 0.7745131149386467, 0]
    Test  Domain Accuracy [0.015149726517923897, 0.0, 0.0]

  EPOCH 21
    Train  Label Loss = 14344.722831726074
    Train  Domain Loss = 18634.279167175293
    Train  Regularization Loss = 1405.568899154663
    Train  Total Loss = 34384.57089805603
    Train  Composite Score 16581.0
    Train  Label Accuracy [0.8672433245581046, 0.3047925189947399, 0.7067363530778165, 0.0]
    Train  Label F1 [0.7838205302515296, 0.3374858437146093, 0.8014487981560751, 0]
    Train  Domain Accuracy [0.589038479900697, 0.0, 0.43951112384226104]

    Val  Label Loss = 3018.2784881591797
    Val  Domain Loss = 4099.710472583771
    Val  Regularization Loss = 396.2690734863281
    Val  Total Loss = 7514.258034229279
    Val  Composite Score 4941.25
    Val  Label Accuracy [0.8907476954592011, 0.2045929018789144, 0.8975754576942108, 0.0]
    Val  Label F1 [0.8145488604433343, 0.3189585028478438, 0.867734991628797, 0]
    Val  Domain Accuracy [0.995260663507109, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 136068.8660211563
    Test  Domain Loss = 15112.225897789001
    Test  Regularization Loss = 1684.1435623168945
    Test  Total Loss = 152865.2354812622
    Test  Composite Score 5204.75
    Test  Label Accuracy [0.674724119810825, 0.03730272596843615, 0.733646953405018, 0.0]
    Test  Label F1 [0.5370138017565872, 0.06727037516170763, 0.7640265951242272, 0]
    Test  Domain Accuracy [0.9907921142722229, 0.0, 0.0]

  EPOCH 22
    Train  Label Loss = 14383.046781539917
    Train  Domain Loss = 18140.356185913086
    Train  Regularization Loss = 1372.219801902771
    Train  Total Loss = 33895.622769355774
    Train  Composite Score 16550.5
    Train  Label Accuracy [0.8707515105740181, 0.29399884593191, 0.704849012775842, 0.0]
    Train  Label F1 [0.7839354016149596, 0.3267072779737095, 0.8032095293241791, 0]
    Train  Domain Accuracy [0.549699226582641, 0.0, 0.45440656927336964]

    Val  Label Loss = 3106.8402557373047
    Val  Domain Loss = 4079.5849471092224
    Val  Regularization Loss = 383.281888961792
    Val  Total Loss = 7569.707091808319
    Val  Composite Score 4922.5
    Val  Label Accuracy [0.8695800614544213, 0.2609603340292276, 0.8891637803067788, 0.0]
    Val  Label F1 [0.810630171865054, 0.36523009495982467, 0.8633197213547923, 0]
    Val  Domain Accuracy [0.3280297901150982, 0.0, 0.8672985781990521]

    Test  Label Loss = 193408.9887714386
    Test  Domain Loss = 17760.42921066284
    Test  Regularization Loss = 1628.948028087616
    Test  Total Loss = 212798.36601018906
    Test  Composite Score 5238.5
    Test  Label Accuracy [0.6883867577509196, 0.047345767575322814, 0.7363351254480287, 0.0]
    Test  Label F1 [0.5458333333333334, 0.0832282471626734, 0.770240187463386, 0]
    Test  Domain Accuracy [0.22102860740565852, 0.0, 0.0]

  EPOCH 23
    Train  Label Loss = 14106.471530914307
    Train  Domain Loss = 17409.5871925354
    Train  Regularization Loss = 1286.2894802093506
    Train  Total Loss = 32802.34820365906
    Train  Composite Score 16627.75
    Train  Label Accuracy [0.8792261457550714, 0.2730205278592375, 0.7121080139372822, 0.0]
    Train  Label F1 [0.7893095017283535, 0.31168396384332103, 0.8062792800197255, 0]
    Train  Domain Accuracy [0.5550463095579108, 0.0, 0.4786594099112002]

    Val  Label Loss = 3139.2764196395874
    Val  Domain Loss = 4190.3304653167725
    Val  Regularization Loss = 361.4039611816406
    Val  Total Loss = 7691.0108461380005
    Val  Composite Score 4909.75
    Val  Label Accuracy [0.8945032434277911, 0.17849686847599164, 0.8837209302325582, 0.0]
    Val  Label F1 [0.8088916332201297, 0.29081632653061223, 0.8582412301777991, 0]
    Val  Domain Accuracy [0.056194989844278946, 0.0, 0.982396750169262]

    Test  Label Loss = 328005.2830982208
    Test  Domain Loss = 22872.082100868225
    Test  Regularization Loss = 1535.9668350219727
    Test  Total Loss = 352413.332034111
    Test  Composite Score 5186.75
    Test  Label Accuracy [0.6878612716763006, 0.03730272596843615, 0.7226702508960573, 0.0]
    Test  Label F1 [0.5350500715307582, 0.06905710491367861, 0.7606696533836359, 0]
    Test  Domain Accuracy [0.05768701058513359, 0.0, 0.0]

  EPOCH 24
    Train  Label Loss = 14828.105255126953
    Train  Domain Loss = 18119.287845611572
    Train  Regularization Loss = 1332.877245426178
    Train  Total Loss = 34280.2703461647
    Train  Composite Score 16467.5
    Train  Label Accuracy [0.8681153990258523, 0.2785334121821407, 0.6927990708478513, 0.0]
    Train  Label F1 [0.7806603773584906, 0.31663865546218484, 0.7838370565045992, 0]
    Train  Domain Accuracy [0.6007829657213788, 0.0, 0.42623890002864506]

    Val  Label Loss = 3094.7120037078857
    Val  Domain Loss = 4070.927049636841
    Val  Regularization Loss = 379.7750473022461
    Val  Total Loss = 7545.414100646973
    Val  Composite Score 4903.75
    Val  Label Accuracy [0.8764083304882212, 0.162839248434238, 0.9134092033646709, 0.0]
    Val  Label F1 [0.805838957777429, 0.26966292134831465, 0.8610074626865671, 0]
    Val  Domain Accuracy [0.995260663507109, 0.0, 0.002708192281651997]

    Test  Label Loss = 155146.96628379822
    Test  Domain Loss = 16118.62296295166
    Test  Regularization Loss = 1614.043951034546
    Test  Total Loss = 172879.63319778442
    Test  Composite Score 5216.0
    Test  Label Accuracy [0.5533368365738308, 0.03156384505021521, 0.7896505376344086, 0.0]
    Test  Label F1 [0.49529633113828786, 0.059139784946236555, 0.7720105124835742, 0]
    Test  Domain Accuracy [0.9924054617715342, 0.0, 0.0]

  EPOCH 25
    Train  Label Loss = 14486.65566444397
    Train  Domain Loss = 17558.163383483887
    Train  Regularization Loss = 1296.0015602111816
    Train  Total Loss = 33340.82060813904
    Train  Composite Score 16472.25
    Train  Label Accuracy [0.8564539007092199, 0.30806775768016076, 0.7054297328687572, 0.0]
    Train  Label F1 [0.7758930866101258, 0.33594239198497183, 0.8008900609856601, 0]
    Train  Domain Accuracy [0.572806263725771, 0.0, 0.44294853432636305]

    Val  Label Loss = 3225.7616930007935
    Val  Domain Loss = 4135.707583427429
    Val  Regularization Loss = 358.8995361328125
    Val  Total Loss = 7720.368812561035
    Val  Composite Score 4879.75
    Val  Label Accuracy [0.8914305223625811, 0.10542797494780794, 0.9030183077684315, 0.0]
    Val  Label F1 [0.802890528905289, 0.18949343339587243, 0.8596325953838907, 0]
    Val  Domain Accuracy [0.5138794854434665, 0.0, 0.40555179417738657]

    Test  Label Loss = 211732.51470947266
    Test  Domain Loss = 17813.107851028442
    Test  Regularization Loss = 1525.3230285644531
    Test  Total Loss = 231070.94558906555
    Test  Composite Score 5253.5
    Test  Label Accuracy [0.5990541250656858, 0.014347202295552367, 0.7840501792114696, 0.0]
    Test  Label F1 [0.5145565335138795, 0.027816411682892905, 0.7796836711962576, 0]
    Test  Domain Accuracy [0.3990870814150238, 0.0, 0.0]

  EPOCH 26
    Train  Label Loss = 14096.467868804932
    Train  Domain Loss = 17532.859519958496
    Train  Regularization Loss = 1225.147210597992
    Train  Total Loss = 32854.47459936142
    Train  Composite Score 16688.0
    Train  Label Accuracy [0.8844050537431642, 0.28707995365005795, 0.7118176538908246, 0.0]
    Train  Label F1 [0.7926314010478284, 0.32874440205672584, 0.8051564167829872, 0]
    Train  Domain Accuracy [0.5532321206913015, 0.0, 0.4659600878449346]

    Val  Label Loss = 3081.4380807876587
    Val  Domain Loss = 3996.0197620391846
    Val  Regularization Loss = 344.30880546569824
    Val  Total Loss = 7421.7666482925415
    Val  Composite Score 4909.75
    Val  Label Accuracy [0.8791396381017412, 0.2160751565762004, 0.8881741712023751, 0.0]
    Val  Label F1 [0.808223477715003, 0.3317307692307692, 0.8555767397521449, 0]
    Val  Domain Accuracy [0.992552471225457, 0.0, 0.036222071767095465]

    Test  Label Loss = 191550.25398731232
    Test  Domain Loss = 15772.104078292847
    Test  Regularization Loss = 1463.3124232292175
    Test  Total Loss = 208785.67048883438
    Test  Composite Score 5162.75
    Test  Label Accuracy [0.6689437729900157, 0.03012912482065997, 0.7246863799283154, 0.0]
    Test  Label F1 [0.522149302707137, 0.05607476635514019, 0.7609079148535811, 0]
    Test  Domain Accuracy [0.986306221225357, 0.0, 0.0]

  EPOCH 27
    Train  Label Loss = 14096.146808624268
    Train  Domain Loss = 17420.92197418213
    Train  Regularization Loss = 1176.6386079788208
    Train  Total Loss = 32693.707390785217
    Train  Composite Score 16660.0
    Train  Label Accuracy [0.8825679475164011, 0.27863046044864226, 0.7076074332171893, 0.0]
    Train  Label F1 [0.79214333781965, 0.31598326359832635, 0.8036273701566363, 0]
    Train  Domain Accuracy [0.5497947102071995, 0.0, 0.48820777236703905]

    Val  Label Loss = 3076.8014335632324
    Val  Domain Loss = 4141.919994831085
    Val  Regularization Loss = 326.742467880249
    Val  Total Loss = 7545.463896274567
    Val  Composite Score 4902.25
    Val  Label Accuracy [0.9156708774325708, 0.13778705636743216, 0.867392380009896, 0.0]
    Val  Label F1 [0.8084400904295403, 0.23634735899731427, 0.8626968503937007, 0]
    Val  Domain Accuracy [0.057210561949898445, 0.0, 0.987813134732566]

    Test  Label Loss = 231376.24033927917
    Test  Domain Loss = 19212.0497713089
    Test  Regularization Loss = 1388.6554884910583
    Test  Total Loss = 251976.94559907913
    Test  Composite Score 5078.75
    Test  Label Accuracy [0.7172884918549658, 0.027259684361549498, 0.6794354838709677, 0.0]
    Test  Label F1 [0.5286599535243998, 0.05170068027210885, 0.7371491068173532, 0]
    Test  Domain Accuracy [0.03738244205721481, 0.0, 0.0]

  EPOCH 28
    Train  Label Loss = 14332.63491821289
    Train  Domain Loss = 17615.157817840576
    Train  Regularization Loss = 1179.6584339141846
    Train  Total Loss = 33127.45116996765
    Train  Composite Score 16522.25
    Train  Label Accuracy [0.8732552693208431, 0.2814070351758794, 0.6942508710801394, 0.0]
    Train  Label F1 [0.7839212883151832, 0.31930236458158645, 0.7890438082666446, 0]
    Train  Domain Accuracy [0.5611572615296476, 0.0, 0.47531748305165666]

    Val  Label Loss = 3125.964853286743
    Val  Domain Loss = 3835.629874229431
    Val  Regularization Loss = 350.39706230163574
    Val  Total Loss = 7311.99178981781
    Val  Composite Score 4892.5
    Val  Label Accuracy [0.8726527825196313, 0.1847599164926931, 0.901039089559624, 0.0]
    Val  Label F1 [0.8018823529411765, 0.29697986577181207, 0.8571428571428571, 0]
    Val  Domain Accuracy [0.3859174001354096, 0.0, 0.9519295870006771]

    Test  Label Loss = 146286.14040374756
    Test  Domain Loss = 18854.520728111267
    Test  Regularization Loss = 1489.187514781952
    Test  Total Loss = 166629.84864664078
    Test  Composite Score 5144.75
    Test  Label Accuracy [0.5612191276931161, 0.027259684361549498, 0.7656810035842294, 0.0]
    Test  Label F1 [0.4855649011138895, 0.05121293800539083, 0.7606542784021365, 0]
    Test  Domain Accuracy [0.2907960492661236, 0.0, 0.0]

  EPOCH 29
    Train  Label Loss = 13841.665229797363
    Train  Domain Loss = 17688.101722717285
    Train  Regularization Loss = 1211.004195690155
    Train  Total Loss = 32740.771148204803
    Train  Composite Score 16755.0
    Train  Label Accuracy [0.8842544316996872, 0.2995155314904531, 0.7234320557491289, 0.0]
    Train  Label F1 [0.7910112359550562, 0.3454396055875103, 0.8162162162162163, 0]
    Train  Domain Accuracy [0.5940991120022916, 0.0, 0.44285305070180464]

    Val  Label Loss = 3103.527322769165
    Val  Domain Loss = 4073.135129928589
    Val  Regularization Loss = 338.3412551879883
    Val  Total Loss = 7515.003707885742
    Val  Composite Score 4915.0
    Val  Label Accuracy [0.9293274155001707, 0.15762004175365343, 0.8466105888174171, 0.0]
    Val  Label F1 [0.8120525059665871, 0.26631393298059963, 0.8602312719959778, 0]
    Val  Domain Accuracy [0.32498307379823965, 0.0, 0.7427217332430602]

    Test  Label Loss = 134315.41670131683
    Test  Domain Loss = 18265.31099510193
    Test  Regularization Loss = 1437.9503345489502
    Test  Total Loss = 154018.6780309677
    Test  Composite Score 4933.25
    Test  Label Accuracy [0.789805570152391, 0.04160688665710186, 0.6028225806451613, 0.0]
    Test  Label F1 [0.5277387640449438, 0.07712765957446809, 0.7007812499999999, 0]
    Test  Domain Accuracy [0.22248455514893953, 0.0, 0.0]
