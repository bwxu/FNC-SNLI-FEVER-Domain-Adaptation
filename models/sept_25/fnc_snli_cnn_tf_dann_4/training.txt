Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
Loading CNN vectors...
SIZE_TRAIN = 368336
SIZE_VAL = 21998
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 75609.04376602173
    Train  Domain Loss = 28399.010438919067
    Train  Regularization Loss = 5688.0364809036255
    Train  Total Loss = 109696.09068584442
    Train  Composite Score 31986.75
    Train  Label Accuracy [0.4914998111069135, 0.4491846243447874, 0.3638793625176518, 0.6569122807017543]
    Train  Label F1 [0.40566454462777707, 0.4109771531339505, 0.39681011962051427, 0.7339658146463854]
    Train  Domain Accuracy [0.9448592615400405, 0.7986554794344802, 0.0]

    Val  Label Loss = 16888.113201141357
    Val  Domain Loss = 2386.986038208008
    Val  Regularization Loss = 1012.2467136383057
    Val  Total Loss = 20287.34595298767
    Val  Composite Score 10926.5
    Val  Label Accuracy [0.6015607069084232, 0.5343472750316857, 0.5004423995752965, 0.9864512119328775]
    Val  Label F1 [0.558610400682012, 0.5562005277044855, 0.5546729430224576, 0.9427977427977429]
    Val  Domain Accuracy [0.9648149831802891, 0.9854532230202746, 0.0]

    New Best Val Loss

    Test  Label Loss = 16124.510093688965
    Test  Domain Loss = 4064.0841302871704
    Test  Regularization Loss = 1173.2859635353088
    Test  Total Loss = 21361.880187511444
    Test  Composite Score 8105.0
    Test  Label Accuracy [0.3699421965317919, 0.03156384505021521, 0.5434587813620072, 0.9773829636492452]
    Test  Label F1 [0.3878787878787879, 0.05472636815920398, 0.6008668730650155, 0.936085810475768]
    Test  Domain Accuracy [0.9271632628969425, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 68976.45949554443
    Train  Domain Loss = 69328.29784011841
    Train  Regularization Loss = 3095.815902233124
    Train  Total Loss = 141400.57323789597
    Train  Composite Score 34372.25
    Train  Label Accuracy [0.5523353442378257, 0.4828044280442804, 0.4125246000908311, 0.6772280701754386]
    Train  Label F1 [0.4473154024377959, 0.4361333333333333, 0.4500289009385924, 0.7743164904820172]
    Train  Domain Accuracy [0.5785800425935904, 0.44009955610294305, 0.0]

    Val  Label Loss = 16337.301174163818
    Val  Domain Loss = 15316.684940338135
    Val  Regularization Loss = 802.781400680542
    Val  Total Loss = 32456.767515182495
    Val  Composite Score 11091.75
    Val  Label Accuracy [0.573100757401882, 0.4899873257287706, 0.5797204034684127, 0.9890615288999378]
    Val  Label F1 [0.5494553856309825, 0.541608293639675, 0.5899513776337116, 0.9550501110244255]
    Val  Domain Accuracy [0.0379125375034094, 0.9823620329120829, 0.0]

    New Best Val Loss

    Test  Label Loss = 15042.824905395508
    Test  Domain Loss = 19077.908661842346
    Test  Regularization Loss = 930.4966235160828
    Test  Total Loss = 35051.23019075394
    Test  Composite Score 8445.25
    Test  Label Accuracy [0.2464529689963216, 0.06169296987087518, 0.6834677419354839, 0.9654477083219793]
    Test  Label F1 [0.32558139534883723, 0.09566184649610678, 0.6564819795589026, 0.938518184948743]
    Test  Domain Accuracy [0.07382048557824736, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 68003.02391052246
    Train  Domain Loss = 64942.845848083496
    Train  Regularization Loss = 2681.674539089203
    Train  Total Loss = 135627.54429769516
    Train  Composite Score 34778.25
    Train  Label Accuracy [0.5541643306547063, 0.4882344235607518, 0.4307560742492077, 0.6763157894736842]
    Train  Label F1 [0.45055585099648005, 0.44225484281788324, 0.4627272972899949, 0.777939217822981]
    Train  Domain Accuracy [0.6101660123675365, 0.39588946193518587, 0.0]

    Val  Label Loss = 16094.684810638428
    Val  Domain Loss = 15268.361320495605
    Val  Regularization Loss = 727.7503681182861
    Val  Total Loss = 32090.79649925232
    Val  Composite Score 11134.75
    Val  Label Accuracy [0.45765434932292864, 0.5673003802281369, 0.6182976464342594, 0.9885643256681168]
    Val  Label F1 [0.5109545163356823, 0.5634441087613293, 0.5970608339029392, 0.9614942876140967]
    Val  Domain Accuracy [1.0, 0.023002091099190835, 0.0]

    New Best Val Loss

    Test  Label Loss = 14405.90728187561
    Test  Domain Loss = 17465.869782447815
    Test  Regularization Loss = 843.528835773468
    Test  Total Loss = 32715.305900096893
    Test  Composite Score 8680.25
    Test  Label Accuracy [0.256437204414083, 0.06456241032998565, 0.7269265232974911, 0.9666466837429832]
    Test  Label F1 [0.33620392697209783, 0.09615384615384615, 0.6840940234004427, 0.9459733333333332]
    Test  Domain Accuracy [0.9623027584307244, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 67343.4571800232
    Train  Domain Loss = 64987.67113494873
    Train  Regularization Loss = 2505.3850436210632
    Train  Total Loss = 134836.513358593
    Train  Composite Score 34945.0
    Train  Label Accuracy [0.5551230537418382, 0.49911686782455106, 0.43115905669844456, 0.6774035087719298]
    Train  Label F1 [0.4498028742210352, 0.4516214956382766, 0.4630597618149485, 0.7811608569867892]
    Train  Domain Accuracy [0.608652143791856, 0.3925538193108049, 0.0]

    Val  Label Loss = 15947.047786712646
    Val  Domain Loss = 15284.090660095215
    Val  Regularization Loss = 686.6842651367188
    Val  Total Loss = 31917.82271194458
    Val  Composite Score 11188.5
    Val  Label Accuracy [0.5288042230892817, 0.5708491761723701, 0.5737037692443815, 0.9880671224362958]
    Val  Label F1 [0.540972059168819, 0.5659002387234577, 0.5903669307110989, 0.9614175133043058]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 14264.98759841919
    Test  Domain Loss = 16561.861031532288
    Test  Regularization Loss = 795.9294891357422
    Test  Total Loss = 31622.77811908722
    Test  Composite Score 8686.0
    Test  Label Accuracy [0.2947976878612717, 0.020086083213773313, 0.712141577060932, 0.9712245898959071]
    Test  Label F1 [0.36523437499999994, 0.034313725490196074, 0.6789108382274426, 0.9486067122667873]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 67146.69002914429
    Train  Domain Loss = 64998.80531311035
    Train  Regularization Loss = 2433.4933087825775
    Train  Total Loss = 134578.98865103722
    Train  Composite Score 35049.25
    Train  Label Accuracy [0.560561253381992, 0.4979922610790684, 0.43603948428686545, 0.6742456140350878]
    Train  Label F1 [0.45287718584790565, 0.4498153521498286, 0.46958644067796607, 0.7788428412199818]
    Train  Domain Accuracy [0.592948964667847, 0.4134657326867318, 0.0]

    Val  Label Loss = 15750.147275924683
    Val  Domain Loss = 15250.904571533203
    Val  Regularization Loss = 687.3944664001465
    Val  Total Loss = 31688.446313858032
    Val  Composite Score 11131.0
    Val  Label Accuracy [0.5014918521918752, 0.602788339670469, 0.5662714563794019, 0.9908017402113114]
    Val  Label F1 [0.5371189773844641, 0.5731501566642565, 0.5894814405452704, 0.9543250523795271]
    Val  Domain Accuracy [0.0, 1.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 13859.951999664307
    Test  Domain Loss = 18212.309573173523
    Test  Regularization Loss = 796.7526769638062
    Test  Total Loss = 32869.014249801636
    Test  Composite Score 8422.5
    Test  Label Accuracy [0.23173935890698896, 0.04878048780487805, 0.6727150537634409, 0.976946972587062]
    Test  Label F1 [0.30656934306569344, 0.07771428571428572, 0.6625482625482625, 0.9432502828277515]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 67074.77657318115
    Train  Domain Loss = 64978.604988098145
    Train  Regularization Loss = 2383.820643901825
    Train  Total Loss = 134437.20220518112
    Train  Composite Score 35102.5
    Train  Label Accuracy [0.5617372801802366, 0.4981162739159341, 0.4377320622177622, 0.6760701754385965]
    Train  Label F1 [0.453356230112632, 0.4517771598941409, 0.4710328815938664, 0.7800651808667841]
    Train  Domain Accuracy [0.5674954455648783, 0.43150386164780746, 0.0]

    Val  Label Loss = 15761.58617401123
    Val  Domain Loss = 15258.950828552246
    Val  Regularization Loss = 665.4757356643677
    Val  Total Loss = 31686.012738227844
    Val  Composite Score 11292.0
    Val  Label Accuracy [0.5228368143217811, 0.5908745247148289, 0.5898071137851708, 0.9884400248601616]
    Val  Label F1 [0.5445201386398948, 0.5820224719101124, 0.6027669771227054, 0.9603864734299516]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 14055.287721633911
    Test  Domain Loss = 17243.650762557983
    Test  Regularization Loss = 771.3468754291534
    Test  Total Loss = 32070.285359621048
    Test  Composite Score 8626.0
    Test  Label Accuracy [0.2674724119810825, 0.04447632711621234, 0.7049731182795699, 0.9731320507929587]
    Test  Label F1 [0.3391072618254497, 0.06958473625140292, 0.6803588801210679, 0.9477203970065282]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 67042.29440689087
    Train  Domain Loss = 65067.062381744385
    Train  Regularization Loss = 2354.5624718666077
    Train  Total Loss = 134463.91926050186
    Train  Composite Score 35089.5
    Train  Label Accuracy [0.5564435564435565, 0.49681482023870543, 0.4427249279320285, 0.6735438596491228]
    Train  Label F1 [0.45411464968152865, 0.44831345601110045, 0.47267818574514037, 0.7782214744694221]
    Train  Domain Accuracy [0.5845072229492213, 0.4142611551586996, 0.0]

    Val  Label Loss = 15644.642417907715
    Val  Domain Loss = 15253.16748046875
    Val  Regularization Loss = 660.7267761230469
    Val  Total Loss = 31558.53667449951
    Val  Composite Score 11246.0
    Val  Label Accuracy [0.531558411751205, 0.6048162230671736, 0.5655636170589277, 0.9903045369794904]
    Val  Label F1 [0.5518884784939831, 0.5849472910026967, 0.59168749421457, 0.9574570364138925]
    Val  Domain Accuracy [0.0, 1.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 13783.130180358887
    Test  Domain Loss = 17784.508445739746
    Test  Regularization Loss = 765.842399597168
    Test  Total Loss = 32333.4810256958
    Test  Composite Score 8522.5
    Test  Label Accuracy [0.23173935890698896, 0.05021520803443329, 0.6964605734767025, 0.9760749904626955]
    Test  Label F1 [0.3105633802816901, 0.07675438596491228, 0.6776373147340891, 0.9451686104807643]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 66809.54705047607
    Train  Domain Loss = 64947.128452301025
    Train  Regularization Loss = 2310.8140370845795
    Train  Total Loss = 134067.48953986168
    Train  Composite Score 35193.25
    Train  Label Accuracy [0.5642821095129952, 0.5008413197746726, 0.4412045169385195, 0.6726666666666666]
    Train  Label F1 [0.4540378660981676, 0.4560959360426382, 0.47252008922572497, 0.7783439231846693]
    Train  Domain Accuracy [0.618915659559182, 0.3863700510609909, 0.0]

    Val  Label Loss = 15667.693328857422
    Val  Domain Loss = 15253.333358764648
    Val  Regularization Loss = 647.5614070892334
    Val  Total Loss = 31568.588094711304
    Val  Composite Score 11337.75
    Val  Label Accuracy [0.5455588707826486, 0.6002534854245881, 0.5747655282250929, 0.9889372280919826]
    Val  Label F1 [0.5576539589442816, 0.5834667980781076, 0.6005917159763313, 0.9621477808683034]
    Val  Domain Accuracy [0.0, 1.0, 0.0]

    Test  Label Loss = 13976.426763534546
    Test  Domain Loss = 17659.248861312866
    Test  Regularization Loss = 750.5825400352478
    Test  Total Loss = 32386.25816488266
    Test  Composite Score 8601.0
    Test  Label Accuracy [0.17393589069889648, 0.06025824964131994, 0.7372311827956989, 0.9711700910131342]
    Test  Label F1 [0.25094768764215314, 0.09302325581395349, 0.6824968892575695, 0.9468398820435164]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 66982.98020172119
    Train  Domain Loss = 64910.767028808594
    Train  Regularization Loss = 2274.236356496811
    Train  Total Loss = 134167.9835870266
    Train  Composite Score 35135.0
    Train  Label Accuracy [0.5478321149483236, 0.509604190919674, 0.44348089139860847, 0.6740350877192982]
    Train  Label F1 [0.44780424983902123, 0.45827199267183555, 0.472966796612448, 0.7792313152824257]
    Train  Domain Accuracy [0.5970030533959407, 0.4019705950273266, 0.0]

    Val  Label Loss = 15672.18476486206
    Val  Domain Loss = 15252.502746582031
    Val  Regularization Loss = 635.8550977706909
    Val  Total Loss = 31560.542609214783
    Val  Composite Score 11338.75
    Val  Label Accuracy [0.5267385815928392, 0.6152091254752852, 0.579189523978057, 0.9880671224362958]
    Val  Label F1 [0.5470798569725864, 0.5936888454011742, 0.6003301540719002, 0.9619992738714753]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 14085.385112762451
    Test  Domain Loss = 17546.96959209442
    Test  Regularization Loss = 737.013863325119
    Test  Total Loss = 32369.36856818199
    Test  Composite Score 8619.75
    Test  Label Accuracy [0.19232790331056226, 0.043041606886657105, 0.733646953405018, 0.9726415608480026]
    Test  Label F1 [0.2700110660272962, 0.06403415154749201, 0.6867987836845968, 0.9482744879254003]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 66923.28344726562
    Train  Domain Loss = 64930.29153442383
    Train  Regularization Loss = 2243.021555662155
    Train  Total Loss = 134096.5965373516
    Train  Composite Score 35148.25
    Train  Label Accuracy [0.5683111361220534, 0.5029873865899536, 0.4330518697225573, 0.6718947368421052]
    Train  Label F1 [0.45661893996483294, 0.45413073157737005, 0.4679048550016292, 0.7780509111594173]
    Train  Domain Accuracy [0.5767069509660534, 0.4291945706001591, 0.0]

    Val  Label Loss = 15615.30493927002
    Val  Domain Loss = 15256.151275634766
    Val  Regularization Loss = 633.1347227096558
    Val  Total Loss = 31504.59093761444
    Val  Composite Score 11349.5
    Val  Label Accuracy [0.5742483360110168, 0.605830164765526, 0.5556538665722881, 0.9889372280919826]
    Val  Label F1 [0.5691537761601456, 0.595193624704271, 0.5944155229531471, 0.9580924855491331]
    Val  Domain Accuracy [0.0, 1.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 13983.062198638916
    Test  Domain Loss = 18164.516276359558
    Test  Regularization Loss = 733.8607013225555
    Test  Total Loss = 32881.43917632103
    Test  Composite Score 8540.75
    Test  Label Accuracy [0.23909616395165528, 0.02295552367288379, 0.7065412186379928, 0.9705161044198594]
    Test  Label F1 [0.3160819729072594, 0.037383177570093455, 0.6746524064171123, 0.9436951856071648]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 66587.49464416504
    Train  Domain Loss = 64988.37727355957
    Train  Regularization Loss = 2236.8973727226257
    Train  Total Loss = 133812.76929044724
    Train  Composite Score 35248.5
    Train  Label Accuracy [0.572124391157737, 0.5023085379259802, 0.4359427907211806, 0.6737894736842105]
    Train  Label F1 [0.46105072463768115, 0.45760448658031777, 0.467432534951772, 0.7792792792792792]
    Train  Domain Accuracy [0.6153234290406179, 0.3856516049572781, 0.0]

    Val  Label Loss = 15609.976697921753
    Val  Domain Loss = 15251.159255981445
    Val  Regularization Loss = 628.1981420516968
    Val  Total Loss = 31489.334095954895
    Val  Composite Score 11312.75
    Val  Label Accuracy [0.5671333486343815, 0.6370088719898606, 0.5294638117147408, 0.9919204474829086]
    Val  Label F1 [0.5648645559492513, 0.5959212710457671, 0.5879347612497544, 0.9594229035166817]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 14233.810409545898
    Test  Domain Loss = 17489.676337242126
    Test  Regularization Loss = 728.1387555599213
    Test  Total Loss = 32451.625502347946
    Test  Composite Score 8527.0
    Test  Label Accuracy [0.27062532842879666, 0.028694404591104734, 0.6836917562724014, 0.9698621178265846]
    Test  Label F1 [0.3323652791222975, 0.04241781548250265, 0.6688582073197458, 0.9451378193212598]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 66825.958984375
    Train  Domain Loss = 65035.589668273926
    Train  Regularization Loss = 2216.655844449997
    Train  Total Loss = 134078.20449709892
    Train  Composite Score 35220.5
    Train  Label Accuracy [0.5659011482775836, 0.4967383246849518, 0.4426550270921132, 0.6766666666666666]
    Train  Label F1 [0.4583154330191302, 0.45225079300803134, 0.4733750033532741, 0.7806112123052014]
    Train  Domain Accuracy [0.5861493854719935, 0.4112077592179201, 0.0]

    Val  Label Loss = 15541.658138275146
    Val  Domain Loss = 15250.431701660156
    Val  Regularization Loss = 617.0850658416748
    Val  Total Loss = 31409.174905776978
    Val  Composite Score 11337.25
    Val  Label Accuracy [0.5226072985999541, 0.6220532319391635, 0.579189523978057, 0.9905531385954008]
    Val  Label F1 [0.5483443708609271, 0.6006608738220536, 0.5993956597381193, 0.9601783239954215]
    Val  Domain Accuracy [0.0, 1.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 13972.508251190186
    Test  Domain Loss = 17667.872900009155
    Test  Regularization Loss = 715.2576899528503
    Test  Total Loss = 32355.63884115219
    Test  Composite Score 8561.5
    Test  Label Accuracy [0.17288491854965843, 0.028694404591104734, 0.7347670250896058, 0.9702436100059949]
    Test  Label F1 [0.24764772299586002, 0.04550625711035267, 0.6812045690550363, 0.9454593733404142]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 66788.41915893555
    Train  Domain Loss = 65014.457500457764
    Train  Regularization Loss = 2196.7114338874817
    Train  Total Loss = 133999.5880932808
    Train  Composite Score 35254.5
    Train  Label Accuracy [0.5686556884352889, 0.503558588304351, 0.43978635493298396, 0.6728771929824562]
    Train  Label F1 [0.4595223638939485, 0.45528724956879396, 0.4728701070025734, 0.7779558223971116]
    Train  Domain Accuracy [0.5856618684730455, 0.40971954943165784, 0.0]

    Val  Label Loss = 15729.82192993164
    Val  Domain Loss = 15252.109184265137
    Val  Regularization Loss = 613.1200551986694
    Val  Total Loss = 31595.051169395447
    Val  Composite Score 11413.0
    Val  Label Accuracy [0.5955932981409227, 0.5850443599493029, 0.5639709785878606, 0.9884400248601616]
    Val  Label F1 [0.570957095709571, 0.5928589776521963, 0.6013207547169811, 0.9627118644067796]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 14345.895946502686
    Test  Domain Loss = 17261.852763175964
    Test  Regularization Loss = 710.6618821620941
    Test  Total Loss = 32318.410591840744
    Test  Composite Score 8713.0
    Test  Label Accuracy [0.2911192853389385, 0.024390243902439025, 0.7195340501792115, 0.9683361491089433]
    Test  Label F1 [0.3553559974342527, 0.03953488372093023, 0.6832588810891299, 0.9489932168990011]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 13