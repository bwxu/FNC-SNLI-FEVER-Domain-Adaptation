Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
Loading CNN vectors...
SIZE_TRAIN = 122888
SIZE_VAL = 21998
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 63455.57063674927
    Train  Domain Loss = 49277.195506095886
    Train  Regularization Loss = 6518.812956809998
    Train  Total Loss = 119251.57909965515
    Train  Composite Score 39676.0
    Train  Label Accuracy [0.8291868159837109, 0.19863383066690635, 0.4367015098722416, 0.6667368421052632]
    Train  Label F1 [0.7259585254098019, 0.22208823233845845, 0.4593067643915102, 0.7438783299731839]
    Train  Domain Accuracy [0.8188746054961127, 0.0, 0.6262797321222384]

    Val  Label Loss = 11703.473846435547
    Val  Domain Loss = 12388.336395263672
    Val  Regularization Loss = 1094.480676651001
    Val  Total Loss = 25186.29091835022
    Val  Composite Score 12973.0
    Val  Label Accuracy [0.9120903702046751, 0.20695419592109662, 0.722909450766947, 0.9909260410192666]
    Val  Label F1 [0.8393371757925072, 0.31825192802056557, 0.7455983669303394, 0.9515965383467623]
    Val  Domain Accuracy [0.7943449404491317, 0.0, 0.706064187653423]

    New Best Val Loss

    Test  Label Loss = 14406.980827331543
    Test  Domain Loss = 13793.77626132965
    Test  Regularization Loss = 1268.602602481842
    Test  Total Loss = 29469.359691143036
    Test  Composite Score 8123.25
    Test  Label Accuracy [0.4030478192327903, 0.01721664275466284, 0.5172491039426523, 0.9955855904953949]
    Test  Label F1 [0.3987522744996101, 0.031331592689295036, 0.6163085546510078, 0.943595041322314]
    Test  Domain Accuracy [0.7915633730767717, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 55233.76839637756
    Train  Domain Loss = 67895.49124908447
    Train  Regularization Loss = 3338.28746843338
    Train  Total Loss = 126467.54711389542
    Train  Composite Score 41995.5
    Train  Label Accuracy [0.8605580215599239, 0.2442367035759666, 0.554006968641115, 0.6782456140350878]
    Train  Label F1 [0.7448714958080053, 0.2694098212944887, 0.5667186455780798, 0.779891468802324]
    Train  Domain Accuracy [0.6096784953685885, 0.0, 0.38875631847689424]

    Val  Label Loss = 11087.166133880615
    Val  Domain Loss = 15225.863136291504
    Val  Regularization Loss = 846.0887289047241
    Val  Total Loss = 27159.117999076843
    Val  Composite Score 13134.5
    Val  Label Accuracy [0.9212616038474444, 0.2226680040120361, 0.7407224146462148, 0.9929148539465507]
    Val  Label F1 [0.8441711503971304, 0.34180138568129326, 0.7583586626139818, 0.9603270016830969]
    Val  Domain Accuracy [0.009546322392944813, 0.0, 0.9956359669060824]

    New Best Val Loss

    Test  Label Loss = 13170.30890083313
    Test  Domain Loss = 18092.420888900757
    Test  Regularization Loss = 980.6937539577484
    Test  Total Loss = 32243.423543691635
    Test  Composite Score 8322.5
    Test  Label Accuracy [0.5396741986337362, 0.03012912482065997, 0.4879032258064516, 0.9956945882609407]
    Test  Label F1 [0.4539226519337017, 0.054333764553686936, 0.6060943369973563, 0.9530267859471585]
    Test  Domain Accuracy [0.009994884507929012, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 54175.51254653931
    Train  Domain Loss = 64997.598625183105
    Train  Regularization Loss = 2834.3106071949005
    Train  Total Loss = 122007.42177891731
    Train  Composite Score 42178.25
    Train  Label Accuracy [0.8608549074486356, 0.2528787333573228, 0.5752032520325203, 0.6770877192982456]
    Train  Label F1 [0.7470777383696058, 0.2745787545787546, 0.5822617385553678, 0.7820941495936936]
    Train  Domain Accuracy [0.608498191055346, 0.0, 0.393862417571139]

    Val  Label Loss = 11024.193590164185
    Val  Domain Loss = 15250.671180725098
    Val  Regularization Loss = 773.2850217819214
    Val  Total Loss = 27048.149792671204
    Val  Composite Score 13208.5
    Val  Label Accuracy [0.9135443462699921, 0.25175526579739216, 0.7728847105393369, 0.9914232442510876]
    Val  Label F1 [0.8451112260734609, 0.3741614906832298, 0.7664376840039254, 0.9629942650166012]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    New Best Val Loss

    Test  Label Loss = 12863.528247833252
    Test  Domain Loss = 17755.116658210754
    Test  Regularization Loss = 896.3076388835907
    Test  Total Loss = 31514.952544927597
    Test  Composite Score 8454.5
    Test  Label Accuracy [0.43352601156069365, 0.058823529411764705, 0.5600358422939068, 0.9947136083710284]
    Test  Label F1 [0.40993788819875776, 0.09512761020881672, 0.6458279514337381, 0.9556771474199544]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 53823.0189704895
    Train  Domain Loss = 64925.630859375
    Train  Regularization Loss = 2697.9018495082855
    Train  Total Loss = 121446.55167937279
    Train  Composite Score 42353.5
    Train  Label Accuracy [0.8633918054184839, 0.2623127298824796, 0.5797038327526133, 0.6794736842105263]
    Train  Label F1 [0.7498030108240369, 0.28490694728636856, 0.5848835506078804, 0.7844368379478662]
    Train  Domain Accuracy [0.6062145587971159, 0.0, 0.3954019449362379]

    Val  Label Loss = 10863.014406204224
    Val  Domain Loss = 15276.851821899414
    Val  Regularization Loss = 743.1459474563599
    Val  Total Loss = 26883.012175559998
    Val  Composite Score 13208.75
    Val  Label Accuracy [0.9400514483838497, 0.1952524239384821, 0.7337951509153884, 0.9903045369794904]
    Val  Label F1 [0.8467660689099336, 0.316788717114185, 0.7520283975659229, 0.9649367165263731]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    New Best Val Loss

    Test  Label Loss = 13235.517265319824
    Test  Domain Loss = 16814.795700073242
    Test  Regularization Loss = 861.3737118244171
    Test  Total Loss = 30911.686677217484
    Test  Composite Score 8456.0
    Test  Label Accuracy [0.581187598528639, 0.015781922525107604, 0.49193548387096775, 0.9941686195432994]
    Test  Label F1 [0.45645893520429226, 0.030344827586206897, 0.6063785724147452, 0.9598021677365042]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 53522.3974647522
    Train  Domain Loss = 64871.22970581055
    Train  Regularization Loss = 2597.8186724185944
    Train  Total Loss = 120991.44584298134
    Train  Composite Score 42331.25
    Train  Label Accuracy [0.8624118431920706, 0.2612815884476534, 0.5683797909407665, 0.6823859649122807]
    Train  Label F1 [0.7483666436940041, 0.28380961717562864, 0.577731867483214, 0.7875597311087713]
    Train  Domain Accuracy [0.6041875144330691, 0.0, 0.3974289893002848]

    Val  Label Loss = 10762.219903945923
    Val  Domain Loss = 15241.026954650879
    Val  Regularization Loss = 729.6255826950073
    Val  Total Loss = 26732.87244129181
    Val  Composite Score 13247.0
    Val  Label Accuracy [0.9403869813219998, 0.19893012370444668, 0.7501237011380505, 0.9898073337476694]
    Val  Label F1 [0.8483503178286752, 0.32266811279826463, 0.7593288254445281, 0.9656217789365185]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    New Best Val Loss

    Test  Label Loss = 13298.463338851929
    Test  Domain Loss = 17676.70196533203
    Test  Regularization Loss = 845.7023799419403
    Test  Total Loss = 31820.8676841259
    Test  Composite Score 8400.25
    Test  Label Accuracy [0.5601681555438781, 0.058823529411764705, 0.47871863799283154, 0.9935691318327974]
    Test  Label F1 [0.44131649761954045, 0.10086100861008611, 0.5955964325529542, 0.9593748355522811]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 53652.440883636475
    Train  Domain Loss = 64973.476291656494
    Train  Regularization Loss = 2541.627334356308
    Train  Total Loss = 121167.54450964928
    Train  Composite Score 42394.25
    Train  Label Accuracy [0.8649798406298612, 0.2587937426530428, 0.5804297328687572, 0.675859649122807]
    Train  Label F1 [0.750185853134723, 0.28084981109857216, 0.5852730200556288, 0.7828331064192965]
    Train  Domain Accuracy [0.6223795961306545, 0.0, 0.38036589433710516]

    Val  Label Loss = 10771.506519317627
    Val  Domain Loss = 15258.674194335938
    Val  Regularization Loss = 710.5853700637817
    Val  Total Loss = 26740.766083717346
    Val  Composite Score 13176.0
    Val  Label Accuracy [0.9385974723185326, 0.19124038783015715, 0.7347847600197922, 0.9906774394033562]
    Val  Label F1 [0.846949588736943, 0.31308155446086483, 0.7530425963488844, 0.9613412942524576]
    Val  Domain Accuracy [0.9986362396581507, 0.0, 0.00554595872352032]

    Test  Label Loss = 12905.947715759277
    Test  Domain Loss = 17218.930322647095
    Test  Regularization Loss = 823.6330425739288
    Test  Total Loss = 30948.5110809803
    Test  Composite Score 8377.75
    Test  Label Accuracy [0.5685759327377824, 0.014347202295552367, 0.482078853046595, 0.9958035860264864]
    Test  Label F1 [0.45538720538720534, 0.027510316368638238, 0.6003626726182174, 0.957200481952957]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 53220.095054626465
    Train  Domain Loss = 64753.08444976807
    Train  Regularization Loss = 2506.3361365795135
    Train  Total Loss = 120479.51564097404
    Train  Composite Score 42437.0
    Train  Label Accuracy [0.866923052474335, 0.2616493916178459, 0.5744773519163763, 0.6788771929824562]
    Train  Label F1 [0.7521820062047572, 0.28356532356532355, 0.5823399558498895, 0.7848768812624234]
    Train  Domain Accuracy [0.6163241218279322, 0.0, 0.39263079567905984]

    Val  Label Loss = 10772.013177871704
    Val  Domain Loss = 15198.915641784668
    Val  Regularization Loss = 700.7642936706543
    Val  Total Loss = 26671.693113327026
    Val  Composite Score 13237.5
    Val  Label Accuracy [0.9290907057376132, 0.24172517552657974, 0.7382483918852053, 0.9914232442510876]
    Val  Label F1 [0.848258960481977, 0.37001023541453426, 0.758130081300813, 0.9629361342508753]
    Val  Domain Accuracy [0.9655423220292754, 0.0, 0.04391308300754614]

    Test  Label Loss = 13128.654354095459
    Test  Domain Loss = 17713.74805545807
    Test  Regularization Loss = 812.2495222091675
    Test  Total Loss = 31654.651931762695
    Test  Composite Score 8354.75
    Test  Label Accuracy [0.5727798213347346, 0.06312769010043041, 0.4652777777777778, 0.9937871273638891]
    Test  Label F1 [0.45933417614833544, 0.09401709401709402, 0.5894706967503902, 0.957293225188335]
    Test  Domain Accuracy [0.9597056624562232, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 53403.489641189575
    Train  Domain Loss = 65007.224224090576
    Train  Regularization Loss = 2460.397452354431
    Train  Total Loss = 120871.11131763458
    Train  Composite Score 42343.75
    Train  Label Accuracy [0.8620293554562859, 0.26626849705829914, 0.578397212543554, 0.6814035087719298]
    Train  Label F1 [0.7476201018375027, 0.2885014729318588, 0.5884351229598995, 0.7866807097140078]
    Train  Domain Accuracy [0.6392887383573242, 0.0, 0.3648679855284428]

    Val  Label Loss = 10791.548030853271
    Val  Domain Loss = 15248.704917907715
    Val  Regularization Loss = 693.2651138305664
    Val  Total Loss = 26733.518062591553
    Val  Composite Score 13212.5
    Val  Label Accuracy [0.9418409573873169, 0.18221330658642595, 0.7491340920336467, 0.9899316345556246]
    Val  Label F1 [0.8476521213951381, 0.3011049723756906, 0.758707090954648, 0.9643981593606201]
    Val  Domain Accuracy [0.9916356032366579, 0.0, 0.008818983543958542]

    Test  Label Loss = 13136.396408081055
    Test  Domain Loss = 17299.19997692108
    Test  Regularization Loss = 803.5572910308838
    Test  Total Loss = 31239.15367603302
    Test  Composite Score 8425.25
    Test  Label Accuracy [0.5538623226484498, 0.018651362984218076, 0.49417562724014336, 0.9936781295983432]
    Test  Label F1 [0.4410041841004184, 0.034666666666666665, 0.6044663652555144, 0.9597073453167354]
    Test  Domain Accuracy [0.9995278007319088, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 53344.13795089722
    Train  Domain Loss = 64923.45703125
    Train  Regularization Loss = 2431.7871272563934
    Train  Total Loss = 120699.38210940361
    Train  Composite Score 42411.75
    Train  Label Accuracy [0.865623107087066, 0.2720042891609329, 0.5662020905923345, 0.6790175438596491]
    Train  Label F1 [0.7500138113916359, 0.29319976883066845, 0.5806595697163701, 0.7852143393317238]
    Train  Domain Accuracy [0.5881507710466221, 0.0, 0.41580068252379854]

    Val  Label Loss = 10731.747079849243
    Val  Domain Loss = 15182.802291870117
    Val  Regularization Loss = 682.6112031936646
    Val  Total Loss = 26597.160574913025
    Val  Composite Score 13262.0
    Val  Label Accuracy [0.9342355441225814, 0.22300234035439653, 0.7560613557644731, 0.9925419515226849]
    Val  Label F1 [0.8500915937309178, 0.35179324894514774, 0.7662988966900702, 0.9641390968365129]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    New Best Val Loss

    Test  Label Loss = 13069.789600372314
    Test  Domain Loss = 17823.682346343994
    Test  Regularization Loss = 791.2084400653839
    Test  Total Loss = 31684.680386781693
    Test  Composite Score 8395.25
    Test  Label Accuracy [0.5570152390961639, 0.04160688665710186, 0.48566308243727596, 0.9948771050193471]
    Test  Label F1 [0.4503930316549819, 0.07277289836888332, 0.6014703842419198, 0.9579408600739904]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 53356.58044052124
    Train  Domain Loss = 64877.17938232422
    Train  Regularization Loss = 2425.8828403949738
    Train  Total Loss = 120659.64266324043
    Train  Composite Score 42524.5
    Train  Label Accuracy [0.869871979056923, 0.2660436137071651, 0.5792682926829268, 0.6808070175438596]
    Train  Label F1 [0.7514237255415672, 0.29292434339474716, 0.5854302692392341, 0.786629368361307]
    Train  Domain Accuracy [0.6274343776460627, 0.0, 0.37510584250635054]

    Val  Label Loss = 10781.336374282837
    Val  Domain Loss = 15248.929229736328
    Val  Regularization Loss = 680.1226663589478
    Val  Total Loss = 26710.388270378113
    Val  Composite Score 13213.5
    Val  Label Accuracy [0.9401632926965664, 0.19424941491140088, 0.7422068283028204, 0.9915475450590429]
    Val  Label F1 [0.8484481453444359, 0.31688028361058085, 0.7585335018963337, 0.9634639772933149]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    Test  Label Loss = 13184.073663711548
    Test  Domain Loss = 17977.880266189575
    Test  Regularization Loss = 788.3239996433258
    Test  Total Loss = 31950.27792954445
    Test  Composite Score 8399.0
    Test  Label Accuracy [0.5785601681555439, 0.02295552367288379, 0.47939068100358423, 0.9953675949643033]
    Test  Label F1 [0.45999582201796535, 0.04129032258064516, 0.5987688864017907, 0.958337705950257]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 53267.969678878784
    Train  Domain Loss = 64945.91360092163
    Train  Regularization Loss = 2397.256050825119
    Train  Total Loss = 120611.13933062553
    Train  Composite Score 42447.75
    Train  Label Accuracy [0.8645999616882702, 0.27091491634033465, 0.5810104529616724, 0.6798947368421052]
    Train  Label F1 [0.749107908494924, 0.29467570183930303, 0.5868035190615836, 0.7862446743761411]
    Train  Domain Accuracy [0.613219408308316, 0.0, 0.383932466066251]

    Val  Label Loss = 10705.695291519165
    Val  Domain Loss = 15234.6948928833
    Val  Regularization Loss = 676.0835409164429
    Val  Total Loss = 26616.47372531891
    Val  Composite Score 13252.75
    Val  Label Accuracy [0.931774969242814, 0.2246740220661986, 0.7580405739732805, 0.9912989434431324]
    Val  Label F1 [0.8487596148948092, 0.35192458758837397, 0.7652347652347652, 0.9642123080643212]
    Val  Domain Accuracy [0.04518592599327211, 0.0, 1.0]

    New Best Val Loss

    Test  Label Loss = 12962.770057678223
    Test  Domain Loss = 17907.62098789215
    Test  Regularization Loss = 783.6422860622406
    Test  Total Loss = 31654.033331632614
    Test  Composite Score 8470.0
    Test  Label Accuracy [0.5517603783499737, 0.03873744619799139, 0.5073924731182796, 0.9952585971987574]
    Test  Label F1 [0.4543487667676331, 0.06792452830188679, 0.6183456183456184, 0.9590630990205603]
    Test  Domain Accuracy [0.0008656986581670798, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 53244.77063751221
    Train  Domain Loss = 65052.39542388916
    Train  Regularization Loss = 2388.0144419670105
    Train  Total Loss = 120685.18050336838
    Train  Composite Score 42474.5
    Train  Label Accuracy [0.865774378585086, 0.2667740203972088, 0.5847851335656213, 0.6798947368421052]
    Train  Label F1 [0.7504143188597944, 0.29006371285443316, 0.5929197026569516, 0.7855115939678936]
    Train  Domain Accuracy [0.5930515998255202, 0.0, 0.4029199702358043]

    Val  Label Loss = 10767.629127502441
    Val  Domain Loss = 15248.543846130371
    Val  Regularization Loss = 668.7624359130859
    Val  Total Loss = 26684.9354095459
    Val  Composite Score 13268.5
    Val  Label Accuracy [0.9311039033665138, 0.22400534938147776, 0.7714002968827314, 0.9910503418272218]
    Val  Label F1 [0.849013308857274, 0.351798372276188, 0.7710187932739861, 0.9645535930316961]
    Val  Domain Accuracy [0.9986362396581507, 0.0, 0.009819074461314664]

    Test  Label Loss = 12902.305988311768
    Test  Domain Loss = 17575.01517391205
    Test  Regularization Loss = 775.1564598083496
    Test  Total Loss = 31252.477622032166
    Test  Composite Score 8493.75
    Test  Label Accuracy [0.5207566999474514, 0.03156384505021521, 0.5291218637992832, 0.9954220938470761]
    Test  Label F1 [0.44479353680430883, 0.0567741935483871, 0.6296987470007998, 0.9589688394193159]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 52987.13669586182
    Train  Domain Loss = 64850.77110290527
    Train  Regularization Loss = 2369.9764540195465
    Train  Total Loss = 120207.88425278664
    Train  Composite Score 42541.0
    Train  Label Accuracy [0.8668195280405082, 0.26727614950255446, 0.5810104529616724, 0.6864561403508772]
    Train  Label F1 [0.7534149885821051, 0.29092682926829266, 0.5877515053605522, 0.7901613522082432]
    Train  Domain Accuracy [0.6121673979421651, 0.0, 0.38762733174248837]

    Val  Label Loss = 10662.916442871094
    Val  Domain Loss = 15241.671180725098
    Val  Regularization Loss = 667.6800346374512
    Val  Total Loss = 26572.267658233643
    Val  Composite Score 13241.5
    Val  Label Accuracy [0.9375908735040823, 0.2042795051822133, 0.7575457694210787, 0.9910503418272218]
    Val  Label F1 [0.8495135792460478, 0.33098591549295775, 0.7626400996264011, 0.9633299099861053]
    Val  Domain Accuracy [0.9806346031457405, 0.0, 0.02936630602782071]

    New Best Val Loss

    Test  Label Loss = 12817.70509147644
    Test  Domain Loss = 17509.658166885376
    Test  Regularization Loss = 773.901858329773
    Test  Total Loss = 31101.26511669159
    Test  Composite Score 8469.75
    Test  Label Accuracy [0.5102469784550709, 0.03156384505021521, 0.5282258064516129, 0.9952040983159846]
    Test  Label F1 [0.4396649309486077, 0.055766793409378956, 0.6278791106377314, 0.9583562937888689]
    Test  Domain Accuracy [0.9820170778735293, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 52999.46994781494
    Train  Domain Loss = 64857.55367279053
    Train  Regularization Loss = 2353.0923614501953
    Train  Total Loss = 120210.11598205566
    Train  Composite Score 42640.25
    Train  Label Accuracy [0.8737200279844813, 0.26124910007199426, 0.5828977932636469, 0.6807719298245614]
    Train  Label F1 [0.7557004153257969, 0.2881818633047104, 0.5877186562248408, 0.7860152325392966]
    Train  Domain Accuracy [0.6067020757960639, 0.0, 0.39091165678803275]

    Val  Label Loss = 10783.18959236145
    Val  Domain Loss = 15249.026695251465
    Val  Regularization Loss = 659.6860218048096
    Val  Total Loss = 26691.902309417725
    Val  Composite Score 13230.75
    Val  Label Accuracy [0.930656526115647, 0.22668004012036108, 0.7496288965858486, 0.9920447482908639]
    Val  Label F1 [0.8486486486486486, 0.35506677140612725, 0.7597793380140422, 0.9627842451293805]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    Test  Label Loss = 12999.547729492188
    Test  Domain Loss = 17619.23083114624
    Test  Regularization Loss = 764.636070728302
    Test  Total Loss = 31383.41463136673
    Test  Composite Score 8424.5
    Test  Label Accuracy [0.5307409353652128, 0.035868005738880916, 0.5078405017921147, 0.9952585971987574]
    Test  Label F1 [0.4452281243112189, 0.06242197253433207, 0.6174588043034183, 0.9575042600602961]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 53071.873096466064
    Train  Domain Loss = 64899.49097442627
    Train  Regularization Loss = 2338.5769848823547
    Train  Total Loss = 120309.94105577469
    Train  Composite Score 42616.0
    Train  Label Accuracy [0.8722405480842426, 0.25358114233907525, 0.5840592334494773, 0.6844912280701755]
    Train  Label F1 [0.7556294393229561, 0.2793089674455762, 0.5907922754974667, 0.7888713656031381]
    Train  Domain Accuracy [0.63356682831704, 0.0, 0.3703333076745439]

    Val  Label Loss = 10709.025268554688
    Val  Domain Loss = 15248.635902404785
    Val  Regularization Loss = 652.3795509338379
    Val  Total Loss = 26610.04072189331
    Val  Composite Score 13219.75
    Val  Label Accuracy [0.9448607538306677, 0.1952524239384821, 0.722909450766947, 0.9906774394033562]
    Val  Label F1 [0.848277939552164, 0.3198247535596933, 0.7515432098765431, 0.9638408513725965]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    Test  Label Loss = 13279.83793258667
    Test  Domain Loss = 17650.21766090393
    Test  Regularization Loss = 756.1672067642212
    Test  Total Loss = 31686.22280025482
    Test  Composite Score 8368.0
    Test  Label Accuracy [0.6001050972149238, 0.03012912482065997, 0.4574372759856631, 0.9941686195432994]
    Test  Label F1 [0.45707424454672807, 0.05454545454545455, 0.5818492662772475, 0.9590956887486854]
    Test  Domain Accuracy [0.0, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 52899.97891616821
    Train  Domain Loss = 64897.89008331299
    Train  Regularization Loss = 2326.8713743686676
    Train  Total Loss = 120124.74037384987
    Train  Composite Score 42621.25
    Train  Label Accuracy [0.8718250309946912, 0.2634897756958833, 0.580574912891986, 0.6812280701754386]
    Train  Label F1 [0.7543874126643562, 0.2895609562936198, 0.5862346991130983, 0.7870201467428757]
    Train  Domain Accuracy [0.5595155620557822, 0.0, 0.4455135606702076]

    Val  Label Loss = 10673.332113265991
    Val  Domain Loss = 15256.147270202637
    Val  Regularization Loss = 653.4914827346802
    Val  Total Loss = 26582.970866203308
    Val  Composite Score 13192.75
    Val  Label Accuracy [0.9394922268202662, 0.19859578736208625, 0.7293419099455715, 0.9921690490988191]
    Val  Label F1 [0.8486562942008488, 0.3223005968529571, 0.7522327124266395, 0.9619764989454656]
    Val  Domain Accuracy [0.9778161651059187, 0.0, 0.019819983634875898]

    Test  Label Loss = 12990.373840332031
    Test  Domain Loss = 17378.862895965576
    Test  Regularization Loss = 757.4560368061066
    Test  Total Loss = 31126.692773103714
    Test  Composite Score 8308.25
    Test  Label Accuracy [0.5417761429322123, 0.02582496413199426, 0.4742383512544803, 0.996021581557578]
    Test  Label F1 [0.43853679285410463, 0.047556142668428, 0.593246462098921, 0.9561077687679833]
    Test  Domain Accuracy [0.999803250304962, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 52965.407943725586
    Train  Domain Loss = 64979.27554702759
    Train  Regularization Loss = 2322.8790221214294
    Train  Total Loss = 120267.5625128746
    Train  Composite Score 42542.75
    Train  Label Accuracy [0.8669490985538638, 0.26898960945897527, 0.5756387921022067, 0.6879298245614035]
    Train  Label F1 [0.7520066312081234, 0.29382124162222983, 0.5863649807749186, 0.7914900488474425]
    Train  Domain Accuracy [0.6471916454981654, 0.0, 0.3515510738203372]

    Val  Label Loss = 10715.514030456543
    Val  Domain Loss = 15248.182144165039
    Val  Regularization Loss = 650.6095552444458
    Val  Total Loss = 26614.305729866028
    Val  Composite Score 13213.25
    Val  Label Accuracy [0.9327815680572643, 0.22668004012036108, 0.7323107372587828, 0.9932877563704164]
    Val  Label F1 [0.8496332518337408, 0.3555322496067121, 0.7533723593789768, 0.9615546597677637]
    Val  Domain Accuracy [0.9753613964905901, 0.0, 0.02936630602782071]

    Test  Label Loss = 12920.760528564453
    Test  Domain Loss = 17412.786195755005
    Test  Regularization Loss = 754.1156208515167
    Test  Total Loss = 31087.662345170975
    Test  Composite Score 8311.25
    Test  Label Accuracy [0.5501839201261166, 0.03299856527977044, 0.4715501792114695, 0.9964575726197613]
    Test  Label F1 [0.4464818763326226, 0.06044678055190538, 0.5917908349732921, 0.9557512872115208]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 52820.33712387085
    Train  Domain Loss = 64900.40783691406
    Train  Regularization Loss = 2323.734149456024
    Train  Total Loss = 120044.47911024094
    Train  Composite Score 42599.75
    Train  Label Accuracy [0.866501382664251, 0.27304676939713435, 0.5866724738675958, 0.6804561403508772]
    Train  Label F1 [0.7524634960942892, 0.29539361442846696, 0.5947019867549669, 0.7862717671146792]
    Train  Domain Accuracy [0.5937957047186514, 0.0, 0.4032022169194057]

    Val  Label Loss = 10732.751161575317
    Val  Domain Loss = 15242.443641662598
    Val  Regularization Loss = 650.896520614624
    Val  Total Loss = 26626.09132385254
    Val  Composite Score 13243.0
    Val  Label Accuracy [0.9343473884352981, 0.23069207622868607, 0.7367639782285997, 0.9924176507147296]
    Val  Label F1 [0.8504530184261427, 0.36163522012578614, 0.7556457751839635, 0.9623335141324656]
    Val  Domain Accuracy [0.990362760250932, 0.0, 0.025547777070642787]

    Test  Label Loss = 13039.15482711792
    Test  Domain Loss = 17410.484330177307
    Test  Regularization Loss = 754.4482398033142
    Test  Total Loss = 31204.08739709854
    Test  Composite Score 8320.25
    Test  Label Accuracy [0.5281135049921177, 0.03873744619799139, 0.48185483870967744, 0.9962940759714426]
    Test  Label F1 [0.43867306852902666, 0.06878980891719745, 0.5961751662971175, 0.9560442433909472]
    Test  Domain Accuracy [0.999803250304962, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 52942.30679702759
    Train  Domain Loss = 64934.05146789551
    Train  Regularization Loss = 2307.927379131317
    Train  Total Loss = 120184.28564405441
    Train  Composite Score 42591.0
    Train  Label Accuracy [0.8688665710186514, 0.2684713660323416, 0.5810104529616724, 0.6871578947368421]
    Train  Label F1 [0.7537650914823881, 0.29269955681098714, 0.5918804998890779, 0.7908413592585861]
    Train  Domain Accuracy [0.6191209298745285, 0.0, 0.37744079234341726]

    Val  Label Loss = 10763.230585098267
    Val  Domain Loss = 15243.134727478027
    Val  Regularization Loss = 650.4891777038574
    Val  Total Loss = 26656.85449028015
    Val  Composite Score 13291.25
    Val  Label Accuracy [0.9323341908063975, 0.23938482113005682, 0.7590301830776843, 0.9909260410192666]
    Val  Label F1 [0.8510464522715672, 0.37098445595854923, 0.7648965345300424, 0.9642576353190204]
    Val  Domain Accuracy [0.9964542231111919, 0.0, 0.015819619965451406]

    Test  Label Loss = 13055.796165466309
    Test  Domain Loss = 17220.097208976746
    Test  Regularization Loss = 753.976092338562
    Test  Total Loss = 31029.869466781616
    Test  Composite Score 8420.0
    Test  Label Accuracy [0.48502364687335786, 0.04878048780487805, 0.5237455197132617, 0.9948226061365743]
    Test  Label F1 [0.420788693868247, 0.08124253285543609, 0.6254681647940075, 0.9575617688716364]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 53124.174810409546
    Train  Domain Loss = 64818.45506286621
    Train  Regularization Loss = 2301.8960797786713
    Train  Total Loss = 120244.52595305443
    Train  Composite Score 42518.0
    Train  Label Accuracy [0.865193968952217, 0.2747832305354429, 0.578397212543554, 0.6829122807017544]
    Train  Label F1 [0.7522414533763839, 0.2967038270353747, 0.5855379188712523, 0.7879757085020243]
    Train  Domain Accuracy [0.6024683755420419, 0.0, 0.40825699843481383]

    Val  Label Loss = 10660.489110946655
    Val  Domain Loss = 15240.888488769531
    Val  Regularization Loss = 646.2190532684326
    Val  Total Loss = 26547.59665298462
    Val  Composite Score 13233.75
    Val  Label Accuracy [0.9408343585728666, 0.20361083249749248, 0.7407224146462148, 0.9916718458669981]
    Val  Label F1 [0.8497828063440751, 0.33197056418642684, 0.756825075834176, 0.962770771737163]
    Val  Domain Accuracy [0.9793617601600145, 0.0, 0.024365851441040094]

    New Best Val Loss

    Test  Label Loss = 13011.642889022827
    Test  Domain Loss = 17474.312992095947
    Test  Regularization Loss = 749.0266299247742
    Test  Total Loss = 31234.98251104355
    Test  Composite Score 8346.25
    Test  Label Accuracy [0.5380977404098791, 0.024390243902439025, 0.4836469534050179, 0.9958580849092593]
    Test  Label F1 [0.43713980789754536, 0.04515272244355909, 0.598558358746881, 0.9573531723162361]
    Test  Domain Accuracy [0.9978357533545823, 0.0, 0.0]
Training model 1
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 63026.19431304932
    Train  Domain Loss = 49325.70518493652
    Train  Regularization Loss = 6397.5606780052185
    Train  Total Loss = 118749.46017599106
    Train  Composite Score 39430.25
    Train  Label Accuracy [0.8193185072062613, 0.20014379437404511, 0.4380081300813008, 0.6601052631578948]
    Train  Label F1 [0.7203457391012462, 0.2182370522808565, 0.4590338531761125, 0.7401011034835461]
    Train  Domain Accuracy [0.7881097169835527, 0.0, 0.6091909783696405]

    Val  Label Loss = 11782.959568023682
    Val  Domain Loss = 13182.179302215576
    Val  Regularization Loss = 944.3308067321777
    Val  Total Loss = 25909.469676971436
    Val  Composite Score 12911.75
    Val  Label Accuracy [0.9232748014763449, 0.14744232698094284, 0.7159821870361207, 0.9912989434431324]
    Val  Label F1 [0.8358647225597409, 0.2434446591222744, 0.7437676689796968, 0.9533771667662883]
    Val  Domain Accuracy [0.5363214837712519, 0.0, 0.911628329848168]

    Test  Label Loss = 14456.716876983643
    Test  Domain Loss = 16239.10736656189
    Test  Regularization Loss = 1094.5652532577515
    Test  Total Loss = 31790.389496803284
    Test  Composite Score 8156.75
    Test  Label Accuracy [0.4818707304256437, 0.015781922525107604, 0.48723118279569894, 0.99493160390212]
    Test  Label F1 [0.43142789931780756, 0.02981029810298103, 0.6016597510373444, 0.9457352293625508]
    Test  Domain Accuracy [0.4452839098099398, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 56426.646450042725
    Train  Domain Loss = 75806.71553039551
    Train  Regularization Loss = 3136.4011068344116
    Train  Total Loss = 135369.76308727264
    Train  Composite Score 41297.5
    Train  Label Accuracy [0.8451112030290496, 0.2212238296342888, 0.5410859465737514, 0.6801052631578948]
    Train  Label F1 [0.734855925521172, 0.2415857128839172, 0.5542419510744293, 0.7788716547456401]
    Train  Domain Accuracy [0.5508428912323916, 0.0, 0.44089497857491083]

    Val  Label Loss = 11346.025156021118
    Val  Domain Loss = 15351.074863433838
    Val  Regularization Loss = 873.7245273590088
    Val  Total Loss = 27570.824546813965
    Val  Composite Score 12933.0
    Val  Label Accuracy [0.9064981545688402, 0.20929455031761954, 0.7154873824839189, 0.9921690490988191]
    Val  Label F1 [0.836256706562113, 0.3169620253164557, 0.7413483722122532, 0.9524491378796015]
    Val  Domain Accuracy [0.9983634875897809, 0.0, 0.011182834803163923]

    Test  Label Loss = 13401.968591690063
    Test  Domain Loss = 15854.32028388977
    Test  Regularization Loss = 1012.7261567115784
    Test  Total Loss = 30269.015032291412
    Test  Composite Score 8261.0
    Test  Label Accuracy [0.4997372569626905, 0.024390243902439025, 0.5047043010752689, 0.996021581557578]
    Test  Label F1 [0.4558964525407479, 0.04234122042341221, 0.6200632998486308, 0.9473356831847398]
    Test  Domain Accuracy [0.9981899028056507, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 54400.981578826904
    Train  Domain Loss = 65117.03158569336
    Train  Regularization Loss = 2871.5757219791412
    Train  Total Loss = 122389.5888864994
    Train  Composite Score 41877.25
    Train  Label Accuracy [0.8524141443075846, 0.24930424634168238, 0.5599593495934959, 0.6806315789473685]
    Train  Label F1 [0.741616592362861, 0.26936320869101316, 0.5686274509803921, 0.7840585275156121]
    Train  Domain Accuracy [0.6065994406383907, 0.0, 0.3948887691478716]

    Val  Label Loss = 10986.5345993042
    Val  Domain Loss = 15235.802085876465
    Val  Regularization Loss = 772.6178312301636
    Val  Total Loss = 26994.954516410828
    Val  Composite Score 13224.75
    Val  Label Accuracy [0.9318868135555307, 0.1855566700100301, 0.7946561108362197, 0.9886886264760721]
    Val  Label F1 [0.8455020548987773, 0.3043597477378667, 0.7732306210881078, 0.9649399490476769]
    Val  Domain Accuracy [0.9768160741885626, 0.0, 0.053095735975997815]

    Test  Label Loss = 13035.66612625122
    Test  Domain Loss = 17451.48080921173
    Test  Regularization Loss = 895.5343043804169
    Test  Total Loss = 31382.68123984337
    Test  Composite Score 8558.0
    Test  Label Accuracy [0.44981607987388333, 0.018651362984218076, 0.5810931899641577, 0.9927516485912039]
    Test  Label F1 [0.4112418928657218, 0.03556771545827633, 0.6542244640605296, 0.9586863849271091]
    Test  Domain Accuracy [0.964191555503089, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 54296.97188568115
    Train  Domain Loss = 64913.49091339111
    Train  Regularization Loss = 2651.9124433994293
    Train  Total Loss = 121862.3752424717
    Train  Composite Score 42046.0
    Train  Label Accuracy [0.8607832532688575, 0.2308314606741573, 0.5781068524970964, 0.6798245614035088]
    Train  Label F1 [0.7437225986448783, 0.2541693472559014, 0.5859760135383709, 0.7854782802586504]
    Train  Domain Accuracy [0.5921278834064608, 0.0, 0.41310650963487544]

    Val  Label Loss = 10976.862571716309
    Val  Domain Loss = 15267.075927734375
    Val  Regularization Loss = 732.3330545425415
    Val  Total Loss = 26976.271553993225
    Val  Composite Score 13176.75
    Val  Label Accuracy [0.9345710770607315, 0.1718488799732531, 0.7718951014349332, 0.9900559353635798]
    Val  Label F1 [0.8437847117035242, 0.2842920353982301, 0.7679054885552548, 0.964811337895948]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 12957.396530151367
    Test  Domain Loss = 17387.82323741913
    Test  Regularization Loss = 848.8405859470367
    Test  Total Loss = 31194.060353517532
    Test  Composite Score 8541.5
    Test  Label Accuracy [0.5176037834997372, 0.01721664275466284, 0.5448028673835126, 0.9944956128399368]
    Test  Label F1 [0.4435937851835172, 0.03278688524590164, 0.6380690017053653, 0.9596634236129373]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 53889.06416320801
    Train  Domain Loss = 64989.7031288147
    Train  Regularization Loss = 2554.612449645996
    Train  Total Loss = 121433.3797416687
    Train  Composite Score 42051.0
    Train  Label Accuracy [0.8589263024142313, 0.23966419931395558, 0.5670731707317073, 0.6815438596491228]
    Train  Label F1 [0.7450812896114632, 0.2609849601887349, 0.5754272245138479, 0.7865559829925086]
    Train  Domain Accuracy [0.6035717034870295, 0.0, 0.39545326251507457]

    Val  Label Loss = 10852.378868103027
    Val  Domain Loss = 15255.340721130371
    Val  Regularization Loss = 710.53795337677
    Val  Total Loss = 26818.25754261017
    Val  Composite Score 13210.0
    Val  Label Accuracy [0.9360250531260486, 0.19558676028084251, 0.7525977238990599, 0.9915475450590429]
    Val  Label F1 [0.8464650551228886, 0.31553398058252424, 0.7648981644455619, 0.9647457217149423]
    Val  Domain Accuracy [1.0, 0.0, 0.011910173652150196]

    Test  Label Loss = 13189.629964828491
    Test  Domain Loss = 17358.99536705017
    Test  Regularization Loss = 823.5780823230743
    Test  Total Loss = 31372.203414201736
    Test  Composite Score 8409.0
    Test  Label Accuracy [0.5496584340514976, 0.035868005738880916, 0.4910394265232975, 0.995476592729849]
    Test  Label F1 [0.44520110661842943, 0.06518904823989569, 0.6036904434040209, 0.9588954800776943]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 53911.64903259277
    Train  Domain Loss = 64999.240367889404
    Train  Regularization Loss = 2494.333482980728
    Train  Total Loss = 121405.2228834629
    Train  Composite Score 41939.0
    Train  Label Accuracy [0.8524396474645548, 0.24968866749688667, 0.5765098722415796, 0.6805964912280702]
    Train  Label F1 [0.7396580865035605, 0.26994278020868395, 0.587860843819393, 0.7852559561160253]
    Train  Domain Accuracy [0.5895620044646294, 0.0, 0.4144664254740461]

    Val  Label Loss = 10913.879062652588
    Val  Domain Loss = 15261.880325317383
    Val  Regularization Loss = 697.3366546630859
    Val  Total Loss = 26873.096042633057
    Val  Composite Score 13219.25
    Val  Label Accuracy [0.932893412369981, 0.20160481444332998, 0.7639782285997031, 0.9916718458669981]
    Val  Label F1 [0.8468020304568529, 0.3221153846153846, 0.7698828222388432, 0.964633335348528]
    Val  Domain Accuracy [1.0, 0.0, 0.0]

    Test  Label Loss = 13290.851751327515
    Test  Domain Loss = 17137.634006500244
    Test  Regularization Loss = 808.2765769958496
    Test  Total Loss = 31236.76233482361
    Test  Composite Score 8437.5
    Test  Label Accuracy [0.5522858644245927, 0.03873744619799139, 0.49731182795698925, 0.9953675949643033]
    Test  Label F1 [0.4480920912385418, 0.07012987012987013, 0.6098901098901099, 0.959117762898779]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 53739.041831970215
    Train  Domain Loss = 65021.535778045654
    Train  Regularization Loss = 2466.8457477092743
    Train  Total Loss = 121227.42335772514
    Train  Composite Score 42091.25
    Train  Label Accuracy [0.8576879053796261, 0.24095083738519718, 0.5814459930313589, 0.6801754385964912]
    Train  Label F1 [0.743878226340172, 0.2615963634586246, 0.5897077228889052, 0.7860589594906937]
    Train  Domain Accuracy [0.5874836425217458, 0.0, 0.40846226875016034]

    Val  Label Loss = 10777.883485794067
    Val  Domain Loss = 15252.089141845703
    Val  Regularization Loss = 690.5508756637573
    Val  Total Loss = 26720.523503303528
    Val  Composite Score 13209.75
    Val  Label Accuracy [0.9421764903254669, 0.19424941491140088, 0.7303315190499753, 0.9921690490988191]
    Val  Label F1 [0.8478687534598158, 0.3178336980306346, 0.7563412759415833, 0.9636605094772425]
    Val  Domain Accuracy [1.0, 0.0, 0.0124556777888899]

    Test  Label Loss = 13177.52896308899
    Test  Domain Loss = 17201.47235584259
    Test  Regularization Loss = 800.4112422466278
    Test  Total Loss = 31179.412561178207
    Test  Composite Score 8394.5
    Test  Label Accuracy [0.6027325275880189, 0.03156384505021521, 0.4637096774193548, 0.9945501117227097]
    Test  Label F1 [0.46156941649899397, 0.057971014492753624, 0.5874840357598978, 0.9592115637319317]
    Test  Domain Accuracy [1.0, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 53593.24568748474
    Train  Domain Loss = 64984.70832824707
    Train  Regularization Loss = 2439.5101642608643
    Train  Total Loss = 121017.46417999268
    Train  Composite Score 42229.25
    Train  Label Accuracy [0.8604023006768566, 0.2538551717918658, 0.5772357723577236, 0.6771578947368421]
    Train  Label F1 [0.7464196611945031, 0.27420611728034283, 0.5854376794522564, 0.7840659787113023]
    Train  Domain Accuracy [0.6057013830087496, 0.0, 0.3947348164113617]

    Val  Label Loss = 10821.136978149414
    Val  Domain Loss = 15255.628463745117
    Val  Regularization Loss = 681.0203838348389
    Val  Total Loss = 26757.78582572937
    Val  Composite Score 13203.5
    Val  Label Accuracy [0.9389330052566827, 0.1972584419926446, 0.7367639782285997, 0.9924176507147296]
    Val  Label F1 [0.8479369728801576, 0.32004339571467316, 0.756990340620234, 0.9634367080970194]
    Val  Domain Accuracy [0.0, 0.0, 1.0]
