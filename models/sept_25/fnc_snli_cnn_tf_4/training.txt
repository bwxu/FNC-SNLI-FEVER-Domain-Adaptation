Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
Loading CNN vectors...
SIZE_TRAIN = 368336
SIZE_VAL = 21998
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 75601.35792541504
    Train  Domain Loss = 0.0
    Train  Regularization Loss = 4874.52268409729
    Train  Total Loss = 80475.88060951233
    Train  Composite Score 31957.25
    Train  Label Accuracy [0.49301095579901777, 0.44845661036691903, 0.35772644744805326, 0.6610175438596492]
    Train  Label F1 [0.4058466801430571, 0.4075691411935954, 0.39368374313148696, 0.7381474806049684]

    Val  Label Loss = 16862.665855407715
    Val  Domain Loss = 0.0
    Val  Regularization Loss = 889.2093276977539
    Val  Total Loss = 17751.87518310547
    Val  Composite Score 10882.0
    Val  Label Accuracy [0.5244434243745697, 0.46844106463878327, 0.5951159086887277, 0.9752641392169049]
    Val  Label F1 [0.5294867338662959, 0.5238837703756201, 0.5768439108061749, 0.9424624624624623]

    New Best Val Loss

    Test  Label Loss = 15916.886293411255
    Test  Domain Loss = 0.0
    Test  Regularization Loss = 1030.6744480133057
    Test  Total Loss = 16947.56074142456
    Test  Composite Score 8235.5
    Test  Label Accuracy [0.27377824487651076, 0.011477761836441894, 0.6256720430107527, 0.9688266390538994]
    Test  Label F1 [0.33205863607393243, 0.021768707482993196, 0.6232983708993528, 0.9358532283961992]

  EPOCH 1
    Train  Label Loss = 68410.63724517822
    Train  Domain Loss = 0.0
    Train  Regularization Loss = 2706.959582090378
    Train  Total Loss = 71117.5968272686
    Train  Composite Score 34453.25
    Train  Label Accuracy [0.5484171901237639, 0.48531365313653135, 0.41868093051420496, 0.6751578947368421]
    Train  Label F1 [0.4471715814295494, 0.4377142476786368, 0.45195555071358534, 0.7744817870798953]

    Val  Label Loss = 15982.849224090576
    Val  Domain Loss = 0.0
    Val  Regularization Loss = 725.8753108978271
    Val  Total Loss = 16708.724534988403
    Val  Composite Score 11251.0
    Val  Label Accuracy [0.5623135184760156, 0.5467680608365019, 0.5802512829587684, 0.9860783095090118]
    Val  Label F1 [0.5550521069324875, 0.5609882964889467, 0.5983576642335766, 0.9605279089478146]

    New Best Val Loss

    Test  Label Loss = 14564.224781036377
    Test  Domain Loss = 0.0
    Test  Regularization Loss = 841.3554739952087
    Test  Total Loss = 15405.580255031586
    Test  Composite Score 8587.25
    Test  Label Accuracy [0.2580136626379401, 0.05308464849354376, 0.709005376344086, 0.9637582429560194]
    Test  Label F1 [0.33503923575571476, 0.08361581920903954, 0.666385935361617, 0.9428700914398442]

  EPOCH 2
    Train  Label Loss = 67465.04917144775
    Train  Domain Loss = 0.0
    Train  Regularization Loss = 2516.709874391556
    Train  Total Loss = 69981.75904583931
    Train  Composite Score 34911.75
    Train  Label Accuracy [0.5470005606428705, 0.5046618321740417, 0.4321142914633533, 0.6759298245614035]
    Train  Label F1 [0.45019225839528326, 0.447565297283108, 0.46424904069610334, 0.779919028340081]

    Val  Label Loss = 15666.951917648315
    Val  Domain Loss = 0.0
    Val  Regularization Loss = 701.5536975860596
    Val  Total Loss = 16368.505615234375
    Val  Composite Score 11137.0
    Val  Label Accuracy [0.5473949965572642, 0.5216730038022813, 0.5857370376924438, 0.9908017402113114]
    Val  Label F1 [0.5451428571428572, 0.5530028214429665, 0.5936154949784792, 0.9574199747762898]

    New Best Val Loss

    Test  Label Loss = 13552.380416870117
    Test  Domain Loss = 0.0
    Test  Regularization Loss = 813.1645131111145
    Test  Total Loss = 14365.544929981232
    Test  Composite Score 8364.25
    Test  Label Accuracy [0.2049395691014188, 0.05595408895265423, 0.6859318996415771, 0.9697531200610388]
    Test  Label F1 [0.29235382308845576, 0.09059233449477352, 0.6599137931034482, 0.9361075308414656]

  EPOCH 3
    Train  Label Loss = 67014.1949672699
    Train  Domain Loss = 0.0
    Train  Regularization Loss = 2428.9227628707886
    Train  Total Loss = 69443.11773014069
    Train  Composite Score 34923.25
    Train  Label Accuracy [0.5413108990457057, 0.5039005004415661, 0.43758153537380834, 0.6760701754385965]
    Train  Label F1 [0.44461633663366334, 0.44874819766679774, 0.4684554024655547, 0.7807289450758728]

    Val  Label Loss = 15587.448184967041
    Val  Domain Loss = 0.0
    Val  Regularization Loss = 691.9185638427734
    Val  Total Loss = 16279.366748809814
    Val  Composite Score 11181.75
    Val  Label Accuracy [0.4962129905898554, 0.6380228136882129, 0.5517607503096797, 0.9864512119328775]
    Val  Label F1 [0.5340249475114239, 0.5829762594093805, 0.5811742777260019, 0.959961291883392]

    New Best Val Loss

    Test  Label Loss = 13745.1734085083
    Test  Domain Loss = 0.0
    Test  Regularization Loss = 801.9965171813965
    Test  Total Loss = 14547.169925689697
    Test  Composite Score 8510.0
    Test  Label Accuracy [0.25328428796636887, 0.03873744619799139, 0.7004928315412187, 0.9616327865278762]
    Test  Label F1 [0.33741687084354216, 0.05515832482124617, 0.66397706762926, 0.9392882808549148]

  EPOCH 4
    Train  Label Loss = 67024.14567947388
    Train  Domain Loss = 0.0
    Train  Regularization Loss = 2407.6988632678986
    Train  Total Loss = 69431.84454274178
    Train  Composite Score 34956.75
    Train  Label Accuracy [0.5543950166740075, 0.5057311820106593, 0.42833400483481066, 0.673578947368421]
    Train  Label F1 [0.4522984522984523, 0.44929463272255554, 0.4615509849677104, 0.7797002558791276]

    Val  Label Loss = 15502.569925308228
    Val  Domain Loss = 0.0
    Val  Regularization Loss = 678.0075883865356
    Val  Total Loss = 16180.577513694763
    Val  Composite Score 11134.0
    Val  Label Accuracy [0.48267156300206565, 0.6261089987325729, 0.560962661475845, 0.9896830329397142]
    Val  Label F1 [0.528060263653484, 0.5787932044522555, 0.5826670342799375, 0.9584110743304242]

    New Best Val Loss

    Test  Label Loss = 13682.21422958374
    Test  Domain Loss = 0.0
    Test  Regularization Loss = 785.8724319934845
    Test  Total Loss = 14468.086661577225
    Test  Composite Score 8326.25
    Test  Label Accuracy [0.29637414608512874, 0.05595408895265423, 0.6303763440860215, 0.9700256144749033]
    Test  Label F1 [0.35752773375594293, 0.08705357142857142, 0.638239963710592, 0.9378507258213242]

  EPOCH 5
    Train  Label Loss = 66852.12345123291
    Train  Domain Loss = 0.0
    Train  Regularization Loss = 2347.9520313739777
    Train  Total Loss = 69200.07548260689
    Train  Composite Score 35059.5
    Train  Label Accuracy [0.556542962638463, 0.4990027332496122, 0.43998996487706976, 0.6686315789473685]
    Train  Label F1 [0.4539676867709743, 0.44574218878880856, 0.4697720515361744, 0.7766705386073242]

    Val  Label Loss = 15638.625579833984
    Val  Domain Loss = 0.0
    Val  Regularization Loss = 656.3623952865601
    Val  Total Loss = 16294.987975120544
    Val  Composite Score 11335.75
    Val  Label Accuracy [0.5570346568739959, 0.5782002534854246, 0.5793664838081756, 0.9862026103169671]
    Val  Label F1 [0.5551235132662398, 0.5791545004443315, 0.6004034476434991, 0.9635071953366933]

    Test  Label Loss = 13970.9720287323
    Test  Domain Loss = 0.0
    Test  Regularization Loss = 760.7836854457855
    Test  Total Loss = 14731.755714178085
    Test  Composite Score 8563.75
    Test  Label Accuracy [0.2348922753547031, 0.03012912482065997, 0.7148297491039427, 0.967954656929533]
    Test  Label F1 [0.3160127253446448, 0.04866743916570104, 0.6734198586050438, 0.9433040337785805]

  EPOCH 6
    Train  Label Loss = 66782.01856994629
    Train  Domain Loss = 0.0
    Train  Regularization Loss = 2289.494968652725
    Train  Total Loss = 69071.51353859901
    Train  Composite Score 35049.25
    Train  Label Accuracy [0.5526973026973027, 0.5029655121915502, 0.4369594902139281, 0.6705614035087719]
    Train  Label F1 [0.4518401306722475, 0.4494536413007918, 0.46589377190617415, 0.7791821258205244]

    Val  Label Loss = 15404.709091186523
    Val  Domain Loss = 0.0
    Val  Regularization Loss = 643.3371257781982
    Val  Total Loss = 16048.046216964722
    Val  Composite Score 11205.25
    Val  Label Accuracy [0.5492311223318798, 0.6035487959442332, 0.5462749955760042, 0.9885643256681168]
    Val  Label F1 [0.5572892408011177, 0.5820804302652487, 0.5846037307073194, 0.954398175927037]

    New Best Val Loss

    Test  Label Loss = 13358.762699127197
    Test  Domain Loss = 0.0
    Test  Regularization Loss = 745.6862139701843
    Test  Total Loss = 14104.448913097382
    Test  Composite Score 8369.0
    Test  Label Accuracy [0.2748292170257488, 0.06169296987087518, 0.6489695340501792, 0.976401983759333]
    Test  Label F1 [0.35566133968038083, 0.09481808158765159, 0.6569160997732426, 0.9390429267781331]

  EPOCH 7
    Train  Label Loss = 66569.32746887207
    Train  Domain Loss = 0.0
    Train  Regularization Loss = 2261.08026266098
    Train  Total Loss = 68830.40773153305
    Train  Composite Score 35143.0
    Train  Label Accuracy [0.5559550845319202, 0.5213987855731949, 0.43041405269761607, 0.6681052631578948]
    Train  Label F1 [0.45168234118340467, 0.46148865218376667, 0.4638433663259235, 0.7771202350828503]

    Val  Label Loss = 15630.27053451538
    Val  Domain Loss = 0.0
    Val  Regularization Loss = 632.6906633377075
    Val  Total Loss = 16262.961197853088
    Val  Composite Score 11356.75
    Val  Label Accuracy [0.5384438834060133, 0.6448669201520912, 0.5512298708193241, 0.9821006836544438]
    Val  Label F1 [0.5535630014157621, 0.58963958743771, 0.593163857945349, 0.9642421283866245]

    Test  Label Loss = 14403.036346435547
    Test  Domain Loss = 0.0
    Test  Regularization Loss = 733.3459961414337
    Test  Total Loss = 15136.38234257698
    Test  Composite Score 8626.5
    Test  Label Accuracy [0.2538097740409879, 0.07173601147776183, 0.7190860215053764, 0.9570003814921794]
    Test  Label F1 [0.3308219178082192, 0.10111223458038422, 0.6645274816271607, 0.9426669529740175]

  EPOCH 8
    Train  Label Loss = 66538.2085647583
    Train  Domain Loss = 0.0
    Train  Regularization Loss = 2226.9595675468445
    Train  Total Loss = 68765.16813230515
    Train  Composite Score 34973.5
    Train  Label Accuracy [0.5428535417191832, 0.5108410942956927, 0.43213673489966725, 0.6778947368421052]
    Train  Label F1 [0.4434263358385669, 0.45430133618040053, 0.4655495505282311, 0.7836138714256743]

    Val  Label Loss = 15739.591300964355
    Val  Domain Loss = 0.0
    Val  Regularization Loss = 619.9777460098267
    Val  Total Loss = 16359.569046974182
    Val  Composite Score 11431.25
    Val  Label Accuracy [0.6063805370667891, 0.5959442332065906, 0.5501681118386126, 0.9819763828464885]
    Val  Label F1 [0.5745351745134283, 0.5851169736187158, 0.5988058551617874, 0.9646498565235972]

    Test  Label Loss = 14432.239376068115
    Test  Domain Loss = 0.0
    Test  Regularization Loss = 718.6105692386627
    Test  Total Loss = 15150.849945306778
    Test  Composite Score 8744.25
    Test  Label Accuracy [0.2743037309511298, 0.02582496413199426, 0.7421594982078853, 0.9620687775900594]
    Test  Label F1 [0.3541383989145183, 0.043373493975903614, 0.6797989124858931, 0.9465161791909064]

  EPOCH 9
    Train  Label Loss = 66279.03820800781
    Train  Domain Loss = 0.0
    Train  Regularization Loss = 2188.2687191963196
    Train  Total Loss = 68467.30692720413
    Train  Composite Score 35318.25
    Train  Label Accuracy [0.562183455261677, 0.5005532197388802, 0.44752714113389624, 0.6723859649122808]
    Train  Label F1 [0.4580934427064758, 0.4503434316620765, 0.4753997704156545, 0.7814934138085722]

    Val  Label Loss = 15486.347845077515
    Val  Domain Loss = 0.0
    Val  Regularization Loss = 611.5275573730469
    Val  Total Loss = 16097.875402450562
    Val  Composite Score 11296.25
    Val  Label Accuracy [0.55221482671563, 0.5604562737642586, 0.5947619890284905, 0.9824735860783095]
    Val  Label F1 [0.5552734825755827, 0.5772092416133664, 0.6048227460860176, 0.9548776804590757]

    Test  Label Loss = 14006.26554107666
    Test  Domain Loss = 0.0
    Test  Regularization Loss = 708.816032409668
    Test  Total Loss = 14715.081573486328
    Test  Composite Score 8367.75
    Test  Label Accuracy [0.24960588544403572, 0.01721664275466284, 0.6801075268817204, 0.960052318927462]
    Test  Label F1 [0.32612427051150017, 0.030534351145038167, 0.6470588235294118, 0.9334711072251809]

  EPOCH 10
    Train  Label Loss = 66246.60499191284
    Train  Domain Loss = 0.0
    Train  Regularization Loss = 2160.5190517902374
    Train  Total Loss = 68407.12404370308
    Train  Composite Score 35115.0
    Train  Label Accuracy [0.5528912201823405, 0.5060461707585197, 0.4377621670793956, 0.6741052631578948]
    Train  Label F1 [0.44976125165091946, 0.45411199894774923, 0.46902750703920293, 0.7814044292599597]

    Val  Label Loss = 15625.1018409729
    Val  Domain Loss = 0.0
    Val  Regularization Loss = 605.3835296630859
    Val  Total Loss = 16230.485370635986
    Val  Composite Score 11414.0
    Val  Label Accuracy [0.5581822354831306, 0.6380228136882129, 0.5538842682711025, 0.9843380981976383]
    Val  Label F1 [0.5611444393170282, 0.596021785460573, 0.5981844242713807, 0.9647316805750138]
