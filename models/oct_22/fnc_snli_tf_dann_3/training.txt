Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
SIZE_TRAIN = 304066
SIZE_VAL = 5908
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 17644.05477142334
    Train  Domain Loss = 6200.658309936523
    Train  Regularization Loss = 1594.7081328630447
    Train  Total Loss = 25439.421214222908
    Train  Composite Score 14796.5
    Train  Label Accuracy [0.6859091462672026, 0.44244911920643065, 0.6583914053426249, 0.0]
    Train  Label F1 [0.6040326040326042, 0.48184019370460046, 0.7265299583466837, 0]
    Train  Domain Accuracy [0.9642891244151628, 0.8061682421464719, 0.0]

    Val  Label Loss = 3531.4049139022827
    Val  Domain Loss = 161.27798222750425
    Val  Regularization Loss = 585.0782203674316
    Val  Total Loss = 4277.761116497219
    Val  Composite Score 4688.5
    Val  Label Accuracy [0.672884440400364, 0.6039076376554174, 0.8822365165759525, 0.0]
    Val  Label F1 [0.6582109479305741, 0.6488549618320612, 0.8535184298707515, 0]
    Val  Domain Accuracy [0.983750846310088, 0.998645903859174, 0.0]

    Test  Label Loss = 96688.03035926819
    Test  Domain Loss = 3519.825255476404
    Test  Regularization Loss = 2486.5824365615845
    Test  Total Loss = 102694.43805130618
    Test  Composite Score 5111.0
    Test  Label Accuracy [0.6894377299001576, 0.06456241032998565, 0.6951164874551972, 0.0]
    Test  Label F1 [0.5306370070778564, 0.10067114093959731, 0.7487031004946315, 0]
    Test  Domain Accuracy [0.9498681777043245, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 16087.967567443848
    Train  Domain Loss = 9152.183792114258
    Train  Regularization Loss = 2155.9018955230713
    Train  Total Loss = 27396.053255081177
    Train  Composite Score 15436.75
    Train  Label Accuracy [0.7323046779328924, 0.4984725050916497, 0.6804587688734031, 0.0]
    Train  Label F1 [0.6460674157303371, 0.5262969267986739, 0.7678571428571428, 0]
    Train  Domain Accuracy [0.8868519048983099, 0.7794328272701232, 0.0]

    Val  Label Loss = 3564.3316898345947
    Val  Domain Loss = 973.2970201969147
    Val  Regularization Loss = 647.3171997070312
    Val  Total Loss = 5184.945909738541
    Val  Composite Score 4695.25
    Val  Label Accuracy [0.7206551410373067, 0.5630550621669627, 0.8688767936665017, 0.0]
    Val  Label F1 [0.6773572803078898, 0.6308457711442786, 0.8516003879728419, 0]
    Val  Domain Accuracy [0.8730534867975627, 0.997291807718348, 0.0]

    Test  Label Loss = 107797.51918792725
    Test  Domain Loss = 6497.406960964203
    Test  Regularization Loss = 2751.098098754883
    Test  Total Loss = 117046.02424764633
    Test  Composite Score 5054.75
    Test  Label Accuracy [0.6547556489753021, 0.11908177905308465, 0.6845878136200717, 0.0]
    Test  Label F1 [0.5166908563134978, 0.16370808678500987, 0.7371848992883849, 0]
    Test  Domain Accuracy [0.8631409121315862, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 15647.573863983154
    Train  Domain Loss = 11284.630611419678
    Train  Regularization Loss = 2199.797658920288
    Train  Total Loss = 29132.00213432312
    Train  Composite Score 15661.0
    Train  Label Accuracy [0.7583055452636779, 0.5195437007213555, 0.6774099883855982, 0.0]
    Train  Label F1 [0.6611748236687666, 0.5487243090007088, 0.7763727121464228, 0]
    Train  Domain Accuracy [0.8082688818867564, 0.7574715936216939, 0.0]

    Val  Label Loss = 3718.432168006897
    Val  Domain Loss = 1718.345633506775
    Val  Regularization Loss = 627.2705268859863
    Val  Total Loss = 6064.048328399658
    Val  Composite Score 4699.0
    Val  Label Accuracy [0.7429481346678799, 0.5411486086441681, 0.8654131618010885, 0.0]
    Val  Label F1 [0.6836926941595144, 0.6221919673247106, 0.8529626920263349, 0]
    Val  Domain Accuracy [0.7840216655382533, 0.985781990521327, 0.0]

    Test  Label Loss = 125503.98048591614
    Test  Domain Loss = 9815.012204647064
    Test  Regularization Loss = 2665.899739265442
    Test  Total Loss = 137984.89242982864
    Test  Composite Score 5108.0
    Test  Label Accuracy [0.6883867577509196, 0.10760401721664276, 0.6879480286738351, 0.0]
    Test  Label F1 [0.5279065081603869, 0.16447368421052633, 0.7442142251302556, 0]
    Test  Domain Accuracy [0.746310943218038, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 15591.587734222412
    Train  Domain Loss = 12014.985275268555
    Train  Regularization Loss = 2124.4179582595825
    Train  Total Loss = 29730.99096775055
    Train  Composite Score 15680.25
    Train  Label Accuracy [0.7649368175683965, 0.5073641442356526, 0.681910569105691, 0.0]
    Train  Label F1 [0.669422374919476, 0.5365678990242593, 0.7775846370333581, 0]
    Train  Domain Accuracy [0.7783825073999809, 0.7416213119450015, 0.0]

    Val  Label Loss = 3719.529266834259
    Val  Domain Loss = 2145.0272755622864
    Val  Regularization Loss = 595.5999755859375
    Val  Total Loss = 6460.156517982483
    Val  Composite Score 4717.0
    Val  Label Accuracy [0.7488626023657871, 0.5677915926583778, 0.8485898070262247, 0.0]
    Val  Label F1 [0.6910159529806884, 0.64190093708166, 0.843996062992126, 0]
    Val  Domain Accuracy [0.6855111712931619, 0.9908598510494245, 0.0]

    Test  Label Loss = 133405.41506958008
    Test  Domain Loss = 12590.477876663208
    Test  Regularization Loss = 2531.2998962402344
    Test  Total Loss = 148527.19284248352
    Test  Composite Score 5042.75
    Test  Label Accuracy [0.652653704676826, 0.1133428981348637, 0.6827956989247311, 0.0]
    Test  Label F1 [0.506938775510204, 0.1605691056910569, 0.7394468704512372, 0]
    Test  Domain Accuracy [0.6103175540077913, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 15662.28030014038
    Train  Domain Loss = 12430.538454055786
    Train  Regularization Loss = 2017.5558471679688
    Train  Total Loss = 30110.374601364136
    Train  Composite Score 15663.5
    Train  Label Accuracy [0.7784467928237896, 0.4851351351351351, 0.6824912891986062, 0.0]
    Train  Label F1 [0.6722912023771622, 0.5252857796067673, 0.7773460107482432, 0]
    Train  Domain Accuracy [0.7509787071517234, 0.7326458512365129, 0.0]

    Val  Label Loss = 3764.977864265442
    Val  Domain Loss = 2193.9200155735016
    Val  Regularization Loss = 574.9790382385254
    Val  Total Loss = 6533.876918077469
    Val  Composite Score 4738.75
    Val  Label Accuracy [0.6733393994540491, 0.655417406749556, 0.871845620979713, 0.0]
    Val  Label F1 [0.6782768102658111, 0.6680748340374171, 0.8516191396810053, 0]
    Val  Domain Accuracy [0.7511848341232228, 0.955991875423155, 0.0]

    Test  Label Loss = 146287.81530952454
    Test  Domain Loss = 9992.122596740723
    Test  Regularization Loss = 2443.660912513733
    Test  Total Loss = 158723.598818779
    Test  Composite Score 4924.25
    Test  Label Accuracy [0.49921177088807145, 0.266857962697274, 0.6888440860215054, 0.0]
    Test  Label F1 [0.4499171205304286, 0.23922829581993565, 0.7365269461077845, 0]
    Test  Domain Accuracy [0.7186479360956991, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 15748.663898468018
    Train  Domain Loss = 12929.275661468506
    Train  Regularization Loss = 1976.2934856414795
    Train  Total Loss = 30654.233045578003
    Train  Composite Score 15729.75
    Train  Label Accuracy [0.7761285574092247, 0.5120216728750423, 0.6742160278745645, 0.0]
    Train  Label F1 [0.6784259060690543, 0.5409176281191306, 0.7709803270523781, 0]
    Train  Domain Accuracy [0.7525064451446577, 0.7104936503389668, 0.0]

    Val  Label Loss = 3707.4802503585815
    Val  Domain Loss = 2187.2935667037964
    Val  Regularization Loss = 553.5036277770996
    Val  Total Loss = 6448.2774448394775
    Val  Composite Score 4739.5
    Val  Label Accuracy [0.6969972702456779, 0.6506808762581409, 0.8505690252350322, 0.0]
    Val  Label F1 [0.6825573624415237, 0.6650529500756428, 0.8547986076578817, 0]
    Val  Domain Accuracy [0.7515233581584293, 0.949898442789438, 0.0]

    Test  Label Loss = 145252.36771965027
    Test  Domain Loss = 10707.855361938477
    Test  Regularization Loss = 2352.3904180526733
    Test  Total Loss = 158312.61349964142
    Test  Composite Score 4973.0
    Test  Label Accuracy [0.6931161324224908, 0.18794835007173602, 0.6330645161290323, 0.0]
    Test  Label F1 [0.5130299494360171, 0.2276281494352737, 0.7213784301212508, 0]
    Test  Domain Accuracy [0.6920473773265652, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 15844.670734405518
    Train  Domain Loss = 13175.812162399292
    Train  Regularization Loss = 1883.0211429595947
    Train  Total Loss = 30903.504039764404
    Train  Composite Score 15610.75
    Train  Label Accuracy [0.7640009782342871, 0.5057823129251701, 0.6697154471544715, 0.0]
    Train  Label F1 [0.6690223792697291, 0.5301247771836006, 0.769731353245453, 0]
    Train  Domain Accuracy [0.7350329418504726, 0.709061395970591, 0.0]

    Val  Label Loss = 3890.4735112190247
    Val  Domain Loss = 2774.5367012023926
    Val  Regularization Loss = 536.7404937744141
    Val  Total Loss = 7201.750706195831
    Val  Composite Score 4671.25
    Val  Label Accuracy [0.7374886260236578, 0.6536412078152753, 0.7590301830776843, 0.0]
    Val  Label F1 [0.6852673853307969, 0.6678765880217786, 0.8118549880920878, 0]
    Val  Domain Accuracy [0.5748138117806364, 0.9888287068381855, 0.0]

    Test  Label Loss = 142716.21993637085
    Test  Domain Loss = 17540.39676475525
    Test  Regularization Loss = 2281.1470985412598
    Test  Total Loss = 162537.76379966736
    Test  Composite Score 4891.25
    Test  Label Accuracy [0.7094062007356805, 0.2898134863701578, 0.5857974910394266, 0.0]
    Test  Label F1 [0.5205320994794679, 0.2698730794923179, 0.7025792584631919, 0]
    Test  Domain Accuracy [0.4434344626765829, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 16000.115688323975
    Train  Domain Loss = 13378.11318397522
    Train  Regularization Loss = 1813.7838954925537
    Train  Total Loss = 31192.012767791748
    Train  Composite Score 15679.5
    Train  Label Accuracy [0.7844392465837745, 0.49688289806234204, 0.6688443670150988, 0.0]
    Train  Label F1 [0.677115987460815, 0.5354516568315932, 0.7650282298239788, 0]
    Train  Domain Accuracy [0.7268213501384513, 0.6978898118972596, 0.0]

    Val  Label Loss = 3956.979293346405
    Val  Domain Loss = 2641.535825252533
    Val  Regularization Loss = 506.91049575805664
    Val  Total Loss = 7105.425614356995
    Val  Composite Score 4675.75
    Val  Label Accuracy [0.7529572338489536, 0.5654233274126702, 0.8189015338941118, 0.0]
    Val  Label F1 [0.693774889960176, 0.6264348966874385, 0.8283283283283283, 0]
    Val  Domain Accuracy [0.6225457007447529, 0.9705484089370345, 0.0]

    Test  Label Loss = 144536.1609430313
    Test  Domain Loss = 17086.358615875244
    Test  Regularization Loss = 2154.3696069717407
    Test  Total Loss = 163776.8891658783
    Test  Composite Score 4974.5
    Test  Label Accuracy [0.6626379400945875, 0.23672883787661406, 0.6388888888888888, 0.0]
    Test  Label F1 [0.5130187144019528, 0.23965141612200436, 0.728015315890236, 0]
    Test  Domain Accuracy [0.4829811513792154, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 15861.39109992981
    Train  Domain Loss = 13672.450466156006
    Train  Regularization Loss = 1757.1637716293335
    Train  Total Loss = 31291.00533771515
    Train  Composite Score 15632.75
    Train  Label Accuracy [0.7790668970624537, 0.4991605104096709, 0.6647793263646922, 0.0]
    Train  Label F1 [0.6751885329197198, 0.5323187108325872, 0.7620236312198369, 0]
    Train  Domain Accuracy [0.7197555619211305, 0.6901556383080302, 0.0]

    Val  Label Loss = 3884.688621520996
    Val  Domain Loss = 2456.3911526203156
    Val  Regularization Loss = 496.1322212219238
    Val  Total Loss = 6837.2119953632355
    Val  Composite Score 4685.5
    Val  Label Accuracy [0.5950864422202001, 0.7229129662522202, 0.8654131618010885, 0.0]
    Val  Label F1 [0.6440177252584933, 0.6790878754171301, 0.8412698412698413, 0]
    Val  Domain Accuracy [0.6956668923493569, 0.9553148273527421, 0.0]

    Test  Label Loss = 148923.2556324005
    Test  Domain Loss = 13008.83504486084
    Test  Regularization Loss = 2108.5619401931763
    Test  Total Loss = 164040.65261745453
    Test  Composite Score 4915.25
    Test  Label Accuracy [0.4025223331581713, 0.4433285509325681, 0.6998207885304659, 0.0]
    Test  Label F1 [0.4182364182364182, 0.29109750353273667, 0.7489810596979142, 0]
    Test  Domain Accuracy [0.5952465273678825, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 15858.269626617432
    Train  Domain Loss = 13425.663934707642
    Train  Regularization Loss = 1676.709457874298
    Train  Total Loss = 30960.64301919937
    Train  Composite Score 15725.5
    Train  Label Accuracy [0.7855915562101129, 0.5076142131979695, 0.665650406504065, 0.0]
    Train  Label F1 [0.6814286474689946, 0.5411743483358888, 0.7631491344873502, 0]
    Train  Domain Accuracy [0.7253890957700755, 0.6916833763009644, 0.0]

    Val  Label Loss = 3952.601411342621
    Val  Domain Loss = 2768.1785883903503
    Val  Regularization Loss = 471.1695957183838
    Val  Total Loss = 7191.949595451355
    Val  Composite Score 4674.25
    Val  Label Accuracy [0.6874431301182894, 0.6560094730609828, 0.8134586838198912, 0.0]
    Val  Label F1 [0.6801710555930678, 0.661295135780364, 0.817503729487817, 0]
    Val  Domain Accuracy [0.6069735951252538, 0.972241029113067, 0.0]

    Test  Label Loss = 146072.00688362122
    Test  Domain Loss = 18800.282962799072
    Test  Regularization Loss = 2002.470781803131
    Test  Total Loss = 166874.76062822342
    Test  Composite Score 4769.0
    Test  Label Accuracy [0.5328428796636889, 0.47919655667144906, 0.5949820788530465, 0.0]
    Test  Label F1 [0.45298190752736206, 0.3182467841829443, 0.7033898305084746, 0]
    Test  Domain Accuracy [0.4357218746310943, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 15666.138278961182
    Train  Domain Loss = 13546.9924659729
    Train  Regularization Loss = 1628.2973518371582
    Train  Total Loss = 30841.42809677124
    Train  Composite Score 15825.0
    Train  Label Accuracy [0.7930068226120858, 0.512991452991453, 0.6691347270615563, 0.0]
    Train  Label F1 [0.6907200084894147, 0.5461825461825461, 0.7647888492491496, 0]
    Train  Domain Accuracy [0.720614914542156, 0.6918743435500812, 0.0]

    Val  Label Loss = 3821.4001336097717
    Val  Domain Loss = 2528.94695687294
    Val  Regularization Loss = 460.4519748687744
    Val  Total Loss = 6810.799065351486
    Val  Composite Score 4711.0
    Val  Label Accuracy [0.7898089171974523, 0.5470692717584369, 0.8174171202375062, 0.0]
    Val  Label F1 [0.709585121602289, 0.625169147496617, 0.8328711872951853, 0]
    Val  Domain Accuracy [0.6651997291807719, 0.953960731211916, 0.0]

    New Best Val Loss

    Test  Label Loss = 148676.11771583557
    Test  Domain Loss = 14790.47663974762
    Test  Regularization Loss = 1956.9208931922913
    Test  Total Loss = 165423.51524877548
    Test  Composite Score 4898.75
    Test  Label Accuracy [0.6826064109301103, 0.2539454806312769, 0.6050627240143369, 0.0]
    Test  Label F1 [0.5079178885630498, 0.24877020379479978, 0.7117259552042161, 0]
    Test  Domain Accuracy [0.5453901546452603, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 15844.588523864746
    Train  Domain Loss = 13793.654052734375
    Train  Regularization Loss = 1570.7618074417114
    Train  Total Loss = 31209.004384040833
    Train  Composite Score 15796.0
    Train  Label Accuracy [0.7864244507180558, 0.5085433936728134, 0.6778455284552846, 0.0]
    Train  Label F1 [0.6860110284276462, 0.5425013535462913, 0.7702713849707168, 0]
    Train  Domain Accuracy [0.7145039625704191, 0.7032368948725294, 0.0]

    Val  Label Loss = 3866.8297290802
    Val  Domain Loss = 2686.3788030147552
    Val  Regularization Loss = 442.80921936035156
    Val  Total Loss = 6996.017751455307
    Val  Composite Score 4700.5
    Val  Label Accuracy [0.7857142857142857, 0.5595026642984015, 0.8045522018802573, 0.0]
    Val  Label F1 [0.7086581862946245, 0.6378670266621668, 0.8172907765770294, 0]
    Val  Domain Accuracy [0.5842924847664184, 0.968855788761002, 0.0]

    Test  Label Loss = 145394.06552791595
    Test  Domain Loss = 19406.99521255493
    Test  Regularization Loss = 1881.9391822814941
    Test  Total Loss = 166682.99992275238
    Test  Composite Score 4905.5
    Test  Label Accuracy [0.7241198108250131, 0.18077474892395984, 0.6008064516129032, 0.0]
    Test  Label F1 [0.5151401869158878, 0.2108786610878661, 0.7073717526045101, 0]
    Test  Domain Accuracy [0.44418211151772713, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 15880.440063476562
    Train  Domain Loss = 13667.075370788574
    Train  Regularization Loss = 1514.8550472259521
    Train  Total Loss = 31062.37048149109
    Train  Composite Score 15704.75
    Train  Label Accuracy [0.7879565164284842, 0.4971895758814512, 0.6663763066202091, 0.0]
    Train  Label F1 [0.6847105025739001, 0.5303415697674418, 0.762838623898953, 0]
    Train  Domain Accuracy [0.710780101212642, 0.6963620739043254, 0.0]

    Val  Label Loss = 3922.972851753235
    Val  Domain Loss = 2731.764284133911
    Val  Regularization Loss = 426.4384460449219
    Val  Total Loss = 7081.175581932068
    Val  Composite Score 4707.25
    Val  Label Accuracy [0.7129208371246588, 0.6329188869153345, 0.8268184067293419, 0.0]
    Val  Label F1 [0.6935162646603231, 0.6617146394305168, 0.82193802262666, 0]
    Val  Domain Accuracy [0.6594448205822614, 0.940419769803656, 0.0]

    Test  Label Loss = 145750.45464897156
    Test  Domain Loss = 15239.315357208252
    Test  Regularization Loss = 1812.363395690918
    Test  Total Loss = 162802.13340187073
    Test  Composite Score 4896.5
    Test  Label Accuracy [0.5932737782448765, 0.36585365853658536, 0.625, 0.0]
    Test  Label F1 [0.49582784365393057, 0.28428093645484953, 0.7172236503856041, 0]
    Test  Domain Accuracy [0.5274072325187896, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 15999.798446655273
    Train  Domain Loss = 13727.854881286621
    Train  Regularization Loss = 1466.5389866828918
    Train  Total Loss = 31194.192314624786
    Train  Composite Score 15648.5
    Train  Label Accuracy [0.7733790905748253, 0.5060179691473131, 0.6665214866434379, 0.0]
    Train  Label F1 [0.6794809669951004, 0.5326077259345169, 0.7588429752066116, 0]
    Train  Domain Accuracy [0.7097297813424998, 0.6908240236799389, 0.0]

    Val  Label Loss = 3958.6044058799744
    Val  Domain Loss = 2769.433700323105
    Val  Regularization Loss = 416.6520881652832
    Val  Total Loss = 7144.690194368362
    Val  Composite Score 4665.25
    Val  Label Accuracy [0.7843494085532302, 0.5553582001184133, 0.7862444334487877, 0.0]
    Val  Label F1 [0.7016687016687017, 0.6276346604215457, 0.8121645796064402, 0]
    Val  Domain Accuracy [0.6252538930264049, 0.9597156398104265, 0.0]

    Test  Label Loss = 144547.6176624298
    Test  Domain Loss = 15971.435486793518
    Test  Regularization Loss = 1770.7713747024536
    Test  Total Loss = 162289.82452392578
    Test  Composite Score 4778.0
    Test  Label Accuracy [0.7046768260641093, 0.23672883787661406, 0.5622759856630825, 0.0]
    Test  Label F1 [0.501965188096575, 0.22821576763485477, 0.6840168960348821, 0]
    Test  Domain Accuracy [0.4957698815566836, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 15725.967836380005
    Train  Domain Loss = 13649.291984558105
    Train  Regularization Loss = 1426.5746421813965
    Train  Total Loss = 30801.834463119507
    Train  Composite Score 15817.5
    Train  Label Accuracy [0.7865420560747663, 0.5261064147190453, 0.6714576074332171, 0.0]
    Train  Label F1 [0.6864973625537006, 0.5558182295770948, 0.7661724509235485, 0]
    Train  Domain Accuracy [0.7200420127948057, 0.6835672682135013, 0.0]

    Val  Label Loss = 4020.4074392318726
    Val  Domain Loss = 2901.8270115852356
    Val  Regularization Loss = 406.722936630249
    Val  Total Loss = 7328.957387447357
    Val  Composite Score 4647.25
    Val  Label Accuracy [0.7661510464058234, 0.5867377146240379, 0.7679366650173182, 0.0]
    Val  Label F1 [0.7012283989173433, 0.6302066772655008, 0.8024819027921406, 0]
    Val  Domain Accuracy [0.5531482735274205, 0.963439404197698, 0.0]

    Test  Label Loss = 142182.01601600647
    Test  Domain Loss = 20050.44672203064
    Test  Regularization Loss = 1728.5724806785583
    Test  Total Loss = 163961.03521871567
    Test  Composite Score 4777.25
    Test  Label Accuracy [0.6878612716763006, 0.2926829268292683, 0.5604838709677419, 0.0]
    Test  Label F1 [0.5029779058597502, 0.25612052730696794, 0.6826739427012278, 0]
    Test  Domain Accuracy [0.4055798213512769, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 15520.321899414062
    Train  Domain Loss = 13866.058502197266
    Train  Regularization Loss = 1402.114900112152
    Train  Total Loss = 30788.49530172348
    Train  Composite Score 15835.0
    Train  Label Accuracy [0.7963712149074414, 0.5190645653279106, 0.6639082462253194, 0.0]
    Train  Label F1 [0.6959130108736408, 0.5471596998928189, 0.7605821205821206, 0]
    Train  Domain Accuracy [0.7157452496896782, 0.6797479232311658, 0.0]

    Val  Label Loss = 3782.258271217346
    Val  Domain Loss = 2697.452151298523
    Val  Regularization Loss = 394.0931797027588
    Val  Total Loss = 6873.803602218628
    Val  Composite Score 4726.0
    Val  Label Accuracy [0.7274795268425842, 0.6412078152753108, 0.8164275111331024, 0.0]
    Val  Label F1 [0.6993221080253663, 0.6652334152334151, 0.8276899924755455, 0]
    Val  Domain Accuracy [0.6594448205822614, 0.950575490859851, 0.0]

    New Best Val Loss

    Test  Label Loss = 144783.12927818298
    Test  Domain Loss = 15143.151693344116
    Test  Regularization Loss = 1674.8960137367249
    Test  Total Loss = 161601.17698526382
    Test  Composite Score 4856.75
    Test  Label Accuracy [0.6841828691539674, 0.21377331420373027, 0.5981182795698925, 0.0]
    Test  Label F1 [0.5061224489795918, 0.2137733142037303, 0.7036500197654499, 0]
    Test  Domain Accuracy [0.5319718254436706, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 15598.238704681396
    Train  Domain Loss = 13935.802066802979
    Train  Regularization Loss = 1367.7864208221436
    Train  Total Loss = 30901.82719230652
    Train  Composite Score 15841.75
    Train  Label Accuracy [0.7992718446601942, 0.5072189755929872, 0.6684088269454123, 0.0]
    Train  Label F1 [0.6967100391410135, 0.53973479652492, 0.7642127977425512, 0]
    Train  Domain Accuracy [0.7134536427002769, 0.6771698653680893, 0.0]

    Val  Label Loss = 3874.8237648010254
    Val  Domain Loss = 2809.668658018112
    Val  Regularization Loss = 388.2421875
    Val  Total Loss = 7072.734610319138
    Val  Composite Score 4708.75
    Val  Label Accuracy [0.7202001819836215, 0.6311426879810539, 0.8213755566551212, 0.0]
    Val  Label F1 [0.698279664755183, 0.6553950199815555, 0.8240258128567882, 0]
    Val  Domain Accuracy [0.6178063642518619, 0.9448205822613406, 0.0]

    Test  Label Loss = 144643.93281650543
    Test  Domain Loss = 16423.291061401367
    Test  Regularization Loss = 1650.029296875
    Test  Total Loss = 162717.2531747818
    Test  Composite Score 4837.25
    Test  Label Accuracy [0.5691014188124015, 0.3615494978479197, 0.6182795698924731, 0.0]
    Test  Label F1 [0.4707672245164095, 0.2855524079320113, 0.7111569183200206, 0]
    Test  Domain Accuracy [0.48640459607287606, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 15725.720092773438
    Train  Domain Loss = 14018.769575119019
    Train  Regularization Loss = 1344.68119764328
    Train  Total Loss = 31089.170865535736
    Train  Composite Score 15861.5
    Train  Label Accuracy [0.8010490363503293, 0.5034129692832765, 0.6756678281068524, 0.0]
    Train  Label F1 [0.6995100127822752, 0.5394039129639788, 0.7651459103986847, 0]
    Train  Domain Accuracy [0.7040007638689965, 0.6870046786976034, 0.0]

    Val  Label Loss = 3940.5571541786194
    Val  Domain Loss = 2879.2571885585785
    Val  Regularization Loss = 379.87157821655273
    Val  Total Loss = 7199.685920953751
    Val  Composite Score 4685.5
    Val  Label Accuracy [0.7725204731574158, 0.5950266429840142, 0.7793171697179614, 0.0]
    Val  Label F1 [0.7038341968911918, 0.646510131875201, 0.8114374034003091, 0]
    Val  Domain Accuracy [0.6184834123222749, 0.9478672985781991, 0.0]

    Test  Label Loss = 145702.8796825409
    Test  Domain Loss = 15914.277433395386
    Test  Regularization Loss = 1614.4542074203491
    Test  Total Loss = 163231.61132335663
    Test  Composite Score 4790.75
    Test  Label Accuracy [0.6678928008407777, 0.3012912482065997, 0.5716845878136201, 0.0]
    Test  Label F1 [0.4987247400431626, 0.2584615384615384, 0.6891709424790711, 0]
    Test  Domain Accuracy [0.5049777672844608, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 15563.788299560547
    Train  Domain Loss = 13811.325008392334
    Train  Regularization Loss = 1303.5720520019531
    Train  Total Loss = 30678.685359954834
    Train  Composite Score 15885.0
    Train  Label Accuracy [0.797308868501529, 0.5225225225225225, 0.6689895470383276, 0.0]
    Train  Label F1 [0.6952533333333333, 0.5534749729924379, 0.766212171599601, 0]
    Train  Domain Accuracy [0.7177504058054044, 0.6859543588274611, 0.0]

    Val  Label Loss = 3798.477684020996
    Val  Domain Loss = 2663.640700817108
    Val  Regularization Loss = 370.2443504333496
    Val  Total Loss = 6832.362735271454
    Val  Composite Score 4734.25
    Val  Label Accuracy [0.7561419472247498, 0.5896980461811723, 0.8337456704601682, 0.0]
    Val  Label F1 [0.7091956475357372, 0.6484375, 0.8306630515158985, 0]
    Val  Domain Accuracy [0.6306702775897088, 0.9658090724441435, 0.0]

    Test  Label Loss = 147479.24063110352
    Test  Domain Loss = 16675.408515930176
    Test  Regularization Loss = 1573.5384893417358
    Test  Total Loss = 165728.18763637543
    Test  Composite Score 4943.75
    Test  Label Accuracy [0.6132422490803994, 0.2898134863701578, 0.6424731182795699, 0.0]
    Test  Label F1 [0.4913684210526316, 0.2765229295003422, 0.7245168624478969, 0]
    Test  Domain Accuracy [0.5071420139298785, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 15403.650943756104
    Train  Domain Loss = 13917.06547164917
    Train  Regularization Loss = 1277.8461661338806
    Train  Total Loss = 30598.562581539154
    Train  Composite Score 15866.0
    Train  Label Accuracy [0.7990728315237282, 0.5082750383893534, 0.674506387921022, 0.0]
    Train  Label F1 [0.69592010199745, 0.5429691059874237, 0.7686962276637989, 0]
    Train  Domain Accuracy [0.7058149527356058, 0.6760240618733887, 0.0]

    Val  Label Loss = 3938.492123603821
    Val  Domain Loss = 2980.5545778274536
    Val  Regularization Loss = 360.0076961517334
    Val  Total Loss = 7279.054397583008
    Val  Composite Score 4684.75
    Val  Label Accuracy [0.7525022747952684, 0.6281823564239195, 0.7728847105393369, 0.0]
    Val  Label F1 [0.7056313993174061, 0.6523209345219797, 0.8061935483870968, 0]
    Val  Domain Accuracy [0.5724441435341909, 0.9417738659444821, 0.0]

    Test  Label Loss = 143719.5390434265
    Test  Domain Loss = 17701.915400505066
    Test  Regularization Loss = 1530.032708644867
    Test  Total Loss = 162951.48715257645
    Test  Composite Score 4718.0
    Test  Label Accuracy [0.5874934314240673, 0.43615494978479197, 0.5631720430107527, 0.0]
    Test  Label F1 [0.47232784114913395, 0.2981853849926434, 0.6836165873555405, 0]
    Test  Domain Accuracy [0.45276039822138275, 0.0, 0.0]
Training model 1
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 17654.596557617188
    Train  Domain Loss = 6231.167482376099
    Train  Regularization Loss = 1557.8781782984734
    Train  Total Loss = 25443.64221829176
    Train  Composite Score 14769.5
    Train  Label Accuracy [0.6877729257641921, 0.4499484004127967, 0.6444541231126597, 0.0]
    Train  Label F1 [0.6061577934573443, 0.4816349074841204, 0.7230819351685942, 0]
    Train  Domain Accuracy [0.9680129857729399, 0.8075050128902893, 0.0]

    Val  Label Loss = 3642.7483649253845
    Val  Domain Loss = 160.66748543083668
    Val  Regularization Loss = 590.2229118347168
    Val  Total Loss = 4393.638762190938
    Val  Composite Score 4680.25
    Val  Label Accuracy [0.6096451319381255, 0.6394316163410302, 0.9158832261256804, 0.0]
    Val  Label F1 [0.6409949772781631, 0.6557377049180328, 0.8527988942639946, 0]
    Val  Domain Accuracy [0.983073798239675, 0.997291807718348, 0.0]

    Test  Label Loss = 98169.1572303772
    Test  Domain Loss = 3155.4071109676734
    Test  Regularization Loss = 2508.4473752975464
    Test  Total Loss = 103833.01171664242
    Test  Composite Score 5241.5
    Test  Label Accuracy [0.4776668418286915, 0.13773314203730272, 0.8129480286738351, 0.0]
    Test  Label F1 [0.48818474758324387, 0.18408437200383507, 0.7753445144749492, 0]
    Test  Domain Accuracy [0.9578562153228662, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 15968.379650115967
    Train  Domain Loss = 9497.711310386658
    Train  Regularization Loss = 2163.8045043945312
    Train  Total Loss = 27629.895464897156
    Train  Composite Score 15565.75
    Train  Label Accuracy [0.7461688153733884, 0.4970870459218643, 0.687862950058072, 0.0]
    Train  Label F1 [0.6570632965620649, 0.5286560364464693, 0.7743095277006046, 0]
    Train  Domain Accuracy [0.8882841592666858, 0.7775231547789554, 0.0]

    Val  Label Loss = 3542.8543090820312
    Val  Domain Loss = 913.6805320382118
    Val  Regularization Loss = 647.1631050109863
    Val  Total Loss = 5103.697946131229
    Val  Composite Score 4739.5
    Val  Label Accuracy [0.6319381255686988, 0.6933096506808762, 0.8857001484413657, 0.0]
    Val  Label F1 [0.6604850213980028, 0.6812100058173357, 0.8581016299137104, 0]
    Val  Domain Accuracy [0.8815165876777251, 0.993906567366283, 0.0]

    Test  Label Loss = 110875.80623817444
    Test  Domain Loss = 7078.251870274544
    Test  Regularization Loss = 2750.443196296692
    Test  Total Loss = 120704.50130474567
    Test  Composite Score 5129.75
    Test  Label Accuracy [0.5969521807672097, 0.14777618364418937, 0.7271505376344086, 0.0]
    Test  Label F1 [0.5079365079365079, 0.1956315289648623, 0.7547082073936294, 0]
    Test  Domain Accuracy [0.8436626923228269, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 15689.516513824463
    Train  Domain Loss = 11294.113262176514
    Train  Regularization Loss = 2230.372127532959
    Train  Total Loss = 29214.001903533936
    Train  Composite Score 15609.5
    Train  Label Accuracy [0.7590068159688412, 0.500342348510784, 0.6785714285714286, 0.0]
    Train  Label F1 [0.6617147707979627, 0.532956513811651, 0.7746105402717932, 0]
    Train  Domain Accuracy [0.8127566122410007, 0.7566122410006684, 0.0]

    Val  Label Loss = 3751.68253326416
    Val  Domain Loss = 1682.9428322315216
    Val  Regularization Loss = 641.7533683776855
    Val  Total Loss = 6076.378733873367
    Val  Composite Score 4719.25
    Val  Label Accuracy [0.7010919017288444, 0.5790408525754884, 0.892627412172192, 0.0]
    Val  Label F1 [0.6811049723756907, 0.6340356564019449, 0.8578221588207323, 0]
    Val  Domain Accuracy [0.7901150981719702, 0.9631008801624915, 0.0]

    Test  Label Loss = 126526.8261795044
    Test  Domain Loss = 10685.100969314575
    Test  Regularization Loss = 2727.4518156051636
    Test  Total Loss = 139939.37896442413
    Test  Composite Score 5179.25
    Test  Label Accuracy [0.582238570677877, 0.1291248206599713, 0.7511200716845878, 0.0]
    Test  Label F1 [0.5109522711551763, 0.18090452261306533, 0.7623919963619828, 0]
    Test  Domain Accuracy [0.7162082398772281, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 15641.917222976685
    Train  Domain Loss = 12259.683254241943
    Train  Regularization Loss = 2176.576647758484
    Train  Total Loss = 30078.17712497711
    Train  Composite Score 15661.25
    Train  Label Accuracy [0.7664751192077272, 0.5051879571355673, 0.6771196283391405, 0.0]
    Train  Label F1 [0.6688003413879554, 0.53576260485253, 0.7742363877822045, 0]
    Train  Domain Accuracy [0.7748496132913205, 0.7400935739520672, 0.0]

    Val  Label Loss = 3750.9708251953125
    Val  Domain Loss = 2186.5879895687103
    Val  Regularization Loss = 616.8409538269043
    Val  Total Loss = 6554.399768590927
    Val  Composite Score 4685.5
    Val  Label Accuracy [0.6906278434940856, 0.6394316163410302, 0.8312716476991588, 0.0]
    Val  Label F1 [0.6730215029926845, 0.6571341648919988, 0.8362369337979094, 0]
    Val  Domain Accuracy [0.6834800270819228, 0.9827352742044685, 0.0]

    Test  Label Loss = 131034.55536174774
    Test  Domain Loss = 15599.877117156982
    Test  Regularization Loss = 2621.5740537643433
    Test  Total Loss = 149256.00653266907
    Test  Composite Score 4921.25
    Test  Label Accuracy [0.6479243300052548, 0.23242467718794835, 0.6299283154121864, 0.0]
    Test  Label F1 [0.5067817509247843, 0.22625698324022345, 0.7182630906768838, 0]
    Test  Domain Accuracy [0.5261480344705466, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 15712.2204246521
    Train  Domain Loss = 12606.567287445068
    Train  Regularization Loss = 2095.7250423431396
    Train  Total Loss = 30414.512754440308
    Train  Composite Score 15678.5
    Train  Label Accuracy [0.7723857617933243, 0.5012628388617613, 0.6791521486643438, 0.0]
    Train  Label F1 [0.6691921886671646, 0.5344703770197486, 0.7796666666666668, 0]
    Train  Domain Accuracy [0.7553709538814093, 0.7392342213310418, 0.0]

    Val  Label Loss = 3897.899414539337
    Val  Domain Loss = 2349.971881866455
    Val  Regularization Loss = 589.6486473083496
    Val  Total Loss = 6837.519943714142
    Val  Composite Score 4639.75
    Val  Label Accuracy [0.5636942675159236, 0.7661338069863824, 0.8332508659079664, 0.0]
    Val  Label F1 [0.6254416961130742, 0.6711618257261411, 0.8424212106053026, 0]
    Val  Domain Accuracy [0.6685849695328369, 0.9840893703452945, 0.0]

    Test  Label Loss = 137555.12545681
    Test  Domain Loss = 13291.549156188965
    Test  Regularization Loss = 2506.006751060486
    Test  Total Loss = 153352.68136405945
    Test  Composite Score 4738.25
    Test  Label Accuracy [0.3667892800840778, 0.5107604017216643, 0.65165770609319, 0.0]
    Test  Label F1 [0.3956916099773243, 0.27321565617805066, 0.7277958468851637, 0]
    Test  Domain Accuracy [0.595876126392004, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 15726.49913406372
    Train  Domain Loss = 13092.745590209961
    Train  Regularization Loss = 1991.2457180023193
    Train  Total Loss = 30810.490442276
    Train  Composite Score 15712.25
    Train  Label Accuracy [0.7738637763271339, 0.5079979794578212, 0.6781358885017421, 0.0]
    Train  Label F1 [0.6754461406149215, 0.5387019016159271, 0.7735364742899726, 0]
    Train  Domain Accuracy [0.735605843597823, 0.7125942900792515, 0.0]

    Val  Label Loss = 4215.730356216431
    Val  Domain Loss = 2887.385112762451
    Val  Regularization Loss = 561.4583015441895
    Val  Total Loss = 7664.573770523071
    Val  Composite Score 4585.0
    Val  Label Accuracy [0.6610555050045496, 0.6897572528123149, 0.7550717466600693, 0.0]
    Val  Label F1 [0.6600045423574835, 0.6492059069378657, 0.7981171548117155, 0]
    Val  Domain Accuracy [0.6100203114421124, 0.9373730534867976, 0.0]

    Test  Label Loss = 139016.53791809082
    Test  Domain Loss = 17285.256549835205
    Test  Regularization Loss = 2386.197781562805
    Test  Total Loss = 158687.99224948883
    Test  Composite Score 4623.5
    Test  Label Accuracy [0.5980031529164477, 0.4734576757532281, 0.524641577060932, 0.0]
    Test  Label F1 [0.4716121011189391, 0.29959146618247845, 0.659811241019862, 0]
    Test  Domain Accuracy [0.4505174516979499, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 15721.828563690186
    Train  Domain Loss = 13178.325607299805
    Train  Regularization Loss = 1889.5880222320557
    Train  Total Loss = 30789.742193222046
    Train  Composite Score 15696.0
    Train  Label Accuracy [0.7904599659284497, 0.4886986301369863, 0.6676829268292683, 0.0]
    Train  Label F1 [0.6835736083342103, 0.5233816247936915, 0.7683568624175089, 0]
    Train  Domain Accuracy [0.7348419746013559, 0.6916833763009644, 0.0]

    Val  Label Loss = 3859.6254348754883
    Val  Domain Loss = 2616.449429512024
    Val  Regularization Loss = 524.4978332519531
    Val  Total Loss = 7000.572697639465
    Val  Composite Score 4689.25
    Val  Label Accuracy [0.7233848953594176, 0.5968028419182948, 0.8337456704601682, 0.0]
    Val  Label F1 [0.6889081455805892, 0.6430622009569378, 0.8290282902829028, 0]
    Val  Domain Accuracy [0.6777251184834123, 0.9678402166553826, 0.0]

    Test  Label Loss = 145438.85812568665
    Test  Domain Loss = 13545.487957000732
    Test  Regularization Loss = 2229.115791320801
    Test  Total Loss = 161213.46187400818
    Test  Composite Score 4986.5
    Test  Label Accuracy [0.5943247503941146, 0.29124820659971307, 0.6630824372759857, 0.0]
    Test  Label F1 [0.5, 0.27694406548431105, 0.7274514622757434, 0]
    Test  Domain Accuracy [0.5810805493251485, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 15792.119068145752
    Train  Domain Loss = 13485.248203277588
    Train  Regularization Loss = 1791.344006538391
    Train  Total Loss = 31068.71127796173
    Train  Composite Score 15691.0
    Train  Label Accuracy [0.779384728520652, 0.508560773012375, 0.6652148664343787, 0.0]
    Train  Label F1 [0.6769935058021931, 0.5406379527842855, 0.7634757977172374, 0]
    Train  Domain Accuracy [0.7291129571278526, 0.6910149909290557, 0.0]

    Val  Label Loss = 3870.0886459350586
    Val  Domain Loss = 2599.6300406455994
    Val  Regularization Loss = 500.6022262573242
    Val  Total Loss = 6970.320912837982
    Val  Composite Score 4706.5
    Val  Label Accuracy [0.7888989990900819, 0.5476613380698638, 0.8149430974764967, 0.0]
    Val  Label F1 [0.7025931928687196, 0.6281833616298812, 0.8371029224904701, 0]
    Val  Domain Accuracy [0.6235612728503723, 0.9827352742044685, 0.0]

    Test  Label Loss = 140406.29879951477
    Test  Domain Loss = 15720.115579605103
    Test  Regularization Loss = 2127.559461593628
    Test  Total Loss = 158253.9738407135
    Test  Composite Score 4906.25
    Test  Label Accuracy [0.7230688386757751, 0.10903873744619799, 0.6126792114695341, 0.0]
    Test  Label F1 [0.511429102397324, 0.15261044176706828, 0.7057153915623791, 0]
    Test  Domain Accuracy [0.5172155983158226, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 15802.322254180908
    Train  Domain Loss = 13589.32907485962
    Train  Regularization Loss = 1697.3778295516968
    Train  Total Loss = 31089.029158592224
    Train  Composite Score 15654.5
    Train  Label Accuracy [0.7932598039215686, 0.4915225500169549, 0.6565040650406504, 0.0]
    Train  Label F1 [0.6811891607471717, 0.5302725443570513, 0.7572636690948673, 0]
    Train  Domain Accuracy [0.7208058817912728, 0.6930201470447818, 0.0]

    Val  Label Loss = 3801.5926027297974
    Val  Domain Loss = 2382.6022820472717
    Val  Regularization Loss = 482.06417083740234
    Val  Total Loss = 6666.259055614471
    Val  Composite Score 4699.75
    Val  Label Accuracy [0.762056414922657, 0.5547661338069864, 0.8337456704601682, 0.0]
    Val  Label F1 [0.6964656964656964, 0.6311889525092623, 0.8347783007183552, 0]
    Val  Domain Accuracy [0.7921462423832092, 0.923493568043331, 0.0]

    Test  Label Loss = 144326.5326976776
    Test  Domain Loss = 10078.202560901642
    Test  Regularization Loss = 2048.77272605896
    Test  Total Loss = 156453.5079846382
    Test  Composite Score 4907.75
    Test  Label Accuracy [0.7388334209143458, 0.11477761836441894, 0.605510752688172, 0.0]
    Test  Label F1 [0.5160579922921636, 0.1637666325486182, 0.7018956115294728, 0]
    Test  Domain Accuracy [0.7467831424861291, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 15803.679553985596
    Train  Domain Loss = 13666.280967712402
    Train  Regularization Loss = 1651.2349152565002
    Train  Total Loss = 31121.1954369545
    Train  Composite Score 15731.25
    Train  Label Accuracy [0.7883238257070033, 0.5038666437532222, 0.6633275261324042, 0.0]
    Train  Label F1 [0.685054319164645, 0.5381791483113069, 0.7599168399168399, 0]
    Train  Domain Accuracy [0.7221426525350902, 0.6833763009643846, 0.0]

    Val  Label Loss = 3907.225597381592
    Val  Domain Loss = 2863.016429901123
    Val  Regularization Loss = 468.1077289581299
    Val  Total Loss = 7238.349756240845
    Val  Composite Score 4648.0
    Val  Label Accuracy [0.7129208371246588, 0.6417998815867377, 0.7803067788223652, 0.0]
    Val  Label F1 [0.6844289146101769, 0.6481315396113602, 0.8103802672147995, 0]
    Val  Domain Accuracy [0.6208530805687204, 0.9570074475287745, 0.0]

    Test  Label Loss = 141299.6900291443
    Test  Domain Loss = 16417.60407447815
    Test  Regularization Loss = 1989.457848072052
    Test  Total Loss = 159706.7519516945
    Test  Composite Score 4832.0
    Test  Label Accuracy [0.6736731476615869, 0.3500717360114778, 0.5739247311827957, 0.0]
    Test  Label F1 [0.5026465398941384, 0.3076923076923077, 0.6886171213546566, 0]
    Test  Domain Accuracy [0.4877031440601267, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 15564.479228973389
    Train  Domain Loss = 13606.017826080322
    Train  Regularization Loss = 1618.345769405365
    Train  Total Loss = 30788.842824459076
    Train  Composite Score 15810.0
    Train  Label Accuracy [0.7885015290519878, 0.5073941866394697, 0.6777003484320557, 0.0]
    Train  Label F1 [0.6857446808510639, 0.5425299890948746, 0.7725279271824577, 0]
    Train  Domain Accuracy [0.7243387758999331, 0.67831566886279, 0.0]

    Val  Label Loss = 3767.181637763977
    Val  Domain Loss = 2515.8899807929993
    Val  Regularization Loss = 463.1587886810303
    Val  Total Loss = 6746.230407238007
    Val  Composite Score 4747.0
    Val  Label Accuracy [0.7543221110100091, 0.5985790408525755, 0.8367144977733795, 0.0]
    Val  Label F1 [0.7044826853622265, 0.658203125, 0.8377508050532573, 0]
    Val  Domain Accuracy [0.6943127962085308, 0.9712254570074476, 0.0]

    New Best Val Loss

    Test  Label Loss = 145194.034614563
    Test  Domain Loss = 13279.658304214478
    Test  Regularization Loss = 1968.4248518943787
    Test  Total Loss = 160442.11777067184
    Test  Composite Score 4943.0
    Test  Label Accuracy [0.6789280084077772, 0.1908177905308465, 0.6297043010752689, 0.0]
    Test  Label F1 [0.506766032555403, 0.2327209098862642, 0.7129089525741821, 0]
    Test  Domain Accuracy [0.5761618069491993, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 15651.260681152344
    Train  Domain Loss = 13826.141345977783
    Train  Regularization Loss = 1579.1761121749878
    Train  Total Loss = 31056.578139305115
    Train  Composite Score 15736.75
    Train  Label Accuracy [0.7846647734288184, 0.5111595905353247, 0.6681184668989547, 0.0]
    Train  Label F1 [0.6832598645306958, 0.5424272103997863, 0.7637540453074435, 0]
    Train  Domain Accuracy [0.7230020051561157, 0.6848085553327604, 0.0]

    Val  Label Loss = 4016.2169189453125
    Val  Domain Loss = 3011.15993642807
    Val  Regularization Loss = 447.57808685302734
    Val  Total Loss = 7474.95494222641
    Val  Composite Score 4660.0
    Val  Label Accuracy [0.7611464968152867, 0.576080521018354, 0.7906976744186046, 0.0]
    Val  Label F1 [0.7016145942545607, 0.6285529715762274, 0.8089091369273601, 0]
    Val  Domain Accuracy [0.580568720379147, 0.9380501015572106, 0.0]

    Test  Label Loss = 141583.13441467285
    Test  Domain Loss = 16506.392526626587
    Test  Regularization Loss = 1902.2068691253662
    Test  Total Loss = 159991.7338104248
    Test  Composite Score 4832.0
    Test  Label Accuracy [0.674198633736206, 0.29411764705882354, 0.5824372759856631, 0.0]
    Test  Label F1 [0.4998052201012855, 0.2833448514167243, 0.689015502848814, 0]
    Test  Domain Accuracy [0.47825915869830404, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 15780.454120635986
    Train  Domain Loss = 13972.49665260315
    Train  Regularization Loss = 1510.28480386734
    Train  Total Loss = 31263.235577106476
    Train  Composite Score 15829.5
    Train  Label Accuracy [0.7969170540738928, 0.5073079537729436, 0.6717479674796748, 0.0]
    Train  Label F1 [0.6937167199148029, 0.5409568684305908, 0.7666942833471417, 0]
    Train  Domain Accuracy [0.7100162322161749, 0.6754511601260383, 0.0]

    Val  Label Loss = 3959.801160812378
    Val  Domain Loss = 2735.935745716095
    Val  Regularization Loss = 420.4259777069092
    Val  Total Loss = 7116.162884235382
    Val  Composite Score 4708.75
    Val  Label Accuracy [0.7252047315741583, 0.5938425103611604, 0.847105393369619, 0.0]
    Val  Label F1 [0.6950076302594287, 0.6462628865979382, 0.830060606060606, 0]
    Val  Domain Accuracy [0.6580907244414353, 0.946513202437373, 0.0]

    Test  Label Loss = 141921.38331890106
    Test  Domain Loss = 14669.302983283997
    Test  Regularization Loss = 1786.810405254364
    Test  Total Loss = 158377.49670743942
    Test  Composite Score 4919.75
    Test  Label Accuracy [0.6437204414083026, 0.30703012912482064, 0.6196236559139785, 0.0]
    Test  Label F1 [0.4974619289340102, 0.298050139275766, 0.712244109694863, 0]
    Test  Domain Accuracy [0.5329162239798528, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 15884.419658660889
    Train  Domain Loss = 13823.692241668701
    Train  Regularization Loss = 1431.422161579132
    Train  Total Loss = 31139.534061908722
    Train  Composite Score 15782.5
    Train  Label Accuracy [0.7902019446522064, 0.5094433399602386, 0.6749419279907085, 0.0]
    Train  Label F1 [0.6852232191114473, 0.5445369222596068, 0.7690017368290465, 0]
    Train  Domain Accuracy [0.7197555619211305, 0.6861453260765779, 0.0]

    Val  Label Loss = 3879.4375915527344
    Val  Domain Loss = 2793.8413939476013
    Val  Regularization Loss = 404.1350841522217
    Val  Total Loss = 7077.414069652557
    Val  Composite Score 4735.0
    Val  Label Accuracy [0.7015468607825296, 0.6820603907637656, 0.8164275111331024, 0.0]
    Val  Label F1 [0.6961625282167043, 0.6727007299270074, 0.8331229487503157, 0]
    Val  Domain Accuracy [0.6431956668923493, 0.9614082599864591, 0.0]

    Test  Label Loss = 140977.40240001678
    Test  Domain Loss = 15005.765622138977
    Test  Regularization Loss = 1717.5741076469421
    Test  Total Loss = 157700.7421298027
    Test  Composite Score 4706.75
    Test  Label Accuracy [0.49710982658959535, 0.4763271162123386, 0.5920698924731183, 0.0]
    Test  Label F1 [0.44195281476290593, 0.29225352112676056, 0.6978217821782178, 0]
    Test  Domain Accuracy [0.5177664974619289, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 15487.616973876953
    Train  Domain Loss = 13739.348979949951
    Train  Regularization Loss = 1400.708842754364
    Train  Total Loss = 30627.67479658127
    Train  Composite Score 15835.75
    Train  Label Accuracy [0.794944512946979, 0.5240416946872899, 0.663472706155633, 0.0]
    Train  Label F1 [0.6917753098342186, 0.5534937405664566, 0.7626199415936588, 0]
    Train  Domain Accuracy [0.7162226678124701, 0.6916833763009644, 0.0]

    Val  Label Loss = 4040.6622428894043
    Val  Domain Loss = 2837.116653442383
    Val  Regularization Loss = 404.4887351989746
    Val  Total Loss = 7282.267631530762
    Val  Composite Score 4646.5
    Val  Label Accuracy [0.6483166515013649, 0.7140319715808171, 0.789213260761999, 0.0]
    Val  Label F1 [0.6658878504672897, 0.6731789003628245, 0.8069820389577537, 0]
    Val  Domain Accuracy [0.6249153689911984, 0.9316181448882871, 0.0]

    Test  Label Loss = 140004.2977180481
    Test  Domain Loss = 16839.67158794403
    Test  Regularization Loss = 1719.077124595642
    Test  Total Loss = 158563.04643058777
    Test  Composite Score 4731.5
    Test  Label Accuracy [0.5286389910667367, 0.5251076040172167, 0.578405017921147, 0.0]
    Test  Label F1 [0.456442831215971, 0.3322741715842034, 0.6869761873087668, 0]
    Test  Domain Accuracy [0.487191594853028, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 15657.642715454102
    Train  Domain Loss = 13844.790702819824
    Train  Regularization Loss = 1409.069845199585
    Train  Total Loss = 30911.50326347351
    Train  Composite Score 15931.0
    Train  Label Accuracy [0.7978723404255319, 0.5272108843537415, 0.6733449477351916, 0.0]
    Train  Label F1 [0.6998444790046656, 0.5559042410113871, 0.7678172336727092, 0]
    Train  Domain Accuracy [0.7209013654158312, 0.6795569559820491, 0.0]

    Val  Label Loss = 3887.253331184387
    Val  Domain Loss = 2611.1991472244263
    Val  Regularization Loss = 400.5841541290283
    Val  Total Loss = 6899.036632537842
    Val  Composite Score 4700.5
    Val  Label Accuracy [0.7479526842584168, 0.6163410301953819, 0.7981197427016329, 0.0]
    Val  Label F1 [0.6995744680851064, 0.651643192488263, 0.8227492986483042, 0]
    Val  Domain Accuracy [0.6591062965470549, 0.9475287745429926, 0.0]

    Test  Label Loss = 139757.33704185486
    Test  Domain Loss = 14908.383379936218
    Test  Regularization Loss = 1702.4826550483704
    Test  Total Loss = 156368.20307683945
    Test  Composite Score 4740.5
    Test  Label Accuracy [0.6347871781397793, 0.3486370157819225, 0.5633960573476703, 0.0]
    Test  Label F1 [0.4819469379613006, 0.2896305125148987, 0.6763479897808257, 0]
    Test  Domain Accuracy [0.5515680950694526, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 15617.464538574219
    Train  Domain Loss = 13782.11181640625
    Train  Regularization Loss = 1366.0747747421265
    Train  Total Loss = 30765.651129722595
    Train  Composite Score 15905.25
    Train  Label Accuracy [0.7929466699434751, 0.5241554054054054, 0.6779907084785134, 0.0]
    Train  Label F1 [0.6957787481804949, 0.5524793020564408, 0.7714545304369373, 0]
    Train  Domain Accuracy [0.7214742671631815, 0.688150482192304, 0.0]

    Val  Label Loss = 3919.157199859619
    Val  Domain Loss = 2768.3924083709717
    Val  Regularization Loss = 382.205228805542
    Val  Total Loss = 7069.754837036133
    Val  Composite Score 4699.0
    Val  Label Accuracy [0.7497725204731575, 0.6264061574896388, 0.7867392380009897, 0.0]
    Val  Label F1 [0.6993422448546573, 0.6593954502960423, 0.8166409861325117, 0]
    Val  Domain Accuracy [0.6293161814488829, 0.9546377792823291, 0.0]

    Test  Label Loss = 141697.29936408997
    Test  Domain Loss = 16062.572642326355
    Test  Regularization Loss = 1624.3722224235535
    Test  Total Loss = 159384.24422883987
    Test  Composite Score 4740.5
    Test  Label Accuracy [0.6636889122438255, 0.36872309899569583, 0.5479390681003584, 0.0]
    Test  Label F1 [0.4925897035881435, 0.30522565320665085, 0.6686714051394204, 0]
    Test  Domain Accuracy [0.49462873332546337, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 15388.096588134766
    Train  Domain Loss = 13667.614475250244
    Train  Regularization Loss = 1311.4295797348022
    Train  Total Loss = 30367.140643119812
    Train  Composite Score 16000.25
    Train  Label Accuracy [0.809167790170364, 0.5224614341413799, 0.6779907084785134, 0.0]
    Train  Label F1 [0.7024525190189924, 0.5597529967308391, 0.7734349122225903, 0]
    Train  Domain Accuracy [0.7145039625704191, 0.6831853337152678, 0.0]

    Val  Label Loss = 3912.7261390686035
    Val  Domain Loss = 2616.29754447937
    Val  Regularization Loss = 369.9817371368408
    Val  Total Loss = 6899.005420684814
    Val  Composite Score 4678.75
    Val  Label Accuracy [0.6105550500454959, 0.7282415630550622, 0.8396833250865908, 0.0]
    Val  Label F1 [0.6555935515388372, 0.6780595369349504, 0.8290180752320468, 0]
    Val  Domain Accuracy [0.6435341909275558, 0.9468517264725795, 0.0]

    Test  Label Loss = 140329.7736606598
    Test  Domain Loss = 16205.416632652283
    Test  Regularization Loss = 1572.4223828315735
    Test  Total Loss = 158107.61267614365
    Test  Composite Score 4710.5
    Test  Label Accuracy [0.5186547556489753, 0.4375896700143472, 0.5900537634408602, 0.0]
    Test  Label F1 [0.4509938313913639, 0.2869238005644403, 0.6908852459016394, 0]
    Test  Domain Accuracy [0.5105654586235391, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 15565.482067108154
    Train  Domain Loss = 13805.419174194336
    Train  Regularization Loss = 1280.6236186027527
    Train  Total Loss = 30651.524859905243
    Train  Composite Score 15855.25
    Train  Label Accuracy [0.7890191239975324, 0.5163782966571476, 0.6813298490127758, 0.0]
    Train  Label F1 [0.6906047516198703, 0.5504028648164727, 0.7699122303338528, 0]
    Train  Domain Accuracy [0.7153633151914447, 0.6852859734555524, 0.0]

    Val  Label Loss = 3861.9424057006836
    Val  Domain Loss = 2777.4521627426147
    Val  Regularization Loss = 365.48386573791504
    Val  Total Loss = 7004.878434181213
    Val  Composite Score 4723.75
    Val  Label Accuracy [0.7529572338489536, 0.6305506216696269, 0.7961405244928254, 0.0]
    Val  Label F1 [0.707416114554392, 0.6652092442223609, 0.8177890724269377, 0]
    Val  Domain Accuracy [0.6015572105619499, 0.9529451591062965, 0.0]

    Test  Label Loss = 141289.81215000153
    Test  Domain Loss = 17101.492965698242
    Test  Regularization Loss = 1553.306429386139
    Test  Total Loss = 159944.6115450859
    Test  Composite Score 4775.0
    Test  Label Accuracy [0.6836573830793484, 0.242467718794835, 0.5694444444444444, 0.0]
    Test  Label F1 [0.4988496932515338, 0.24160114367405286, 0.6766937308664981, 0]
    Test  Domain Accuracy [0.4805021052217369, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 15384.97745513916
    Train  Domain Loss = 13845.988855361938
    Train  Regularization Loss = 1266.659031867981
    Train  Total Loss = 30497.62534236908
    Train  Composite Score 16004.25
    Train  Label Accuracy [0.8083394294074616, 0.5213456284153005, 0.6787166085946573, 0.0]
    Train  Label F1 [0.7056945183608302, 0.5543853277646631, 0.7736863880844022, 0]
    Train  Domain Accuracy [0.7183233075527548, 0.6807027594767497, 0.0]

    Val  Label Loss = 3774.0243310928345
    Val  Domain Loss = 2645.172366142273
    Val  Regularization Loss = 361.1218070983887
    Val  Total Loss = 6780.318504333496
    Val  Composite Score 4741.75
    Val  Label Accuracy [0.7565969062784349, 0.6175251628182357, 0.8149430974764967, 0.0]
    Val  Label F1 [0.7091684434968016, 0.6643312101910828, 0.826392373306573, 0]
    Val  Domain Accuracy [0.6787406905890319, 0.9251861882193636, 0.0]

    Test  Label Loss = 141300.479804039
    Test  Domain Loss = 14547.255655288696
    Test  Regularization Loss = 1534.7676801681519
    Test  Total Loss = 157382.50313949585
    Test  Composite Score 4809.5
    Test  Label Accuracy [0.6663163426169206, 0.242467718794835, 0.587141577060932, 0.0]
    Test  Label F1 [0.4950224477845013, 0.24351585014409222, 0.6881974530655114, 0]
    Test  Domain Accuracy [0.5654586235391336, 0.0, 0.0]
Training model 2
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 17571.374053955078
    Train  Domain Loss = 6360.183930397034
    Train  Regularization Loss = 1594.871225297451
    Train  Total Loss = 25526.429209649563
    Train  Composite Score 14830.75
    Train  Label Accuracy [0.685036496350365, 0.4513532031517643, 0.6578106852497096, 0.0]
    Train  Label F1 [0.6050609788857251, 0.4842414775337683, 0.7318688418672266, 0]
    Train  Domain Accuracy [0.9618065501766447, 0.8043540532798625, 0.0]

    Val  Label Loss = 3587.1194734573364
    Val  Domain Loss = 255.45188921689987
    Val  Regularization Loss = 626.3738250732422
    Val  Total Loss = 4468.9451877474785
    Val  Composite Score 4672.75
    Val  Label Accuracy [0.7010919017288444, 0.5820011841326228, 0.859475507174666, 0.0]
    Val  Label F1 [0.6633663366336633, 0.6323576712769379, 0.8554543215956661, 0]
    Val  Domain Accuracy [0.981042654028436, 0.9969532836831415, 0.0]

    Test  Label Loss = 88667.23556804657
    Test  Domain Loss = 2991.3882588744164
    Test  Regularization Loss = 2662.0887565612793
    Test  Total Loss = 94320.71258348227
    Test  Composite Score 4985.0
    Test  Label Accuracy [0.7320021019442985, 0.06025824964131994, 0.6400089605734767, 0.0]
    Test  Label F1 [0.5202614379084968, 0.0880503144654088, 0.7307839877222152, 0]
    Test  Domain Accuracy [0.9547475701412663, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 15921.348197937012
    Train  Domain Loss = 9300.945692062378
    Train  Regularization Loss = 2181.9608964920044
    Train  Total Loss = 27404.254786491394
    Train  Composite Score 15510.25
    Train  Label Accuracy [0.7446362515413071, 0.5065568258238063, 0.6747967479674797, 0.0]
    Train  Label F1 [0.65068419351363, 0.5371724014975932, 0.767820269265714, 0]
    Train  Domain Accuracy [0.882937076291416, 0.7831566886279003, 0.0]

    Val  Label Loss = 3589.15953540802
    Val  Domain Loss = 1367.4351208209991
    Val  Regularization Loss = 643.1972694396973
    Val  Total Loss = 5599.791925668716
    Val  Composite Score 4728.25
    Val  Label Accuracy [0.6797088262056415, 0.6216696269982238, 0.8861949529935675, 0.0]
    Val  Label F1 [0.6716115981119354, 0.6570713391739674, 0.8587868616638695, 0]
    Val  Domain Accuracy [0.7911306702775897, 0.9928909952606635, 0.0]

    Test  Label Loss = 106055.67092704773
    Test  Domain Loss = 11071.25534582138
    Test  Regularization Loss = 2733.5883951187134
    Test  Total Loss = 119860.51466798782
    Test  Composite Score 5148.5
    Test  Label Accuracy [0.6121912769311614, 0.11047345767575323, 0.732078853046595, 0.0]
    Test  Label F1 [0.5119753900241705, 0.1627906976744186, 0.7572703047155602, 0]
    Test  Domain Accuracy [0.7501672372407823, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 15759.010108947754
    Train  Domain Loss = 11217.545749664307
    Train  Regularization Loss = 2222.10834980011
    Train  Total Loss = 29198.66420841217
    Train  Composite Score 15614.5
    Train  Label Accuracy [0.7541507809617514, 0.5049772228783533, 0.6843786295005807, 0.0]
    Train  Label F1 [0.6597450104900747, 0.5330839789829905, 0.781174910928826, 0]
    Train  Domain Accuracy [0.8097011362551323, 0.7573761099971354, 0.0]

    Val  Label Loss = 3619.2044882774353
    Val  Domain Loss = 1657.3895491361618
    Val  Regularization Loss = 629.8465919494629
    Val  Total Loss = 5906.44062936306
    Val  Composite Score 4724.5
    Val  Label Accuracy [0.7479526842584168, 0.5559502664298401, 0.8644235526966848, 0.0]
    Val  Label F1 [0.6909014498844295, 0.63531799729364, 0.8519873201658134, 0]
    Val  Domain Accuracy [0.7589708869329722, 0.9969532836831415, 0.0]

    Test  Label Loss = 124987.18374824524
    Test  Domain Loss = 11862.852945327759
    Test  Regularization Loss = 2676.8480157852173
    Test  Total Loss = 139526.88470935822
    Test  Composite Score 5141.75
    Test  Label Accuracy [0.6910141881240147, 0.047345767575322814, 0.7063172043010753, 0.0]
    Test  Label F1 [0.5323886639676114, 0.08270676691729324, 0.7516090584028605, 0]
    Test  Domain Accuracy [0.6862235863534412, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 15584.895866394043
    Train  Domain Loss = 11812.85705947876
    Train  Regularization Loss = 2166.6952505111694
    Train  Total Loss = 29564.448176383972
    Train  Composite Score 15651.0
    Train  Label Accuracy [0.7684801171017321, 0.4950511945392492, 0.6806039488966318, 0.0]
    Train  Label F1 [0.6685059422750425, 0.5280305788132508, 0.7782850502199719, 0]
    Train  Domain Accuracy [0.779146376396448, 0.7507877399026067, 0.0]

    Val  Label Loss = 3700.4967136383057
    Val  Domain Loss = 2378.417722225189
    Val  Regularization Loss = 621.1351203918457
    Val  Total Loss = 6700.049556255341
    Val  Composite Score 4712.5
    Val  Label Accuracy [0.7315741583257507, 0.605683836589698, 0.8327560613557645, 0.0]
    Val  Label F1 [0.6892413201885984, 0.6446124763705104, 0.846579476861167, 0]
    Val  Domain Accuracy [0.6591062965470549, 0.95937711577522, 0.0]

    Test  Label Loss = 132165.64799690247
    Test  Domain Loss = 16295.831095695496
    Test  Regularization Loss = 2639.8242616653442
    Test  Total Loss = 151101.3033542633
    Test  Composite Score 5072.75
    Test  Label Accuracy [0.6715712033631108, 0.1563845050215208, 0.6769713261648745, 0.0]
    Test  Label F1 [0.5202523916140851, 0.20624408703878902, 0.7408678597695513, 0]
    Test  Domain Accuracy [0.5567229370794475, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 15583.037044525146
    Train  Domain Loss = 12391.571933746338
    Train  Regularization Loss = 2111.9841203689575
    Train  Total Loss = 30086.593098640442
    Train  Composite Score 15641.5
    Train  Label Accuracy [0.771719152064698, 0.5043242326606749, 0.6686991869918699, 0.0]
    Train  Label F1 [0.6688970314906272, 0.5358075849022611, 0.7711367821865058, 0]
    Train  Domain Accuracy [0.7584264298672777, 0.7238613577771412, 0.0]

    Val  Label Loss = 3725.430673122406
    Val  Domain Loss = 1815.52370262146
    Val  Regularization Loss = 594.8482131958008
    Val  Total Loss = 6135.802588939667
    Val  Composite Score 4752.25
    Val  Label Accuracy [0.6842584167424932, 0.6494967436352872, 0.8738248391885205, 0.0]
    Val  Label F1 [0.6819315347993653, 0.667681071211199, 0.8574896819616411, 0]
    Val  Domain Accuracy [0.8073798239675017, 0.974272173324306, 0.0]

    Test  Label Loss = 141765.22498893738
    Test  Domain Loss = 9098.567336559296
    Test  Regularization Loss = 2528.1049060821533
    Test  Total Loss = 153391.89723157883
    Test  Composite Score 5070.5
    Test  Label Accuracy [0.6316342616920652, 0.17647058823529413, 0.6901881720430108, 0.0]
    Test  Label F1 [0.5131270010672359, 0.20900594732370434, 0.7454633438180498, 0]
    Test  Domain Accuracy [0.7306496674930154, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 15576.769407272339
    Train  Domain Loss = 13061.908782958984
    Train  Regularization Loss = 2026.0752000808716
    Train  Total Loss = 30664.753390312195
    Train  Composite Score 15734.0
    Train  Label Accuracy [0.7821988246816847, 0.5088285229202038, 0.6697154471544715, 0.0]
    Train  Label F1 [0.6777701161618841, 0.5425907486195348, 0.7697955778055904, 0]
    Train  Domain Accuracy [0.7336961711066552, 0.7194691110474554, 0.0]

    Val  Label Loss = 3891.072379589081
    Val  Domain Loss = 2308.552116394043
    Val  Regularization Loss = 562.3274230957031
    Val  Total Loss = 6761.951919078827
    Val  Composite Score 4658.5
    Val  Label Accuracy [0.7857142857142857, 0.5405565423327413, 0.7926768926274121, 0.0]
    Val  Label F1 [0.69385295299317, 0.6173089925625423, 0.8257731958762886, 0]
    Val  Domain Accuracy [0.7379823967501693, 0.9322951929587001, 0.0]

    Test  Label Loss = 142093.90445804596
    Test  Domain Loss = 11396.458607673645
    Test  Regularization Loss = 2389.8915481567383
    Test  Total Loss = 155880.25461387634
    Test  Composite Score 4946.0
    Test  Label Accuracy [0.743562795585917, 0.12338593974175036, 0.6135752688172043, 0.0]
    Test  Label F1 [0.5192660550458715, 0.1762295081967213, 0.7112438327707088, 0]
    Test  Domain Accuracy [0.6821705426356589, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 15751.154312133789
    Train  Domain Loss = 13124.832611083984
    Train  Regularization Loss = 1930.2676610946655
    Train  Total Loss = 30806.25458431244
    Train  Composite Score 15667.5
    Train  Label Accuracy [0.7698842649593696, 0.5080862533692723, 0.6740708478513356, 0.0]
    Train  Label F1 [0.6722571628232006, 0.5372283576772354, 0.770686364013611, 0]
    Train  Domain Accuracy [0.7335052038575385, 0.714694929819536, 0.0]

    Val  Label Loss = 3800.4423518180847
    Val  Domain Loss = 2395.5025691986084
    Val  Regularization Loss = 535.682258605957
    Val  Total Loss = 6731.62717962265
    Val  Composite Score 4687.0
    Val  Label Accuracy [0.707916287534122, 0.6175251628182357, 0.8317664522513607, 0.0]
    Val  Label F1 [0.6771105308964316, 0.6590837282780411, 0.8290998766954377, 0]
    Val  Domain Accuracy [0.6949898442789438, 0.960731211916046, 0.0]

    Test  Label Loss = 143092.74711990356
    Test  Domain Loss = 13120.712892532349
    Test  Regularization Loss = 2276.6495990753174
    Test  Total Loss = 158490.10961151123
    Test  Composite Score 5033.75
    Test  Label Accuracy [0.6121912769311614, 0.18507890961262555, 0.6861559139784946, 0.0]
    Test  Label F1 [0.4979696516349647, 0.22872340425531917, 0.7362095901934863, 0]
    Test  Domain Accuracy [0.6173611930901507, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 15695.218402862549
    Train  Domain Loss = 13428.530548095703
    Train  Regularization Loss = 1827.4205131530762
    Train  Total Loss = 30951.169464111328
    Train  Composite Score 15710.75
    Train  Label Accuracy [0.7787114845938375, 0.508636907815974, 0.6679732868757259, 0.0]
    Train  Label F1 [0.6788766788766789, 0.5400399491556201, 0.7648574515834096, 0]
    Train  Domain Accuracy [0.7183233075527548, 0.6991310990165187, 0.0]

    Val  Label Loss = 3876.6934900283813
    Val  Domain Loss = 2718.0591294765472
    Val  Regularization Loss = 518.8872528076172
    Val  Total Loss = 7113.639872312546
    Val  Composite Score 4707.25
    Val  Label Accuracy [0.762056414922657, 0.5820011841326228, 0.8159327065809006, 0.0]
    Val  Label F1 [0.6996658312447787, 0.6456486042692939, 0.8280190810946522, 0]
    Val  Domain Accuracy [0.6689234935680434, 0.955991875423155, 0.0]

    Test  Label Loss = 145601.02655792236
    Test  Domain Loss = 12641.961217880249
    Test  Regularization Loss = 2205.270824432373
    Test  Total Loss = 160448.25860023499
    Test  Composite Score 4943.75
    Test  Label Accuracy [0.6647398843930635, 0.1406025824964132, 0.6438172043010753, 0.0]
    Test  Label F1 [0.5002966185485466, 0.18955512572533847, 0.7151922359089211, 0]
    Test  Domain Accuracy [0.6116948018730571, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 15739.024478912354
    Train  Domain Loss = 13644.584190368652
    Train  Regularization Loss = 1793.5872344970703
    Train  Total Loss = 31177.195903778076
    Train  Composite Score 15731.25
    Train  Label Accuracy [0.7869411621391156, 0.5069242605573603, 0.6633275261324042, 0.0]
    Train  Label F1 [0.6841046277665996, 0.5415525114155252, 0.7581514975524766, 0]
    Train  Domain Accuracy [0.7269168337630096, 0.6897737038097966, 0.0]

    Val  Label Loss = 3929.222758293152
    Val  Domain Loss = 2183.4595379829407
    Val  Regularization Loss = 509.78227615356445
    Val  Total Loss = 6622.464572429657
    Val  Composite Score 4708.0
    Val  Label Accuracy [0.6464968152866242, 0.6560094730609828, 0.880257298367145, 0.0]
    Val  Label F1 [0.6712328767123287, 0.6774686640171201, 0.825330549756437, 0]
    Val  Domain Accuracy [0.7261340555179417, 0.9647935003385241, 0.0]

    Test  Label Loss = 145535.9023590088
    Test  Domain Loss = 12824.363523483276
    Test  Regularization Loss = 2166.574673652649
    Test  Total Loss = 160526.8405561447
    Test  Composite Score 5081.0
    Test  Label Accuracy [0.5202312138728323, 0.25251076040172166, 0.7289426523297491, 0.0]
    Test  Label F1 [0.47860768672951415, 0.25562817719680464, 0.7555142790805666, 0]
    Test  Domain Accuracy [0.638492110337229, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 15678.72480392456
    Train  Domain Loss = 13547.47640991211
    Train  Regularization Loss = 1736.3478517532349
    Train  Total Loss = 30962.549065589905
    Train  Composite Score 15769.0
    Train  Label Accuracy [0.7865846153846154, 0.5150851171414125, 0.6676829268292683, 0.0]
    Train  Label F1 [0.6814159292035399, 0.5493438792018694, 0.7665000000000001, 0]
    Train  Domain Accuracy [0.7189916929246635, 0.696266590279767, 0.0]

    Val  Label Loss = 3805.6840014457703
    Val  Domain Loss = 2447.3901641368866
    Val  Regularization Loss = 487.01648712158203
    Val  Total Loss = 6740.090652704239
    Val  Composite Score 4734.25
    Val  Label Accuracy [0.72975432211101, 0.6044997039668443, 0.8500742206828302, 0.0]
    Val  Label F1 [0.6967854039965248, 0.6612694300518135, 0.8331716779825412, 0]
    Val  Domain Accuracy [0.6668923493568043, 0.9610697359512526, 0.0]

    Test  Label Loss = 145203.18567085266
    Test  Domain Loss = 15042.008448600769
    Test  Regularization Loss = 2069.8200702667236
    Test  Total Loss = 162315.01418972015
    Test  Composite Score 5020.25
    Test  Label Accuracy [0.6342616920651603, 0.19799139167862267, 0.6706989247311828, 0.0]
    Test  Label F1 [0.5073560319461958, 0.22604422604422605, 0.7348140876181126, 0]
    Test  Domain Accuracy [0.5630976271986778, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 15597.350326538086
    Train  Domain Loss = 13630.992603302002
    Train  Regularization Loss = 1685.3685984611511
    Train  Total Loss = 30913.71152830124
    Train  Composite Score 15832.5
    Train  Label Accuracy [0.7943778020113897, 0.5024978466838932, 0.6761033681765389, 0.0]
    Train  Label F1 [0.6912330644736148, 0.5382415351969739, 0.7711541645967877, 0]
    Train  Domain Accuracy [0.7167000859352621, 0.7046691492409052, 0.0]

    Val  Label Loss = 3763.3526611328125
    Val  Domain Loss = 2626.475688934326
    Val  Regularization Loss = 475.336332321167
    Val  Total Loss = 6865.164682388306
    Val  Composite Score 4738.75
    Val  Label Accuracy [0.7165605095541401, 0.6542332741267022, 0.8258287976249381, 0.0]
    Val  Label F1 [0.7014028056112225, 0.6701030927835051, 0.8289048919791409, 0]
    Val  Domain Accuracy [0.6343940419769803, 0.9603926878808395, 0.0]

    New Best Val Loss

    Test  Label Loss = 144413.37315750122
    Test  Domain Loss = 13711.155527114868
    Test  Regularization Loss = 2020.1794123649597
    Test  Total Loss = 160144.70809698105
    Test  Composite Score 4915.25
    Test  Label Accuracy [0.5780346820809249, 0.27546628407460544, 0.6512096774193549, 0.0]
    Test  Label F1 [0.47919843171422344, 0.25668449197860965, 0.7230443974630021, 0]
    Test  Domain Accuracy [0.5625860779915791, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 15792.783178329468
    Train  Domain Loss = 13768.742149353027
    Train  Regularization Loss = 1629.7323589324951
    Train  Total Loss = 31191.25768661499
    Train  Composite Score 15791.5
    Train  Label Accuracy [0.7901506798970966, 0.5077184054283291, 0.6726190476190477, 0.0]
    Train  Label F1 [0.6898764639820311, 0.5393278673754393, 0.7666721826907166, 0]
    Train  Domain Accuracy [0.7109710684617588, 0.685667907953786, 0.0]

    Val  Label Loss = 3877.3402967453003
    Val  Domain Loss = 2716.0487055778503
    Val  Regularization Loss = 461.38051986694336
    Val  Total Loss = 7054.769522190094
    Val  Composite Score 4706.5
    Val  Label Accuracy [0.7402183803457689, 0.6098283007696862, 0.8159327065809006, 0.0]
    Val  Label F1 [0.7034154777345439, 0.6459705236751332, 0.8242939265183703, 0]
    Val  Domain Accuracy [0.6641841570751523, 0.950575490859851, 0.0]

    Test  Label Loss = 143787.89978694916
    Test  Domain Loss = 14194.90036869049
    Test  Regularization Loss = 1960.8672094345093
    Test  Total Loss = 159943.66736507416
    Test  Composite Score 4858.25
    Test  Label Accuracy [0.5528113504992118, 0.4146341463414634, 0.6232078853046595, 0.0]
    Test  Label F1 [0.4739806262671773, 0.30695698353690914, 0.7127850371509097, 0]
    Test  Domain Accuracy [0.5678983197576044, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 15496.404983520508
    Train  Domain Loss = 13824.342126846313
    Train  Regularization Loss = 1574.9709610939026
    Train  Total Loss = 30895.718071460724
    Train  Composite Score 15951.0
    Train  Label Accuracy [0.7988997555012225, 0.5270500170125894, 0.6756678281068524, 0.0]
    Train  Label F1 [0.7004662629294174, 0.5568937623584397, 0.7690019828155982, 0]
    Train  Domain Accuracy [0.721092332664948, 0.6684808555332761, 0.0]

    Val  Label Loss = 3807.1011085510254
    Val  Domain Loss = 2699.207734823227
    Val  Regularization Loss = 442.36026763916016
    Val  Total Loss = 6948.6691110134125
    Val  Composite Score 4743.25
    Val  Label Accuracy [0.672884440400364, 0.6992303137951451, 0.838693715982187, 0.0]
    Val  Label F1 [0.6859925788497218, 0.6882284382284382, 0.8325147347740667, 0]
    Val  Domain Accuracy [0.6310088016249153, 0.9549763033175356, 0.0]

    Test  Label Loss = 145735.9380121231
    Test  Domain Loss = 14330.06629562378
    Test  Regularization Loss = 1880.0311374664307
    Test  Total Loss = 161946.03544521332
    Test  Composite Score 4936.25
    Test  Label Accuracy [0.5086705202312138, 0.36441893830703015, 0.673163082437276, 0.0]
    Test  Label F1 [0.45768321513002364, 0.29812206572769956, 0.733463509885282, 0]
    Test  Domain Accuracy [0.5564474875063944, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 15641.664546966553
    Train  Domain Loss = 14058.270599365234
    Train  Regularization Loss = 1513.7488741874695
    Train  Total Loss = 31213.684020519257
    Train  Composite Score 15851.5
    Train  Label Accuracy [0.7935483870967742, 0.5124080095841177, 0.6739256678281068, 0.0]
    Train  Label F1 [0.6936951316839586, 0.5452062278066102, 0.7667024527211164, 0]
    Train  Domain Accuracy [0.7051465673636971, 0.6761195454979471, 0.0]

    Val  Label Loss = 3858.367076396942
    Val  Domain Loss = 2866.33678650856
    Val  Regularization Loss = 425.70247650146484
    Val  Total Loss = 7150.406339406967
    Val  Composite Score 4723.75
    Val  Label Accuracy [0.7579617834394905, 0.6222616933096506, 0.797624938149431, 0.0]
    Val  Label F1 [0.706980691703798, 0.6660329531051965, 0.8168229034709906, 0]
    Val  Domain Accuracy [0.6066350710900474, 0.9485443466486121, 0.0]

    Test  Label Loss = 142647.90096378326
    Test  Domain Loss = 14969.112339019775
    Test  Regularization Loss = 1809.2355251312256
    Test  Total Loss = 159426.24882793427
    Test  Composite Score 4935.5
    Test  Label Accuracy [0.6831318970047294, 0.1994261119081779, 0.6243279569892473, 0.0]
    Test  Label F1 [0.5105046141763205, 0.22491909385113268, 0.7147070137197076, 0]
    Test  Domain Accuracy [0.527367882579782, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 15489.389110565186
    Train  Domain Loss = 13991.411289215088
    Train  Regularization Loss = 1462.6707644462585
    Train  Total Loss = 30943.471164226532
    Train  Composite Score 15889.25
    Train  Label Accuracy [0.8034929164631167, 0.5173764906303236, 0.6662311265969802, 0.0]
    Train  Label F1 [0.7011990407673862, 0.5486405925390659, 0.7615333554596747, 0]
    Train  Domain Accuracy [0.7156497660651199, 0.67535567650148, 0.0]

    Val  Label Loss = 3769.239909172058
    Val  Domain Loss = 2794.8632855415344
    Val  Regularization Loss = 418.79384994506836
    Val  Total Loss = 6982.897044658661
    Val  Composite Score 4761.25
    Val  Label Accuracy [0.7561419472247498, 0.62048549437537, 0.8258287976249381, 0.0]
    Val  Label F1 [0.710863986313088, 0.6709346991037131, 0.8311752988047809, 0]
    Val  Domain Accuracy [0.6560595802301964, 0.9461746784021665, 0.0]

    Test  Label Loss = 144255.31553173065
    Test  Domain Loss = 12486.222279548645
    Test  Regularization Loss = 1779.8738622665405
    Test  Total Loss = 158521.41167354584
    Test  Composite Score 5003.0
    Test  Label Accuracy [0.6221755123489228, 0.21233859397417504, 0.6684587813620072, 0.0]
    Test  Label F1 [0.5018012290739563, 0.2305295950155763, 0.7345230769230768, 0]
    Test  Domain Accuracy [0.6102782040687837, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 15490.400114059448
    Train  Domain Loss = 13687.348201751709
    Train  Regularization Loss = 1451.0159454345703
    Train  Total Loss = 30628.764261245728
    Train  Composite Score 15939.0
    Train  Label Accuracy [0.794327111984283, 0.5344944200202908, 0.6739256678281068, 0.0]
    Train  Label F1 [0.6974287100425853, 0.5631569570639586, 0.7667024527211164, 0]
    Train  Domain Accuracy [0.7212832999140647, 0.6801298577293994, 0.0]

    Val  Label Loss = 3729.831635951996
    Val  Domain Loss = 2555.823415994644
    Val  Regularization Loss = 407.68675804138184
    Val  Total Loss = 6693.341809988022
    Val  Composite Score 4720.75
    Val  Label Accuracy [0.7606915377616015, 0.576080521018354, 0.8312716476991588, 0.0]
    Val  Label F1 [0.7019311502938707, 0.6482345103264491, 0.8296296296296297, 0]
    Val  Domain Accuracy [0.6591062965470549, 0.9475287745429926, 0.0]

    New Best Val Loss

    Test  Label Loss = 142546.1018257141
    Test  Domain Loss = 13469.102069854736
    Test  Regularization Loss = 1732.6687216758728
    Test  Total Loss = 157747.87261724472
    Test  Composite Score 5014.25
    Test  Label Accuracy [0.6410930110352075, 0.17216642754662842, 0.6700268817204301, 0.0]
    Test  Label F1 [0.5019543303846945, 0.21486123545210384, 0.7339877300613498, 0]
    Test  Domain Accuracy [0.6024475662062724, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 15345.964950561523
    Train  Domain Loss = 14010.448051452637
    Train  Regularization Loss = 1408.3949041366577
    Train  Total Loss = 30764.807906150818
    Train  Composite Score 15872.5
    Train  Label Accuracy [0.8016367411750336, 0.5099642309657639, 0.671602787456446, 0.0]
    Train  Label F1 [0.6968570821830539, 0.5442646791492456, 0.767864553074944, 0]
    Train  Domain Accuracy [0.7185142748018715, 0.6602692638212546, 0.0]

    Val  Label Loss = 3915.9827642440796
    Val  Domain Loss = 2859.0344111919403
    Val  Regularization Loss = 400.33238410949707
    Val  Total Loss = 7175.349559545517
    Val  Composite Score 4677.25
    Val  Label Accuracy [0.7356687898089171, 0.6459443457667259, 0.7714002968827314, 0.0]
    Val  Label F1 [0.6942893945899528, 0.6662595419847328, 0.8029873808910637, 0]
    Val  Domain Accuracy [0.5876777251184834, 0.9461746784021665, 0.0]

    Test  Label Loss = 139494.0204181671
    Test  Domain Loss = 16877.069291114807
    Test  Regularization Loss = 1701.4126324653625
    Test  Total Loss = 158072.50234174728
    Test  Composite Score 4787.0
    Test  Label Accuracy [0.630057803468208, 0.3170731707317073, 0.5842293906810035, 0.0]
    Test  Label F1 [0.4854251012145749, 0.2675544794188862, 0.6921443736730362, 0]
    Test  Domain Accuracy [0.48435839924448115, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 15556.909133911133
    Train  Domain Loss = 14054.202659606934
    Train  Regularization Loss = 1371.5460906028748
    Train  Total Loss = 30982.65788412094
    Train  Composite Score 15971.25
    Train  Label Accuracy [0.7966539549760118, 0.5397200202395007, 0.6737804878048781, 0.0]
    Train  Label F1 [0.7005246362702147, 0.5666725695059323, 0.7672976771100274, 0]
    Train  Domain Accuracy [0.7037143129953213, 0.6892008020624463, 0.0]

    Val  Label Loss = 3888.498543739319
    Val  Domain Loss = 2865.6583654880524
    Val  Regularization Loss = 385.5546283721924
    Val  Total Loss = 7139.711537599564
    Val  Composite Score 4708.0
    Val  Label Accuracy [0.7656960873521383, 0.5778567199526347, 0.8159327065809006, 0.0]
    Val  Label F1 [0.7098270771826235, 0.6393711103832296, 0.8201939815966177, 0]
    Val  Domain Accuracy [0.5971563981042654, 0.9624238320920785, 0.0]

    Test  Label Loss = 141744.5240650177
    Test  Domain Loss = 15937.410806655884
    Test  Regularization Loss = 1638.6071705818176
    Test  Total Loss = 159320.5420422554
    Test  Composite Score 4925.0
    Test  Label Accuracy [0.6395165528113504, 0.2812051649928264, 0.6270161290322581, 0.0]
    Test  Label F1 [0.49928205128205133, 0.26739427012278305, 0.7188904584564016, 0]
    Test  Domain Accuracy [0.4870735450360052, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 15256.986045837402
    Train  Domain Loss = 14012.764995574951
    Train  Regularization Loss = 1332.1449031829834
    Train  Total Loss = 30601.895944595337
    Train  Composite Score 16075.0
    Train  Label Accuracy [0.8088578088578089, 0.5390214999153546, 0.6788617886178862, 0.0]
    Train  Label F1 [0.710644031258421, 0.5672040616371248, 0.772573316811235, 0]
    Train  Domain Accuracy [0.7144084789458608, 0.6737324548839874, 0.0]

    Val  Label Loss = 3792.557159423828
    Val  Domain Loss = 2651.109964132309
    Val  Regularization Loss = 377.69585609436035
    Val  Total Loss = 6821.362979650497
    Val  Composite Score 4711.0
    Val  Label Accuracy [0.7775250227479527, 0.5600947306098283, 0.8198911429985156, 0.0]
    Val  Label F1 [0.7111943404078235, 0.6389733198243837, 0.8184736972091874, 0]
    Val  Domain Accuracy [0.6635071090047393, 0.9350033852403521, 0.0]

    Test  Label Loss = 141415.84111976624
    Test  Domain Loss = 13897.622061729431
    Test  Regularization Loss = 1605.2073884010315
    Test  Total Loss = 156918.6705698967
    Test  Composite Score 4967.75
    Test  Label Accuracy [0.6868102995270625, 0.16929698708751795, 0.6370967741935484, 0.0]
    Test  Label F1 [0.5091546552395793, 0.2088495575221239, 0.723296032553408, 0]
    Test  Domain Accuracy [0.5800574509109511, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 15251.593097686768
    Train  Domain Loss = 13915.899868011475
    Train  Regularization Loss = 1309.480237007141
    Train  Total Loss = 30476.973202705383
    Train  Composite Score 16007.25
    Train  Label Accuracy [0.8134823182711198, 0.5221508285424417, 0.6752322880371661, 0.0]
    Train  Label F1 [0.7047122646526965, 0.560639070442992, 0.770990468296726, 0]
    Train  Domain Accuracy [0.7108755848372004, 0.6773608326172061, 0.0]

    Val  Label Loss = 3841.719738006592
    Val  Domain Loss = 2832.5565605163574
    Val  Regularization Loss = 371.3885021209717
    Val  Total Loss = 7045.664800643921
    Val  Composite Score 4733.5
    Val  Label Accuracy [0.7611464968152867, 0.6305506216696269, 0.793666501731816, 0.0]
    Val  Label F1 [0.7161815068493151, 0.6610800744878957, 0.8179500254971953, 0]
    Val  Domain Accuracy [0.5846310088016249, 0.9603926878808395, 0.0]

    Test  Label Loss = 138003.5770263672
    Test  Domain Loss = 16998.86379623413
    Test  Regularization Loss = 1578.4011340141296
    Test  Total Loss = 156580.84195661545
    Test  Composite Score 4884.5
    Test  Label Accuracy [0.6647398843930635, 0.30703012912482064, 0.6001344086021505, 0.0]
    Test  Label F1 [0.5018845467169212, 0.28763440860215056, 0.7050927753651796, 0]
    Test  Domain Accuracy [0.45716759139023333, 0.0, 0.0]
