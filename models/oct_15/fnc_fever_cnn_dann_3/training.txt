Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading CNN vectors...
SIZE_TRAIN = 94441
SIZE_VAL = 5908
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 27314.238414764404
    Train  Domain Loss = 11926.48567199707
    Train  Regularization Loss = 2499.4817566871643
    Train  Total Loss = 41740.20584344864
    Train  Composite Score 15023.0
    Train  Label Accuracy [0.7875502383400318, 0.14676987198571004, 0.603513356562137, 0.0]
    Train  Label F1 [0.7074430124679905, 0.17198674341531486, 0.6783616187989556, 0]
    Train  Domain Accuracy [0.888570610140361, 0.0, 0.665520863171966]

    Val  Label Loss = 3861.965063095093
    Val  Domain Loss = 664.080910384655
    Val  Regularization Loss = 723.2870864868164
    Val  Total Loss = 5249.333059966564
    Val  Composite Score 4810.75
    Val  Label Accuracy [0.8576305906452715, 0.1127348643006263, 0.9030183077684315, 0.0]
    Val  Label F1 [0.7883257492546681, 0.19030837004405285, 0.8472609099350046, 0]
    Val  Domain Accuracy [0.9786729857819905, 0.0, 0.947190250507786]

    Test  Label Loss = 197784.8590965271
    Test  Domain Loss = 3019.819935798645
    Test  Regularization Loss = 3073.9701175689697
    Test  Total Loss = 203878.6491498947
    Test  Composite Score 5264.0
    Test  Label Accuracy [0.6353126642143984, 0.028694404591104734, 0.769489247311828, 0.0]
    Test  Label F1 [0.5369753497668222, 0.049566294919454766, 0.7790882286232705, 0]
    Test  Domain Accuracy [0.9533703222760005, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 18803.047161102295
    Train  Domain Loss = 33812.729972839355
    Train  Regularization Loss = 2566.2218589782715
    Train  Total Loss = 55181.99899291992
    Train  Composite Score 15360.0
    Train  Label Accuracy [0.8169768753525098, 0.16345029239766082, 0.6189024390243902, 0.0]
    Train  Label F1 [0.7262471797442969, 0.1946717743339718, 0.7005751848808546, 0]
    Train  Domain Accuracy [0.7374200324644323, 0.0, 0.5626849995225819]

    Val  Label Loss = 4657.840310096741
    Val  Domain Loss = 2203.7501348257065
    Val  Regularization Loss = 737.8108978271484
    Val  Total Loss = 7599.401342749596
    Val  Composite Score 4427.5
    Val  Label Accuracy [0.5435302150904746, 0.48434237995824636, 0.9292429490351312, 0.0]
    Val  Label F1 [0.645579886455799, 0.4050632911392405, 0.8177661659046376, 0]
    Val  Domain Accuracy [0.6858496953283684, 0.0, 0.9901828029790115]

    Test  Label Loss = 598791.5798339844
    Test  Domain Loss = 14995.166462898254
    Test  Regularization Loss = 3135.696315765381
    Test  Total Loss = 616922.442612648
    Test  Composite Score 5003.0
    Test  Label Accuracy [0.18917498686284814, 0.1994261119081779, 0.8550627240143369, 0.0]
    Test  Label F1 [0.26627218934911245, 0.17256362507759157, 0.7779476205034139, 0]
    Test  Domain Accuracy [0.5559359382992957, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 21752.439907073975
    Train  Domain Loss = 35676.82679748535
    Train  Regularization Loss = 2615.7929191589355
    Train  Total Loss = 60045.05962371826
    Train  Composite Score 14827.5
    Train  Label Accuracy [0.7629657722575139, 0.19139846197664484, 0.5965447154471545, 0.0]
    Train  Label F1 [0.6958965711073636, 0.2071835979651611, 0.6759335417009377, 0]
    Train  Domain Accuracy [0.6523441229829084, 0.0, 0.48429294376014514]

    Val  Label Loss = 4759.691019535065
    Val  Domain Loss = 3476.977258682251
    Val  Regularization Loss = 745.784912109375
    Val  Total Loss = 8982.45319032669
    Val  Composite Score 4084.75
    Val  Label Accuracy [0.5158757255035848, 0.662839248434238, 0.6585848589807026, 0.0]
    Val  Label F1 [0.618501841997544, 0.37112799532437174, 0.7588369441277081, 0]
    Val  Domain Accuracy [0.8469871360866622, 0.0, 0.5856465809072444]

    Test  Label Loss = 915117.1350631714
    Test  Domain Loss = 13394.093168258667
    Test  Regularization Loss = 3169.5858764648438
    Test  Total Loss = 931680.8141078949
    Test  Composite Score 3811.25
    Test  Label Accuracy [0.2138728323699422, 0.7503586800573888, 0.4025537634408602, 0.0]
    Test  Label F1 [0.27555856465809075, 0.21905759162303665, 0.5616502578527894, 0]
    Test  Domain Accuracy [0.7781056939361743, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 20638.94382095337
    Train  Domain Loss = 25962.57668685913
    Train  Regularization Loss = 2500.8925771713257
    Train  Total Loss = 49102.413084983826
    Train  Composite Score 15143.75
    Train  Label Accuracy [0.7724144432921656, 0.21356128658359896, 0.6258710801393729, 0.0]
    Train  Label F1 [0.7108276939094221, 0.23143350604490504, 0.6966146885351863, 0]
    Train  Domain Accuracy [0.7289219898787358, 0.0, 0.5295521818008212]

    Val  Label Loss = 4106.789966583252
    Val  Domain Loss = 2551.1967465877533
    Val  Regularization Loss = 718.4752464294434
    Val  Total Loss = 7376.461959600449
    Val  Composite Score 4644.25
    Val  Label Accuracy [0.9515192898600204, 0.05219206680584551, 0.685799109351806, 0.0]
    Val  Label F1 [0.7719152471956793, 0.09871668311944717, 0.7738693467336684, 0]
    Val  Domain Accuracy [0.6475964793500338, 0.0, 0.9908598510494245]

    Test  Label Loss = 209344.50699996948
    Test  Domain Loss = 17986.909046173096
    Test  Regularization Loss = 3053.5197973251343
    Test  Total Loss = 230384.9358434677
    Test  Composite Score 4594.25
    Test  Label Accuracy [0.9153967419863374, 0.00430416068866571, 0.4538530465949821, 0.0]
    Test  Label F1 [0.5176820208023775, 0.008498583569405098, 0.6054991034070533, 0]
    Test  Domain Accuracy [0.4921496871679849, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 19308.61855697632
    Train  Domain Loss = 23252.702949523926
    Train  Regularization Loss = 2482.3457040786743
    Train  Total Loss = 45043.66721057892
    Train  Composite Score 15407.0
    Train  Label Accuracy [0.800376647834275, 0.23182082606166377, 0.6234030197444832, 0.0]
    Train  Label F1 [0.727086095547667, 0.2493352103863601, 0.7140600315955766, 0]
    Train  Domain Accuracy [0.6698176262770935, 0.0, 0.49794710207199466]

    Val  Label Loss = 8014.489692687988
    Val  Domain Loss = 4215.21857970953
    Val  Regularization Loss = 712.1955871582031
    Val  Total Loss = 12941.903859555721
    Val  Composite Score 4102.0
    Val  Label Accuracy [0.9822465005121201, 0.14822546972860126, 0.2380009896091044, 0.0]
    Val  Label F1 [0.7203304957436155, 0.2146636432350718, 0.3840319361277445, 0]
    Val  Domain Accuracy [0.2874069058903182, 0.0, 1.0]

    Test  Label Loss = 547652.8749351501
    Test  Domain Loss = 41549.33574676514
    Test  Regularization Loss = 3026.8312454223633
    Test  Total Loss = 592229.0419273376
    Test  Composite Score 3601.25
    Test  Label Accuracy [0.9753021544929059, 0.03873744619799139, 0.12634408602150538, 0.0]
    Test  Label F1 [0.45240706886045096, 0.0608108108108108, 0.22403177755710027, 0]
    Test  Domain Accuracy [0.12316530909377091, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 21755.72039413452
    Train  Domain Loss = 23674.246757507324
    Train  Regularization Loss = 2590.260540008545
    Train  Total Loss = 48020.22769165039
    Train  Composite Score 15183.25
    Train  Label Accuracy [0.7723806834227619, 0.2395924308588064, 0.6199186991869918, 0.0]
    Train  Label F1 [0.713075218354843, 0.24954517889630082, 0.7013797634691195, 0]
    Train  Domain Accuracy [0.6785066361119068, 0.0, 0.5252554186956937]

    Val  Label Loss = 4694.407264709473
    Val  Domain Loss = 2295.9222197532654
    Val  Regularization Loss = 712.8875541687012
    Val  Total Loss = 7703.217038631439
    Val  Composite Score 4784.5
    Val  Label Accuracy [0.8350973028337316, 0.06471816283924843, 0.9411182582879762, 0.0]
    Val  Label F1 [0.7872545864177665, 0.12109375, 0.8309305373525556, 0]
    Val  Domain Accuracy [0.7122545700744752, 0.0, 0.9962762356127285]

    Test  Label Loss = 369889.4781322479
    Test  Domain Loss = 14416.476417541504
    Test  Regularization Loss = 3029.77210521698
    Test  Total Loss = 387335.7266550064
    Test  Composite Score 5228.0
    Test  Label Accuracy [0.4550709406200736, 0.0014347202295552368, 0.8398297491039427, 0.0]
    Test  Label F1 [0.45966029723991514, 0.002844950213371266, 0.776431604017811, 0]
    Test  Domain Accuracy [0.5803722504230119, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 18448.21985244751
    Train  Domain Loss = 17679.669059753418
    Train  Regularization Loss = 2291.0032625198364
    Train  Total Loss = 38418.892174720764
    Train  Composite Score 15580.5
    Train  Label Accuracy [0.8167549167927383, 0.23233773693279725, 0.6335656213704994, 0.0]
    Train  Label F1 [0.7367478357286026, 0.2577664489405767, 0.7207861920885292, 0]
    Train  Domain Accuracy [0.6989401317674019, 0.0, 0.5705146567363697]

    Val  Label Loss = 5407.3454303741455
    Val  Domain Loss = 2880.133726119995
    Val  Regularization Loss = 646.1611747741699
    Val  Total Loss = 8933.64033126831
    Val  Composite Score 4057.0
    Val  Label Accuracy [0.37214066234209625, 0.48329853862212946, 0.9336961900049481, 0.0]
    Val  Label F1 [0.5112570356472795, 0.4203359055832955, 0.7055524397083568, 0]
    Val  Domain Accuracy [0.7762356127285037, 0.0, 0.7345971563981043]

    Test  Label Loss = 161476.98810958862
    Test  Domain Loss = 11761.288145065308
    Test  Regularization Loss = 2746.184992790222
    Test  Total Loss = 175984.46124744415
    Test  Composite Score 5086.25
    Test  Label Accuracy [0.24802942722017868, 0.19655667144906744, 0.8552867383512545, 0.0]
    Test  Label F1 [0.32869080779944293, 0.18922651933701656, 0.7785481239804241, 0]
    Test  Domain Accuracy [0.7156179907921143, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 18686.70502090454
    Train  Domain Loss = 15885.885540008545
    Train  Regularization Loss = 2185.093587875366
    Train  Total Loss = 36757.68414878845
    Train  Composite Score 15603.0
    Train  Label Accuracy [0.8094609875612514, 0.24869413813116656, 0.6374854819976771, 0.0]
    Train  Label F1 [0.7357601713062099, 0.27206349206349206, 0.7201902575036903, 0]
    Train  Domain Accuracy [0.6952162704096247, 0.0, 0.5687959514943187]

    Val  Label Loss = 12001.078004837036
    Val  Domain Loss = 5521.960397481918
    Val  Regularization Loss = 611.5918350219727
    Val  Total Loss = 18134.630237340927
    Val  Composite Score 3178.0
    Val  Label Accuracy [0.07681802663024923, 0.024008350730688934, 0.9995051954477981, 0.0]
    Val  Label F1 [0.14009962640099627, 0.0467005076142132, 0.530253314083213, 0]
    Val  Domain Accuracy [0.984427894380501, 0.0, 0.14759647935003387]

    Test  Label Loss = 225128.6035079956
    Test  Domain Loss = 1482.055591225624
    Test  Regularization Loss = 2599.265298843384
    Test  Total Loss = 229209.9243980646
    Test  Composite Score 5114.0
    Test  Label Accuracy [0.009458749343142408, 0.0, 0.9959677419354839, 0.0]
    Test  Label F1 [0.018480492813141684, 0, 0.7744295418916565, 0]
    Test  Domain Accuracy [0.9910282139062685, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 22658.123363494873
    Train  Domain Loss = 22442.147899627686
    Train  Regularization Loss = 2205.1295957565308
    Train  Total Loss = 47305.40085887909
    Train  Composite Score 14982.25
    Train  Label Accuracy [0.753739064998589, 0.23139772395681354, 0.6142566782810686, 0.0]
    Train  Label F1 [0.7047493403693931, 0.2602987034301658, 0.6543964117237646, 0]
    Train  Domain Accuracy [0.6651389286737325, 0.0, 0.5243005824501098]

    Val  Label Loss = 3704.5553426742554
    Val  Domain Loss = 3236.696440219879
    Val  Regularization Loss = 641.1229705810547
    Val  Total Loss = 7582.374753475189
    Val  Composite Score 4774.75
    Val  Label Accuracy [0.9566404916353705, 0.10751565762004175, 0.7382483918852053, 0.0]
    Val  Label F1 [0.7924208144796381, 0.18968692449355434, 0.8157463094587206, 0]
    Val  Domain Accuracy [0.8615436696005416, 0.0, 0.44448205822613407]

    Test  Label Loss = 298797.2698059082
    Test  Domain Loss = 11734.403753757477
    Test  Regularization Loss = 2724.7726249694824
    Test  Total Loss = 313256.44618463516
    Test  Composite Score 4728.5
    Test  Label Accuracy [0.8817656332107199, 0.010043041606886656, 0.5073924731182796, 0.0]
    Test  Label F1 [0.524293079206374, 0.019151846785225714, 0.6475128644939966, 0]
    Test  Domain Accuracy [0.7851493330185338, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 17155.24160003662
    Train  Domain Loss = 16948.596298217773
    Train  Regularization Loss = 2186.623544692993
    Train  Total Loss = 36290.46144294739
    Train  Composite Score 15958.25
    Train  Label Accuracy [0.8517717830623179, 0.2559227844398947, 0.6344367015098722, 0.0]
    Train  Label F1 [0.7623454193656938, 0.2797761790567546, 0.7388621185222758, 0]
    Train  Domain Accuracy [0.6312422419555046, 0.0, 0.5532321206913015]

    Val  Label Loss = 3495.2140417099
    Val  Domain Loss = 3115.9858827590942
    Val  Regularization Loss = 602.7274703979492
    Val  Total Loss = 7213.927394866943
    Val  Composite Score 4829.5
    Val  Label Accuracy [0.9296688289518606, 0.1732776617954071, 0.7822859970311727, 0.0]
    Val  Label F1 [0.801000147080453, 0.27689741451209343, 0.8281822943949712, 0]
    Val  Domain Accuracy [0.6973595125253893, 0.0, 0.9732566012186865]

    Test  Label Loss = 521950.0114593506
    Test  Domain Loss = 16033.743401527405
    Test  Regularization Loss = 2561.591749191284
    Test  Total Loss = 540545.3466100693
    Test  Composite Score 4821.5
    Test  Label Accuracy [0.8507619548081976, 0.028694404591104734, 0.5454749103942652, 0.0]
    Test  Label F1 [0.5287393860222077, 0.0510204081632653, 0.6745152354570637, 0]
    Test  Domain Accuracy [0.5562507378113564, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 16679.41439819336
    Train  Domain Loss = 15512.776062011719
    Train  Regularization Loss = 2034.7767190933228
    Train  Total Loss = 34226.9671792984
    Train  Composite Score 16056.25
    Train  Label Accuracy [0.8511335956529885, 0.25620567375886527, 0.6506968641114983, 0.0]
    Train  Label F1 [0.7626122723075631, 0.28388998035363455, 0.7510682865521575, 0]
    Train  Domain Accuracy [0.6604602310703714, 0.0, 0.5816862408097011]

    Val  Label Loss = 3759.98956823349
    Val  Domain Loss = 2952.215301513672
    Val  Regularization Loss = 573.9803123474121
    Val  Total Loss = 7286.185182094574
    Val  Composite Score 4824.25
    Val  Label Accuracy [0.9289860020484807, 0.0824634655532359, 0.8228599703117269, 0.0]
    Val  Label F1 [0.7968955923268415, 0.1511961722488038, 0.843734145104008, 0]
    Val  Domain Accuracy [0.7796208530805687, 0.0, 0.8784698713608666]

    New Best Val Loss

    Test  Label Loss = 659392.5550727844
    Test  Domain Loss = 14206.653678894043
    Test  Regularization Loss = 2439.4163274765015
    Test  Total Loss = 676038.625079155
    Test  Composite Score 4847.75
    Test  Label Accuracy [0.8265895953757225, 0.0014347202295552368, 0.5678763440860215, 0.0]
    Test  Label F1 [0.5238095238095238, 0.002844950213371266, 0.6833805095026284, 0]
    Test  Domain Accuracy [0.6766615511745957, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 17146.24426651001
    Train  Domain Loss = 16164.224075317383
    Train  Regularization Loss = 1977.0652227401733
    Train  Total Loss = 35287.533564567566
    Train  Composite Score 15962.75
    Train  Label Accuracy [0.8458345126898764, 0.2575888985255854, 0.647938443670151, 0.0]
    Train  Label F1 [0.7586206896551724, 0.29318854886475815, 0.7360435392100272, 0]
    Train  Domain Accuracy [0.7057194691110474, 0.0, 0.5282154110570038]

    Val  Label Loss = 4048.7127361297607
    Val  Domain Loss = 2614.4377040863037
    Val  Regularization Loss = 556.6063499450684
    Val  Total Loss = 7219.756790161133
    Val  Composite Score 4809.25
    Val  Label Accuracy [0.9344486172755206, 0.07828810020876827, 0.8070262246412667, 0.0]
    Val  Label F1 [0.7957551969763047, 0.1440922190201729, 0.8372689938398357, 0]
    Val  Domain Accuracy [0.6205145565335138, 0.0, 0.9962762356127285]

    Test  Label Loss = 535483.4557495117
    Test  Domain Loss = 23213.46966934204
    Test  Regularization Loss = 2365.5769872665405
    Test  Total Loss = 561062.5024061203
    Test  Composite Score 4919.75
    Test  Label Accuracy [0.8328954282711508, 0.0014347202295552368, 0.5866935483870968, 0.0]
    Test  Label F1 [0.5355634397702315, 0.0028530670470756064, 0.6976558337773041, 0]
    Test  Domain Accuracy [0.4155747058592059, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 18368.358470916748
    Train  Domain Loss = 17361.696643829346
    Train  Regularization Loss = 1920.1682224273682
    Train  Total Loss = 37650.22333717346
    Train  Composite Score 15766.75
    Train  Label Accuracy [0.8279367469879518, 0.2524752475247525, 0.6387921022067363, 0.0]
    Train  Label F1 [0.7492653009071938, 0.2853381602764522, 0.7173133355070102, 0]
    Train  Domain Accuracy [0.7081065597250071, 0.0, 0.5253509023202521]

    Val  Label Loss = 12972.124645233154
    Val  Domain Loss = 2895.5598402023315
    Val  Regularization Loss = 544.6519088745117
    Val  Total Loss = 16412.336394309998
    Val  Composite Score 3055.0
    Val  Label Accuracy [0.025606008876749745, 0.009394572025052192, 0.9995051954477981, 0.0]
    Val  Label F1 [0.049867021276595744, 0.018614270941054806, 0.5152404030098202, 0]
    Val  Domain Accuracy [0.6807718348002708, 0.0, 0.9248476641841571]

    Test  Label Loss = 463648.6869354248
    Test  Domain Loss = 20335.02493095398
    Test  Regularization Loss = 2314.770612716675
    Test  Total Loss = 486298.48247909546
    Test  Composite Score 5113.25
    Test  Label Accuracy [0.005780346820809248, 0.0, 0.9973118279569892, 0.0]
    Test  Label F1 [0.011375387797311272, 0, 0.7744629033660956, 0]
    Test  Domain Accuracy [0.5300436784322984, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 21915.84569168091
    Train  Domain Loss = 27110.251350402832
    Train  Regularization Loss = 1950.9133796691895
    Train  Total Loss = 50977.01042175293
    Train  Composite Score 15491.25
    Train  Label Accuracy [0.7998499343462765, 0.2582449941107185, 0.6239837398373984, 0.0]
    Train  Label F1 [0.7373335638941726, 0.2829488627197935, 0.6892791275759763, 0]
    Train  Domain Accuracy [0.6663802157929914, 0.0, 0.49183615010025783]

    Val  Label Loss = 3868.353193283081
    Val  Domain Loss = 2739.86035823822
    Val  Regularization Loss = 551.2709426879883
    Val  Total Loss = 7159.48449420929
    Val  Composite Score 4857.25
    Val  Label Accuracy [0.8644588596790713, 0.11377870563674322, 0.9233052944087086, 0.0]
    Val  Label F1 [0.8017732742241925, 0.20073664825046042, 0.845491617580426, 0]
    Val  Domain Accuracy [0.7335815842924848, 0.0, 0.970886932972241]

    Test  Label Loss = 143390.12886619568
    Test  Domain Loss = 14174.68773651123
    Test  Regularization Loss = 2342.90150642395
    Test  Total Loss = 159907.71810913086
    Test  Composite Score 5192.75
    Test  Label Accuracy [0.5901208617971624, 0.007173601147776184, 0.7708333333333334, 0.0]
    Test  Label F1 [0.5054005400540054, 0.01394700139470014, 0.767480762796922, 0]
    Test  Domain Accuracy [0.6092157557155786, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 16623.16563987732
    Train  Domain Loss = 15052.465856552124
    Train  Regularization Loss = 1874.6804733276367
    Train  Total Loss = 33550.31196975708
    Train  Composite Score 16128.5
    Train  Label Accuracy [0.8492685228881548, 0.2812590239676581, 0.6621660859465738, 0.0]
    Train  Label F1 [0.7659176029962546, 0.31033933407678826, 0.7546326935804103, 0]
    Train  Domain Accuracy [0.6871956459467201, 0.0, 0.5896113816480474]

    Val  Label Loss = 4874.1408314704895
    Val  Domain Loss = 3195.218219280243
    Val  Regularization Loss = 519.0303039550781
    Val  Total Loss = 8588.38935470581
    Val  Composite Score 4192.75
    Val  Label Accuracy [0.5844998292932742, 0.7129436325678496, 0.6066303809995052, 0.0]
    Val  Label F1 [0.6713725490196079, 0.400704018773834, 0.7414575143634714, 0]
    Val  Domain Accuracy [0.5964793500338524, 0.0, 0.965470548408937]

    Test  Label Loss = 288973.44271850586
    Test  Domain Loss = 17003.87054824829
    Test  Regularization Loss = 2205.878791809082
    Test  Total Loss = 308183.19205856323
    Test  Composite Score 3842.0
    Test  Label Accuracy [0.4766158696794535, 0.5853658536585366, 0.32549283154121866, 0.0]
    Test  Label F1 [0.45034756703078455, 0.19936476911800632, 0.4837689362410521, 0]
    Test  Domain Accuracy [0.4257269901231653, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 16890.001136779785
    Train  Domain Loss = 15371.193618774414
    Train  Regularization Loss = 1794.2430515289307
    Train  Total Loss = 34055.43780708313
    Train  Composite Score 16007.25
    Train  Label Accuracy [0.8542100283822138, 0.2606077981651376, 0.6444541231126597, 0.0]
    Train  Label F1 [0.7672501699524132, 0.2892141266306077, 0.7384794543337214, 0]
    Train  Domain Accuracy [0.6981762627709348, 0.0, 0.5743340017187052]

    Val  Label Loss = 5381.99939250946
    Val  Domain Loss = 3046.872169494629
    Val  Regularization Loss = 510.76990127563477
    Val  Total Loss = 8939.641463279724
    Val  Composite Score 4380.25
    Val  Label Accuracy [0.6483441447593035, 0.008350730688935281, 0.9717961405244928, 0.0]
    Val  Label F1 [0.7025527192008879, 0.016511867905056758, 0.721926116522698, 0]
    Val  Domain Accuracy [0.8896411645226812, 0.0, 0.5910629654705484]

    Test  Label Loss = 241989.12957382202
    Test  Domain Loss = 7371.003575801849
    Test  Regularization Loss = 2170.7720804214478
    Test  Total Loss = 251530.90523004532
    Test  Composite Score 5190.5
    Test  Label Accuracy [0.301629006831319, 0.0, 0.8942652329749103, 0.0]
    Test  Label F1 [0.3670076726342711, 0, 0.7749199262350771, 0]
    Test  Domain Accuracy [0.8962342108369732, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 17461.628868103027
    Train  Domain Loss = 15216.99856185913
    Train  Regularization Loss = 1896.748064994812
    Train  Total Loss = 34575.37549495697
    Train  Composite Score 15865.0
    Train  Label Accuracy [0.8476984277325251, 0.23714285714285716, 0.6392276422764228, 0.0]
    Train  Label F1 [0.7568710359408034, 0.2710646636185499, 0.7287925184143011, 0]
    Train  Domain Accuracy [0.700181418886661, 0.0, 0.5785352811992743]

    Val  Label Loss = 3841.596999168396
    Val  Domain Loss = 3168.7108874320984
    Val  Regularization Loss = 569.6926689147949
    Val  Total Loss = 7580.000555515289
    Val  Composite Score 4804.0
    Val  Label Accuracy [0.8863093205872311, 0.162839248434238, 0.8332508659079664, 0.0]
    Val  Label F1 [0.7929138668295662, 0.26621160409556316, 0.822265625, 0]
    Val  Domain Accuracy [0.6340555179417738, 0.0, 0.95937711577522]

    Test  Label Loss = 380150.1177520752
    Test  Domain Loss = 16542.941638946533
    Test  Regularization Loss = 2421.1938428878784
    Test  Total Loss = 399114.2532339096
    Test  Composite Score 4851.5
    Test  Label Accuracy [0.7803468208092486, 0.020086083213773313, 0.5857974910394266, 0.0]
    Test  Label F1 [0.5153565851119208, 0.03669724770642201, 0.6879768481978428, 0]
    Test  Domain Accuracy [0.43210168024239565, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 16697.444416046143
    Train  Domain Loss = 15011.56505203247
    Train  Regularization Loss = 1972.1345672607422
    Train  Total Loss = 33681.144035339355
    Train  Composite Score 16032.5
    Train  Label Accuracy [0.8604410101771579, 0.248984329657574, 0.6406794425087108, 0.0]
    Train  Label F1 [0.7615830518370241, 0.2870045158053186, 0.7409335124244458, 0]
    Train  Domain Accuracy [0.6784111524873484, 0.0, 0.5838823641745441]

    Val  Label Loss = 3597.5110397338867
    Val  Domain Loss = 3044.4852657318115
    Val  Regularization Loss = 557.7504730224609
    Val  Total Loss = 7199.746778488159
    Val  Composite Score 4829.5
    Val  Label Accuracy [0.9153294639808809, 0.2160751565762004, 0.7827808015833746, 0.0]
    Val  Label F1 [0.8020942408376963, 0.3167559296097934, 0.8274058577405858, 0]
    Val  Domain Accuracy [0.5714285714285714, 0.0, 0.973595125253893]

    New Best Val Loss

    Test  Label Loss = 993427.2607059479
    Test  Domain Loss = 18112.848304748535
    Test  Regularization Loss = 2370.439510345459
    Test  Total Loss = 1013910.5485210419
    Test  Composite Score 4698.5
    Test  Label Accuracy [0.8024172359432475, 0.058823529411764705, 0.524641577060932, 0.0]
    Test  Label F1 [0.5079840319361277, 0.09090909090909091, 0.6492930413085667, 0]
    Test  Domain Accuracy [0.3425805690001181, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 20722.327117919922
    Train  Domain Loss = 21422.118675231934
    Train  Regularization Loss = 1998.8913927078247
    Train  Total Loss = 44143.33718585968
    Train  Composite Score 15334.75
    Train  Label Accuracy [0.8024714649561362, 0.26439109054093146, 0.591753774680604, 0.0]
    Train  Label F1 [0.7279962346497797, 0.29393793214343145, 0.6679777122254998, 0]
    Train  Domain Accuracy [0.6733505203857538, 0.0, 0.5313663706674305]

    Val  Label Loss = 3685.19629573822
    Val  Domain Loss = 6677.146977506578
    Val  Regularization Loss = 605.3965759277344
    Val  Total Loss = 10967.739849172533
    Val  Composite Score 4856.5
    Val  Label Accuracy [0.9368385114373506, 0.12839248434237996, 0.8109846610588818, 0.0]
    Val  Label F1 [0.8026912388474476, 0.22262443438914026, 0.8461538461538461, 0]
    Val  Domain Accuracy [0.3006093432633717, 0.0, 1.0]

    Test  Label Loss = 464372.4550590515
    Test  Domain Loss = 71628.56336212158
    Test  Regularization Loss = 2572.935447692871
    Test  Total Loss = 538573.953868866
    Test  Composite Score 4844.0
    Test  Label Accuracy [0.837624802942722, 0.01291248206599713, 0.5602598566308243, 0.0]
    Test  Label F1 [0.5287775750539061, 0.024291497975708502, 0.679804294645284, 0]
    Test  Domain Accuracy [0.11722346830362412, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 18230.3582572937
    Train  Domain Loss = 18242.546798706055
    Train  Regularization Loss = 2112.274211883545
    Train  Total Loss = 38585.1792678833
    Train  Composite Score 15699.5
    Train  Label Accuracy [0.8238706609605325, 0.26587637595258257, 0.633130081300813, 0.0]
    Train  Label F1 [0.744020268819513, 0.29895271342430974, 0.7115933752141633, 0]
    Train  Domain Accuracy [0.6895827365606798, 0.0, 0.5084503007734174]

    Val  Label Loss = 3757.0622148513794
    Val  Domain Loss = 2896.3319005966187
    Val  Regularization Loss = 595.3112983703613
    Val  Total Loss = 7248.705413818359
    Val  Composite Score 4877.5
    Val  Label Accuracy [0.9341072038238306, 0.10960334029227557, 0.8377041068777833, 0.0]
    Val  Label F1 [0.80612846199175, 0.19534883720930235, 0.8565646344548444, 0]
    Val  Domain Accuracy [0.7640487474610698, 0.0, 0.8276912660798916]

    Test  Label Loss = 589021.0648956299
    Test  Domain Loss = 13001.536066055298
    Test  Regularization Loss = 2530.0730180740356
    Test  Total Loss = 604552.6739797592
    Test  Composite Score 4913.0
    Test  Label Accuracy [0.8239621650026274, 0.00860832137733142, 0.5873655913978495, 0.0]
    Test  Label F1 [0.5341509112587293, 0.01655172413793103, 0.6962294211364843, 0]
    Test  Domain Accuracy [0.6566324322197301, 0.0, 0.0]
Training model 1
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 27872.203643798828
    Train  Domain Loss = 13816.85433959961
    Train  Regularization Loss = 3597.664025783539
    Train  Total Loss = 45286.722009181976
    Train  Composite Score 14626.0
    Train  Label Accuracy [0.7631678666161424, 0.15933752141633353, 0.5737514518002322, 0.0]
    Train  Label F1 [0.6858505022986547, 0.1804949053857351, 0.6544671689989237, 0]
    Train  Domain Accuracy [0.8336675260192877, 0.0, 0.6458512365129381]

    Val  Label Loss = 3910.5599489212036
    Val  Domain Loss = 836.16669267416
    Val  Regularization Loss = 882.9850959777832
    Val  Total Loss = 5629.711737573147
    Val  Composite Score 4766.5
    Val  Label Accuracy [0.8525093888699214, 0.1409185803757829, 0.867887184562098, 0.0]
    Val  Label F1 [0.777518293632259, 0.22939677145284623, 0.8320683111954459, 0]
    Val  Domain Accuracy [0.967501692620176, 0.0, 0.9536222071767095]

    Test  Label Loss = 137548.1459941864
    Test  Domain Loss = 3300.7217178344727
    Test  Regularization Loss = 3752.6866579055786
    Test  Total Loss = 144601.55436992645
    Test  Composite Score 5171.75
    Test  Label Accuracy [0.6862848134524435, 0.0014347202295552368, 0.7244623655913979, 0.0]
    Test  Label F1 [0.5293879205512769, 0.0028328611898017, 0.7620169651272385, 0]
    Test  Domain Accuracy [0.9418014402077677, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 18226.982162475586
    Train  Domain Loss = 21957.265754699707
    Train  Regularization Loss = 2738.174259185791
    Train  Total Loss = 42922.422176361084
    Train  Composite Score 15514.75
    Train  Label Accuracy [0.8299172621286198, 0.17416715371127994, 0.6239837398373984, 0.0]
    Train  Label F1 [0.7342677702449777, 0.20712423979148567, 0.7137163732979077, 0]
    Train  Domain Accuracy [0.7584264298672777, 0.0, 0.5961042681180178]

    Val  Label Loss = 3855.1192951202393
    Val  Domain Loss = 2018.511994957924
    Val  Regularization Loss = 742.4111938476562
    Val  Total Loss = 6616.042483925819
    Val  Composite Score 4714.0
    Val  Label Accuracy [0.9364970979856606, 0.05010438413361169, 0.7545769421078674, 0.0]
    Val  Label F1 [0.7811476576961413, 0.09365853658536587, 0.809447983014862, 0]
    Val  Domain Accuracy [0.7241029113067028, 0.0, 0.9854434664861205]

    Test  Label Loss = 317533.9673938751
    Test  Domain Loss = 15737.457801818848
    Test  Regularization Loss = 3155.247573852539
    Test  Total Loss = 336426.6727695465
    Test  Composite Score 4719.5
    Test  Label Accuracy [0.8528638991066737, 0.005738880918220947, 0.5176971326164874, 0.0]
    Test  Label F1 [0.5154835636017152, 0.011049723756906077, 0.6503447305473478, 0]
    Test  Domain Accuracy [0.6092551056545862, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 18489.1336517334
    Train  Domain Loss = 23289.98733139038
    Train  Regularization Loss = 2566.1813526153564
    Train  Total Loss = 44345.302335739136
    Train  Composite Score 15444.25
    Train  Label Accuracy [0.8209025679758308, 0.20109636468551645, 0.6151277584204413, 0.0]
    Train  Label F1 [0.7314098250336473, 0.22607849497242943, 0.7124600638977636, 0]
    Train  Domain Accuracy [0.7006588370094529, 0.0, 0.5328941086603648]

    Val  Label Loss = 4321.740643978119
    Val  Domain Loss = 2476.310473680496
    Val  Regularization Loss = 720.1497459411621
    Val  Total Loss = 7518.200863599777
    Val  Composite Score 4640.5
    Val  Label Accuracy [0.9419597132127006, 0.1430062630480167, 0.6541316180108857, 0.0]
    Val  Label F1 [0.7767454954954955, 0.2227642276422764, 0.7593337162550259, 0]
    Val  Domain Accuracy [0.8361543669600542, 0.0, 0.7230873392010833]

    Test  Label Loss = 262333.0026359558
    Test  Domain Loss = 10327.3235912323
    Test  Regularization Loss = 3060.636420249939
    Test  Total Loss = 275720.96264743805
    Test  Composite Score 4502.0
    Test  Label Accuracy [0.8728323699421965, 0.08751793400286945, 0.4314516129032258, 0.0]
    Test  Label F1 [0.511312913652455, 0.11338289962825278, 0.5876430205949656, 0]
    Test  Domain Accuracy [0.779797741313501, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 17727.75685119629
    Train  Domain Loss = 15832.79428100586
    Train  Regularization Loss = 2423.7343435287476
    Train  Total Loss = 35984.285475730896
    Train  Composite Score 15672.0
    Train  Label Accuracy [0.8218444778362134, 0.22316715542521995, 0.6416957026713124, 0.0]
    Train  Label F1 [0.7389799020435737, 0.24489139179404668, 0.7404305218192478, 0]
    Train  Domain Accuracy [0.7211878162895063, 0.0, 0.5837868805499857]

    Val  Label Loss = 3793.476291656494
    Val  Domain Loss = 2282.887453317642
    Val  Regularization Loss = 652.2602462768555
    Val  Total Loss = 6728.623991250992
    Val  Composite Score 4826.5
    Val  Label Accuracy [0.899283031751451, 0.16910229645093947, 0.8263236021771401, 0.0]
    Val  Label F1 [0.7970948706309576, 0.26843413421706713, 0.835, 0]
    Val  Domain Accuracy [0.7674339878131348, 0.0, 0.9129993229519295]

    Test  Label Loss = 164430.359208107
    Test  Domain Loss = 11574.324067115784
    Test  Regularization Loss = 2772.1060466766357
    Test  Total Loss = 178776.7893218994
    Test  Composite Score 4962.25
    Test  Label Accuracy [0.7645822385706779, 0.047345767575322814, 0.621415770609319, 0.0]
    Test  Label F1 [0.5287063953488372, 0.07875894988066826, 0.7126525369299935, 0]
    Test  Domain Accuracy [0.6927163262896943, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 25979.82558822632
    Train  Domain Loss = 41464.45579147339
    Train  Regularization Loss = 2301.013656616211
    Train  Total Loss = 69745.29503631592
    Train  Composite Score 14795.0
    Train  Label Accuracy [0.7693892843761708, 0.21259609698403312, 0.5580720092915215, 0.0]
    Train  Label F1 [0.7031631211745067, 0.2236391912908242, 0.6405599066822195, 0]
    Train  Domain Accuracy [0.6740189057576625, 0.0, 0.4627136446099494]

    Val  Label Loss = 5318.861786842346
    Val  Domain Loss = 4965.512135505676
    Val  Regularization Loss = 663.4617805480957
    Val  Total Loss = 10947.835702896118
    Val  Composite Score 4549.0
    Val  Label Accuracy [0.9737111642198703, 0.08350730688935282, 0.5759524987629886, 0.0]
    Val  Label F1 [0.7624649111081406, 0.1496725912067353, 0.7127985303123087, 0]
    Val  Domain Accuracy [0.999322951929587, 0.0, 0.010832769126607989]

    Test  Label Loss = 286645.7371292114
    Test  Domain Loss = 4384.584330558777
    Test  Regularization Loss = 2819.7125673294067
    Test  Total Loss = 293850.0340270996
    Test  Composite Score 4273.25
    Test  Label Accuracy [0.9348397267472413, 0.010043041606886656, 0.3487903225806452, 0.0]
    Test  Label F1 [0.492661312655774, 0.01818181818181818, 0.5074967405475881, 0]
    Test  Domain Accuracy [0.9897296659190178, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 19839.99631690979
    Train  Domain Loss = 17539.111610412598
    Train  Regularization Loss = 2233.22878742218
    Train  Total Loss = 39612.33671474457
    Train  Composite Score 15311.0
    Train  Label Accuracy [0.7881796690307329, 0.24117140396210163, 0.6218060394889663, 0.0]
    Train  Label F1 [0.7200241879751209, 0.25688073394495414, 0.706532497525569, 0]
    Train  Domain Accuracy [0.6586460422037621, 0.0, 0.543301823737229]

    Val  Label Loss = 4008.097360610962
    Val  Domain Loss = 3182.3008875846863
    Val  Regularization Loss = 609.8256683349609
    Val  Total Loss = 7800.223916530609
    Val  Composite Score 4678.75
    Val  Label Accuracy [0.9115739160122909, 0.2244258872651357, 0.6848095002474023, 0.0]
    Val  Label F1 [0.7786526684164481, 0.3084648493543759, 0.77665544332211, 0]
    Val  Domain Accuracy [0.43872714962762355, 0.0, 1.0]

    Test  Label Loss = 563082.4161682129
    Test  Domain Loss = 22030.516565322876
    Test  Regularization Loss = 2591.759090423584
    Test  Total Loss = 587704.6918239594
    Test  Composite Score 4563.5
    Test  Label Accuracy [0.8507619548081976, 0.12195121951219512, 0.4538530465949821, 0.0]
    Test  Label F1 [0.5133164235890932, 0.15246636771300448, 0.6043251304996271, 0]
    Test  Domain Accuracy [0.2371620823987723, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 18985.482501983643
    Train  Domain Loss = 18653.716579437256
    Train  Regularization Loss = 2090.445590019226
    Train  Total Loss = 39729.644671440125
    Train  Composite Score 15471.25
    Train  Label Accuracy [0.8147275127286442, 0.21147161066048667, 0.6238385598141696, 0.0]
    Train  Label F1 [0.7342170107910613, 0.24140211640211642, 0.7020668246058328, 0]
    Train  Domain Accuracy [0.6896782201852383, 0.0, 0.5445431108564881]

    Val  Label Loss = 4070.914587020874
    Val  Domain Loss = 2682.6054623126984
    Val  Regularization Loss = 602.0094108581543
    Val  Total Loss = 7355.529460191727
    Val  Composite Score 4743.25
    Val  Label Accuracy [0.9562990781836804, 0.0511482254697286, 0.7446808510638298, 0.0]
    Val  Label F1 [0.785584069555462, 0.09712586719524281, 0.8188248095756256, 0]
    Val  Domain Accuracy [0.5910629654705484, 0.0, 0.989844278943805]

    Test  Label Loss = 325006.49677467346
    Test  Domain Loss = 18848.141657829285
    Test  Regularization Loss = 2558.5399961471558
    Test  Total Loss = 346413.1784286499
    Test  Composite Score 4671.5
    Test  Label Accuracy [0.882291119285339, 0.00430416068866571, 0.4910394265232975, 0.0]
    Test  Label F1 [0.5164564749307905, 0.008403361344537815, 0.6342592592592593, 0]
    Test  Domain Accuracy [0.41848660134576793, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 17484.136182785034
    Train  Domain Loss = 20292.120838165283
    Train  Regularization Loss = 2089.40190410614
    Train  Total Loss = 39865.65892505646
    Train  Composite Score 15840.25
    Train  Label Accuracy [0.8510777881911903, 0.22491145218417946, 0.6260162601626016, 0.0]
    Train  Label F1 [0.7544865403788634, 0.258963466440102, 0.7256205300799327, 0]
    Train  Domain Accuracy [0.6632292561825647, 0.0, 0.5065406282822495]

    Val  Label Loss = 4567.886660575867
    Val  Domain Loss = 3261.8338389396667
    Val  Regularization Loss = 600.3743362426758
    Val  Total Loss = 8430.09483575821
    Val  Composite Score 4591.0
    Val  Label Accuracy [0.9713212700580403, 0.12421711899791232, 0.5878278080158338, 0.0]
    Val  Label F1 [0.766949723682437, 0.2132616487455197, 0.7241694605303262, 0]
    Val  Domain Accuracy [0.44075829383886256, 0.0, 0.997291807718348]

    Test  Label Loss = 847501.9760246277
    Test  Domain Loss = 23767.907603263855
    Test  Regularization Loss = 2551.590929031372
    Test  Total Loss = 873821.4745569229
    Test  Composite Score 4295.75
    Test  Label Accuracy [0.9358906988964792, 0.03299856527977044, 0.35147849462365593, 0.0]
    Test  Label F1 [0.494447529150472, 0.05889884763124199, 0.5108253296434967, 0]
    Test  Domain Accuracy [0.24152992562861528, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 18318.387672424316
    Train  Domain Loss = 17650.14049911499
    Train  Regularization Loss = 2061.3247871398926
    Train  Total Loss = 38029.8529586792
    Train  Composite Score 15667.75
    Train  Label Accuracy [0.8204215456674473, 0.2488915164055572, 0.6287746806039489, 0.0]
    Train  Label F1 [0.7434319426170366, 0.26793953858393, 0.7231591250626148, 0]
    Train  Domain Accuracy [0.6836627518380598, 0.0, 0.5471211687195646]

    Val  Label Loss = 4004.398055076599
    Val  Domain Loss = 2505.346887111664
    Val  Regularization Loss = 574.8510932922363
    Val  Total Loss = 7084.596035480499
    Val  Composite Score 4837.0
    Val  Label Accuracy [0.9262546944349608, 0.09498956158663883, 0.8292924294903513, 0.0]
    Val  Label F1 [0.7987634329456793, 0.17186024551463647, 0.8456104944500503, 0]
    Val  Domain Accuracy [0.6895734597156398, 0.0, 0.975626269465132]

    Test  Label Loss = 470545.4738292694
    Test  Domain Loss = 14758.174805641174
    Test  Regularization Loss = 2443.1171464920044
    Test  Total Loss = 487746.7657814026
    Test  Composite Score 4915.25
    Test  Label Accuracy [0.8055701523909616, 0.00860832137733142, 0.5958781362007168, 0.0]
    Test  Label F1 [0.5316455696202531, 0.01634877384196185, 0.6975219614527336, 0]
    Test  Domain Accuracy [0.5557785385432653, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 17658.544548034668
    Train  Domain Loss = 15605.479362487793
    Train  Regularization Loss = 1950.9161357879639
    Train  Total Loss = 35214.940046310425
    Train  Composite Score 15863.5
    Train  Label Accuracy [0.8391316712484596, 0.2519236249643773, 0.6460511033681765, 0.0]
    Train  Label F1 [0.7524011899702508, 0.2782499213094114, 0.7442716173273124, 0]
    Train  Domain Accuracy [0.6840446863362933, 0.0, 0.572806263725771]

    Val  Label Loss = 4017.404857635498
    Val  Domain Loss = 2866.7556047439575
    Val  Regularization Loss = 535.3242301940918
    Val  Total Loss = 7419.484692573547
    Val  Composite Score 4646.5
    Val  Label Accuracy [0.6848753840901332, 0.4718162839248434, 0.8748144482929243, 0.0]
    Val  Label F1 [0.7302511831088461, 0.41793804900601017, 0.8502043760519356, 0]
    Val  Domain Accuracy [0.5941096817874069, 0.0, 0.981042654028436]

    Test  Label Loss = 403028.6909503937
    Test  Domain Loss = 17175.918420791626
    Test  Regularization Loss = 2275.12797832489
    Test  Total Loss = 422479.7373495102
    Test  Composite Score 4962.5
    Test  Label Accuracy [0.511823436678928, 0.2467718794835007, 0.6980286738351255, 0.0]
    Test  Label F1 [0.47897713302188344, 0.2029498525073746, 0.7449199139373657, 0]
    Test  Domain Accuracy [0.4158108054932515, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 17832.580478668213
    Train  Domain Loss = 15705.663482666016
    Train  Regularization Loss = 1844.0071182250977
    Train  Total Loss = 35382.251079559326
    Train  Composite Score 15827.25
    Train  Label Accuracy [0.8476846175610676, 0.22894356005788713, 0.6326945412311266, 0.0]
    Train  Label F1 [0.7528899313117775, 0.2651692926583976, 0.7262122979503417, 0]
    Train  Domain Accuracy [0.6828033992170343, 0.0, 0.5785352811992743]

    Val  Label Loss = 6526.873216629028
    Val  Domain Loss = 4902.925389289856
    Val  Regularization Loss = 545.189151763916
    Val  Total Loss = 11974.9877576828
    Val  Composite Score 4143.25
    Val  Label Accuracy [0.9918060771594401, 0.12526096033402923, 0.26224641266699655, 0.0]
    Val  Label F1 [0.7164878530028364, 0.20960698689956334, 0.4137392661982826, 0]
    Val  Domain Accuracy [0.9962762356127285, 0.0, 0.12897765741367637]

    Test  Label Loss = 193091.21116256714
    Test  Domain Loss = 3637.245320081711
    Test  Regularization Loss = 2317.053894996643
    Test  Total Loss = 199045.5103776455
    Test  Composite Score 3540.5
    Test  Label Accuracy [0.9868628481345244, 0.02582496413199426, 0.10528673835125447, 0.0]
    Test  Label F1 [0.4478893393751491, 0.04488778054862843, 0.1902834008097166, 0]
    Test  Domain Accuracy [0.9939401093928304, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 21350.371738433838
    Train  Domain Loss = 20967.08501434326
    Train  Regularization Loss = 1914.8374586105347
    Train  Total Loss = 44232.294211387634
    Train  Composite Score 15064.0
    Train  Label Accuracy [0.7715172608409369, 0.23344032681645754, 0.6004645760743321, 0.0]
    Train  Label F1 [0.7117938036969538, 0.25698682942499196, 0.6609140300415468, 0]
    Train  Domain Accuracy [0.6884369330659792, 0.0, 0.5076864317769503]

    Val  Label Loss = 4314.12678194046
    Val  Domain Loss = 3393.6024804115295
    Val  Regularization Loss = 532.7579498291016
    Val  Total Loss = 8240.487212181091
    Val  Composite Score 4678.0
    Val  Label Accuracy [0.9409354728576306, 0.21920668058455114, 0.644235526966848, 0.0]
    Val  Label F1 [0.7884422829352025, 0.29893238434163705, 0.7614035087719299, 0]
    Val  Domain Accuracy [0.3679756262694651, 0.0, 1.0]

    Test  Label Loss = 176160.2910194397
    Test  Domain Loss = 25559.860179901123
    Test  Regularization Loss = 2264.2212867736816
    Test  Total Loss = 203984.3724861145
    Test  Composite Score 4340.0
    Test  Label Accuracy [0.8754598003152917, 0.12625538020086083, 0.37589605734767023, 0.0]
    Test  Label F1 [0.49605478636295963, 0.1592760180995475, 0.5321915635902315, 0]
    Test  Domain Accuracy [0.18407901467752724, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 17074.281829833984
    Train  Domain Loss = 15374.76946258545
    Train  Regularization Loss = 1827.617512702942
    Train  Total Loss = 34276.668805122375
    Train  Composite Score 15909.0
    Train  Label Accuracy [0.8550479413423576, 0.22865497076023392, 0.6337108013937283, 0.0]
    Train  Label F1 [0.7589170247382253, 0.2648154419234677, 0.7289579158316634, 0]
    Train  Domain Accuracy [0.6849040389573188, 0.0, 0.570610140360928]

    Val  Label Loss = 3739.577350616455
    Val  Domain Loss = 2706.4504885673523
    Val  Regularization Loss = 519.5608520507812
    Val  Total Loss = 6965.588691234589
    Val  Composite Score 4831.75
    Val  Label Accuracy [0.8774325708432912, 0.1722338204592902, 0.8599703117268679, 0.0]
    Val  Label F1 [0.7932098765432098, 0.2759197324414716, 0.8396135265700484, 0]
    Val  Domain Accuracy [0.8601895734597157, 0.0, 0.8395396073121192]

    Test  Label Loss = 303817.0987319946
    Test  Domain Loss = 9765.134502410889
    Test  Regularization Loss = 2208.1336212158203
    Test  Total Loss = 315790.36685562134
    Test  Composite Score 5111.75
    Test  Label Accuracy [0.6374146085128745, 0.014347202295552367, 0.725358422939068, 0.0]
    Test  Label F1 [0.5140919686374231, 0.026631158455392805, 0.747978747978748, 0]
    Test  Domain Accuracy [0.8155274859323968, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 17574.802433013916
    Train  Domain Loss = 15170.37285232544
    Train  Regularization Loss = 1778.814673423767
    Train  Total Loss = 34523.98995876312
    Train  Composite Score 15861.75
    Train  Label Accuracy [0.8482185048672148, 0.22835777969513948, 0.639808362369338, 0.0]
    Train  Label F1 [0.7557894736842106, 0.2632189623736118, 0.7295149809634166, 0]
    Train  Domain Accuracy [0.6866227441993699, 0.0, 0.5789172156975079]

    Val  Label Loss = 4156.342979431152
    Val  Domain Loss = 2802.9289379119873
    Val  Regularization Loss = 505.17757415771484
    Val  Total Loss = 7464.4494915008545
    Val  Composite Score 4686.25
    Val  Label Accuracy [0.7374530556503927, 0.33298538622129437, 0.8906481939633845, 0.0]
    Val  Label F1 [0.7539267015706806, 0.3772915434654051, 0.8191126279863482, 0]
    Val  Domain Accuracy [0.7968855788761002, 0.0, 0.7620176032498307]

    Test  Label Loss = 179648.41117095947
    Test  Domain Loss = 10416.906096458435
    Test  Regularization Loss = 2147.004690170288
    Test  Total Loss = 192212.3219575882
    Test  Composite Score 5065.25
    Test  Label Accuracy [0.5260115606936416, 0.12195121951219512, 0.7421594982078853, 0.0]
    Test  Label F1 [0.49044585987261147, 0.14431239388794567, 0.7471808750563825, 0]
    Test  Domain Accuracy [0.773973950340377, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 17018.88609313965
    Train  Domain Loss = 17847.129627227783
    Train  Regularization Loss = 1797.9124822616577
    Train  Total Loss = 36663.92820262909
    Train  Composite Score 15954.0
    Train  Label Accuracy [0.856, 0.21526361782697348, 0.6488095238095238, 0.0]
    Train  Label F1 [0.7607377357701476, 0.2550034506556246, 0.7358801251440804, 0]
    Train  Domain Accuracy [0.6794614723574907, 0.0, 0.5277379929342118]

    Val  Label Loss = 4100.184561729431
    Val  Domain Loss = 3299.9020643234253
    Val  Regularization Loss = 522.7488327026367
    Val  Total Loss = 7922.835458755493
    Val  Composite Score 4700.5
    Val  Label Accuracy [0.9771252987367702, 0.12108559498956159, 0.6531420089064819, 0.0]
    Val  Label F1 [0.784109589041096, 0.21148587055606197, 0.7721556010529395, 0]
    Val  Domain Accuracy [0.453283683141503, 0.0, 0.9495599187542315]

    Test  Label Loss = 226256.49703979492
    Test  Domain Loss = 23096.941514968872
    Test  Regularization Loss = 2221.682538986206
    Test  Total Loss = 251575.12109375
    Test  Composite Score 4367.0
    Test  Label Accuracy [0.9196006305832896, 0.028694404591104734, 0.3803763440860215, 0.0]
    Test  Label F1 [0.4957507082152975, 0.052980132450331126, 0.5379375891018533, 0]
    Test  Domain Accuracy [0.25408255617203795, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 16514.650806427002
    Train  Domain Loss = 15899.95719909668
    Train  Regularization Loss = 1806.8269062042236
    Train  Total Loss = 34221.434911727905
    Train  Composite Score 16229.25
    Train  Label Accuracy [0.8640457872021017, 0.2626470588235294, 0.6628919860627178, 0.0]
    Train  Label F1 [0.7744187024345122, 0.29628400796284005, 0.7579681274900398, 0]
    Train  Domain Accuracy [0.690346605557147, 0.0, 0.5350902320252077]

    Val  Label Loss = 3578.35174036026
    Val  Domain Loss = 3011.062973499298
    Val  Regularization Loss = 505.0982666015625
    Val  Total Loss = 7094.512980461121
    Val  Composite Score 4843.0
    Val  Label Accuracy [0.9532263571184705, 0.14509394572025053, 0.7704106877783276, 0.0]
    Val  Label F1 [0.8021835943111623, 0.24667258207630877, 0.8353004291845493, 0]
    Val  Domain Accuracy [0.6330399458361544, 0.0, 0.9647935003385241]

    New Best Val Loss

    Test  Label Loss = 284483.79194641113
    Test  Domain Loss = 15855.267714500427
    Test  Regularization Loss = 2146.6676330566406
    Test  Total Loss = 302485.7272939682
    Test  Composite Score 4712.0
    Test  Label Accuracy [0.8507619548081976, 0.027259684361549498, 0.5129928315412187, 0.0]
    Test  Label F1 [0.5145399650405212, 0.05026455026455026, 0.646984037293403, 0]
    Test  Domain Accuracy [0.4768425608940306, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 16275.745380401611
    Train  Domain Loss = 15601.526290893555
    Train  Regularization Loss = 1723.115406036377
    Train  Total Loss = 33600.38707733154
    Train  Composite Score 16187.75
    Train  Label Accuracy [0.8652161627578412, 0.2528334786399303, 0.6617305458768873, 0.0]
    Train  Label F1 [0.7732974156073743, 0.282513395031661, 0.763611995309097, 0]
    Train  Domain Accuracy [0.6663802157929914, 0.0, 0.5517998663229257]

    Val  Label Loss = 3777.928933620453
    Val  Domain Loss = 3248.464183330536
    Val  Regularization Loss = 477.47291564941406
    Val  Total Loss = 7503.866032600403
    Val  Composite Score 4699.75
    Val  Label Accuracy [0.7203823830658928, 0.5031315240083507, 0.8436417615042059, 0.0]
    Val  Label F1 [0.7462422634836428, 0.44220183486238535, 0.8565687013313238, 0]
    Val  Domain Accuracy [0.5159106296547055, 0.0, 0.980365605958023]

    Test  Label Loss = 684139.7137126923
    Test  Domain Loss = 19831.07477092743
    Test  Regularization Loss = 2029.2598915100098
    Test  Total Loss = 706000.0483751297
    Test  Composite Score 4934.75
    Test  Label Accuracy [0.6200735680504467, 0.21807747489239598, 0.6480734767025089, 0.0]
    Test  Label F1 [0.5028766247602813, 0.21184668989547042, 0.7232500000000001, 0]
    Test  Domain Accuracy [0.2669893361665289, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 16796.217975616455
    Train  Domain Loss = 14821.81481552124
    Train  Regularization Loss = 1620.49805021286
    Train  Total Loss = 33238.530841350555
    Train  Composite Score 16030.25
    Train  Label Accuracy [0.8548916611950098, 0.25669708566382105, 0.6416957026713124, 0.0]
    Train  Label F1 [0.7641165374135401, 0.286230100114886, 0.7427947231325098, 0]
    Train  Domain Accuracy [0.6868137114484866, 0.0, 0.5906617015181896]

    Val  Label Loss = 3988.3725233078003
    Val  Domain Loss = 3166.8716912269592
    Val  Regularization Loss = 454.32186126708984
    Val  Total Loss = 7609.566075801849
    Val  Composite Score 4689.25
    Val  Label Accuracy [0.9289860020484807, 0.08559498956158663, 0.7323107372587828, 0.0]
    Val  Label F1 [0.7789865445176066, 0.15500945179584122, 0.7847295864262991, 0]
    Val  Domain Accuracy [0.6073121191604604, 0.0, 0.9079214624238321]

    Test  Label Loss = 328312.3962650299
    Test  Domain Loss = 16226.119672775269
    Test  Regularization Loss = 1930.8679103851318
    Test  Total Loss = 346469.3838481903
    Test  Composite Score 4655.0
    Test  Label Accuracy [0.8864950078822911, 0.00860832137733142, 0.4836469534050179, 0.0]
    Test  Label F1 [0.5186779400461183, 0.016282225237449117, 0.6270694162067963, 0]
    Test  Domain Accuracy [0.44768425608940304, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 19084.529653549194
    Train  Domain Loss = 15791.169521331787
    Train  Regularization Loss = 1628.2875218391418
    Train  Total Loss = 36503.98669672012
    Train  Composite Score 15560.5
    Train  Label Accuracy [0.8134856926999716, 0.24791006053617756, 0.6258710801393729, 0.0]
    Train  Label F1 [0.7369636822517858, 0.2811376266753841, 0.6988166639649862, 0]
    Train  Domain Accuracy [0.7094433304688246, 0.0, 0.5516088990738088]

    Val  Label Loss = 4063.270688533783
    Val  Domain Loss = 3969.8026084899902
    Val  Regularization Loss = 469.8625373840332
    Val  Total Loss = 8502.935834407806
    Val  Composite Score 4748.5
    Val  Label Accuracy [0.8306589279617617, 0.1649269311064718, 0.8762988619495299, 0.0]
    Val  Label F1 [0.7900633219678519, 0.24745497259201255, 0.8086757990867579, 0]
    Val  Domain Accuracy [0.9502369668246445, 0.0, 0.15098171970209884]

    Test  Label Loss = 173448.11153793335
    Test  Domain Loss = 6628.121373176575
    Test  Regularization Loss = 1996.915783882141
    Test  Total Loss = 182073.14869499207
    Test  Composite Score 5140.25
    Test  Label Accuracy [0.6121912769311614, 0.043041606886657105, 0.7401433691756273, 0.0]
    Test  Label F1 [0.5133289270764486, 0.0746268656716418, 0.7521912350597609, 0]
    Test  Domain Accuracy [0.9230708692401527, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 17871.803813934326
    Train  Domain Loss = 15641.260025024414
    Train  Regularization Loss = 1667.8161158561707
    Train  Total Loss = 35180.87995481491
    Train  Composite Score 15780.0
    Train  Label Accuracy [0.8321989033843826, 0.2413793103448276, 0.6432926829268293, 0.0]
    Train  Label F1 [0.7518790570550051, 0.28037383177570097, 0.7126085558057252, 0]
    Train  Domain Accuracy [0.7111620357108756, 0.0, 0.5789172156975079]

    Val  Label Loss = 3800.244025707245
    Val  Domain Loss = 2953.74245595932
    Val  Regularization Loss = 485.68851470947266
    Val  Total Loss = 7239.674996376038
    Val  Composite Score 4762.0
    Val  Label Accuracy [0.9682485489928303, 0.1336116910229645, 0.7006432459178624, 0.0]
    Val  Label F1 [0.7941753010361244, 0.22515391380826738, 0.8006785411365565, 0]
    Val  Domain Accuracy [0.503385240352065, 0.0, 0.9901828029790115]

    Test  Label Loss = 159316.20441436768
    Test  Domain Loss = 21507.348236083984
    Test  Regularization Loss = 2064.176187515259
    Test  Total Loss = 182887.72883796692
    Test  Composite Score 4529.0
    Test  Label Accuracy [0.8870204939569102, 0.018651362984218076, 0.4442204301075269, 0.0]
    Test  Label F1 [0.5081276339554486, 0.032994923857868015, 0.5922939068100358, 0]
    Test  Domain Accuracy [0.31220241608625504, 0.0, 0.0]
Training model 2
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 28485.96834564209
    Train  Domain Loss = 10410.064764022827
    Train  Regularization Loss = 2595.9739241600037
    Train  Total Loss = 41492.00703382492
    Train  Composite Score 14999.0
    Train  Label Accuracy [0.7855380527614348, 0.1534090909090909, 0.6116434378629501, 0.0]
    Train  Label F1 [0.7007237482541161, 0.18289585097375105, 0.6840951530405132, 0]
    Train  Domain Accuracy [0.9038479900697031, 0.0, 0.6712498806454693]

    Val  Label Loss = 3686.002869606018
    Val  Domain Loss = 684.6337777972221
    Val  Regularization Loss = 720.1765823364258
    Val  Total Loss = 5090.813229739666
    Val  Composite Score 4725.25
    Val  Label Accuracy [0.9218163195629908, 0.055323590814196244, 0.7808015833745671, 0.0]
    Val  Label F1 [0.7854545454545454, 0.0999057492931197, 0.8134020618556702, 0]
    Val  Domain Accuracy [0.9157075152335816, 0.0, 0.990521327014218]

    Test  Label Loss = 222955.57193946838
    Test  Domain Loss = 5953.5041761398315
    Test  Regularization Loss = 3060.7504749298096
    Test  Total Loss = 231969.82659053802
    Test  Composite Score 5013.5
    Test  Label Accuracy [0.8313189700472937, 0.0, 0.6155913978494624, 0.0]
    Test  Label F1 [0.5492102065613609, 0, 0.7170254403131116, 0]
    Test  Domain Accuracy [0.8961161610199504, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 18527.459224700928
    Train  Domain Loss = 23164.038150787354
    Train  Regularization Loss = 2503.315110206604
    Train  Total Loss = 44194.812485694885
    Train  Composite Score 15506.25
    Train  Label Accuracy [0.8114392873886545, 0.1839080459770115, 0.6431475029036005, 0.0]
    Train  Label F1 [0.7309121621621621, 0.21038435603506409, 0.7241520228851654, 0]
    Train  Domain Accuracy [0.7700754320634011, 0.0, 0.5730927145994462]

    Val  Label Loss = 4407.820343017578
    Val  Domain Loss = 18774.372547492385
    Val  Regularization Loss = 713.7348747253418
    Val  Total Loss = 23895.927765235305
    Val  Composite Score 4765.75
    Val  Label Accuracy [0.8422669853192216, 0.017745302713987474, 0.9406234537357744, 0.0]
    Val  Label F1 [0.7824294322867111, 0.034552845528455285, 0.8400353513035792, 0]
    Val  Domain Accuracy [0.993906567366283, 0.0, 0.016249153689911984]

    Test  Label Loss = 171190.15992355347
    Test  Domain Loss = 209.8305215537548
    Test  Regularization Loss = 3033.3732175827026
    Test  Total Loss = 174433.36366268992
    Test  Composite Score 5231.75
    Test  Label Accuracy [0.5218076720966894, 0.01291248206599713, 0.8107078853046595, 0.0]
    Test  Label F1 [0.48832062945660193, 0.024965325936199722, 0.7749464668094219, 0]
    Test  Domain Accuracy [0.9995671506709165, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 26699.471035003662
    Train  Domain Loss = 64578.92384338379
    Train  Regularization Loss = 2702.749532699585
    Train  Total Loss = 93981.14441108704
    Train  Composite Score 14694.0
    Train  Label Accuracy [0.7487512958250871, 0.21148825065274152, 0.5785423925667829, 0.0]
    Train  Label F1 [0.69458408008043, 0.21438023820026467, 0.6604789922930306, 0]
    Train  Domain Accuracy [0.6803208249785162, 0.0, 0.5017664470543302]

    Val  Label Loss = 3619.132942676544
    Val  Domain Loss = 2012.8662523031235
    Val  Regularization Loss = 749.3332099914551
    Val  Total Loss = 6381.332404971123
    Val  Composite Score 4810.75
    Val  Label Accuracy [0.9170365312393308, 0.12212943632567849, 0.8124690747154873, 0.0]
    Val  Label F1 [0.7995237386515852, 0.19914893617021273, 0.8373278939316675, 0]
    Val  Domain Accuracy [0.7400135409614083, 0.0, 0.989844278943805]

    Test  Label Loss = 295272.2845058441
    Test  Domain Loss = 15023.174349784851
    Test  Regularization Loss = 3184.666142463684
    Test  Total Loss = 313480.12499809265
    Test  Composite Score 4994.75
    Test  Label Accuracy [0.7777193904361535, 0.05164992826398852, 0.6247759856630825, 0.0]
    Test  Label F1 [0.5376930063578564, 0.07868852459016394, 0.723663725998962, 0]
    Test  Domain Accuracy [0.6530122378310314, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 18922.623825073242
    Train  Domain Loss = 18464.01668548584
    Train  Regularization Loss = 2450.9960613250732
    Train  Total Loss = 39837.636571884155
    Train  Composite Score 15593.75
    Train  Label Accuracy [0.8123649346988631, 0.21200585651537335, 0.6477932636469221, 0.0]
    Train  Label F1 [0.736049035883029, 0.23525588952071486, 0.7328570255399522, 0]
    Train  Domain Accuracy [0.7181323403036379, 0.0, 0.5820681753079346]

    Val  Label Loss = 4375.469838142395
    Val  Domain Loss = 2414.654942125082
    Val  Regularization Loss = 695.643196105957
    Val  Total Loss = 7485.767976373434
    Val  Composite Score 4531.0
    Val  Label Accuracy [0.6087401843632639, 0.4342379958246347, 0.9267689262741218, 0.0]
    Val  Label F1 [0.682488038277512, 0.39263803680981596, 0.8376565295169948, 0]
    Val  Domain Accuracy [0.7234258632362898, 0.0, 0.9515910629654706]

    Test  Label Loss = 316924.8572320938
    Test  Domain Loss = 22470.474868774414
    Test  Regularization Loss = 2956.4835834503174
    Test  Total Loss = 342351.81568431854
    Test  Composite Score 5126.0
    Test  Label Accuracy [0.44298476090383604, 0.10186513629842181, 0.7988351254480287, 0.0]
    Test  Label F1 [0.45176848874598075, 0.12199312714776633, 0.7725303292894281, 0]
    Test  Domain Accuracy [0.6078778577893205, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 20248.73899078369
    Train  Domain Loss = 27211.65090560913
    Train  Regularization Loss = 2487.5319032669067
    Train  Total Loss = 49947.92179965973
    Train  Composite Score 15258.5
    Train  Label Accuracy [0.7933822147020116, 0.2108187134502924, 0.6138211382113821, 0.0]
    Train  Label F1 [0.7223553577541938, 0.22722975102426723, 0.6989007355979832, 0]
    Train  Domain Accuracy [0.6656163467965244, 0.0, 0.4772271555428244]

    Val  Label Loss = 4509.655857086182
    Val  Domain Loss = 2632.44460773468
    Val  Regularization Loss = 701.9071769714355
    Val  Total Loss = 7844.007641792297
    Val  Composite Score 4053.25
    Val  Label Accuracy [0.35472857630590643, 0.7985386221294363, 0.8070262246412667, 0.0]
    Val  Label F1 [0.4954697186456843, 0.4116222760290557, 0.8353393085787452, 0]
    Val  Domain Accuracy [0.7471225457007448, 0.0, 0.932972241029113]

    Test  Label Loss = 431297.64577293396
    Test  Domain Loss = 14222.980386734009
    Test  Regularization Loss = 2983.105502128601
    Test  Total Loss = 448503.73166179657
    Test  Composite Score 4438.25
    Test  Label Accuracy [0.21439831844456123, 0.6771879483500718, 0.6010304659498208, 0.0]
    Test  Label F1 [0.2904948380206479, 0.24933967247754887, 0.7123324040886766, 0]
    Test  Domain Accuracy [0.6303860229016645, 0.0, 0.0]

  EPOCH 5
    Train  Label Loss = 19150.607913970947
    Train  Domain Loss = 18617.220668792725
    Train  Regularization Loss = 2399.3396434783936
    Train  Total Loss = 40167.168226242065
    Train  Composite Score 15500.25
    Train  Label Accuracy [0.7955119214586255, 0.2366934284864704, 0.6389372822299652, 0.0]
    Train  Label F1 [0.7316506858150233, 0.24522489217498458, 0.7284614747993048, 0]
    Train  Domain Accuracy [0.6875775804449537, 0.0, 0.5386231261338681]

    Val  Label Loss = 5413.952711105347
    Val  Domain Loss = 2857.3327679634094
    Val  Regularization Loss = 664.4621086120605
    Val  Total Loss = 8935.747587680817
    Val  Composite Score 4660.75
    Val  Label Accuracy [0.9583475588938204, 0.012526096033402923, 0.7055912914398812, 0.0]
    Val  Label F1 [0.7747722881589842, 0.024665981500513877, 0.7928829580205725, 0]
    Val  Domain Accuracy [0.8249830737982397, 0.0, 0.6553825321597834]

    Test  Label Loss = 737362.3903961182
    Test  Domain Loss = 11024.926592826843
    Test  Regularization Loss = 2823.9639616012573
    Test  Total Loss = 751211.2809505463
    Test  Composite Score 4631.75
    Test  Label Accuracy [0.8891224382553863, 0.0, 0.476926523297491, 0.0]
    Test  Label F1 [0.515225334957369, 0, 0.620428384088591, 0]
    Test  Domain Accuracy [0.8011254082556172, 0.0, 0.0]

  EPOCH 6
    Train  Label Loss = 19748.129558563232
    Train  Domain Loss = 19799.16565322876
    Train  Regularization Loss = 2246.5808248519897
    Train  Total Loss = 41793.87603664398
    Train  Composite Score 15467.5
    Train  Label Accuracy [0.8076923076923077, 0.21728971962616822, 0.6289198606271778, 0.0]
    Train  Label F1 [0.7328185657608464, 0.24429486127072728, 0.7050207502644642, 0]
    Train  Domain Accuracy [0.6807027594767497, 0.0, 0.5636398357681658]

    Val  Label Loss = 3591.6726274490356
    Val  Domain Loss = 2837.185678958893
    Val  Regularization Loss = 658.5272598266602
    Val  Total Loss = 7087.385566234589
    Val  Composite Score 4877.5
    Val  Label Accuracy [0.9231819733697507, 0.061586638830897704, 0.8762988619495299, 0.0]
    Val  Label F1 [0.8069233064756789, 0.11512195121951219, 0.8662264612374663, 0]
    Val  Domain Accuracy [0.899796885578876, 0.0, 0.6079891672308734]

    Test  Label Loss = 359397.24198150635
    Test  Domain Loss = 9574.396168708801
    Test  Regularization Loss = 2798.7408542633057
    Test  Total Loss = 371770.37900447845
    Test  Composite Score 5165.0
    Test  Label Accuracy [0.7677351550183921, 0.0028694404591104736, 0.6875, 0.0]
    Test  Label F1 [0.5527809307604995, 0.005625879043600563, 0.7548886975771738, 0]
    Test  Domain Accuracy [0.9016645024200213, 0.0, 0.0]

  EPOCH 7
    Train  Label Loss = 20494.501220703125
    Train  Domain Loss = 20571.2724609375
    Train  Regularization Loss = 2270.777536392212
    Train  Total Loss = 43336.55121803284
    Train  Composite Score 15316.75
    Train  Label Accuracy [0.7882319766895385, 0.23310909622696696, 0.6218060394889663, 0.0]
    Train  Label F1 [0.7208182912154032, 0.25169745776093483, 0.7013263468151302, 0]
    Train  Domain Accuracy [0.6683853719087176, 0.0, 0.5371908717654922]

    Val  Label Loss = 5902.307968616486
    Val  Domain Loss = 6378.280005931854
    Val  Regularization Loss = 652.3114585876465
    Val  Total Loss = 12932.899433135986
    Val  Composite Score 4496.5
    Val  Label Accuracy [0.9699556162512804, 0.1430062630480167, 0.5185551707075705, 0.0]
    Val  Label F1 [0.7703362255965293, 0.20493642483171276, 0.67547534643893, 0]
    Val  Domain Accuracy [0.999322951929587, 0.0, 0.003385240352064997]

    Test  Label Loss = 349922.61599349976
    Test  Domain Loss = 2494.095139980316
    Test  Regularization Loss = 2772.3236989974976
    Test  Total Loss = 355189.03483247757
    Test  Composite Score 3999.5
    Test  Label Accuracy [0.9353652128218602, 0.03299856527977044, 0.2632168458781362, 0.0]
    Test  Label F1 [0.4803670219943328, 0.044965786901270774, 0.412715138742536, 0]
    Test  Domain Accuracy [0.9948451579900052, 0.0, 0.0]

  EPOCH 8
    Train  Label Loss = 19040.54071044922
    Train  Domain Loss = 16150.358348846436
    Train  Regularization Loss = 2187.950472831726
    Train  Total Loss = 37378.84953212738
    Train  Composite Score 15721.5
    Train  Label Accuracy [0.8152489918409453, 0.24594992636229748, 0.6495354239256679, 0.0]
    Train  Label F1 [0.7439770636313064, 0.2629921259842519, 0.7390765672751302, 0]
    Train  Domain Accuracy [0.6911104745536141, 0.0, 0.5887520290270218]

    Val  Label Loss = 3555.067317008972
    Val  Domain Loss = 2696.8544845581055
    Val  Regularization Loss = 600.7712173461914
    Val  Total Loss = 6852.693018913269
    Val  Composite Score 4870.75
    Val  Label Accuracy [0.905428473881871, 0.10334029227557412, 0.8777832756061356, 0.0]
    Val  Label F1 [0.8031496062992126, 0.1804922515952598, 0.8622114216281895, 0]
    Val  Domain Accuracy [0.7965470548408937, 0.0, 0.9441435341909276]

    Test  Label Loss = 345942.8750190735
    Test  Domain Loss = 13321.87124824524
    Test  Regularization Loss = 2553.2776737213135
    Test  Total Loss = 361818.02394104004
    Test  Composite Score 5119.25
    Test  Label Accuracy [0.7551234892275355, 0.00860832137733142, 0.6783154121863799, 0.0]
    Test  Label F1 [0.5443181818181818, 0.0163265306122449, 0.7464563046961666, 0]
    Test  Domain Accuracy [0.701766812261441, 0.0, 0.0]

  EPOCH 9
    Train  Label Loss = 18929.168811798096
    Train  Domain Loss = 16096.870189666748
    Train  Regularization Loss = 2058.956597328186
    Train  Total Loss = 37084.99559879303
    Train  Composite Score 15653.5
    Train  Label Accuracy [0.8173831775700935, 0.22185824895771292, 0.6409698025551684, 0.0]
    Train  Label F1 [0.7430440508049786, 0.25126475548060706, 0.7137660657990462, 0]
    Train  Domain Accuracy [0.7054330182373723, 0.0, 0.5635443521436073]

    Val  Label Loss = 14800.186411857605
    Val  Domain Loss = 3945.6590089797974
    Val  Regularization Loss = 657.8588104248047
    Val  Total Loss = 19403.704231262207
    Val  Composite Score 3778.75
    Val  Label Accuracy [0.9897575964493001, 0.08872651356993737, 0.042058386937159825, 0.0]
    Val  Label F1 [0.6728559823604502, 0.15567765567765568, 0.08068343616516375, 0]
    Val  Domain Accuracy [0.1939742721733243, 0.0, 0.9847664184157076]

    Test  Label Loss = 390790.07534217834
    Test  Domain Loss = 28593.29243850708
    Test  Regularization Loss = 2795.89994430542
    Test  Total Loss = 422179.26772499084
    Test  Composite Score 3214.25
    Test  Label Accuracy [0.998949027850762, 0.0, 0.006720430107526882, 0.0]
    Test  Label F1 [0.4256128960035822, 0, 0.013351134846461948, 0]
    Test  Domain Accuracy [0.16192499901625151, 0.0, 0.0]

  EPOCH 10
    Train  Label Loss = 22123.53427886963
    Train  Domain Loss = 30610.841972351074
    Train  Regularization Loss = 2543.383406639099
    Train  Total Loss = 55277.7596578598
    Train  Composite Score 15172.5
    Train  Label Accuracy [0.7988695242581253, 0.2227708393842579, 0.5871080139372822, 0.0]
    Train  Label F1 [0.7224707135250266, 0.24874331117236906, 0.6672716772543519, 0]
    Train  Domain Accuracy [0.644609949393679, 0.0, 0.44409433782106367]

    Val  Label Loss = 3892.367292404175
    Val  Domain Loss = 3257.522970676422
    Val  Regularization Loss = 740.9607124328613
    Val  Total Loss = 7890.850975513458
    Val  Composite Score 4751.5
    Val  Label Accuracy [0.899965858654831, 0.23068893528183715, 0.7466600692726373, 0.0]
    Val  Label F1 [0.7909977494373595, 0.3108298171589311, 0.8093322606596942, 0]
    Val  Domain Accuracy [0.45396073121191605, 0.0, 0.996614759647935]

    Test  Label Loss = 500348.82000923157
    Test  Domain Loss = 23511.404554367065
    Test  Regularization Loss = 3149.0830278396606
    Test  Total Loss = 527009.3075914383
    Test  Composite Score 4777.25
    Test  Label Accuracy [0.8434051497635313, 0.0746054519368723, 0.5282258064516129, 0.0]
    Test  Label F1 [0.5324266047437387, 0.10473313192346424, 0.6636645088657472, 0]
    Test  Domain Accuracy [0.21363081887223076, 0.0, 0.0]

  EPOCH 11
    Train  Label Loss = 18040.441844940186
    Train  Domain Loss = 19910.973510742188
    Train  Regularization Loss = 2583.8925132751465
    Train  Total Loss = 40535.30786895752
    Train  Composite Score 15687.5
    Train  Label Accuracy [0.8283624085537422, 0.2234982332155477, 0.6332752613240418, 0.0]
    Train  Label F1 [0.7447194232471859, 0.25004117937736786, 0.7241636922055283, 0]
    Train  Domain Accuracy [0.6223622648715745, 0.0, 0.4602310703714313]

    Val  Label Loss = 3563.1786017417908
    Val  Domain Loss = 3713.2199244499207
    Val  Regularization Loss = 730.8958053588867
    Val  Total Loss = 8007.294331550598
    Val  Composite Score 4819.0
    Val  Label Accuracy [0.9139638101741209, 0.10334029227557412, 0.8312716476991588, 0.0]
    Val  Label F1 [0.7937731653076352, 0.1852198316183349, 0.8395802098950524, 0]
    Val  Domain Accuracy [0.991875423155044, 0.0, 0.12153012863913337]

    New Best Val Loss

    Test  Label Loss = 545649.3345108032
    Test  Domain Loss = 11359.329607963562
    Test  Regularization Loss = 3106.3071727752686
    Test  Total Loss = 560114.971291542
    Test  Composite Score 5052.5
    Test  Label Accuracy [0.7792958486600106, 0.007173601147776184, 0.6482974910394266, 0.0]
    Test  Label F1 [0.5373188405797101, 0.013908205841446452, 0.7336798073266573, 0]
    Test  Domain Accuracy [0.9650179042222484, 0.0, 0.0]

  EPOCH 12
    Train  Label Loss = 17489.838527679443
    Train  Domain Loss = 16979.94635772705
    Train  Regularization Loss = 2510.903003692627
    Train  Total Loss = 36980.68788909912
    Train  Composite Score 15825.75
    Train  Label Accuracy [0.8335049134300421, 0.23658464275126, 0.6443089430894309, 0.0]
    Train  Label F1 [0.7504845369512092, 0.2642384105960265, 0.7366586438708606, 0]
    Train  Domain Accuracy [0.6605557146949298, 0.0, 0.5022438651771222]

    Val  Label Loss = 4305.908652305603
    Val  Domain Loss = 3522.222549676895
    Val  Regularization Loss = 700.3004837036133
    Val  Total Loss = 8528.431685686111
    Val  Composite Score 4696.0
    Val  Label Accuracy [0.9607374530556504, 0.04384133611691023, 0.7105393369619001, 0.0]
    Val  Label F1 [0.7803660565723793, 0.08374875373878365, 0.7975562343793391, 0]
    Val  Domain Accuracy [0.2870683818551117, 0.0, 1.0]

    Test  Label Loss = 604199.8838043213
    Test  Domain Loss = 23502.222534179688
    Test  Regularization Loss = 2976.2770557403564
    Test  Total Loss = 630678.3833942413
    Test  Composite Score 4562.0
    Test  Label Accuracy [0.9180241723594325, 0.0014347202295552368, 0.4435483870967742, 0.0]
    Test  Label F1 [0.5137479782384943, 0.0028530670470756064, 0.5976456383942047, 0]
    Test  Domain Accuracy [0.08656986581670799, 0.0, 0.0]

  EPOCH 13
    Train  Label Loss = 17627.65591430664
    Train  Domain Loss = 15499.135192871094
    Train  Regularization Loss = 2364.5180530548096
    Train  Total Loss = 35491.309160232544
    Train  Composite Score 15819.75
    Train  Label Accuracy [0.8283302063789869, 0.25927015891701, 0.6416957026713124, 0.0]
    Train  Label F1 [0.7506588455326023, 0.27739294710327456, 0.7395014221181194, 0]
    Train  Domain Accuracy [0.679270505108374, 0.0, 0.5511314809510169]

    Val  Label Loss = 3937.79727268219
    Val  Domain Loss = 3281.007849216461
    Val  Regularization Loss = 647.5625610351562
    Val  Total Loss = 7866.367682933807
    Val  Composite Score 4828.0
    Val  Label Accuracy [0.8531922157733015, 0.17640918580375783, 0.8906481939633845, 0.0]
    Val  Label F1 [0.7953532781667727, 0.2781893004115226, 0.8339124391938846, 0]
    Val  Domain Accuracy [0.7359512525389302, 0.0, 0.6963439404197698]

    Test  Label Loss = 684361.3177433014
    Test  Domain Loss = 15058.84062576294
    Test  Regularization Loss = 2752.140884399414
    Test  Total Loss = 702172.2992534637
    Test  Composite Score 5163.5
    Test  Label Accuracy [0.6810299527062533, 0.018651362984218076, 0.7215501792114696, 0.0]
    Test  Label F1 [0.532347504621072, 0.03394255874673629, 0.7585070057694572, 0]
    Test  Domain Accuracy [0.6222799354661, 0.0, 0.0]

  EPOCH 14
    Train  Label Loss = 16962.946643829346
    Train  Domain Loss = 15564.994369506836
    Train  Regularization Loss = 2200.7468185424805
    Train  Total Loss = 34728.68783187866
    Train  Composite Score 15922.0
    Train  Label Accuracy [0.8400188768286928, 0.2494946578111464, 0.6527293844367015, 0.0]
    Train  Label F1 [0.7532797291578501, 0.2824452435436417, 0.7427721790847513, 0]
    Train  Domain Accuracy [0.6626563544352143, 0.0, 0.557815334670104]

    Val  Label Loss = 3737.3613510131836
    Val  Domain Loss = 3090.914909362793
    Val  Regularization Loss = 604.9778938293457
    Val  Total Loss = 7433.254154205322
    Val  Composite Score 4845.25
    Val  Label Accuracy [0.8545578695800614, 0.3235908141962422, 0.830282038594755, 0.0]
    Val  Label F1 [0.7946031746031745, 0.39667306461932184, 0.8489754616746774, 0]
    Val  Domain Accuracy [0.5453622207176709, 0.0, 0.987136086662153]

    Test  Label Loss = 523788.20166015625
    Test  Domain Loss = 18753.753274917603
    Test  Regularization Loss = 2571.1560487747192
    Test  Total Loss = 545113.1109838486
    Test  Composite Score 4963.25
    Test  Label Accuracy [0.7761429322122964, 0.040172166427546625, 0.617831541218638, 0.0]
    Test  Label F1 [0.532156368221942, 0.066429418742586, 0.713214378070856, 0]
    Test  Domain Accuracy [0.3249517963247157, 0.0, 0.0]

  EPOCH 15
    Train  Label Loss = 17072.238410949707
    Train  Domain Loss = 16218.942840576172
    Train  Regularization Loss = 2053.99263381958
    Train  Total Loss = 35345.17388534546
    Train  Composite Score 15981.5
    Train  Label Accuracy [0.8514489355716027, 0.26332842415316643, 0.6335656213704994, 0.0]
    Train  Label F1 [0.7633902295467923, 0.29206141783730805, 0.7301932569229482, 0]
    Train  Domain Accuracy [0.6590279767019956, 0.0, 0.5525637353193927]

    Val  Label Loss = 3852.2248678207397
    Val  Domain Loss = 3820.5511264801025
    Val  Regularization Loss = 574.0178489685059
    Val  Total Loss = 8246.793843269348
    Val  Composite Score 4753.0
    Val  Label Accuracy [0.9245476271765107, 0.027139874739039668, 0.8085106382978723, 0.0]
    Val  Label F1 [0.8003546623319049, 0.05163853028798411, 0.8085106382978723, 0]
    Val  Domain Accuracy [0.9637779282329045, 0.0, 0.03757616790792146]

    Test  Label Loss = 346103.49349594116
    Test  Domain Loss = 8564.826655387878
    Test  Regularization Loss = 2439.57585811615
    Test  Total Loss = 357107.8960094452
    Test  Composite Score 4943.75
    Test  Label Accuracy [0.7997898055701524, 0.00860832137733142, 0.6068548387096774, 0.0]
    Test  Label F1 [0.5343163068281552, 0.016643550624133148, 0.7027237354085603, 0]
    Test  Domain Accuracy [0.990005115492071, 0.0, 0.0]

  EPOCH 16
    Train  Label Loss = 19876.695442199707
    Train  Domain Loss = 17197.493213653564
    Train  Regularization Loss = 1965.6151695251465
    Train  Total Loss = 39039.80382537842
    Train  Composite Score 15469.5
    Train  Label Accuracy [0.7996586707120508, 0.25263457704357734, 0.6303716608594657, 0.0]
    Train  Label F1 [0.7375278737265533, 0.2795461708162622, 0.6882231732445713, 0]
    Train  Domain Accuracy [0.6932111142938986, 0.0, 0.5452114962283968]

    Val  Label Loss = 4687.354981422424
    Val  Domain Loss = 3660.424582719803
    Val  Regularization Loss = 556.5304756164551
    Val  Total Loss = 8904.310039758682
    Val  Composite Score 4657.0
    Val  Label Accuracy [0.9720040969614203, 0.11482254697286012, 0.6348342404750124, 0.0]
    Val  Label F1 [0.7784005468215994, 0.19607843137254904, 0.7593962710861202, 0]
    Val  Domain Accuracy [0.35003385240352064, 0.0, 1.0]

    Test  Label Loss = 217168.28268241882
    Test  Domain Loss = 31960.03765487671
    Test  Regularization Loss = 2365.254521369934
    Test  Total Loss = 251493.57485866547
    Test  Composite Score 4291.25
    Test  Label Accuracy [0.9379926431949553, 0.015781922525107604, 0.351926523297491, 0.0]
    Test  Label F1 [0.49487108400332686, 0.02887139107611548, 0.5107282184655396, 0]
    Test  Domain Accuracy [0.14500452524298588, 0.0, 0.0]

  EPOCH 17
    Train  Label Loss = 18548.624515533447
    Train  Domain Loss = 16520.029876708984
    Train  Regularization Loss = 2016.519968032837
    Train  Total Loss = 37085.17436027527
    Train  Composite Score 15577.5
    Train  Label Accuracy [0.8140367404616109, 0.23903572465872786, 0.6302264808362369, 0.0]
    Train  Label F1 [0.7388943520458335, 0.2720211535283424, 0.7001048302556245, 0]
    Train  Domain Accuracy [0.7147904134440943, 0.0, 0.5561921130526115]

    Val  Label Loss = 3761.4680252075195
    Val  Domain Loss = 2937.512414932251
    Val  Regularization Loss = 583.5108375549316
    Val  Total Loss = 7282.491277694702
    Val  Composite Score 4793.5
    Val  Label Accuracy [0.9457152611812906, 0.1430062630480167, 0.7496288965858486, 0.0]
    Val  Label F1 [0.7930146006298311, 0.24247787610619467, 0.818918918918919, 0]
    Val  Domain Accuracy [0.7210561949898443, 0.0, 0.8937034529451591]

    Test  Label Loss = 170183.46561813354
    Test  Domain Loss = 13346.851079940796
    Test  Regularization Loss = 2479.9210596084595
    Test  Total Loss = 186010.2377576828
    Test  Composite Score 4692.5
    Test  Label Accuracy [0.8633736205990541, 0.007173601147776184, 0.5049283154121864, 0.0]
    Test  Label F1 [0.5186237373737373, 0.013368983957219251, 0.639977285633163, 0]
    Test  Domain Accuracy [0.6508086412466061, 0.0, 0.0]

  EPOCH 18
    Train  Label Loss = 18733.40574645996
    Train  Domain Loss = 16766.40906715393
    Train  Regularization Loss = 2034.5462808609009
    Train  Total Loss = 37534.36109447479
    Train  Composite Score 15657.25
    Train  Label Accuracy [0.8115257439773264, 0.24042614454362224, 0.6518583042973287, 0.0]
    Train  Label F1 [0.7406449387825487, 0.2719426803452207, 0.7188025294164733, 0]
    Train  Domain Accuracy [0.7145994461949776, 0.0, 0.5554282440561443]

    Val  Label Loss = 3777.0810780525208
    Val  Domain Loss = 3016.6822516918182
    Val  Regularization Loss = 571.6045761108398
    Val  Total Loss = 7365.367905855179
    Val  Composite Score 4804.75
    Val  Label Accuracy [0.9194264254011608, 0.21816283924843424, 0.7595249876298862, 0.0]
    Val  Label F1 [0.7958037825059101, 0.32055214723926384, 0.8199786324786325, 0]
    Val  Domain Accuracy [0.483073798239675, 0.0, 0.9996614759647935]

    Test  Label Loss = 201559.26048088074
    Test  Domain Loss = 24640.43540763855
    Test  Regularization Loss = 2429.3194484710693
    Test  Total Loss = 228629.01533699036
    Test  Composite Score 4639.25
    Test  Label Accuracy [0.882291119285339, 0.03443328550932568, 0.4767025089605735, 0.0]
    Test  Label F1 [0.5175709001233046, 0.059627329192546576, 0.6226773957571324, 0]
    Test  Domain Accuracy [0.2440876716641089, 0.0, 0.0]

  EPOCH 19
    Train  Label Loss = 17506.51184463501
    Train  Domain Loss = 18962.84965133667
    Train  Regularization Loss = 2006.5053453445435
    Train  Total Loss = 38475.86684131622
    Train  Composite Score 15800.25
    Train  Label Accuracy [0.8486190969931191, 0.24209915917657293, 0.6193379790940766, 0.0]
    Train  Label F1 [0.7545888860950465, 0.2773165061441382, 0.7139151535436364, 0]
    Train  Domain Accuracy [0.6707724625226774, 0.0, 0.5298386326744964]

    Val  Label Loss = 3873.585627555847
    Val  Domain Loss = 3426.346510410309
    Val  Regularization Loss = 583.3596611022949
    Val  Total Loss = 7883.291799068451
    Val  Composite Score 4791.25
    Val  Label Accuracy [0.9508364629566405, 0.0918580375782881, 0.7649678377041069, 0.0]
    Val  Label F1 [0.7948059360730594, 0.16666666666666666, 0.8240938166311301, 0]
    Val  Domain Accuracy [0.942450914014895, 0.0, 0.21462423832092078]

    Test  Label Loss = 225962.08526039124
    Test  Domain Loss = 11164.832110881805
    Test  Regularization Loss = 2479.2785596847534
    Test  Total Loss = 239606.1959309578
    Test  Composite Score 4784.75
    Test  Label Accuracy [0.861271676300578, 0.005738880918220947, 0.5336021505376344, 0.0]
    Test  Label F1 [0.5246478873239437, 0.0110803324099723, 0.6655490360435875, 0]
    Test  Domain Accuracy [0.9340888521622791, 0.0, 0.0]
