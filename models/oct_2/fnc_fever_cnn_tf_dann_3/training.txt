Loading train vectors...
Loading val vectors...
Loading test vectors...
Loading TF vectors...
Loading CNN vectors...
SIZE_TRAIN = 94441
SIZE_VAL = 5908
SIZE_TEST = 25413
TEST LABEL FREQ = [ 3: 18349, 0: 1903, 2: 4464, 1: 697, ]
Training model 0
Defining Model...
Training Model...

  EPOCH 0
    Train  Label Loss = 18686.70715713501
    Train  Domain Loss = 12654.501838684082
    Train  Regularization Loss = 2412.248694896698
    Train  Total Loss = 33753.45769071579
    Train  Composite Score 15368.0
    Train  Label Accuracy [0.8051219740162632, 0.1637392080976481, 0.6322590011614402, 0.0]
    Train  Label F1 [0.723288131323733, 0.1915375239421905, 0.7081876575331328, 0]
    Train  Domain Accuracy [0.8562016614150673, 0.0, 0.6595053948247875]

    Val  Label Loss = 4007.224856376648
    Val  Domain Loss = 1655.5401185750961
    Val  Regularization Loss = 737.1520042419434
    Val  Total Loss = 6399.916979193687
    Val  Composite Score 4558.75
    Val  Label Accuracy [0.9631273472174804, 0.016701461377870562, 0.6293913904007917, 0.0]
    Val  Label F1 [0.7614035087719299, 0.03219315895372233, 0.7456037514654162, 0]
    Val  Domain Accuracy [0.9231550440081245, 0.0, 0.8933649289099526]

    New Best Val Loss

    Test  Label Loss = 171224.27304840088
    Test  Domain Loss = 4746.241587638855
    Test  Regularization Loss = 3132.8960180282593
    Test  Total Loss = 179103.410654068
    Test  Composite Score 4449.5
    Test  Label Accuracy [0.9337887545980031, 0.0028694404591104736, 0.40300179211469533, 0.0]
    Test  Label F1 [0.5061236115066932, 0.005714285714285714, 0.561660942866063, 0]
    Test  Domain Accuracy [0.885963876755991, 0.0, 0.0]

  EPOCH 1
    Train  Label Loss = 21133.33250808716
    Train  Domain Loss = 63286.46490097046
    Train  Regularization Loss = 2739.631318092346
    Train  Total Loss = 87159.42872714996
    Train  Composite Score 15001.25
    Train  Label Accuracy [0.7661214514006393, 0.22923976608187135, 0.5969802555168409, 0.0]
    Train  Label F1 [0.7028285615729561, 0.24477052763034654, 0.6732705689725748, 0]
    Train  Domain Accuracy [0.6198796906330565, 0.0, 0.46701040771507685]

    Val  Label Loss = 3651.200677871704
    Val  Domain Loss = 3341.17138171196
    Val  Regularization Loss = 717.084846496582
    Val  Total Loss = 7709.456906080246
    Val  Composite Score 4768.0
    Val  Label Accuracy [0.9306930693069307, 0.006263048016701462, 0.8193963384463137, 0.0]
    Val  Label F1 [0.7876336318982953, 0.012448132780082988, 0.8427480916030534, 0]
    Val  Domain Accuracy [0.5558564658090724, 0.0, 0.9041976980365606]

    New Best Val Loss

    Test  Label Loss = 273981.1071243286
    Test  Domain Loss = 24429.42774581909
    Test  Regularization Loss = 3047.6105976104736
    Test  Total Loss = 301458.1454677582
    Test  Composite Score 4818.5
    Test  Label Accuracy [0.8801891749868629, 0.0, 0.5365143369175627, 0.0]
    Test  Label F1 [0.5325067556827214, 0, 0.6708683473389355, 0]
    Test  Domain Accuracy [0.436823672923307, 0.0, 0.0]

  EPOCH 2
    Train  Label Loss = 19618.152256011963
    Train  Domain Loss = 43087.1448059082
    Train  Regularization Loss = 2545.6267862319946
    Train  Total Loss = 65250.92384815216
    Train  Composite Score 15339.75
    Train  Label Accuracy [0.7906513700578364, 0.2195955568214184, 0.6382113821138211, 0.0]
    Train  Label F1 [0.7195306096035204, 0.244684227229451, 0.7144482366325371, 0]
    Train  Domain Accuracy [0.5686049842452019, 0.0, 0.42986727776186384]

    Val  Label Loss = 3696.443221092224
    Val  Domain Loss = 12806.637312822044
    Val  Regularization Loss = 715.3581047058105
    Val  Total Loss = 17218.43863862008
    Val  Composite Score 4808.25
    Val  Label Accuracy [0.8231478320245817, 0.2139874739039666, 0.9040079168728352, 0.0]
    Val  Label F1 [0.7855979146301726, 0.3012490815576782, 0.8472061210294458, 0]
    Val  Domain Accuracy [0.0, 0.0, 1.0]

    Test  Label Loss = 94760.778881073
    Test  Domain Loss = 102355.7173500061
    Test  Regularization Loss = 3040.271944999695
    Test  Total Loss = 200156.7681760788
    Test  Composite Score 5316.5
    Test  Label Accuracy [0.6190225959012087, 0.01721664275466284, 0.7934587813620072, 0.0]
    Test  Label F1 [0.5324293785310734, 0.03234501347708895, 0.7908015181960258, 0]
    Test  Domain Accuracy [0.0001967496950379727, 0.0, 0.0]

  EPOCH 3
    Train  Label Loss = 29786.508304595947
    Train  Domain Loss = 66734.43573379517
    Train  Regularization Loss = 2630.760093688965
    Train  Total Loss = 99151.70413208008
    Train  Composite Score 14630.5
    Train  Label Accuracy [0.7358348260582634, 0.23123732251521298, 0.5799941927990708, 0.0]
    Train  Label F1 [0.6842889707171664, 0.2401083195426508, 0.6541137945149407, 0]
    Train  Domain Accuracy [0.5771985104554569, 0.0, 0.4004583213978803]

    Val  Label Loss = 6505.570233345032
    Val  Domain Loss = 3441.0962591171265
    Val  Regularization Loss = 725.2634811401367
    Val  Total Loss = 10671.929973602295
    Val  Composite Score 4655.5
    Val  Label Accuracy [0.7678388528508023, 0.0, 0.9841662543295399, 0.0]
    Val  Label F1 [0.7601825249281731, 0, 0.8051001821493624, 0]
    Val  Domain Accuracy [0.8283683141503047, 0.0, 0.5341909275558565]

    Test  Label Loss = 391713.42150497437
    Test  Domain Loss = 14199.671531677246
    Test  Regularization Loss = 3082.369794845581
    Test  Total Loss = 408995.4628314972
    Test  Composite Score 5248.25
    Test  Label Accuracy [0.15186547556489752, 0.0, 0.975358422939068, 0.0]
    Test  Label F1 [0.24093372238432678, 0, 0.7893401015228426, 0]
    Test  Domain Accuracy [0.740683901939952, 0.0, 0.0]

  EPOCH 4
    Train  Label Loss = 18674.050136566162
    Train  Domain Loss = 20976.912139892578
    Train  Regularization Loss = 2371.8538208007812
    Train  Total Loss = 42022.81609725952
    Train  Composite Score 15614.75
    Train  Label Accuracy [0.7987758945386064, 0.2428737638161722, 0.6596980255516841, 0.0]
    Train  Label F1 [0.7305373751291767, 0.2620018826482586, 0.7436380001636527, 0]
    Train  Domain Accuracy [0.5750978707151724, 0.0, 0.451542060536618]

    Val  Label Loss = 3421.5785417556763
    Val  Domain Loss = 4048.6653776168823
    Val  Regularization Loss = 633.7705421447754
    Val  Total Loss = 8104.014461517334
    Val  Composite Score 4836.25
    Val  Label Accuracy [0.8791396381017412, 0.08663883089770355, 0.901039089559624, 0.0]
    Val  Label F1 [0.7977075588599752, 0.1534195933456562, 0.8513323983169705, 0]
    Val  Domain Accuracy [0.2166553825321598, 0.0, 0.9637779282329045]

    New Best Val Loss

    Test  Label Loss = 197496.29976272583
    Test  Domain Loss = 26311.168195724487
    Test  Regularization Loss = 2693.5248041152954
    Test  Total Loss = 226500.9927625656
    Test  Composite Score 5279.75
    Test  Label Accuracy [0.6789280084077772, 0.007173601147776184, 0.7589605734767025, 0.0]
    Test  Label F1 [0.5461847389558233, 0.013986013986013986, 0.7804653305689934, 0]
    Test  Domain Accuracy [0.09695824971471294, 0.0, 0.0]

  EPOCH 5